<Alter AllowCreate="true" ObjectExpansion="ExpandFull" xmlns="http://schemas.microsoft.com/analysisservices/2003/engine">
  <Object>
    <DatabaseID>SemanticModel</DatabaseID>
  </Object>
  <ObjectDefinition>
    <Database xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ddl2="http://schemas.microsoft.com/analysisservices/2003/engine/2" xmlns:ddl2_2="http://schemas.microsoft.com/analysisservices/2003/engine/2/2" xmlns:ddl100_100="http://schemas.microsoft.com/analysisservices/2008/engine/100/100" xmlns:ddl200="http://schemas.microsoft.com/analysisservices/2010/engine/200" xmlns:ddl200_200="http://schemas.microsoft.com/analysisservices/2010/engine/200/200" xmlns:ddl300="http://schemas.microsoft.com/analysisservices/2011/engine/300" xmlns:ddl300_300="http://schemas.microsoft.com/analysisservices/2011/engine/300/300" xmlns:ddl400="http://schemas.microsoft.com/analysisservices/2012/engine/400" xmlns:ddl400_400="http://schemas.microsoft.com/analysisservices/2012/engine/400/400">
      <ID>SemanticModel</ID>
      <Name>SemanticModel</Name>
      <Annotations>
        <Annotation>
          <Name>ClientCompatibilityLevel</Name>
          <Value>300</Value>
        </Annotation>
      </Annotations>
      <ddl200:CompatibilityLevel>1103</ddl200:CompatibilityLevel>
      <ddl200_200:StorageEngineUsed>InMemory</ddl200_200:StorageEngineUsed>
      <Language>12298</Language>
      <DataSourceImpersonationInfo>
        <ImpersonationMode>Default</ImpersonationMode>
      </DataSourceImpersonationInfo>
      <Dimensions>
        <Dimension>
          <ID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</ID>
          <Name>DWDCuentaContable</Name>
          <Annotations>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
              <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT DISTINCT 
  cc.ccIdCuentaContable,
  ccCodigoNivel6=CONVERT(varchar(12), DecryptByKey(cc.ccCodigoNivel6)),
  cc.ccCodigoMoneda,
  cc.ccCodigoIndicador,  
  
  cpCalIndicadorNivel1=case when cp.indicadorNivel1 is null then cr.CpCodigoIndicadorN2 else cp.indicadorNivel1 end, -- se tiene los codigos de rentabilidad de nivel unon para el filtro en el dataset
  cpCalIndicadorNivel2=cp.indicadorNivel2, 
  --cpCalIndicadorNivel3=cp.indicadorNivel3, -- Se comento porque la informacion ya tiene la columna cc.ccCodigoIndicador

  ccCalProductoNivel1= case when cp.ProductoNivel1 is null then cc.ccFamiliaProducto else cp.ProductoNivel1  end,
  ccCalProductoNivel2= case when cp.ProductoNivel2 is null then cc.ccGrupo else cp.ProductoNivel2  end,

  cp.CpEstadoProducto,
  --cp.CpOrden, Comente porque no se usa
  cc.ccAgrupacionContableNivel2,
   
  ccSubGrupo,
  ccTarifaTransaccion=ltrim(rtrim(ccCostoOperativo)),

  ccCalCodigoAgrupacionRentabilidaN1=cr.CpCodigoIndicadorN2,
  ccCalAgrupacionRentabilidaN1=ltrim(rtrim(upper(CpProducto))),
  ccCalCodigoTipoIngresoN2=cr.CpCodigoIndicadorN3,
  ccCalTipoIngresoN2=ltrim(rtrim(upper(ccTipoIngreso))),
  ccCalDescripcionNivel6N3= case when CONVERT(varchar(150), DecryptByKey(cc.ccDescripcionNivel6)) like '%SIN%DESCRIPCION%NIVEL%' then 'SIN DESCRIPCION NIVEL' 
                            else substring(CONVERT(varchar(150), DecryptByKey(cc.ccDescripcionNivel6)),14,100) end,
  
  ccAgrupacionTributario,
  ccAgrupacionRentabilidadTransaccion,
  ccCovid,
  ccCodigoNivel2,
  ccCodigoNivel3,

  ccCalProductoCobranza=case when    ccCodigoNivel2 between '1409' and '1416' or ccCodigoNivel2 between '1421' and '1424' 
								  or ccCodigoNivel2 between '1433' and '1437' or ccCodigoNivel2 between '1439' and '1440' 
								  or ccCodigoNivel2 between '1457' and '1464' or ccCodigoNivel3='149105' then 'REF'

							 when    ccCodigoNivel2 between '1417' and '1420' or ccCodigoNivel2 in ('1441','1443','1444','1465','1467','1468')
							      or ccCodigoNivel3 in ( '14948025','14958025','14968025') then 'REES' else ''
							 end,
 ccCodigoIndicadorRentabilidad

--drop table #DWDCuentaContable
--into #DWDCuentaContable

FROM DWDCuentaContable cc
left outer join
( 
    SELECT DISTINCT 
    p.CpCodigoIndicador indicadorNivel1,p1.CpCodigoIndicador indicadorNivel2,p2.CpCodigoIndicador indicadorNivel3,
    p.CpProducto ProductoNivel1,
    ProductoNivel2=case when p1.CpCodigoIndicador=124  then 'Tarjeta de Credito' else p1.CpProducto end,
    p2.CpEstadoProducto,
    isnull(p1.CpOrden,1) CpOrden
    FROM DWDClasificacionProductos p
    join DWDClasificacionProductos p1 ON p1.CpPadre=p.CpCodigoIndicador
    join DWDClasificacionProductos p2 ON p2.CpPadre=p1.CpCodigoIndicador
    WHERE p.CpCodigoIndicador in (1,2,3,72,80,73) -- Comente los indicadores 32,28 ; 72 (ficticias de ingresos); 80 (Portafolio); 73(Cont)
    and  p.CpNivel=1 and p1.CpNivel=2 and p2.CpNivel=3
    and p1.CpCodigoIndicador not in (125,143,144) -- Se excluye estas agrupaciones que no pertenecen a captaciones EA

) cp ON ccCodigoIndicador=cp.indicadorNivel3
left outer join
(
   select distinct
   CpCodigoIndicadorN4=n4.CpCodigoIndicador,
   CpCodigoIndicadorN2=n2.CpCodigoIndicador,
   CpCodigoIndicadorN3=n3.CpCodigoIndicador,
   n2.CpProducto
   from DWDClasificacionProductos n1
   inner join DWDClasificacionProductos n2 on n2.CpPadre=n1.CpCodigoIndicador
   inner join DWDClasificacionProductos n3 on n3.CpPadre=n2.CpCodigoIndicador
   inner join DWDClasificacionProductos n4 on n4.CpPadre=n3.CpCodigoIndicador
   where n1.CpCodigoIndicador=71 -- Cuentas de rentabilidad
   and n1.CpNivel=1 and n2.CpNivel=2 and n3.CpNivel=3 and n4.CpNivel=4
) as cr on cc.ccCodigoIndicadorRentabilidad=cr.CpCodigoIndicadorN4


CLOSE SYMMETRIC KEY ClaveMIS02&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
            </Annotation>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>True</Value>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>ccIdCuentaContable</AttributeID>
                  <Cardinality>One</Cardinality>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccIdCuentaContable</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCodigoMoneda</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCodigoMoneda</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCodigoIndicador</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCodigoIndicador</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>CpEstadoProducto</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>CpEstadoProducto</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCodigoNivel6</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCodigoNivel6</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccAgrupacionContableNivel2</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccAgrupacionContableNivel2</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>cpCalIndicadorNivel1</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>cpCalIndicadorNivel1</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>cpCalIndicadorNivel2</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>cpCalIndicadorNivel2</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalProductoNivel1</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalProductoNivel1</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalProductoNivel2</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalProductoNivel2</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccSubGrupo</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccSubGrupo</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccTarifaTransaccion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccTarifaTransaccion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalAgrupacionRentabilidaN1</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalAgrupacionRentabilidaN1</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalTipoIngresoN2</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalTipoIngresoN2</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalDescripcionNivel6N3</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalDescripcionNivel6N3</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalCodigoAgrupacionRentabilidaN1</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalCodigoAgrupacionRentabilidaN1</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalCodigoTipoIngresoN2</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalCodigoTipoIngresoN2</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>cpCalOrdenIndicadorNivel1</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>cpCalOrdenIndicadorNivel1</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>cpCalOrdenIndicadorNivel2</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>cpCalOrdenIndicadorNivel2</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccAgrupacionTributario</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccAgrupacionTributario</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalOrdenAgrupacionTributario</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalOrdenAgrupacionTributario</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalBandera</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalBandTributarioAhoCtaCorr</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccAgrupacionRentabilidadTransaccion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccAgrupacionRentabilidadTransaccion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalProductoBruto</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalProductoBruto</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalEstado</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalEstado</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCovid</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCovid</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalProductoOperCredito</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalProductoOperCredito</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalEstadoOpeCredito</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalEstadoOpeCredito</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalAgrupacion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalAgrupacionCobranza</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCodigoNivel2</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCodigoNivel2</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCodigoNivel3</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCodigoNivel3</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalProductoCobranza</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalProductoCobranza</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCodigoIndicadorRentabilidad</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCodigoIndicadorRentabilidad</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccIdCuentaContable</ID>
              <Name>ccIdCuentaContable</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    <ColumnID>ccIdCuentaContable</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                  <ColumnID>ccIdCuentaContable</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccCodigoMoneda</ID>
              <Name>ccCodigoMoneda</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    <ColumnID>ccCodigoMoneda</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                  <ColumnID>ccCodigoMoneda</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccCodigoIndicador</ID>
              <Name>ccCodigoIndicador</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    <ColumnID>ccCodigoIndicador</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                  <ColumnID>ccCodigoIndicador</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>CpEstadoProducto</ID>
              <Name>CpEstadoProducto</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    <ColumnID>CpEstadoProducto</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                  <ColumnID>CpEstadoProducto</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>ccCodigoNivel6</ID>
              <Name>ccCodigoNivel6</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    <ColumnID>ccCodigoNivel6</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                  <ColumnID>ccCodigoNivel6</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>ccAgrupacionContableNivel2</ID>
              <Name>ccAgrupacionContableNivel2</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    <ColumnID>ccAgrupacionContableNivel2</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                  <ColumnID>ccAgrupacionContableNivel2</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>cpCalIndicadorNivel1</ID>
              <Name>cpCalIndicadorNivel1</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    <ColumnID>cpCalIndicadorNivel1</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                  <ColumnID>cpCalIndicadorNivel1</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>cpCalIndicadorNivel2</ID>
              <Name>cpCalIndicadorNivel2</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    <ColumnID>cpCalIndicadorNivel2</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                  <ColumnID>cpCalIndicadorNivel2</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>ccCalProductoNivel1</ID>
              <Name>ccCalProductoNivel1</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    <ColumnID>ccCalProductoNivel1</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                  <ColumnID>ccCalProductoNivel1</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>ccCalProductoNivel2</ID>
              <Name>ccCalProductoNivel2</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    <ColumnID>ccCalProductoNivel2</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                  <ColumnID>ccCalProductoNivel2</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>ccSubGrupo</ID>
              <Name>ccSubGrupo</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    <ColumnID>ccSubGrupo</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                  <ColumnID>ccSubGrupo</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>ccTarifaTransaccion</ID>
              <Name>ccTarifaTransaccion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    <ColumnID>ccTarifaTransaccion</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                  <ColumnID>ccTarifaTransaccion</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>ccCalAgrupacionRentabilidaN1</ID>
              <Name>ccCalAgrupacionRentabilidaN1</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    <ColumnID>ccCalAgrupacionRentabilidaN1</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                  <ColumnID>ccCalAgrupacionRentabilidaN1</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <ID>ccCalTipoIngresoN2</ID>
              <Name>ccCalTipoIngresoN2</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    <ColumnID>ccCalTipoIngresoN2</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                  <ColumnID>ccCalTipoIngresoN2</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <ID>ccCalDescripcionNivel6N3</ID>
              <Name>ccCalDescripcionNivel6N3</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    <ColumnID>ccCalDescripcionNivel6N3</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                  <ColumnID>ccCalDescripcionNivel6N3</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>ccCalCodigoAgrupacionRentabilidaN1</ID>
              <Name>ccCalCodigoAgrupacionRentabilidaN1</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    <ColumnID>ccCalCodigoAgrupacionRentabilidaN1</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                  <ColumnID>ccCalCodigoAgrupacionRentabilidaN1</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <ID>ccCalCodigoTipoIngresoN2</ID>
              <Name>ccCalCodigoTipoIngresoN2</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    <ColumnID>ccCalCodigoTipoIngresoN2</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                  <ColumnID>ccCalCodigoTipoIngresoN2</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>cpCalOrdenIndicadorNivel1</ID>
              <Name>cpCalOrdenIndicadorNivel1</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>
IF(DWDCuentaContable[cpCalIndicadorNivel1]=1 ||  DWDCuentaContable[cpCalIndicadorNivel1]=80,20,
  IF(DWDCuentaContable[cpCalIndicadorNivel1]=2,10,
      IF(DWDCuentaContable[cpCalIndicadorNivel1]=3,30,
             IF(DWDCuentaContable[cpCalIndicadorNivel1]=72,40,99))))</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>
IF(DWDCuentaContable[cpCalIndicadorNivel1]=1 ||  DWDCuentaContable[cpCalIndicadorNivel1]=80,20,
  IF(DWDCuentaContable[cpCalIndicadorNivel1]=2,10,
      IF(DWDCuentaContable[cpCalIndicadorNivel1]=3,30,
             IF(DWDCuentaContable[cpCalIndicadorNivel1]=72,40,99))))</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>cpCalOrdenIndicadorNivel2</ID>
              <Name>cpCalOrdenIndicadorNivel2</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>
if(DWDCuentaContable[cpCalIndicadorNivel2]=140,11,
  if(DWDCuentaContable[cpCalIndicadorNivel2]=141,12,
    if(DWDCuentaContable[cpCalIndicadorNivel2]=142,13,
      if(DWDCuentaContable[cpCalIndicadorNivel2]=120 || DWDCuentaContable[cpCalIndicadorNivel2]=126,21,
         if(DWDCuentaContable[cpCalIndicadorNivel2]=121,22,
            if(DWDCuentaContable[cpCalIndicadorNivel2]=122,23,
               if(DWDCuentaContable[cpCalIndicadorNivel2]=124,24,
                  if(DWDCuentaContable[cpCalIndicadorNivel2]=200,25,
                  if(DWDCuentaContable[cpCalIndicadorNivel2]=160,31,
                     if(DWDCuentaContable[cpCalIndicadorNivel2]=161,32,
                       if(DWDCuentaContable[cpCalIndicadorNivel2]=162,33,
                          if(DWDCuentaContable[cpCalIndicadorNivel2]=100,40,99
                          ))))))))))))
                          
                        </Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>
if(DWDCuentaContable[cpCalIndicadorNivel2]=140,11,
  if(DWDCuentaContable[cpCalIndicadorNivel2]=141,12,
    if(DWDCuentaContable[cpCalIndicadorNivel2]=142,13,
      if(DWDCuentaContable[cpCalIndicadorNivel2]=120 || DWDCuentaContable[cpCalIndicadorNivel2]=126,21,
         if(DWDCuentaContable[cpCalIndicadorNivel2]=121,22,
            if(DWDCuentaContable[cpCalIndicadorNivel2]=122,23,
               if(DWDCuentaContable[cpCalIndicadorNivel2]=124,24,
                  if(DWDCuentaContable[cpCalIndicadorNivel2]=200,25,
                  if(DWDCuentaContable[cpCalIndicadorNivel2]=160,31,
                     if(DWDCuentaContable[cpCalIndicadorNivel2]=161,32,
                       if(DWDCuentaContable[cpCalIndicadorNivel2]=162,33,
                          if(DWDCuentaContable[cpCalIndicadorNivel2]=100,40,99
                          ))))))))))))
                          
                        </Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>ccAgrupacionTributario</ID>
              <Name>ccAgrupacionTributario</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    <ColumnID>ccAgrupacionTributario</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                  <ColumnID>ccAgrupacionTributario</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccCalOrdenAgrupacionTributario</ID>
              <Name>ccCalOrdenAgrupacionTributario</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>
IF(DWDCuentaContable[ccAgrupacionTributario]="Mantenimiento, administracion, mantencion o manejo de cuentas ahorros", 1,
IF(DWDCuentaContable[ccAgrupacionTributario]="Depositos efectivo - ahorros, cuentas corrientes", 2, 
IF(DWDCuentaContable[ccAgrupacionTributario]="Deposito en cheque ahorros y cuentas corriente", 3,
IF(DWDCuentaContable[ccAgrupacionTributario]="Deposito Mixto - ahorros y cuenta corriente", 4, 
IF(DWDCuentaContable[ccAgrupacionTributario]="Retiro en cajas cuentas de ahorros", 5,
IF(DWDCuentaContable[ccAgrupacionTributario]="Mantenimiento, administracion, mantencion o manejo de cuentas corriente", 6, 
IF(DWDCuentaContable[ccAgrupacionTributario]="Tarjeta de debito, emision y renovacion",  7,
IF(DWDCuentaContable[ccAgrupacionTributario]="Tarjeta de debito, reposicion",8 ,
IF(DWDCuentaContable[ccAgrupacionTributario]="Mantenimiento tarjeta credito", 9,
IF(DWDCuentaContable[ccAgrupacionTributario]="Transacciones Baninter on Line", 10,
IF(DWDCuentaContable[ccAgrupacionTributario]="Atm - Otras Transacciones", 11,
IF(DWDCuentaContable[ccAgrupacionTributario]="Atm Retiros Clientes Propios (Sin costo)",12 ,
IF(DWDCuentaContable[ccAgrupacionTributario]="Otras transacciones", 13,
IF(DWDCuentaContable[ccAgrupacionTributario]="SIN AGRUPACION TRIBUTARIO",99 ,20 ))))))))))))))</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>
IF(DWDCuentaContable[ccAgrupacionTributario]="Mantenimiento, administracion, mantencion o manejo de cuentas ahorros", 1,
IF(DWDCuentaContable[ccAgrupacionTributario]="Depositos efectivo - ahorros, cuentas corrientes", 2, 
IF(DWDCuentaContable[ccAgrupacionTributario]="Deposito en cheque ahorros y cuentas corriente", 3,
IF(DWDCuentaContable[ccAgrupacionTributario]="Deposito Mixto - ahorros y cuenta corriente", 4, 
IF(DWDCuentaContable[ccAgrupacionTributario]="Retiro en cajas cuentas de ahorros", 5,
IF(DWDCuentaContable[ccAgrupacionTributario]="Mantenimiento, administracion, mantencion o manejo de cuentas corriente", 6, 
IF(DWDCuentaContable[ccAgrupacionTributario]="Tarjeta de debito, emision y renovacion",  7,
IF(DWDCuentaContable[ccAgrupacionTributario]="Tarjeta de debito, reposicion",8 ,
IF(DWDCuentaContable[ccAgrupacionTributario]="Mantenimiento tarjeta credito", 9,
IF(DWDCuentaContable[ccAgrupacionTributario]="Transacciones Baninter on Line", 10,
IF(DWDCuentaContable[ccAgrupacionTributario]="Atm - Otras Transacciones", 11,
IF(DWDCuentaContable[ccAgrupacionTributario]="Atm Retiros Clientes Propios (Sin costo)",12 ,
IF(DWDCuentaContable[ccAgrupacionTributario]="Otras transacciones", 13,
IF(DWDCuentaContable[ccAgrupacionTributario]="SIN AGRUPACION TRIBUTARIO",99 ,20 ))))))))))))))</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccCalBandera</ID>
              <Name>ccCalBandTributarioAhoCtaCorr</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>IF(LEFT(DWDCuentaContable[ccCodigoNivel6],6)="210105" || LEFT(DWDCuentaContable[ccCodigoNivel6],6)="210110" || LEFT(DWDCuentaContable[ccCodigoNivel6],6)="210115" 
|| LEFT(DWDCuentaContable[ccCodigoNivel6],6)="210125" || LEFT(DWDCuentaContable[ccCodigoNivel6],6)="210135",1,0)
</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>IF(LEFT(DWDCuentaContable[ccCodigoNivel6],6)="210105" || LEFT(DWDCuentaContable[ccCodigoNivel6],6)="210110" || LEFT(DWDCuentaContable[ccCodigoNivel6],6)="210115" 
|| LEFT(DWDCuentaContable[ccCodigoNivel6],6)="210125" || LEFT(DWDCuentaContable[ccCodigoNivel6],6)="210135",1,0)
</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>ccAgrupacionRentabilidadTransaccion</ID>
              <Name>ccAgrupacionRentabilidadTransaccion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    <ColumnID>ccAgrupacionRentabilidadTransaccion</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                  <ColumnID>ccAgrupacionRentabilidadTransaccion</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccCalProductoBruto</ID>
              <Name>ccCalProductoBruto</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>IF(DWDCuentaContable[cpCalIndicadorNivel1]=2, "Depósitos " &amp; DWDCuentaContable[ccCalProductoNivel2], 
   IF(DWDCuentaContable[cpCalIndicadorNivel1]=1, DWDCuentaContable[ccCalProductoNivel1] &amp;" " &amp; DWDCuentaContable[ccCalProductoNivel2],""))</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>IF(DWDCuentaContable[cpCalIndicadorNivel1]=2, "Depósitos " &amp; DWDCuentaContable[ccCalProductoNivel2], 
   IF(DWDCuentaContable[cpCalIndicadorNivel1]=1, DWDCuentaContable[ccCalProductoNivel1] &amp;" " &amp; DWDCuentaContable[ccCalProductoNivel2],""))</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccCalEstado</ID>
              <Name>ccCalEstado</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>IF(UPPER(DWDCuentaContable[CpEstadoProducto])="VIG","Por Vencer",
  IF(UPPER(DWDCuentaContable[CpEstadoProducto])="VEN" ||  UPPER(DWDCuentaContable[CpEstadoProducto])="NDE","En Dificultades","No Aplica"))</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>IF(UPPER(DWDCuentaContable[CpEstadoProducto])="VIG","Por Vencer",
  IF(UPPER(DWDCuentaContable[CpEstadoProducto])="VEN" ||  UPPER(DWDCuentaContable[CpEstadoProducto])="NDE","En Dificultades","No Aplica"))</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>ccCovid</ID>
              <Name>ccCovid</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Boolean</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    <ColumnID>ccCovid</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                  <ColumnID>ccCovid</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccCalProductoOperCredito</ID>
              <Name>ccCalProductoOperCredito</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>IF(DWDCuentaContable[cpCalIndicadorNivel1]=1 &amp;&amp; DWDCuentaContable[ccCovid]=TRUE() , DWDCuentaContable[ccCalDescripcionNivel6N3], 
    IF(DWDCuentaContable[cpCalIndicadorNivel1]=1  &amp;&amp; (DWDCuentaContable[cpCalIndicadorNivel2]=122 || DWDCuentaContable[cpCalIndicadorNivel2]=126) ,  UPPER(DWDCuentaContable[ccSubGrupo]),
      IF(DWDCuentaContable[cpCalIndicadorNivel1]=1  , UPPER(DWDCuentaContable[ccCalProductoNivel2]) &amp; " " &amp;  UPPER(DWDCuentaContable[ccSubGrupo]),BLANK())))</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>IF(DWDCuentaContable[cpCalIndicadorNivel1]=1 &amp;&amp; DWDCuentaContable[ccCovid]=TRUE() , DWDCuentaContable[ccCalDescripcionNivel6N3], 
    IF(DWDCuentaContable[cpCalIndicadorNivel1]=1  &amp;&amp; (DWDCuentaContable[cpCalIndicadorNivel2]=122 || DWDCuentaContable[cpCalIndicadorNivel2]=126) ,  UPPER(DWDCuentaContable[ccSubGrupo]),
      IF(DWDCuentaContable[cpCalIndicadorNivel1]=1  , UPPER(DWDCuentaContable[ccCalProductoNivel2]) &amp; " " &amp;  UPPER(DWDCuentaContable[ccSubGrupo]),BLANK())))</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccCalEstadoOpeCredito</ID>
              <Name>ccCalEstadoOpeCredito</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>IF(UPPER(DWDCuentaContable[CpEstadoProducto])="VIG","Vigente",
    IF(UPPER(DWDCuentaContable[CpEstadoProducto])="NDE","QNDI",
       IF(UPPER(DWDCuentaContable[CpEstadoProducto])="VEN","Vencida",BLANK())))
</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>IF(UPPER(DWDCuentaContable[CpEstadoProducto])="VIG","Vigente",
    IF(UPPER(DWDCuentaContable[CpEstadoProducto])="NDE","QNDI",
       IF(UPPER(DWDCuentaContable[CpEstadoProducto])="VEN","Vencida",BLANK())))
</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccCalAgrupacion</ID>
              <Name>ccCalAgrupacionCobranza</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>IF(DWDCuentaContable[cpCalIndicadorNivel1]=1 &amp;&amp; DWDCuentaContable[ccCovid]=TRUE() , DWDCuentaContable[ccCalDescripcionNivel6N3], 
    IF(DWDCuentaContable[cpCalIndicadorNivel1]=1  &amp;&amp; (DWDCuentaContable[cpCalIndicadorNivel2]=122 || DWDCuentaContable[cpCalIndicadorNivel2]=126) ,  UPPER(DWDCuentaContable[ccSubGrupo]),
      IF(DWDCuentaContable[cpCalIndicadorNivel1]=1  , UPPER(DWDCuentaContable[ccCalProductoNivel2]) &amp; " " &amp;  UPPER(DWDCuentaContable[ccSubGrupo]),BLANK())))

&amp; " " &amp; DWDCuentaContable[ccCalProductoCobranza]</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>IF(DWDCuentaContable[cpCalIndicadorNivel1]=1 &amp;&amp; DWDCuentaContable[ccCovid]=TRUE() , DWDCuentaContable[ccCalDescripcionNivel6N3], 
    IF(DWDCuentaContable[cpCalIndicadorNivel1]=1  &amp;&amp; (DWDCuentaContable[cpCalIndicadorNivel2]=122 || DWDCuentaContable[cpCalIndicadorNivel2]=126) ,  UPPER(DWDCuentaContable[ccSubGrupo]),
      IF(DWDCuentaContable[cpCalIndicadorNivel1]=1  , UPPER(DWDCuentaContable[ccCalProductoNivel2]) &amp; " " &amp;  UPPER(DWDCuentaContable[ccSubGrupo]),BLANK())))

&amp; " " &amp; DWDCuentaContable[ccCalProductoCobranza]</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>ccCodigoNivel2</ID>
              <Name>ccCodigoNivel2</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32768</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    <ColumnID>ccCodigoNivel2</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32768</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                  <ColumnID>ccCodigoNivel2</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>ccCodigoNivel3</ID>
              <Name>ccCodigoNivel3</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32768</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    <ColumnID>ccCodigoNivel3</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32768</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                  <ColumnID>ccCodigoNivel3</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>ccCalProductoCobranza</ID>
              <Name>ccCalProductoCobranza</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32768</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    <ColumnID>ccCalProductoCobranza</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32768</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                  <ColumnID>ccCalProductoCobranza</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>ccCodigoIndicadorRentabilidad</ID>
              <Name>ccCodigoIndicadorRentabilidad</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    <ColumnID>ccCodigoIndicadorRentabilidad</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                  <ColumnID>ccCodigoIndicadorRentabilidad</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
          </Attributes>
          <Hierarchies>
            <Hierarchy>
              <ID>ccJerCuentasContables</ID>
              <Name>ccJerCuentasContables</Name>
              <Levels>
                <Level>
                  <ID>ccCalProductoNivel1</ID>
                  <Name>ccCalProductoNivel1</Name>
                  <SourceAttributeID>ccCalProductoNivel1</SourceAttributeID>
                </Level>
                <Level>
                  <ID>ccCalProductoBruto</ID>
                  <Name>ccCalProductoBruto</Name>
                  <SourceAttributeID>ccCalProductoBruto</SourceAttributeID>
                </Level>
                <Level>
                  <ID>ccCodigoNivel6</ID>
                  <Name>ccCodigoNivel6</Name>
                  <SourceAttributeID>ccCodigoNivel6</SourceAttributeID>
                </Level>
              </Levels>
            </Hierarchy>
          </Hierarchies>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
        </Dimension>
        <Dimension>
          <ID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</ID>
          <Name>DWDFecha</Name>
          <Annotations>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
              <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;declare @FechaMesAntRent  int, @FechaInicio int, @FechaFin int

select @FechaMesAntRent = feMesAntCierr from dwdfecha where femesanterior = 1 

select @FechaInicio=feMesAntCierr from DWDFecha -- Se obtiene el mes anterior de la fecha de dos años atras --
where  feIdFecha = ( select feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 ) 

select @FechaFin=feIdFecha from DWDFecha where feDiaActual=1 -- Dia Actual --

select 
 feIdFecha
,feFecha
,feDescripcionFecha
,feCalAnio
,feCalMes
,feCalDia
,feTrimNumero
,feTrimMes
,feTrimDia
,feFeriado
,feCierreMes
,feFinMes
,feFinSemana
,EsDiaAnterior
,fecIdAnterior
,EsCierreAño
,feMesAntCierr
,feAnioAntCierr
,feIdFechaAnioAnt
,feIdFechaCierreAnioAnt
,feFechaCierreAnio
,feDiaActual
,feDiaAnterior
,feMesAnterior--
,feAnioAnterior
,feHaceUnAnio
,feFinTrimestreAnt
,feCierreMesAnterior
,feFechaMesAntCierr
,feCierreMesTodosAnios
,feValorCalculoPromedio
,feEsMesActual
,feEsTrimestreActual
,feIdFechaHaceUnMesLab
,feIdFechaHaceUnTrimestreLab
,feIdFechaHaceUnSemestreLab
,feIdFechaHaceUnAnioLab
,feIdFechaHistoricoLab
,feNumDiasMesLab
,feNumDiasTrimLab
,feNumDiasTrimFiscLab
,feNumDiasSemestLab
,feNumDiasAnioLab
,feNumDiasHistLab
,feTrimestresAnteriores
,feCierrFechAnioActFut
,feMesAntAnioAnt
,feCierrMesAnioAtras
,feIdFechaTresMesAtras
,feIdFechaSeisMesAtras
,feIdFechaDoceMesAtras
,FechaMesAntRent=case when feidfecha = @FechaMesAntRent then 1 else 0 end
from DWDFecha
where feidfecha between @FechaInicio and @FechaFin
and feCierreMes=1
order by 1&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
            </Annotation>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>True</Value>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>feIdFecha</AttributeID>
                  <Cardinality>One</Cardinality>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feIdFecha</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feFecha</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feFecha</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feDescripcionFecha</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feDescripcionFecha</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feCalAnio</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feCalAnio</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feCalMes</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feCalMes</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feCalDia</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feCalDia</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feTrimNumero</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feTrimNumero</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feTrimMes</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feTrimMes</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feTrimDia</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feTrimDia</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feFeriado</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feFeriado</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feCierreMes</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feCierreMes</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feFinMes</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feFinMes</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feFinSemana</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feFinSemana</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>EsDiaAnterior</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>EsDiaAnterior</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>fecIdAnterior</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>fecIdAnterior</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>EsCierreAño</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>EsCierreAño</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feMesAntCierr</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feMesAntCierr</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feAnioAntCierr</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feAnioAntCierr</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feIdFechaAnioAnt</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feIdFechaAnioAnt</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feIdFechaCierreAnioAnt</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feIdFechaCierreAnioAnt</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feFechaCierreAnio</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feFechaCierreAnio</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feDiaActual</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feDiaActual</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feDiaAnterior</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feDiaAnterior</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feMesAnterior</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feMesAnterior</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feAnioAnterior</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feAnioAnterior</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feHaceUnAnio</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feHaceUnAnio</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feFinTrimestreAnt</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feFinTrimestreAnt</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feCierreMesAnterior</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feCierreMesAnterior</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feFechaMesAntCierr</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feFechaMesAntCierr</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feCierreMesTodosAnios</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feCierreMesTodosAnios</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feValorCalculoPromedio</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feValorCalculoPromedio</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feEsMesActual</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feEsMesActual</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feEsTrimestreActual</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feEsTrimestreActual</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feIdFechaHaceUnMesLab</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feIdFechaHaceUnMesLab</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feIdFechaHaceUnTrimestreLab</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feIdFechaHaceUnTrimestreLab</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feIdFechaHaceUnSemestreLab</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feIdFechaHaceUnSemestreLab</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feIdFechaHaceUnAnioLab</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feIdFechaHaceUnAnioLab</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feIdFechaHistoricoLab</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feIdFechaHistoricoLab</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feNumDiasMesLab</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feNumDiasMesLab</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feNumDiasTrimLab</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feNumDiasTrimLab</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feNumDiasTrimFiscLab</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feNumDiasTrimFiscLab</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feNumDiasSemestLab</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feNumDiasSemestLab</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feNumDiasAnioLab</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feNumDiasAnioLab</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feNumDiasHistLab</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feNumDiasHistLab</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feTrimestresAnteriores</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feTrimestresAnteriores</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feCierrFechAnioActFut</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feCierrFechAnioActFut</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feMesAntAnioAnt</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feMesAntAnioAnt</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feCierrMesAnioAtras</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feCierrMesAnioAtras</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>Column1</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feCalMesCorto</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>Column1 1</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feCalMesCortoAnio</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feIdFechaTresMesAtras</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feIdFechaTresMesAtras</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feIdFechaSeisMesAtras</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feIdFechaSeisMesAtras</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feIdFechaDoceMesAtras</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feIdFechaDoceMesAtras</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>feCalMesAnteriorRentabilidad</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>feCalMesAnteriorRentabilidad</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>FechaMesAntRent</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>FechaMesAntRent</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>F</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>FeCalMesAbreviado</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>Agregar columna2</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>FeMesAbreviadoAnio</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feIdFecha</ID>
              <Name>feIdFecha</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feIdFecha</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feIdFecha</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="DateTimeGeneral" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feFecha</ID>
              <Name>feFecha</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Date</DataType>
                  <DataSize>-1</DataSize>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feFecha</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feFecha</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <ddl300_300:FormatString>General Date</ddl300_300:FormatString>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feDescripcionFecha</ID>
              <Name>feDescripcionFecha</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feDescripcionFecha</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feDescripcionFecha</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feCalAnio</ID>
              <Name>feCalAnio</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feCalAnio</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feCalAnio</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feCalMes</ID>
              <Name>feCalMes</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feCalMes</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feCalMes</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feCalDia</ID>
              <Name>feCalDia</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feCalDia</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feCalDia</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feTrimNumero</ID>
              <Name>feTrimNumero</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feTrimNumero</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feTrimNumero</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feTrimMes</ID>
              <Name>feTrimMes</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feTrimMes</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feTrimMes</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feTrimDia</ID>
              <Name>feTrimDia</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feTrimDia</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feTrimDia</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Boolean" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feFeriado</ID>
              <Name>feFeriado</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Boolean</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feFeriado</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feFeriado</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <ddl300_300:FormatString>"TRUE";"TRUE";"FALSE"</ddl300_300:FormatString>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Boolean" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feCierreMes</ID>
              <Name>feCierreMes</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Boolean</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feCierreMes</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feCierreMes</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <ddl300_300:FormatString>"TRUE";"TRUE";"FALSE"</ddl300_300:FormatString>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Boolean" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feFinMes</ID>
              <Name>feFinMes</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Boolean</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feFinMes</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feFinMes</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <ddl300_300:FormatString>"TRUE";"TRUE";"FALSE"</ddl300_300:FormatString>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Boolean" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feFinSemana</ID>
              <Name>feFinSemana</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Boolean</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feFinSemana</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feFinSemana</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <ddl300_300:FormatString>"TRUE";"TRUE";"FALSE"</ddl300_300:FormatString>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Boolean" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>EsDiaAnterior</ID>
              <Name>EsDiaAnterior</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Boolean</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>EsDiaAnterior</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>EsDiaAnterior</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <ddl300_300:FormatString>"TRUE";"TRUE";"FALSE"</ddl300_300:FormatString>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>fecIdAnterior</ID>
              <Name>fecIdAnterior</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>fecIdAnterior</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>fecIdAnterior</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Boolean" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>EsCierreAño</ID>
              <Name>EsCierreAño</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Boolean</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>EsCierreAño</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>EsCierreAño</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <ddl300_300:FormatString>"TRUE";"TRUE";"FALSE"</ddl300_300:FormatString>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feMesAntCierr</ID>
              <Name>feMesAntCierr</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feMesAntCierr</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feMesAntCierr</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feAnioAntCierr</ID>
              <Name>feAnioAntCierr</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feAnioAntCierr</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feAnioAntCierr</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feIdFechaAnioAnt</ID>
              <Name>feIdFechaAnioAnt</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feIdFechaAnioAnt</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feIdFechaAnioAnt</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feIdFechaCierreAnioAnt</ID>
              <Name>feIdFechaCierreAnioAnt</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feIdFechaCierreAnioAnt</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feIdFechaCierreAnioAnt</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="DateTimeGeneral" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feFechaCierreAnio</ID>
              <Name>feFechaCierreAnio</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Date</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feFechaCierreAnio</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feFechaCierreAnio</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <ddl300_300:FormatString>General Date</ddl300_300:FormatString>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feDiaActual</ID>
              <Name>feDiaActual</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feDiaActual</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feDiaActual</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feDiaAnterior</ID>
              <Name>feDiaAnterior</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feDiaAnterior</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feDiaAnterior</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feMesAnterior</ID>
              <Name>feMesAnterior</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feMesAnterior</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feMesAnterior</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feAnioAnterior</ID>
              <Name>feAnioAnterior</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feAnioAnterior</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feAnioAnterior</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Boolean" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feHaceUnAnio</ID>
              <Name>feHaceUnAnio</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Boolean</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feHaceUnAnio</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feHaceUnAnio</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <ddl300_300:FormatString>"TRUE";"TRUE";"FALSE"</ddl300_300:FormatString>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feFinTrimestreAnt</ID>
              <Name>feFinTrimestreAnt</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feFinTrimestreAnt</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feFinTrimestreAnt</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feCierreMesAnterior</ID>
              <Name>feCierreMesAnterior</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feCierreMesAnterior</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feCierreMesAnterior</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="DateTimeGeneral" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feFechaMesAntCierr</ID>
              <Name>feFechaMesAntCierr</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Date</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feFechaMesAntCierr</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feFechaMesAntCierr</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <ddl300_300:FormatString>General Date</ddl300_300:FormatString>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Boolean" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feCierreMesTodosAnios</ID>
              <Name>feCierreMesTodosAnios</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Boolean</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feCierreMesTodosAnios</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feCierreMesTodosAnios</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <ddl300_300:FormatString>"TRUE";"TRUE";"FALSE"</ddl300_300:FormatString>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feValorCalculoPromedio</ID>
              <Name>feValorCalculoPromedio</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feValorCalculoPromedio</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feValorCalculoPromedio</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Boolean" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feEsMesActual</ID>
              <Name>feEsMesActual</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Boolean</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feEsMesActual</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feEsMesActual</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <ddl300_300:FormatString>"TRUE";"TRUE";"FALSE"</ddl300_300:FormatString>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Boolean" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feEsTrimestreActual</ID>
              <Name>feEsTrimestreActual</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Boolean</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feEsTrimestreActual</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feEsTrimestreActual</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <ddl300_300:FormatString>"TRUE";"TRUE";"FALSE"</ddl300_300:FormatString>
            </Attribute>
            <Attribute>
              <ID>feIdFechaHaceUnMesLab</ID>
              <Name>feIdFechaHaceUnMesLab</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feIdFechaHaceUnMesLab</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feIdFechaHaceUnMesLab</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>feIdFechaHaceUnTrimestreLab</ID>
              <Name>feIdFechaHaceUnTrimestreLab</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feIdFechaHaceUnTrimestreLab</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feIdFechaHaceUnTrimestreLab</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>feIdFechaHaceUnSemestreLab</ID>
              <Name>feIdFechaHaceUnSemestreLab</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feIdFechaHaceUnSemestreLab</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feIdFechaHaceUnSemestreLab</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>feIdFechaHaceUnAnioLab</ID>
              <Name>feIdFechaHaceUnAnioLab</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feIdFechaHaceUnAnioLab</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feIdFechaHaceUnAnioLab</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>feIdFechaHistoricoLab</ID>
              <Name>feIdFechaHistoricoLab</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feIdFechaHistoricoLab</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feIdFechaHistoricoLab</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>feNumDiasMesLab</ID>
              <Name>feNumDiasMesLab</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feNumDiasMesLab</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feNumDiasMesLab</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>feNumDiasTrimLab</ID>
              <Name>feNumDiasTrimLab</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feNumDiasTrimLab</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feNumDiasTrimLab</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>feNumDiasTrimFiscLab</ID>
              <Name>feNumDiasTrimFiscLab</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feNumDiasTrimFiscLab</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feNumDiasTrimFiscLab</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>feNumDiasSemestLab</ID>
              <Name>feNumDiasSemestLab</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feNumDiasSemestLab</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feNumDiasSemestLab</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>feNumDiasAnioLab</ID>
              <Name>feNumDiasAnioLab</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feNumDiasAnioLab</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feNumDiasAnioLab</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>feNumDiasHistLab</ID>
              <Name>feNumDiasHistLab</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feNumDiasHistLab</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feNumDiasHistLab</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>feTrimestresAnteriores</ID>
              <Name>feTrimestresAnteriores</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feTrimestresAnteriores</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feTrimestresAnteriores</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>feCierrFechAnioActFut</ID>
              <Name>feCierrFechAnioActFut</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feCierrFechAnioActFut</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feCierrFechAnioActFut</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>feMesAntAnioAnt</ID>
              <Name>feMesAntAnioAnt</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feMesAntAnioAnt</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feMesAntAnioAnt</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>feCierrMesAnioAtras</ID>
              <Name>feCierrMesAnioAtras</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feCierrMesAnioAtras</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feCierrMesAnioAtras</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>Column1</ID>
              <Name>feCalMesCorto</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>IF(DWDFecha[feCalMes]=1,"Ene",
IF(DWDFecha[feCalMes]=2,"Feb",
IF(DWDFecha[feCalMes]=3,"Mar",
IF(DWDFecha[feCalMes]=4,"Abr",
IF(DWDFecha[feCalMes]=5,"May",
IF(DWDFecha[feCalMes]=6,"Jun",
IF(DWDFecha[feCalMes]=7,"Jul",
IF(DWDFecha[feCalMes]=8,"Ago",
IF(DWDFecha[feCalMes]=9,"Sep",
IF(DWDFecha[feCalMes]=10,"Oct",
IF(DWDFecha[feCalMes]=11,"Nov","Dic")
))))))))))

</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>IF(DWDFecha[feCalMes]=1,"Ene",
IF(DWDFecha[feCalMes]=2,"Feb",
IF(DWDFecha[feCalMes]=3,"Mar",
IF(DWDFecha[feCalMes]=4,"Abr",
IF(DWDFecha[feCalMes]=5,"May",
IF(DWDFecha[feCalMes]=6,"Jun",
IF(DWDFecha[feCalMes]=7,"Jul",
IF(DWDFecha[feCalMes]=8,"Ago",
IF(DWDFecha[feCalMes]=9,"Sep",
IF(DWDFecha[feCalMes]=10,"Oct",
IF(DWDFecha[feCalMes]=11,"Nov","Dic")
))))))))))

</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>Column1 1</ID>
              <Name>feCalMesCortoAnio</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>DWDFecha[feCalMesCorto] &amp; " " &amp; DWDFecha[feCalAnio]
</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>DWDFecha[feCalMesCorto] &amp; " " &amp; DWDFecha[feCalAnio]
</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>feIdFechaTresMesAtras</ID>
              <Name>feIdFechaTresMesAtras</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feIdFechaTresMesAtras</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feIdFechaTresMesAtras</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>feIdFechaSeisMesAtras</ID>
              <Name>feIdFechaSeisMesAtras</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feIdFechaSeisMesAtras</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feIdFechaSeisMesAtras</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>feIdFechaDoceMesAtras</ID>
              <Name>feIdFechaDoceMesAtras</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>feIdFechaDoceMesAtras</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>feIdFechaDoceMesAtras</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>feCalMesAnteriorRentabilidad</ID>
              <Name>feCalMesAnteriorRentabilidad</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>IF(DWDFecha[feIdFecha]=[ValFechaMesAntRent],1,0)</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>IF(DWDFecha[feIdFecha]=[ValFechaMesAntRent],1,0)</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>FechaMesAntRent</ID>
              <Name>FechaMesAntRent</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    <ColumnID>FechaMesAntRent</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                  <ColumnID>FechaMesAntRent</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>F</ID>
              <Name>FeCalMesAbreviado</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>SWITCH([feCalMes],
1,"ENE",
2,"FEB",
3,"MAR",
4,"ABR",
5,"MAY",
6,"JUN",
7,"JUL",
8,"AGO",
9,"SEP",
10,"OCT",
11,"NOV",
12,"DIC")</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>SWITCH([feCalMes],
1,"ENE",
2,"FEB",
3,"MAR",
4,"ABR",
5,"MAY",
6,"JUN",
7,"JUL",
8,"AGO",
9,"SEP",
10,"OCT",
11,"NOV",
12,"DIC")</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>Agregar columna2</ID>
              <Name>FeMesAbreviadoAnio</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>DWDFecha[feCalMesAbreviado] &amp; "-" &amp; DWDFecha[feCalAnio]</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>DWDFecha[feCalMesAbreviado] &amp; "-" &amp; DWDFecha[feCalAnio]</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
          </Attributes>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
        </Dimension>
        <Dimension>
          <ID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</ID>
          <Name>DWDCanalCliente</Name>
          <Annotations>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>False</Value>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>DataMarketWebBaseUrl</Name>
            </Annotation>
            <Annotation>
              <Name>DataMarketWebQueryUrl</Name>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>caIdCanal</AttributeID>
                  <Cardinality>One</Cardinality>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>caIdCanal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>caCodigoCanal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>caCodigoCanal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>caDescripcionCanal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>caDescripcionCanal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>caCodigoAgrupacionCanal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>caCodigoAgrupacionCanal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>caDescripcionAgrupacionCanal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>caDescripcionAgrupacionCanal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>caOrdenCanal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>caOrdenCanal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>caAgrupacion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>caAgrupacion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>caEstado</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>caEstado</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>caOrdenDescripcionCanal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>caOrdenDescripcionCanal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>caCodDescripcionAgrupacionCanal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>caCodDescripcionAgrupacionCanal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalCanalConsolidado</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalCanalConsolidado</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>caIdCanal</ID>
              <Name>caIdCanal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                    <ColumnID>caIdCanal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                  <ColumnID>caIdCanal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>caCodigoCanal</ID>
              <Name>caCodigoCanal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                    <ColumnID>caCodigoCanal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                  <ColumnID>caCodigoCanal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>caDescripcionCanal</ID>
              <Name>caDescripcionCanal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                    <ColumnID>caDescripcionCanal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                  <ColumnID>caDescripcionCanal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>caCodigoAgrupacionCanal</ID>
              <Name>caCodigoAgrupacionCanal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                    <ColumnID>caCodigoAgrupacionCanal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                  <ColumnID>caCodigoAgrupacionCanal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>caDescripcionAgrupacionCanal</ID>
              <Name>caDescripcionAgrupacionCanal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                    <ColumnID>caDescripcionAgrupacionCanal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                  <ColumnID>caDescripcionAgrupacionCanal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>caOrdenCanal</ID>
              <Name>caOrdenCanal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                    <ColumnID>caOrdenCanal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                  <ColumnID>caOrdenCanal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>caAgrupacion</ID>
              <Name>caAgrupacion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                    <ColumnID>caAgrupacion</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                  <ColumnID>caAgrupacion</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Boolean" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>caEstado</ID>
              <Name>caEstado</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Boolean</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                    <ColumnID>caEstado</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                  <ColumnID>caEstado</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <ddl300_300:FormatString>"TRUE";"TRUE";"FALSE"</ddl300_300:FormatString>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>caOrdenDescripcionCanal</ID>
              <Name>caOrdenDescripcionCanal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                    <ColumnID>caOrdenDescripcionCanal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                  <ColumnID>caOrdenDescripcionCanal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>caCodDescripcionAgrupacionCanal</ID>
              <Name>caCodDescripcionAgrupacionCanal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                    <ColumnID>caCodDescripcionAgrupacionCanal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                  <ColumnID>caCodDescripcionAgrupacionCanal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccCalCanalConsolidado</ID>
              <Name>ccCalCanalConsolidado</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>IF(DWDCanalCliente[caEstado]=TRUE() &amp;&amp; DWDCanalCliente[caCodigoCanal]&lt;&gt;"-1" &amp;&amp; DWDCanalCliente[caCodigoCanal]&lt;&gt;"CEX", left(DWDCanalCliente[caAgrupacion],5) &amp;" "&amp;DWDCanalCliente[caDescripcionAgrupacionCanal]   , BLANK() )</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>IF(DWDCanalCliente[caEstado]=TRUE() &amp;&amp; DWDCanalCliente[caCodigoCanal]&lt;&gt;"-1" &amp;&amp; DWDCanalCliente[caCodigoCanal]&lt;&gt;"CEX", left(DWDCanalCliente[caAgrupacion],5) &amp;" "&amp;DWDCanalCliente[caDescripcionAgrupacionCanal]   , BLANK() )</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
          </Attributes>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
        </Dimension>
        <Dimension>
          <ID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</ID>
          <Name>DWDAgenciaOperacionCliente</Name>
          <Annotations>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
              <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;Set nocount ON

select
a.agIdAgencia
,a.agCodigoAgencia
,a.agNombreAgencia
,a.agDireccionAgencia
,a.agTelefonoAgencia
,a.agResponsableNombre
,a.agFechaApertura
,a.agFechaClausura
,a.agNumeroColaboradores
,a.agMontoInvertido
,a.agCodigoZona
,a.agNombreZona
--,a.agCodigoSubregion
--,a.agNombreSubregion
,a.agCodigoRegion
,a.agNombreRegion
,a.agCodigoCantonCompleto
,a.agNombreCanton
,a.agCodigoProvincia
,a.agNombreProvincia
,a.agCodigoRegionDescn
,a.agNombreRegionDescn
,a.agOrdenRegionAsesor
,a.agEstado
,a.agCodigoJefeAgencia
,agNombreJefeAgencia= b.asNombreAsesor
,'RED' agCodigoAgrupacionCanal
,agCodigoRegional=b.asCodigoRegion
,agCodigoSubregion=b.asCodigoSubregion
from DWDAgenciaOperacion a
left outer join DWDAsesorOperacion b on a.agCodigoJefeAgencia = b.asCodigoAsesor
--where agEstado = 'R'&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
            </Annotation>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>True</Value>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>agIdAgencia</AttributeID>
                  <Cardinality>One</Cardinality>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agIdAgencia</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agCodigoAgencia</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agCodigoAgencia</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agNombreAgencia</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agNombreAgencia</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agDireccionAgencia</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agDireccionAgencia</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agTelefonoAgencia</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agTelefonoAgencia</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agResponsableNombre</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agResponsableNombre</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agFechaApertura</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agFechaApertura</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agFechaClausura</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agFechaClausura</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agNumeroColaboradores</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agNumeroColaboradores</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agMontoInvertido</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agMontoInvertido</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agCodigoZona</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agCodigoZona</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agNombreZona</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agNombreZona</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agCodigoSubregion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agCodigoSubregion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agCodigoRegion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agCodigoRegion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agNombreRegion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agNombreRegion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agCodigoCantonCompleto</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agCodigoCantonCompleto</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agNombreCanton</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agNombreCanton</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agCodigoProvincia</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agCodigoProvincia</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agNombreProvincia</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agNombreProvincia</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agCodigoRegionDescn</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agCodigoRegionDescn</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agNombreRegionDescn</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agNombreRegionDescn</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agOrdenRegionAsesor</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agOrdenRegionAsesor</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agEstado</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agEstado</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agCodigoJefeAgencia</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agCodigoJefeAgencia</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agNombreJefeAgencia</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agNombreJefeAgencia</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agCodigoAgrupacionCanal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agCodigoAgrupacionCanal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>agCodigoRegional</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>agCodigoRegional</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>agIdAgencia</ID>
              <Name>agIdAgencia</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agIdAgencia</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agIdAgencia</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>agCodigoAgencia</ID>
              <Name>agCodigoAgencia</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agCodigoAgencia</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agCodigoAgencia</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>agNombreAgencia</ID>
              <Name>agNombreAgencia</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agNombreAgencia</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agNombreAgencia</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>agDireccionAgencia</ID>
              <Name>agDireccionAgencia</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agDireccionAgencia</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agDireccionAgencia</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>agTelefonoAgencia</ID>
              <Name>agTelefonoAgencia</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agTelefonoAgencia</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agTelefonoAgencia</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>agResponsableNombre</ID>
              <Name>agResponsableNombre</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agResponsableNombre</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agResponsableNombre</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="DateTimeGeneral" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>agFechaApertura</ID>
              <Name>agFechaApertura</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Date</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agFechaApertura</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agFechaApertura</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <ddl300_300:FormatString>General Date</ddl300_300:FormatString>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="DateTimeGeneral" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>agFechaClausura</ID>
              <Name>agFechaClausura</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Date</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agFechaClausura</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agFechaClausura</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <ddl300_300:FormatString>General Date</ddl300_300:FormatString>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>agNumeroColaboradores</ID>
              <Name>agNumeroColaboradores</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agNumeroColaboradores</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agNumeroColaboradores</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>agMontoInvertido</ID>
              <Name>agMontoInvertido</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agMontoInvertido</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agMontoInvertido</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>agCodigoZona</ID>
              <Name>agCodigoZona</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agCodigoZona</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agCodigoZona</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>agNombreZona</ID>
              <Name>agNombreZona</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agNombreZona</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agNombreZona</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>agCodigoSubregion</ID>
              <Name>agCodigoSubregion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agCodigoSubregion</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agCodigoSubregion</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>agCodigoRegion</ID>
              <Name>agCodigoRegion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agCodigoRegion</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agCodigoRegion</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>agNombreRegion</ID>
              <Name>agNombreRegion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agNombreRegion</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agNombreRegion</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>agCodigoCantonCompleto</ID>
              <Name>agCodigoCantonCompleto</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agCodigoCantonCompleto</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agCodigoCantonCompleto</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>agNombreCanton</ID>
              <Name>agNombreCanton</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agNombreCanton</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agNombreCanton</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>agCodigoProvincia</ID>
              <Name>agCodigoProvincia</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agCodigoProvincia</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agCodigoProvincia</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>agNombreProvincia</ID>
              <Name>agNombreProvincia</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agNombreProvincia</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agNombreProvincia</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>agCodigoRegionDescn</ID>
              <Name>agCodigoRegionDescn</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agCodigoRegionDescn</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agCodigoRegionDescn</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>agNombreRegionDescn</ID>
              <Name>agNombreRegionDescn</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agNombreRegionDescn</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agNombreRegionDescn</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>agOrdenRegionAsesor</ID>
              <Name>agOrdenRegionAsesor</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agOrdenRegionAsesor</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agOrdenRegionAsesor</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>agEstado</ID>
              <Name>agEstado</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agEstado</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agEstado</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>agCodigoJefeAgencia</ID>
              <Name>agCodigoJefeAgencia</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agCodigoJefeAgencia</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agCodigoJefeAgencia</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>agNombreJefeAgencia</ID>
              <Name>agNombreJefeAgencia</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agNombreJefeAgencia</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agNombreJefeAgencia</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>agCodigoAgrupacionCanal</ID>
              <Name>agCodigoAgrupacionCanal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agCodigoAgrupacionCanal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agCodigoAgrupacionCanal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>agCodigoRegional</ID>
              <Name>agCodigoRegional</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    <ColumnID>agCodigoRegional</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                  <ColumnID>agCodigoRegional</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
          </Attributes>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
        </Dimension>
        <Dimension>
          <ID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</ID>
          <Name>DWDAsesorOperacionCliente</Name>
          <Annotations>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
              <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;Set nocount ON

select 
a.asIdAsesor
,a.asCodigoAsesor
,a.asNombreAsesor
,a.asUsuario
,asCodigoAgrupacionCanal=c.caCodigoAgrupacionCanal
,a.asNombreCanal
,a.asAsesorPrincipal
,a.asCodigoAgencia
,a.asNombreAgencia
,a.asEstado
,a.asOrdenAsesor
,asCodigoRegion=b.agCodigoRegion
,asNombreRegion=b.agNombreRegion
,asCodigoZona=b.agCodigoZona
,asNombreZona=b.agNombreZona
,asCodigoRegional=a.asCodigoRegion
,asNombreRegional=a.asNombreRegion
,a.asCodigoSubregion
,a.asNombreSubregion
from DWDAsesorOperacion a
left join DWDAgenciaOperacion b on a.asCodigoAgencia = b.agCodigoAgencia
inner join DWDCanal c on a.asCodigoCanal = c.caCodigoCanal 

/*Set nocount ON

select 
a.asIdAsesor
,a.asCodigoAsesor
,a.asNombreAsesor
,a.asUsuario
--,a.asCodigoCanal
,c.caCodigoAgrupacionCanal
,a.asNombreCanal
,a.asAsesorPrincipal
,a.asCodigoAgencia
,a.asNombreAgencia
,a.asEstado
,a.asOrdenAsesor
,b.agCodigoRegion
,b.agNombreRegion
,b.agCodigoZona
,b.agNombreZona
,a.asCodigoRegion
,a.asNombreRegion
from DWDAsesorOperacion a
left join DWDAgenciaOperacion b on a.asCodigoAgencia = b.agCodigoAgencia
inner join DWDCanal c on a.asCodigoCanal = c.caCodigoCanal 
--where a.asEstado=1 
--and c.caCodigoAgrupacionCanal in ('COR','ESP','TES')*/&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
            </Annotation>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>True</Value>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>asIdAsesor</AttributeID>
                  <Cardinality>One</Cardinality>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>asIdAsesor</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>asCodigoAsesor</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>asCodigoAsesor</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>asNombreAsesor</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>asNombreAsesor</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>asUsuario</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>asUsuario</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>asNombreCanal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>asNombreCanal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>asAsesorPrincipal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>asAsesorPrincipal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>asCodigoAgencia</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>asCodigoAgencia</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>asNombreAgencia</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>asNombreAgencia</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>asEstado</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>asEstado</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>asOrdenAsesor</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>asOrdenAsesor</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>Calculated Column 1</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>asCodigoCompuesto</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>asCodigoRegion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>asCodigoRegion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>asNombreRegion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>asNombreRegion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>asCodigoAgrupacionCanal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>asCodigoAgrupacionCanal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>asCodigoZona</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>asCodigoZona</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>asNombreZona</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>asNombreZona</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>asCodigoRegional</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>asCodigoRegional</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>asNombreRegional</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>asNombreRegional</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>asCodigoSubRegion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>asCodigoSubregion 1</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>asNombreSubRegion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>asNombreSubregion 1</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>asIdAsesor</ID>
              <Name>asIdAsesor</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                    <ColumnID>asIdAsesor</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                  <ColumnID>asIdAsesor</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>asCodigoAsesor</ID>
              <Name>asCodigoAsesor</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                    <ColumnID>asCodigoAsesor</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                  <ColumnID>asCodigoAsesor</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>asNombreAsesor</ID>
              <Name>asNombreAsesor</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                    <ColumnID>asNombreAsesor</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                  <ColumnID>asNombreAsesor</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>asUsuario</ID>
              <Name>asUsuario</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                    <ColumnID>asUsuario</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                  <ColumnID>asUsuario</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>asNombreCanal</ID>
              <Name>asNombreCanal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                    <ColumnID>asNombreCanal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                  <ColumnID>asNombreCanal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Boolean" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>asAsesorPrincipal</ID>
              <Name>asAsesorPrincipal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Boolean</DataType>
                  <DataSize>-1</DataSize>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                    <ColumnID>asAsesorPrincipal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                  <ColumnID>asAsesorPrincipal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <ddl300_300:FormatString>"TRUE";"TRUE";"FALSE"</ddl300_300:FormatString>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>asCodigoAgencia</ID>
              <Name>asCodigoAgencia</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                    <ColumnID>asCodigoAgencia</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                  <ColumnID>asCodigoAgencia</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>asNombreAgencia</ID>
              <Name>asNombreAgencia</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                    <ColumnID>asNombreAgencia</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                  <ColumnID>asNombreAgencia</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Boolean" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>asEstado</ID>
              <Name>asEstado</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Boolean</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                    <ColumnID>asEstado</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                  <ColumnID>asEstado</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <ddl300_300:FormatString>"TRUE";"TRUE";"FALSE"</ddl300_300:FormatString>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>asOrdenAsesor</ID>
              <Name>asOrdenAsesor</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                    <ColumnID>asOrdenAsesor</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                  <ColumnID>asOrdenAsesor</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>Calculated Column 1</ID>
              <Name>asCodigoCompuesto</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>DWDAsesorOperacionCliente[asCodigoAsesor] &amp; "-" &amp; DWDAsesorOperacionCliente[asNombreAsesor]</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>DWDAsesorOperacionCliente[asCodigoAsesor] &amp; "-" &amp; DWDAsesorOperacionCliente[asNombreAsesor]</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>asCodigoRegion</ID>
              <Name>asCodigoRegion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                    <ColumnID>asCodigoRegion</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                  <ColumnID>asCodigoRegion</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>asNombreRegion</ID>
              <Name>asNombreRegion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                    <ColumnID>asNombreRegion</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                  <ColumnID>asNombreRegion</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>asCodigoAgrupacionCanal</ID>
              <Name>asCodigoAgrupacionCanal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                    <ColumnID>asCodigoAgrupacionCanal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                  <ColumnID>asCodigoAgrupacionCanal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>asCodigoZona</ID>
              <Name>asCodigoZona</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                    <ColumnID>asCodigoZona</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                  <ColumnID>asCodigoZona</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>asNombreZona</ID>
              <Name>asNombreZona</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                    <ColumnID>asNombreZona</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                  <ColumnID>asNombreZona</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>asCodigoRegional</ID>
              <Name>asCodigoRegional</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                    <ColumnID>asCodigoRegional</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                  <ColumnID>asCodigoRegional</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>asNombreRegional</ID>
              <Name>asNombreRegional</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                    <ColumnID>asNombreRegional</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                  <ColumnID>asNombreRegional</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>asCodigoSubRegion</ID>
              <Name>asCodigoSubregion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                    <ColumnID>asCodigoSubRegion</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                  <ColumnID>asCodigoSubRegion</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>asNombreSubRegion</ID>
              <Name>asNombreSubregion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                    <ColumnID>asNombreSubRegion</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                  <ColumnID>asNombreSubRegion</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
          </Attributes>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
        </Dimension>
        <Dimension>
          <ID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</ID>
          <Name>DWDCliente</Name>
          <Annotations>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
              <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;select
clIdCliente
,clCodigoCliente
,clNombreCompleto
,clIdCanal
,clIdAsesorPrincipal
,clIdAgencia
,clVinculacionValor
,clCodigoGrupo
,clGrupo
,clEstado
,clIdBanca
,clIdSegmentacionCliente
,concat(year(getdate())-left(clFechaIngreso,4),' año(s) ') clCalClienteDesde
,clFechaFin
,clSegmentacionTipoCliente
,clFechaIngreso
from DWDCliente&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
            </Annotation>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>True</Value>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>clIdCliente</AttributeID>
                  <Cardinality>One</Cardinality>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clIdCliente</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>clCodigoCliente</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clCodigoCliente</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>clNombreCompleto</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clNombreCompleto</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>clIdCanal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clIdCanal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>clIdAsesorPrincipal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clIdAsesorPrincipal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>clIdAgencia</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clIdAgencia</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>clVinculacionValor</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clVinculacionValor</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>clCodigoGrupo</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clCodigoGrupo</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>clGrupo</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clGrupo</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>clEstado</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clEstado</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>clFechaFin</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clFechaFin</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>clIdBanca</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clIdBanca</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>clIdSegmentacionCliente</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clIdSegmentacionCliente</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>clCalClienteDesde</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clCalClienteDesde</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>CanalCliente</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clCalAgrupacionCanal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>Calculated Column 1</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clCalNombreAgencia</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>Calculated Column 1 1</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clCalNombreRegion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>Calculated Column 1 2</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clCalNombreZona</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>Calculated Column 1 3</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clCalNombreAsesor</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>clSegmentacionTipoCliente</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clSegmentacionTipoCliente</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ClCodigoCliente1</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clCodigoCliente1 1</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>Calculated Column 1 4</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clCodigoCompuesto</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>Calculated Column 1 5</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clCodigoAsesor</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>clCodigoAgrupacionCanal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clCodigoAgrupacionCanal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>clCodigoAgencia</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clCodigoAgencia</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>clCodigoZona</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clCodigoZona</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>clCodigoRegion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clCodigoRegion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>clCodigoRegion 1</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clCodigoRegional</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>clCodigoSubregion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clCodigoSubregion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>clFechaIngreso</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clFechaIngreso</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>clIdCliente</ID>
              <Name>clIdCliente</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                    <ColumnID>clIdCliente</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                  <ColumnID>clIdCliente</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>clCodigoCliente</ID>
              <Name>clCodigoCliente</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                    <ColumnID>clCodigoCliente</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                  <ColumnID>clCodigoCliente</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>clNombreCompleto</ID>
              <Name>clNombreCompleto</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                    <ColumnID>clNombreCompleto</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                  <ColumnID>clNombreCompleto</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>clIdCanal</ID>
              <Name>clIdCanal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                    <ColumnID>clIdCanal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                  <ColumnID>clIdCanal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>clIdAsesorPrincipal</ID>
              <Name>clIdAsesorPrincipal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                    <ColumnID>clIdAsesorPrincipal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                  <ColumnID>clIdAsesorPrincipal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>clIdAgencia</ID>
              <Name>clIdAgencia</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                    <ColumnID>clIdAgencia</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                  <ColumnID>clIdAgencia</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>clVinculacionValor</ID>
              <Name>clVinculacionValor</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                    <ColumnID>clVinculacionValor</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                  <ColumnID>clVinculacionValor</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>clCodigoGrupo</ID>
              <Name>clCodigoGrupo</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                    <ColumnID>clCodigoGrupo</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                  <ColumnID>clCodigoGrupo</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>clGrupo</ID>
              <Name>clGrupo</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                    <ColumnID>clGrupo</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                  <ColumnID>clGrupo</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>clEstado</ID>
              <Name>clEstado</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                    <ColumnID>clEstado</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                  <ColumnID>clEstado</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>clFechaFin</ID>
              <Name>clFechaFin</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Date</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                    <ColumnID>clFechaFin</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                  <ColumnID>clFechaFin</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>clIdBanca</ID>
              <Name>clIdBanca</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                    <ColumnID>clIdBanca</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                  <ColumnID>clIdBanca</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>clIdSegmentacionCliente</ID>
              <Name>clIdSegmentacionCliente</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                    <ColumnID>clIdSegmentacionCliente</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                  <ColumnID>clIdSegmentacionCliente</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>clCalClienteDesde</ID>
              <Name>clCalClienteDesde</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                    <ColumnID>clCalClienteDesde</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                  <ColumnID>clCalClienteDesde</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>CanalCliente</ID>
              <Name>clCalAgrupacionCanal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>RELATED(DWDCanalCliente[caDescripcionAgrupacionCanal])</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>RELATED(DWDCanalCliente[caDescripcionAgrupacionCanal])</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>Calculated Column 1</ID>
              <Name>clCalNombreAgencia</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreAgencia])</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreAgencia])</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>Calculated Column 1 1</ID>
              <Name>clCalNombreRegion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreRegion])</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreRegion])</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>Calculated Column 1 2</ID>
              <Name>clCalNombreZona</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreZona])</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreZona])</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>Calculated Column 1 3</ID>
              <Name>clCalNombreAsesor</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>RELATED(DWDAsesorOperacionCliente[asNombreAsesor])</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>RELATED(DWDAsesorOperacionCliente[asNombreAsesor])</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>clSegmentacionTipoCliente</ID>
              <Name>clSegmentacionTipoCliente</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                    <ColumnID>clSegmentacionTipoCliente</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                  <ColumnID>clSegmentacionTipoCliente</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ClCodigoCliente1</ID>
              <Name>clCodigoCliente1</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>DWDCliente[clCodigoCliente]</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>DWDCliente[clCodigoCliente]</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>Calculated Column 1 4</ID>
              <Name>clCodigoCompuesto</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>DWDCliente[clCodigoCliente] &amp; "-" &amp; DWDCliente[clNombreCompleto]</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>DWDCliente[clCodigoCliente] &amp; "-" &amp; DWDCliente[clNombreCompleto]</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>Calculated Column 1 5</ID>
              <Name>clCodigoAsesor</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>RELATED('DWDAsesorOperacionCliente'[asCodigoAsesor])</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>RELATED('DWDAsesorOperacionCliente'[asCodigoAsesor])</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>clCodigoAgrupacionCanal</ID>
              <Name>clCodigoAgrupacionCanal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>RELATED(DWDCanalCliente[caCodigoAgrupacionCanal])</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>RELATED(DWDCanalCliente[caCodigoAgrupacionCanal])</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>clCodigoAgencia</ID>
              <Name>clCodigoAgencia</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoAgencia])</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoAgencia])</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>clCodigoZona</ID>
              <Name>clCodigoZona</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoZona])</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoZona])</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>clCodigoRegion</ID>
              <Name>clCodigoRegion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoRegion])</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoRegion])</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>clCodigoRegion 1</ID>
              <Name>clCodigoRegional</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>RELATED(DWDAsesorOperacionCliente[asCodigoRegional])</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>RELATED(DWDAsesorOperacionCliente[asCodigoRegional])</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>clCodigoSubregion</ID>
              <Name>clCodigoSubregion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>RELATED(DWDAsesorOperacionCliente[asCodigoSubregion])</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>RELATED(DWDAsesorOperacionCliente[asCodigoSubregion])</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>clFechaIngreso</ID>
              <Name>clFechaIngreso</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                    <ColumnID>clFechaIngreso</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                  <ColumnID>clFechaIngreso</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
          </Attributes>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
          <ddl300_300:Relationships>
            <ddl300_300:Relationship>
              <ID>1df0b318-cd0b-42dc-8632-fe0e895dd652</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>clIdCanal</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>caIdCanal</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>101f6faa-d6b5-4794-bc99-7f2128495c8d</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>clIdAgencia</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>agIdAgencia</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>bf3db671-982b-4f8b-aa28-4b4970c164f9</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>clIdAsesorPrincipal</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>asIdAsesor</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>1f2909a1-2e55-4995-baeb-256f7e9d6935</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>clIdSegmentacionCliente</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>scIdSegmentacionCliente</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>c70196b5-f7ef-4e1f-91fe-15172d035d8a</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>clIdBanca</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>baIdBanca</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>7c08be2b-53c5-4ed1-b190-971d2fd8a2b6</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>clCodigoGrupo</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>grCodigoGrupo</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
          </ddl300_300:Relationships>
        </Dimension>
        <Dimension>
          <ID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</ID>
          <Name>DWHPasivoOperacion</Name>
          <Annotations>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
              <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=2

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha=19000101 --between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones


/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) +  (12*cta.ccCostoOperativo) ) 
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
            </Annotation>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>True</Value>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>poIdFecha</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>poIdFecha</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>poIdCliente</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>poIdCliente</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>poIdCuentaContable</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>poIdCuentaContable</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>poSaldoOperacionUSD</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>poSaldoOperacionUSD</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>poSaldoAcumuladoAnual</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>poSaldoAcumuladoAnual</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>poSaldoPromedioAnual</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>poSaldoPromedioAnual</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>poValorActPondRiesgoPromAnual</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>poValorActPondRiesgoPromAnual</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>poValorComision</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>poValorComision</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>poValorIngresoServicio</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>poValorIngresoServicio</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>poNumeroTransaccionesAnual</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>poNumeroTransaccionesAnual</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>poValorCostoOperativo</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>poValorCostoOperativo</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>poValorOperacionFinanciera</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>poValorOperacionFinanciera</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>poValorInteresRealAnual</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>poValorInteresRealAnual</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>poValorInteresTasaPool</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>poValorInteresTasaPool</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>poValorMargenFinanciero</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>poValorMargenFinanciero</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>poValorMargenBancarioBasico</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>poValorMargenBancarioBasico</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>poValorMargenOrdinario</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>poValorMargenOrdinario</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>poValorMargenExplotacion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>poValorMargenExplotacion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>poValorUtilidadOperativa</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>poValorUtilidadOperativa</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>poSaldoAcumuladoMensualFiscal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>poSaldoAcumuladoMensualFiscal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>poCuentaAperturada</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>poCuentaAperturada</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>poIdFecha</ID>
              <Name>poIdFecha</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                    <ColumnID>poIdFecha</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                  <ColumnID>poIdFecha</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>poIdCliente</ID>
              <Name>poIdCliente</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                    <ColumnID>poIdCliente</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                  <ColumnID>poIdCliente</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>poIdCuentaContable</ID>
              <Name>poIdCuentaContable</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                    <ColumnID>poIdCuentaContable</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                  <ColumnID>poIdCuentaContable</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>poSaldoOperacionUSD</ID>
              <Name>poSaldoOperacionUSD</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                    <ColumnID>poSaldoOperacionUSD</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                  <ColumnID>poSaldoOperacionUSD</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>poSaldoAcumuladoAnual</ID>
              <Name>poSaldoAcumuladoAnual</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                    <ColumnID>poSaldoAcumuladoAnual</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                  <ColumnID>poSaldoAcumuladoAnual</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>poSaldoPromedioAnual</ID>
              <Name>poSaldoPromedioAnual</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                    <ColumnID>poSaldoPromedioAnual</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                  <ColumnID>poSaldoPromedioAnual</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>poValorActPondRiesgoPromAnual</ID>
              <Name>poValorActPondRiesgoPromAnual</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                    <ColumnID>poValorActPondRiesgoPromAnual</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                  <ColumnID>poValorActPondRiesgoPromAnual</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>poValorComision</ID>
              <Name>poValorComision</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                    <ColumnID>poValorComision</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                  <ColumnID>poValorComision</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>poValorIngresoServicio</ID>
              <Name>poValorIngresoServicio</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                    <ColumnID>poValorIngresoServicio</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                  <ColumnID>poValorIngresoServicio</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>poNumeroTransaccionesAnual</ID>
              <Name>poNumeroTransaccionesAnual</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                    <ColumnID>poNumeroTransaccionesAnual</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                  <ColumnID>poNumeroTransaccionesAnual</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>poValorCostoOperativo</ID>
              <Name>poValorCostoOperativo</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                    <ColumnID>poValorCostoOperativo</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                  <ColumnID>poValorCostoOperativo</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>poValorOperacionFinanciera</ID>
              <Name>poValorOperacionFinanciera</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                    <ColumnID>poValorOperacionFinanciera</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                  <ColumnID>poValorOperacionFinanciera</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>poValorInteresRealAnual</ID>
              <Name>poValorInteresRealAnual</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                    <ColumnID>poValorInteresRealAnual</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                  <ColumnID>poValorInteresRealAnual</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>poValorInteresTasaPool</ID>
              <Name>poValorInteresTasaPool</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                    <ColumnID>poValorInteresTasaPool</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                  <ColumnID>poValorInteresTasaPool</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>poValorMargenFinanciero</ID>
              <Name>poValorMargenFinanciero</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                    <ColumnID>poValorMargenFinanciero</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                  <ColumnID>poValorMargenFinanciero</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>poValorMargenBancarioBasico</ID>
              <Name>poValorMargenBancarioBasico</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                    <ColumnID>poValorMargenBancarioBasico</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                  <ColumnID>poValorMargenBancarioBasico</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>poValorMargenOrdinario</ID>
              <Name>poValorMargenOrdinario</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                    <ColumnID>poValorMargenOrdinario</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                  <ColumnID>poValorMargenOrdinario</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>poValorMargenExplotacion</ID>
              <Name>poValorMargenExplotacion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                    <ColumnID>poValorMargenExplotacion</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                  <ColumnID>poValorMargenExplotacion</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>poValorUtilidadOperativa</ID>
              <Name>poValorUtilidadOperativa</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                    <ColumnID>poValorUtilidadOperativa</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                  <ColumnID>poValorUtilidadOperativa</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <ID>poSaldoAcumuladoMensualFiscal</ID>
              <Name>poSaldoAcumuladoMensualFiscal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                    <ColumnID>poSaldoAcumuladoMensualFiscal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                  <ColumnID>poSaldoAcumuladoMensualFiscal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <ID>poCuentaAperturada</ID>
              <Name>poCuentaAperturada</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                    <ColumnID>poCuentaAperturada</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                  <ColumnID>poCuentaAperturada</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
          </Attributes>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
          <ddl300_300:Relationships>
            <ddl300_300:Relationship>
              <ID>93439458-7936-442d-a92f-c5741d518c39</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>poIdFecha</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>feIdFecha</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>2d9daa2d-0280-427e-89bc-0bcd4781eca8</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>poIdCliente</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>clIdCliente</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>ffb0c8a6-40bb-447b-a8b0-5f77a0448931</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>poIdCuentaContable</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>ccIdCuentaContable</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
          </ddl300_300:Relationships>
        </Dimension>
        <Dimension>
          <ID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</ID>
          <Name>DWHTarjetaCreditoOperacion</Name>
          <Annotations>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
              <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=1

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
            </Annotation>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>True</Value>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>tcoIdFecha</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoIdFecha</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoIdCuentaContable</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoIdCuentaContable</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoIdProducto</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoIdProducto</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoIdCliente</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoIdCliente</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoNumeroOperacion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoNumeroOperacion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoSaldo</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoSaldo</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoSaldoAcumuladoAnual</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoSaldoAcumuladoAnual</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoSaldoPromedioAnual</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoSaldoPromedioAnual</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoValorActPondRiesgoPromAnual</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoValorActPondRiesgoPromAnual</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoValorComision</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoValorComision</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoValorIngresoServicio</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoValorIngresoServicio</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoValorOperacionFinanciera</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoValorOperacionFinanciera</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoValorInteresRealAnual</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoValorInteresRealAnual</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoValorInteresTasaPool</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoValorInteresTasaPool</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoValorMargenFinanciero</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoValorMargenFinanciero</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoValorMargenBancarioBasico</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoValorMargenBancarioBasico</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoValorMargenOrdinario</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoValorMargenOrdinario</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoValorMargenExplotacion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoValorMargenExplotacion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoValorUtilidadOperativa</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoValorUtilidadOperativa</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoValorCostoOperativo</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoValorCostoOperativo</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoValorPerdidaEsperada</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoValorPerdidaEsperada</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoNumeroTransaccionesAnual</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoNumeroTransaccionesAnual</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoTasaEfectiva</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoTasaEfectiva</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoIdCalificacionOperacionCliente</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoIdCalificacionOperacionCliente</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoIdTarjeta</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoIdTarjeta</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoValorPorcentajePerdidaEsperada</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoValorPorcentajePerdidaEsperada</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>tcoSaldoAcumuladoMensualFiscal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>tcoSaldoAcumuladoMensualFiscal</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>tcoIdFecha</ID>
              <Name>tcoIdFecha</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoIdFecha</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoIdFecha</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>tcoIdCuentaContable</ID>
              <Name>tcoIdCuentaContable</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoIdCuentaContable</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoIdCuentaContable</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>tcoIdProducto</ID>
              <Name>tcoIdProducto</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoIdProducto</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoIdProducto</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>tcoIdCliente</ID>
              <Name>tcoIdCliente</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoIdCliente</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoIdCliente</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>tcoNumeroOperacion</ID>
              <Name>tcoNumeroOperacion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoNumeroOperacion</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoNumeroOperacion</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>tcoSaldo</ID>
              <Name>tcoSaldo</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoSaldo</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoSaldo</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>tcoSaldoAcumuladoAnual</ID>
              <Name>tcoSaldoAcumuladoAnual</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoSaldoAcumuladoAnual</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoSaldoAcumuladoAnual</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>tcoSaldoPromedioAnual</ID>
              <Name>tcoSaldoPromedioAnual</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoSaldoPromedioAnual</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoSaldoPromedioAnual</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>tcoValorActPondRiesgoPromAnual</ID>
              <Name>tcoValorActPondRiesgoPromAnual</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoValorActPondRiesgoPromAnual</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoValorActPondRiesgoPromAnual</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>tcoValorComision</ID>
              <Name>tcoValorComision</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoValorComision</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoValorComision</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>tcoValorIngresoServicio</ID>
              <Name>tcoValorIngresoServicio</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoValorIngresoServicio</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoValorIngresoServicio</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>tcoValorOperacionFinanciera</ID>
              <Name>tcoValorOperacionFinanciera</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoValorOperacionFinanciera</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoValorOperacionFinanciera</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>tcoValorInteresRealAnual</ID>
              <Name>tcoValorInteresRealAnual</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoValorInteresRealAnual</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoValorInteresRealAnual</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>tcoValorInteresTasaPool</ID>
              <Name>tcoValorInteresTasaPool</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoValorInteresTasaPool</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoValorInteresTasaPool</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>tcoValorMargenFinanciero</ID>
              <Name>tcoValorMargenFinanciero</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoValorMargenFinanciero</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoValorMargenFinanciero</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>tcoValorMargenBancarioBasico</ID>
              <Name>tcoValorMargenBancarioBasico</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoValorMargenBancarioBasico</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoValorMargenBancarioBasico</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>tcoValorMargenOrdinario</ID>
              <Name>tcoValorMargenOrdinario</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoValorMargenOrdinario</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoValorMargenOrdinario</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>tcoValorMargenExplotacion</ID>
              <Name>tcoValorMargenExplotacion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoValorMargenExplotacion</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoValorMargenExplotacion</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>tcoValorUtilidadOperativa</ID>
              <Name>tcoValorUtilidadOperativa</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoValorUtilidadOperativa</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoValorUtilidadOperativa</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>tcoValorCostoOperativo</ID>
              <Name>tcoValorCostoOperativo</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoValorCostoOperativo</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoValorCostoOperativo</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>tcoValorPerdidaEsperada</ID>
              <Name>tcoValorPerdidaEsperada</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoValorPerdidaEsperada</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoValorPerdidaEsperada</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>tcoNumeroTransaccionesAnual</ID>
              <Name>tcoNumeroTransaccionesAnual</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoNumeroTransaccionesAnual</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoNumeroTransaccionesAnual</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <ID>tcoTasaEfectiva</ID>
              <Name>tcoTasaEfectiva</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoTasaEfectiva</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoTasaEfectiva</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>tcoIdCalificacionOperacionCliente</ID>
              <Name>tcoIdCalificacionOperacionCliente</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoIdCalificacionOperacionCliente</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoIdCalificacionOperacionCliente</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <ID>tcoIdTarjeta</ID>
              <Name>tcoIdTarjeta</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoIdTarjeta</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoIdTarjeta</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <ID>tcoValorPorcentajePerdidaEsperada</ID>
              <Name>tcoValorPorcentajePerdidaEsperada</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoValorPorcentajePerdidaEsperada</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoValorPorcentajePerdidaEsperada</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>tcoSaldoAcumuladoMensualFiscal</ID>
              <Name>tcoSaldoAcumuladoMensualFiscal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    <ColumnID>tcoSaldoAcumuladoMensualFiscal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                  <ColumnID>tcoSaldoAcumuladoMensualFiscal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
          </Attributes>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
          <ddl300_300:Relationships>
            <ddl300_300:Relationship>
              <ID>8d290665-7d3e-4b4e-9834-b8bb24a707c0</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>tcoIdFecha</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>feIdFecha</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>e5746a2f-8cd3-4021-9444-3cdd16957e2a</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>tcoIdCuentaContable</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>ccIdCuentaContable</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>980d9663-737e-44ab-8920-db4eacc33b12</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>tcoIdCliente</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>clIdCliente</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>caea6a6f-7058-457e-904d-f19f1dcc0ff6</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>tcoIdCalificacionOperacionCliente</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>cocIdCalificacionOperacionCliente</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>8f2e5e52-1181-43b5-8342-d814ff4498a2</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>tcoIdTarjeta</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>taIdTarjeta</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>a9a0c436-cfba-4327-a5b6-144b0b68f12e</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>tcoIdProducto</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>prIdProducto</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
          </ddl300_300:Relationships>
        </Dimension>
        <Dimension>
          <ID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</ID>
          <Name>DWHActivoOperacion</Name>
          <Annotations>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
              <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;declare @FechaActual int

select @FechaActual=feIdFecha from DWDFecha where feDiaActual=1


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto

,aoIdCalificacionOperacionCliente
 
,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0) 

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)
,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)
,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)
,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion
where aoIdFecha=@FechaActual

CLOSE SYMMETRIC KEY ClaveMIS02&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
            </Annotation>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>True</Value>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>aoIdFecha</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoIdFecha</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoIdCliente</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoIdCliente</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoIdCuentaContable</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoIdCuentaContable</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoIdProducto</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoIdProducto</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoNumeroOperacion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoNumeroOperacion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoMontoSaldoDolar</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoMontoSaldoDolar</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoSaldoAcumuladoAnual</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoSaldoAcumuladoAnual</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoSaldoPromedioAnual</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoSaldoPromedioAnual</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoValorActPondRiesgoPromAnual</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoValorActPondRiesgoPromAnual</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoValorComision</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoValorComision</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoValorIngresoServicio</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoValorIngresoServicio</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoValorOperacionFinanciera</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoValorOperacionFinanciera</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoValorInteresRealAnual</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoValorInteresRealAnual</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoValorInteresTasaPool</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoValorInteresTasaPool</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoValorMargenFinanciero</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoValorMargenFinanciero</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoValorMargenBancarioBasico</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoValorMargenBancarioBasico</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoValorMargenOrdinario</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoValorMargenOrdinario</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoValorMargenExplotacion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoValorMargenExplotacion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoValorUtilidadOperativa</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoValorUtilidadOperativa</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoValorCostoOperativo</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoValorCostoOperativo</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoValorPerdidaEsperada</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoValorPerdidaEsperada</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoTasaPool</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoTasaPool</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoSpread</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoSpread</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoTasaImplicita</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoTasaImplicita</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoNumeroTransaccionesAnual</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoNumeroTransaccionesAnual</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoTasaEfectiva</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoTasaEfectiva</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoIdCalificacionOperacionCliente</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoIdCalificacionOperacionCliente</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>aoValorPorcentajePerdidaEsperada</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>aoValorPorcentajePerdidaEsperada</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoIdFecha</ID>
              <Name>aoIdFecha</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoIdFecha</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoIdFecha</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoIdCliente</ID>
              <Name>aoIdCliente</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoIdCliente</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoIdCliente</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoIdCuentaContable</ID>
              <Name>aoIdCuentaContable</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoIdCuentaContable</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoIdCuentaContable</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoIdProducto</ID>
              <Name>aoIdProducto</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoIdProducto</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoIdProducto</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoNumeroOperacion</ID>
              <Name>aoNumeroOperacion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoNumeroOperacion</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoNumeroOperacion</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoMontoSaldoDolar</ID>
              <Name>aoMontoSaldoDolar</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoMontoSaldoDolar</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoMontoSaldoDolar</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoSaldoAcumuladoAnual</ID>
              <Name>aoSaldoAcumuladoAnual</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoSaldoAcumuladoAnual</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoSaldoAcumuladoAnual</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoSaldoPromedioAnual</ID>
              <Name>aoSaldoPromedioAnual</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoSaldoPromedioAnual</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoSaldoPromedioAnual</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoValorActPondRiesgoPromAnual</ID>
              <Name>aoValorActPondRiesgoPromAnual</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoValorActPondRiesgoPromAnual</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoValorActPondRiesgoPromAnual</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoValorComision</ID>
              <Name>aoValorComision</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoValorComision</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoValorComision</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoValorIngresoServicio</ID>
              <Name>aoValorIngresoServicio</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoValorIngresoServicio</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoValorIngresoServicio</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoValorOperacionFinanciera</ID>
              <Name>aoValorOperacionFinanciera</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoValorOperacionFinanciera</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoValorOperacionFinanciera</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoValorInteresRealAnual</ID>
              <Name>aoValorInteresRealAnual</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoValorInteresRealAnual</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoValorInteresRealAnual</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoValorInteresTasaPool</ID>
              <Name>aoValorInteresTasaPool</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoValorInteresTasaPool</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoValorInteresTasaPool</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoValorMargenFinanciero</ID>
              <Name>aoValorMargenFinanciero</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoValorMargenFinanciero</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoValorMargenFinanciero</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoValorMargenBancarioBasico</ID>
              <Name>aoValorMargenBancarioBasico</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoValorMargenBancarioBasico</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoValorMargenBancarioBasico</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoValorMargenOrdinario</ID>
              <Name>aoValorMargenOrdinario</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoValorMargenOrdinario</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoValorMargenOrdinario</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoValorMargenExplotacion</ID>
              <Name>aoValorMargenExplotacion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoValorMargenExplotacion</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoValorMargenExplotacion</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoValorUtilidadOperativa</ID>
              <Name>aoValorUtilidadOperativa</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoValorUtilidadOperativa</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoValorUtilidadOperativa</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoValorCostoOperativo</ID>
              <Name>aoValorCostoOperativo</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoValorCostoOperativo</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoValorCostoOperativo</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoValorPerdidaEsperada</ID>
              <Name>aoValorPerdidaEsperada</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoValorPerdidaEsperada</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoValorPerdidaEsperada</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoTasaPool</ID>
              <Name>aoTasaPool</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoTasaPool</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoTasaPool</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoSpread</ID>
              <Name>aoSpread</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoSpread</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoSpread</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoTasaImplicita</ID>
              <Name>aoTasaImplicita</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoTasaImplicita</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoTasaImplicita</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>aoNumeroTransaccionesAnual</ID>
              <Name>aoNumeroTransaccionesAnual</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoNumeroTransaccionesAnual</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoNumeroTransaccionesAnual</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <ID>aoTasaEfectiva</ID>
              <Name>aoTasaEfectiva</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoTasaEfectiva</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoTasaEfectiva</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>aoIdCalificacionOperacionCliente</ID>
              <Name>aoIdCalificacionOperacionCliente</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoIdCalificacionOperacionCliente</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoIdCalificacionOperacionCliente</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <ID>aoValorPorcentajePerdidaEsperada</ID>
              <Name>aoValorPorcentajePerdidaEsperada</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    <ColumnID>aoValorPorcentajePerdidaEsperada</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                  <ColumnID>aoValorPorcentajePerdidaEsperada</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
          </Attributes>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
          <ddl300_300:Relationships>
            <ddl300_300:Relationship>
              <ID>57fd781c-eb21-4f48-9b96-bfa993f5e8f1</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>aoIdCliente</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>clIdCliente</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>12f0298f-0579-4f3e-b032-013f1b5ed5f5</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>aoIdCuentaContable</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>ccIdCuentaContable</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>de082024-84ed-4cb5-86da-b45ebec9019c</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>aoIdFecha</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>feIdFecha</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>5edcc5d2-66ec-4abb-8080-def1a3831a39</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>aoIdCalificacionOperacionCliente</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>cocIdCalificacionOperacionCliente</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
          </ddl300_300:Relationships>
        </Dimension>
        <Dimension>
          <ID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</ID>
          <Name>DWDSegmentacionCliente</Name>
          <Annotations>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
              <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="TableWidgetSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;?xml version="1.0"?&gt;
&lt;TableWidgetGridSerialization xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"&gt;
  &lt;ColumnSuggestedType /&gt;
  &lt;ColumnFormat /&gt;
  &lt;ColumnAccuracy /&gt;
  &lt;ColumnCurrencySymbol /&gt;
  &lt;ColumnPositivePattern /&gt;
  &lt;ColumnNegativePattern /&gt;
  &lt;ColumnWidths&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scIdSegmentacionCliente&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;150&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scIdCodigo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;83&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scDetalleCodigo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;106&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scDetalleNombre&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;110&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacionCodigo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;140&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacion&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;107&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacionTipoCodigo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;160&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacionTipo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;127&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacionOrden&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;137&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacionOrdenN2&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;150&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacionOrdenN3&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;150&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
  &lt;/ColumnWidths&gt;
  &lt;ColumnDisplayIndex&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scIdSegmentacionCliente&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;0&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scIdCodigo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;1&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scDetalleCodigo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;2&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scDetalleNombre&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;3&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacionCodigo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;4&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacion&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;5&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacionTipoCodigo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;6&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacionTipo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;7&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacionOrden&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;8&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacionOrdenN2&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;9&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacionOrdenN3&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;10&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
  &lt;/ColumnDisplayIndex&gt;
  &lt;ColumnFrozen /&gt;
  &lt;ColumnChecked /&gt;
  &lt;ColumnFilter /&gt;
  &lt;SelectionFilter /&gt;
  &lt;FilterParameters /&gt;
  &lt;IsSortDescending&gt;false&lt;/IsSortDescending&gt;
&lt;/TableWidgetGridSerialization&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>False</Value>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>scIdSegmentacionCliente</AttributeID>
                  <Cardinality>One</Cardinality>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>scIdSegmentacionCliente</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>scIdCodigo</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>scIdCodigo</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>scDetalleCodigo</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>scDetalleCodigo</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>scDetalleNombre</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>scDetalleNombre</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>scSegmentacionCodigo</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>scSegmentacionCodigo</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>scSegmentacion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>scSegmentacion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>scSegmentacionTipoCodigo</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>scSegmentacionTipoCodigo</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>scSegmentacionTipo</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>scSegmentacionTipo</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>scSegmentacionOrden</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>scSegmentacionOrden</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>scSegmentacionOrdenN2</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>scSegmentacionOrdenN2</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>scSegmentacionOrdenN3</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>scSegmentacionOrdenN3</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>scIdSegmentacionCliente</ID>
              <Name>scIdSegmentacionCliente</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                    <ColumnID>scIdSegmentacionCliente</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                  <ColumnID>scIdSegmentacionCliente</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>scIdCodigo</ID>
              <Name>scIdCodigo</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                    <ColumnID>scIdCodigo</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                  <ColumnID>scIdCodigo</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>scDetalleCodigo</ID>
              <Name>scDetalleCodigo</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                    <ColumnID>scDetalleCodigo</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                  <ColumnID>scDetalleCodigo</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>scDetalleNombre</ID>
              <Name>scDetalleNombre</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                    <ColumnID>scDetalleNombre</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                  <ColumnID>scDetalleNombre</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>scSegmentacionCodigo</ID>
              <Name>scSegmentacionCodigo</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                    <ColumnID>scSegmentacionCodigo</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                  <ColumnID>scSegmentacionCodigo</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>scSegmentacion</ID>
              <Name>scSegmentacion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                    <ColumnID>scSegmentacion</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                  <ColumnID>scSegmentacion</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>scSegmentacionTipoCodigo</ID>
              <Name>scSegmentacionTipoCodigo</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                    <ColumnID>scSegmentacionTipoCodigo</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                  <ColumnID>scSegmentacionTipoCodigo</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>scSegmentacionTipo</ID>
              <Name>scSegmentacionTipo</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                    <ColumnID>scSegmentacionTipo</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                  <ColumnID>scSegmentacionTipo</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>scSegmentacionOrden</ID>
              <Name>scSegmentacionOrden</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                    <ColumnID>scSegmentacionOrden</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                  <ColumnID>scSegmentacionOrden</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>scSegmentacionOrdenN2</ID>
              <Name>scSegmentacionOrdenN2</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                    <ColumnID>scSegmentacionOrdenN2</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                  <ColumnID>scSegmentacionOrdenN2</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>scSegmentacionOrdenN3</ID>
              <Name>scSegmentacionOrdenN3</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                    <ColumnID>scSegmentacionOrdenN3</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                  <ColumnID>scSegmentacionOrdenN3</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
          </Attributes>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
        </Dimension>
        <Dimension>
          <ID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</ID>
          <Name>DWDBanca</Name>
          <Annotations>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
              <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;SELECT 
baidbanca,
baCodigoBanca,
baDescripcionBanca 
FROM [dbo].[DWDBanca]&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
            </Annotation>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>True</Value>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>baIdBanca</AttributeID>
                  <Cardinality>One</Cardinality>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>baIdBanca</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>baCodigoBanca</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>baCodigoBanca</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>baDescripcionBanca</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>baDescripcionBanca</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>baIdBanca</ID>
              <Name>baIdBanca</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                    <ColumnID>baIdBanca</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                  <ColumnID>baIdBanca</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>baCodigoBanca</ID>
              <Name>baCodigoBanca</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                    <ColumnID>baCodigoBanca</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                  <ColumnID>baCodigoBanca</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>baDescripcionBanca</ID>
              <Name>baDescripcionBanca</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                    <ColumnID>baDescripcionBanca</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                  <ColumnID>baDescripcionBanca</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
          </Attributes>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
        </Dimension>
        <Dimension>
          <ID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</ID>
          <Name>DWDCalificacionOperacionCliente</Name>
          <Annotations>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>False</Value>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>DataMarketWebBaseUrl</Name>
            </Annotation>
            <Annotation>
              <Name>DataMarketWebQueryUrl</Name>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>cocIdCalificacionOperacionCliente</AttributeID>
                  <Cardinality>One</Cardinality>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>cocIdCalificacionOperacionCliente</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>cocCodigoCalificacionOperacionCliente</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>cocCodigoCalificacionOperacionCliente</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>cocCalificacionOperacionCiente</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>cocCalificacionOperacionCiente</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>cocIdCalificacionOperacionCliente</ID>
              <Name>cocIdCalificacionOperacionCliente</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</TableID>
                    <ColumnID>cocIdCalificacionOperacionCliente</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</TableID>
                  <ColumnID>cocIdCalificacionOperacionCliente</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>cocCodigoCalificacionOperacionCliente</ID>
              <Name>cocCodigoCalificacionOperacionCliente</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</TableID>
                    <ColumnID>cocCodigoCalificacionOperacionCliente</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</TableID>
                  <ColumnID>cocCodigoCalificacionOperacionCliente</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>cocCalificacionOperacionCiente</ID>
              <Name>cocCalificacionOperacionCiente</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</TableID>
                    <ColumnID>cocCalificacionOperacionCiente</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</TableID>
                  <ColumnID>cocCalificacionOperacionCiente</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
          </Attributes>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
        </Dimension>
        <Dimension>
          <ID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</ID>
          <Name>DWHIngresoOperacion</Name>
          <Annotations>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
              <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=100

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal

--,ioIdCuentaContableSecundaria -- NO VA

--,ioIdMoneda -- NO VA
--,ioIdProducto -- NO VA

--,ioIdAgenciaOperacion -- NO VA
--,ioIdTipoTrasaccion -- NO VA
--,ioIdConstanteOperacion -- NO VA
--,ioNumeroOperacion=CONVERT(varchar(20), DecryptByKey(ioNumeroOperacion)) -- NO VA

,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
--,ioFacturacionAnual=isnull(ioFacturacionAnual,0.00) -- NO VA
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable

--,ioIdCuentaContableSecundaria=-1

--,ioIdMoneda=@IdMoneda
--,ioIdProducto=-1

--,ioIdAgenciaOperacion=-1
--,ioIdTipoTrasaccion=-1
--,ioIdConstanteOperacion=-1
--,ioNumeroOperacion=NumeroOperacion

,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
--,ioFacturacionAnual=0
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
            </Annotation>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>True</Value>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>ioIdFecha</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ioIdFecha</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ioIdCliente</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ioIdCliente</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ioIdCuentaContablePrincipal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ioIdCuentaContablePrincipal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ioMontoIngreso</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ioMontoIngreso</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ioSaldoAcumuladoMensualFiscal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ioSaldoAcumuladoMensualFiscal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ioSaldoAcumuladoAnual</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ioSaldoAcumuladoAnual</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ioMontoCostoTrx</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ioMontoCostoTrx</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ioSaldoAcumuladoAnualCostoTrx</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ioSaldoAcumuladoAnualCostoTrx</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ioSaldoAcumuladoMesCostoTrxFiscal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ioSaldoAcumuladoMesCostoTrxFiscal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ioSaldoInteresRealFiscal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ioSaldoInteresRealFiscal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ioSaldoInteresRealAcumuladoAnualFiscal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ioSaldoInteresRealAcumuladoAnualFiscal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ioNumeroTransaccionesOperacionMesFiscal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ioNumeroTransaccionesOperacionMesFiscal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ioNumeroTransaccionesOperacionAnual</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ioNumeroTransaccionesOperacionAnual</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ioNumeroTransaccionesOperacion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ioNumeroTransaccionesOperacion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ioConteoNumeroOperacionAnual</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ioConteoNumeroOperacionAnual</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ioCostoOperacionAnual</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ioCostoOperacionAnual</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ioIdCuentaContableVolumen</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ioIdCuentaContableVolumen</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ioIdFecha</ID>
              <Name>ioIdFecha</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                    <ColumnID>ioIdFecha</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                  <ColumnID>ioIdFecha</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ioIdCliente</ID>
              <Name>ioIdCliente</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                    <ColumnID>ioIdCliente</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                  <ColumnID>ioIdCliente</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ioIdCuentaContablePrincipal</ID>
              <Name>ioIdCuentaContablePrincipal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                    <ColumnID>ioIdCuentaContablePrincipal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                  <ColumnID>ioIdCuentaContablePrincipal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ioMontoIngreso</ID>
              <Name>ioMontoIngreso</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                    <ColumnID>ioMontoIngreso</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                  <ColumnID>ioMontoIngreso</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ioSaldoAcumuladoMensualFiscal</ID>
              <Name>ioSaldoAcumuladoMensualFiscal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                    <ColumnID>ioSaldoAcumuladoMensualFiscal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                  <ColumnID>ioSaldoAcumuladoMensualFiscal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ioSaldoAcumuladoAnual</ID>
              <Name>ioSaldoAcumuladoAnual</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                    <ColumnID>ioSaldoAcumuladoAnual</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                  <ColumnID>ioSaldoAcumuladoAnual</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ioMontoCostoTrx</ID>
              <Name>ioMontoCostoTrx</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                    <ColumnID>ioMontoCostoTrx</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                  <ColumnID>ioMontoCostoTrx</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ioSaldoAcumuladoAnualCostoTrx</ID>
              <Name>ioSaldoAcumuladoAnualCostoTrx</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                    <ColumnID>ioSaldoAcumuladoAnualCostoTrx</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                  <ColumnID>ioSaldoAcumuladoAnualCostoTrx</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ioSaldoAcumuladoMesCostoTrxFiscal</ID>
              <Name>ioSaldoAcumuladoMesCostoTrxFiscal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                    <ColumnID>ioSaldoAcumuladoMesCostoTrxFiscal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                  <ColumnID>ioSaldoAcumuladoMesCostoTrxFiscal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ioSaldoInteresRealFiscal</ID>
              <Name>ioSaldoInteresRealFiscal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                    <ColumnID>ioSaldoInteresRealFiscal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                  <ColumnID>ioSaldoInteresRealFiscal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ioSaldoInteresRealAcumuladoAnualFiscal</ID>
              <Name>ioSaldoInteresRealAcumuladoAnualFiscal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                    <ColumnID>ioSaldoInteresRealAcumuladoAnualFiscal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                  <ColumnID>ioSaldoInteresRealAcumuladoAnualFiscal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ioNumeroTransaccionesOperacionMesFiscal</ID>
              <Name>ioNumeroTransaccionesOperacionMesFiscal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                    <ColumnID>ioNumeroTransaccionesOperacionMesFiscal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                  <ColumnID>ioNumeroTransaccionesOperacionMesFiscal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ioNumeroTransaccionesOperacionAnual</ID>
              <Name>ioNumeroTransaccionesOperacionAnual</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                    <ColumnID>ioNumeroTransaccionesOperacionAnual</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                  <ColumnID>ioNumeroTransaccionesOperacionAnual</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ioNumeroTransaccionesOperacion</ID>
              <Name>ioNumeroTransaccionesOperacion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                    <ColumnID>ioNumeroTransaccionesOperacion</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                  <ColumnID>ioNumeroTransaccionesOperacion</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <ID>ioConteoNumeroOperacionAnual</ID>
              <Name>ioConteoNumeroOperacionAnual</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                    <ColumnID>ioConteoNumeroOperacionAnual</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                  <ColumnID>ioConteoNumeroOperacionAnual</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>ioCostoOperacionAnual</ID>
              <Name>ioCostoOperacionAnual</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                    <ColumnID>ioCostoOperacionAnual</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                  <ColumnID>ioCostoOperacionAnual</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>ioIdCuentaContableVolumen</ID>
              <Name>ioIdCuentaContableVolumen</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                    <ColumnID>ioIdCuentaContableVolumen</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                  <ColumnID>ioIdCuentaContableVolumen</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
          </Attributes>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
          <ddl300_300:Relationships>
            <ddl300_300:Relationship>
              <ID>8832beb8-3b8e-4df3-98ed-1dfbed58ea42</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>ioIdFecha</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>feIdFecha</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>c36c566a-ff4f-402e-ac8e-146baee30bab</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>ioIdCliente</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>clIdCliente</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>7df4f545-e4d3-4b88-b372-0443485183ba</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>ioIdCuentaContablePrincipal</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>ccIdCuentaContable</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>b6fa4a5e-c7e7-4591-b791-3b09f0a9f5ec</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>ioIdCuentaContableVolumen</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>ccIdCuentaContable</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
          </ddl300_300:Relationships>
        </Dimension>
        <Dimension>
          <ID>DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b</ID>
          <Name>DWDMoneda</Name>
          <Annotations>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>False</Value>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>DataMarketWebBaseUrl</Name>
            </Annotation>
            <Annotation>
              <Name>DataMarketWebQueryUrl</Name>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>moIdMoneda</AttributeID>
                  <Cardinality>One</Cardinality>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>moIdMoneda</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>moCodigoMoneda</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>moCodigoMoneda</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>moMoneda</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>moMoneda</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>moIdMoneda</ID>
              <Name>moIdMoneda</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b</TableID>
                    <ColumnID>moIdMoneda</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b</TableID>
                  <ColumnID>moIdMoneda</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>moCodigoMoneda</ID>
              <Name>moCodigoMoneda</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b</TableID>
                    <ColumnID>moCodigoMoneda</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b</TableID>
                  <ColumnID>moCodigoMoneda</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>moMoneda</ID>
              <Name>moMoneda</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b</TableID>
                    <ColumnID>moMoneda</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b</TableID>
                  <ColumnID>moMoneda</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
          </Attributes>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
        </Dimension>
        <Dimension>
          <ID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</ID>
          <Name>DWDProducto</Name>
          <Annotations>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
              <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="TableWidgetSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;?xml version="1.0"?&gt;
&lt;TableWidgetGridSerialization xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"&gt;
  &lt;ColumnSuggestedType /&gt;
  &lt;ColumnFormat /&gt;
  &lt;ColumnAccuracy /&gt;
  &lt;ColumnCurrencySymbol /&gt;
  &lt;ColumnPositivePattern /&gt;
  &lt;ColumnNegativePattern /&gt;
  &lt;ColumnWidths&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prIdProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;117&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prCodigoProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;148&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;105&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prSubGrupo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;110&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prGrupo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;86&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prFamiliaProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;144&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prVehiculo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;98&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prCodigoIndicador&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;148&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prOrdenN1&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;103&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prOrdenN2&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;103&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prOrdenN3&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;103&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prDescripcionProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;175&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prCodigoTipoProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;174&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prDescripcionTipoProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;201&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prTipoProductoAUMS&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;166&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
  &lt;/ColumnWidths&gt;
  &lt;ColumnDisplayIndex&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prIdProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;0&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prCodigoProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;1&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;2&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prSubGrupo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;3&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prGrupo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;4&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prFamiliaProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;5&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prVehiculo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;6&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prCodigoIndicador&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;7&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prOrdenN1&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;8&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prOrdenN2&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;9&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prOrdenN3&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;10&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prDescripcionProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;11&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prCodigoTipoProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;12&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prDescripcionTipoProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;13&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prTipoProductoAUMS&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;14&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
  &lt;/ColumnDisplayIndex&gt;
  &lt;ColumnFrozen /&gt;
  &lt;ColumnChecked&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prCodigoTipoProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;boolean&gt;false&lt;/boolean&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prDescripcionTipoProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;boolean&gt;false&lt;/boolean&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prTipoProductoAUMS&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;boolean&gt;true&lt;/boolean&gt;
      &lt;/value&gt;
    &lt;/item&gt;
  &lt;/ColumnChecked&gt;
  &lt;ColumnFilter /&gt;
  &lt;SelectionFilter /&gt;
  &lt;FilterParameters /&gt;
  &lt;IsSortDescending&gt;false&lt;/IsSortDescending&gt;
&lt;/TableWidgetGridSerialization&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>False</Value>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>prIdProducto</AttributeID>
                  <Cardinality>One</Cardinality>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>prIdProducto</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>prCodigoProducto</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>prCodigoProducto</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>prProducto</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>prProducto</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>prSubGrupo</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>prSubGrupo</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>prGrupo</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>prGrupo</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>prFamiliaProducto</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>prFamiliaProducto</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>prVehiculo</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>prVehiculo</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>prCodigoIndicador</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>prCodigoIndicador</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>prOrdenN1</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>prOrdenN1</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>prOrdenN2</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>prOrdenN2</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>prOrdenN3</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>prOrdenN3</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>prDescripcionProducto</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>prDescripcionProducto</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>prTipoProductoAUMS</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>prTipoProductoAUMS</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>prCalBanderaVehiculos</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>prCalBanderaVehiculos</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>prIdProducto</ID>
              <Name>prIdProducto</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                    <ColumnID>prIdProducto</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                  <ColumnID>prIdProducto</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>prCodigoProducto</ID>
              <Name>prCodigoProducto</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                    <ColumnID>prCodigoProducto</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                  <ColumnID>prCodigoProducto</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>prProducto</ID>
              <Name>prProducto</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                    <ColumnID>prProducto</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                  <ColumnID>prProducto</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>prSubGrupo</ID>
              <Name>prSubGrupo</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                    <ColumnID>prSubGrupo</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                  <ColumnID>prSubGrupo</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>prGrupo</ID>
              <Name>prGrupo</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                    <ColumnID>prGrupo</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                  <ColumnID>prGrupo</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>prFamiliaProducto</ID>
              <Name>prFamiliaProducto</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                    <ColumnID>prFamiliaProducto</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                  <ColumnID>prFamiliaProducto</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>prVehiculo</ID>
              <Name>prVehiculo</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                    <ColumnID>prVehiculo</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                  <ColumnID>prVehiculo</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>prCodigoIndicador</ID>
              <Name>prCodigoIndicador</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                    <ColumnID>prCodigoIndicador</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                  <ColumnID>prCodigoIndicador</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>prOrdenN1</ID>
              <Name>prOrdenN1</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                    <ColumnID>prOrdenN1</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                  <ColumnID>prOrdenN1</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>prOrdenN2</ID>
              <Name>prOrdenN2</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                    <ColumnID>prOrdenN2</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                  <ColumnID>prOrdenN2</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>prOrdenN3</ID>
              <Name>prOrdenN3</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                    <ColumnID>prOrdenN3</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                  <ColumnID>prOrdenN3</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>prDescripcionProducto</ID>
              <Name>prDescripcionProducto</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                    <ColumnID>prDescripcionProducto</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                  <ColumnID>prDescripcionProducto</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>prTipoProductoAUMS</ID>
              <Name>prTipoProductoAUMS</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                    <ColumnID>prTipoProductoAUMS</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                  <ColumnID>prTipoProductoAUMS</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>prCalBanderaVehiculos</ID>
              <Name>prCalBanderaVehiculos</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>IF(DWDProducto[prVehiculo]="Vehiculos",DWDProducto[prVehiculo],"Sin Vehiculos")</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>IF(DWDProducto[prVehiculo]="Vehiculos",DWDProducto[prVehiculo],"Sin Vehiculos")</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
          </Attributes>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
        </Dimension>
        <Dimension>
          <ID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</ID>
          <Name>DWHPerdidaEsperadaPortafolioGlobal</Name>
          <Annotations>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
              <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @FechaMesAnt int, @FechaHaceDosAnios int

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 peIdFecha
,peIdCliente
,peNumeroOperacion=CONVERT(varchar(25), DecryptByKey(peNumeroOperacion))
,peProbabilidadIncumplimientoPD
,peSeveridadLGD
,peExposicionIncumplimientoEAD
,pePerdidaEsperadaPE
,peCalculoOperacionPEMes
,peValorOperacionPETrimestral
,peValorOperacionPESemestral
,peValorOperacionPEAnual

--,pePerdidaEsperadaPEAnual
--,peExposicionIncumplimientoEADAnual
--,peValorPorcentajePE

from DWHPerdidaEsperadaPortafolioGlobal pe
inner join #DWDFecha fe on pe.peIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
            </Annotation>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>True</Value>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>peIdFecha</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>peIdFecha</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>peIdCliente</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>peIdCliente</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>peProbabilidadIncumplimientoPD</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>peProbabilidadIncumplimientoPD</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>peSeveridadLGD</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>peSeveridadLGD</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>peExposicionIncumplimientoEAD</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>peExposicionIncumplimientoEAD</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>pePerdidaEsperadaPE</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>pePerdidaEsperadaPE</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>peNumeroOperacion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>peNumeroOperacion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>peCalculoOperacionPEMes</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>peCalculoOperacionPEMes</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>peValorOperacionPETrimestral</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>peValorOperacionPETrimestral</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>peValorOperacionPESemestral</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>peValorOperacionPESemestral</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>peValorOperacionPEAnual</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>peValorOperacionPEAnual</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>peIdFecha</ID>
              <Name>peIdFecha</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                    <ColumnID>peIdFecha</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                  <ColumnID>peIdFecha</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>peIdCliente</ID>
              <Name>peIdCliente</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                    <ColumnID>peIdCliente</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                  <ColumnID>peIdCliente</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>peProbabilidadIncumplimientoPD</ID>
              <Name>peProbabilidadIncumplimientoPD</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                    <ColumnID>peProbabilidadIncumplimientoPD</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                  <ColumnID>peProbabilidadIncumplimientoPD</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>peSeveridadLGD</ID>
              <Name>peSeveridadLGD</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                    <ColumnID>peSeveridadLGD</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                  <ColumnID>peSeveridadLGD</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>peExposicionIncumplimientoEAD</ID>
              <Name>peExposicionIncumplimientoEAD</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                    <ColumnID>peExposicionIncumplimientoEAD</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                  <ColumnID>peExposicionIncumplimientoEAD</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>pePerdidaEsperadaPE</ID>
              <Name>pePerdidaEsperadaPE</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                    <ColumnID>pePerdidaEsperadaPE</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                  <ColumnID>pePerdidaEsperadaPE</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>peNumeroOperacion</ID>
              <Name>peNumeroOperacion</Name>
              <Description>Número de operación de las cuentas de cartera y tarjeta de crédito</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                    <ColumnID>peNumeroOperacion</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                  <ColumnID>peNumeroOperacion</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <ID>peCalculoOperacionPEMes</ID>
              <Name>peCalculoOperacionPEMes</Name>
              <Description>Si la operación del mes actual existe para el mes anterior aplicar la siguiente fórmula prPerdidaEsperadaPE(MesActual) - prPerdidaEsperadaPE(MesMesAnterior) ; si la operacion del mes actual no existe mes anterior prPerdidaEsperadaPE(MesActual) / 12</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                    <ColumnID>peCalculoOperacionPEMes</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                  <ColumnID>peCalculoOperacionPEMes</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <ID>peValorOperacionPETrimestral</ID>
              <Name>peValorOperacionPETrimestral</Name>
              <Description>Acumulado trimestral del campo peCalculoOperacionPEMES, si el acumulado es negativo se coloca el valor en cero</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                    <ColumnID>peValorOperacionPETrimestral</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                  <ColumnID>peValorOperacionPETrimestral</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <ID>peValorOperacionPESemestral</ID>
              <Name>peValorOperacionPESemestral</Name>
              <Description>Acumulado semestral del campo peCalculoOperacionPEMES, si el acumulado es negativo se coloca el valor en cero</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                    <ColumnID>peValorOperacionPESemestral</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                  <ColumnID>peValorOperacionPESemestral</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <ID>peValorOperacionPEAnual</ID>
              <Name>peValorOperacionPEAnual</Name>
              <Description>Acumulado anual del campo peCalculoOperacionPEMES, si el acumulado es negativo se coloca el valor en cero</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                    <ColumnID>peValorOperacionPEAnual</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                  <ColumnID>peValorOperacionPEAnual</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
          </Attributes>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
          <ddl300_300:Relationships>
            <ddl300_300:Relationship>
              <ID>505a30ae-c4f9-4200-b404-8daa70a56a93</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>peIdCliente</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>clIdCliente</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>9cbd90a4-082b-484f-a39f-7ddeea344d5f</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>peIdFecha</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>feIdFecha</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
          </ddl300_300:Relationships>
        </Dimension>
        <Dimension>
          <ID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</ID>
          <Name>DWDPerfilesAccesoMonitores</Name>
          <Annotations>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>True</Value>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
              <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;select * from DWDPerfilesAccesoMonitores&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
            </Annotation>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>DataMarketWebBaseUrl</Name>
            </Annotation>
            <Annotation>
              <Name>DataMarketWebQueryUrl</Name>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>pamIdPerfilAcceso</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>pamIdPerfilAcceso</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>pamBinUsuario</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>pamBinUsuario</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>pamBinPerfil</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>pamBinPerfil</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>pamIdAsesor</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>pamIdAsesor</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>pamBinUsuarioPadre</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>pamBinUsuarioPadre</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>pamRegion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>pamRegion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>pamSubregion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>pamSubregion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>pamDescripcionPerfil</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>pamDescripcionPerfil</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>pamIdPerfilAcceso</ID>
              <Name>pamIdPerfilAcceso</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                    <ColumnID>pamIdPerfilAcceso</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                  <ColumnID>pamIdPerfilAcceso</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>pamBinUsuario</ID>
              <Name>pamBinUsuario</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                    <ColumnID>pamBinUsuario</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                  <ColumnID>pamBinUsuario</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>pamBinPerfil</ID>
              <Name>pamBinPerfil</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                    <ColumnID>pamBinPerfil</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                  <ColumnID>pamBinPerfil</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>pamIdAsesor</ID>
              <Name>pamIdAsesor</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                    <ColumnID>pamIdAsesor</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                  <ColumnID>pamIdAsesor</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>pamBinUsuarioPadre</ID>
              <Name>pamBinUsuarioPadre</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                    <ColumnID>pamBinUsuarioPadre</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                  <ColumnID>pamBinUsuarioPadre</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>pamRegion</ID>
              <Name>pamRegion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                    <ColumnID>pamRegion</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                  <ColumnID>pamRegion</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>pamSubregion</ID>
              <Name>pamSubregion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                    <ColumnID>pamSubregion</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                  <ColumnID>pamSubregion</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>pamDescripcionPerfil</ID>
              <Name>pamDescripcionPerfil</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                    <ColumnID>pamDescripcionPerfil</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                  <ColumnID>pamDescripcionPerfil</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
          </Attributes>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
        </Dimension>
        <Dimension>
          <ID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</ID>
          <Name>DWDCuentaContableIngresos</Name>
          <Annotations>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
              <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT DISTINCT 
  cc.ccIdCuentaContable,
  ccCodigoNivel6=CONVERT(varchar(12), DecryptByKey(cc.ccCodigoNivel6)),
  cc.ccCodigoMoneda,
  cc.ccCodigoIndicador,  
  
  cpCalIndicadorNivel1=case when cp.indicadorNivel1 is null then cr.CpCodigoIndicadorN2 else cp.indicadorNivel1 end, -- se tiene los codigos de rentabilidad de nivel unon para el filtro en el dataset
  cpCalIndicadorNivel2=cp.indicadorNivel2, 
  --cpCalIndicadorNivel3=cp.indicadorNivel3, -- Se comento porque la informacion ya tiene la columna cc.ccCodigoIndicador

  ccCalProductoNivel1= case when cp.ProductoNivel1 is null then cc.ccFamiliaProducto else cp.ProductoNivel1  end,
  ccCalProductoNivel2= case when cp.ProductoNivel2 is null then cc.ccGrupo else cp.ProductoNivel2  end,

  cp.CpEstadoProducto,
  --cp.CpOrden, Comente porque no se usa
  cc.ccAgrupacionContableNivel2,
   
  ccSubGrupo,
  ccTarifaTransaccion=ccCostoOperativo,

  ccCalCodigoAgrupacionRentabilidaN1=cr.CpCodigoIndicadorN2,
  ccCalAgrupacionRentabilidaN1=ltrim(rtrim(upper(CpProducto))),
  ccCalCodigoTipoIngresoN2=cr.CpCodigoIndicadorN3,
  ccCalTipoIngresoN2=ltrim(rtrim(upper(ccTipoIngreso))),
  ccCalDescripcionNivel6N3= case when CONVERT(varchar(150), DecryptByKey(cc.ccDescripcionNivel6)) like '%SIN%DESCRIPCION%NIVEL%' then 'SIN DESCRIPCION NIVEL' 
                            else substring(CONVERT(varchar(150), DecryptByKey(cc.ccDescripcionNivel6)),14,100) end,

  ccCodigoIndicadorRentabilidad,
  ccCalAgrupacionTarifaBasica=isnull(cr.CpProductoN4,'SIN AGRUPACION'),

  ccAgrupacionTributario,
  ccCuentaAdquirenciaTC=case when ccCodigoIndicadorRentabilidad=40 then 1 else 0 end,ccCalCodigoAgrupacionRentabilidaN4=cr.CpCodigoIndicadorN4
  
  --drop table #DWDCuentaContable
  --into #DWDCuentaContable

FROM DWDCuentaContable cc
left outer join
( 
    SELECT DISTINCT 
    p.CpCodigoIndicador indicadorNivel1,p1.CpCodigoIndicador indicadorNivel2,p2.CpCodigoIndicador indicadorNivel3,
    p.CpProducto ProductoNivel1,
    ProductoNivel2=case when p1.CpCodigoIndicador=124  then 'Tarjeta de Credito' else p1.CpProducto end,
    p2.CpEstadoProducto,
    isnull(p1.CpOrden,1) CpOrden
    FROM DWDClasificacionProductos p
    join DWDClasificacionProductos p1 ON p1.CpPadre=p.CpCodigoIndicador
    join DWDClasificacionProductos p2 ON p2.CpPadre=p1.CpCodigoIndicador
    WHERE p.CpCodigoIndicador in (1,2,3,72,80) -- Comente los indicadores 32,28 ; 72 (ficticias de ingresos); 80 (Portafolio)
    and  p.CpNivel=1 and p1.CpNivel=2 and p2.CpNivel=3
    and p1.CpCodigoIndicador not in (143,144) -- Se excluye estas agrupaciones que no pertenecen a captaciones EA

) cp ON ccCodigoIndicador=cp.indicadorNivel3
left outer join
(
   select distinct
   CpCodigoIndicadorN4=n4.CpCodigoIndicador,
   CpProductoN4=case when n3.CpCodigoIndicador between 460 and 465 then n4.CpProducto else 'SIN AGRUPACION' end, -- Solo se obtiene las agrupaciones de tarifa básica / Conteo Tributario
   CpCodigoIndicadorN2=n2.CpCodigoIndicador,
   CpCodigoIndicadorN3=n3.CpCodigoIndicador,
   n2.CpProducto
   from DWDClasificacionProductos n1
   inner join DWDClasificacionProductos n2 on n2.CpPadre=n1.CpCodigoIndicador
   inner join DWDClasificacionProductos n3 on n3.CpPadre=n2.CpCodigoIndicador
   inner join DWDClasificacionProductos n4 on n4.CpPadre=n3.CpCodigoIndicador
   where n1.CpCodigoIndicador=71 -- Cuentas de rentabilidad
   and n1.CpNivel=1 and n2.CpNivel=2 and n3.CpNivel=3 and n4.CpNivel=4
) as cr on cc.ccCodigoIndicadorRentabilidad=cr.CpCodigoIndicadorN4

CLOSE SYMMETRIC KEY ClaveMIS02&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
            </Annotation>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>True</Value>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>ccIdCuentaContable</AttributeID>
                  <Cardinality>One</Cardinality>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccIdCuentaContable</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCodigoNivel6</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCodigoNivel6</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCodigoMoneda</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCodigoMoneda</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCodigoIndicador</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCodigoIndicador</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>cpCalIndicadorNivel1</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>cpCalIndicadorNivel1</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>cpCalIndicadorNivel2</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>cpCalIndicadorNivel2</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalProductoNivel1</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalProductoNivel1</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalProductoNivel2</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalProductoNivel2</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>CpEstadoProducto</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>CpEstadoProducto</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccAgrupacionContableNivel2</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccAgrupacionContableNivel2</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccSubGrupo</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccSubGrupo</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalCodigoAgrupacionRentabilidaN1</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalCodigoAgrupacionRentabilidaN1</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalAgrupacionRentabilidaN1</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalAgrupacionRentabilidaN1</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalCodigoTipoIngresoN2</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalCodigoTipoIngresoN2</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalTipoIngresoN2</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalTipoIngresoN2</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalDescripcionNivel6N3</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalDescripcionNivel6N3</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>cuentaPrueba</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>cuentaPrueba</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccTarifaTransaccion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccTarifaTransaccion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccAgrupacionTributario</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccAgrupacionTributario</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>Calculated Column 1</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalOrdenAgrupacionTributario</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCuentaAdquirenciaTC</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCuentaAdquirenciaTC</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalCodigoAgrupacionRentabilidaN4</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalCodigoAgrupacionRentabilidaN4</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCodigoIndicadorRentabilidad</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCodigoIndicadorRentabilidad</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ccCalAgrupacionTarifaBasica</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ccCalAgrupacionTarifaBasica</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccIdCuentaContable</ID>
              <Name>ccIdCuentaContable</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                    <ColumnID>ccIdCuentaContable</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                  <ColumnID>ccIdCuentaContable</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccCodigoNivel6</ID>
              <Name>ccCodigoNivel6</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                    <ColumnID>ccCodigoNivel6</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                  <ColumnID>ccCodigoNivel6</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccCodigoMoneda</ID>
              <Name>ccCodigoMoneda</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                    <ColumnID>ccCodigoMoneda</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                  <ColumnID>ccCodigoMoneda</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccCodigoIndicador</ID>
              <Name>ccCodigoIndicador</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                    <ColumnID>ccCodigoIndicador</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                  <ColumnID>ccCodigoIndicador</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>cpCalIndicadorNivel1</ID>
              <Name>cpCalIndicadorNivel1</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                    <ColumnID>cpCalIndicadorNivel1</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                  <ColumnID>cpCalIndicadorNivel1</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>cpCalIndicadorNivel2</ID>
              <Name>cpCalIndicadorNivel2</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                    <ColumnID>cpCalIndicadorNivel2</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                  <ColumnID>cpCalIndicadorNivel2</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccCalProductoNivel1</ID>
              <Name>ccCalProductoNivel1</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                    <ColumnID>ccCalProductoNivel1</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                  <ColumnID>ccCalProductoNivel1</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccCalProductoNivel2</ID>
              <Name>ccCalProductoNivel2</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                    <ColumnID>ccCalProductoNivel2</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                  <ColumnID>ccCalProductoNivel2</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>CpEstadoProducto</ID>
              <Name>CpEstadoProducto</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                    <ColumnID>CpEstadoProducto</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                  <ColumnID>CpEstadoProducto</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccAgrupacionContableNivel2</ID>
              <Name>ccAgrupacionContableNivel2</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                    <ColumnID>ccAgrupacionContableNivel2</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                  <ColumnID>ccAgrupacionContableNivel2</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccSubGrupo</ID>
              <Name>ccSubGrupo</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                    <ColumnID>ccSubGrupo</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                  <ColumnID>ccSubGrupo</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccCalCodigoAgrupacionRentabilidaN1</ID>
              <Name>ccCalCodigoAgrupacionRentabilidaN1</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                    <ColumnID>ccCalCodigoAgrupacionRentabilidaN1</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                  <ColumnID>ccCalCodigoAgrupacionRentabilidaN1</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccCalAgrupacionRentabilidaN1</ID>
              <Name>ccCalAgrupacionRentabilidaN1</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                    <ColumnID>ccCalAgrupacionRentabilidaN1</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                  <ColumnID>ccCalAgrupacionRentabilidaN1</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccCalCodigoTipoIngresoN2</ID>
              <Name>ccCalCodigoTipoIngresoN2</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                    <ColumnID>ccCalCodigoTipoIngresoN2</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                  <ColumnID>ccCalCodigoTipoIngresoN2</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccCalTipoIngresoN2</ID>
              <Name>ccCalTipoIngresoN2</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                    <ColumnID>ccCalTipoIngresoN2</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                  <ColumnID>ccCalTipoIngresoN2</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccCalDescripcionNivel6N3</ID>
              <Name>ccCalDescripcionNivel6N3</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                    <ColumnID>ccCalDescripcionNivel6N3</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                  <ColumnID>ccCalDescripcionNivel6N3</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>cuentaPrueba</ID>
              <Name>cuentaPrueba</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>DWDCuentaContableIngresos[ccCodigoNivel6]</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>DWDCuentaContableIngresos[ccCodigoNivel6]</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ccTarifaTransaccion</ID>
              <Name>ccTarifaTransaccion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                    <ColumnID>ccTarifaTransaccion</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                  <ColumnID>ccTarifaTransaccion</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>ccAgrupacionTributario</ID>
              <Name>ccAgrupacionTributario</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                    <ColumnID>ccAgrupacionTributario</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                  <ColumnID>ccAgrupacionTributario</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>Calculated Column 1</ID>
              <Name>ccCalOrdenAgrupacionTributario</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Mantenimiento, administracion, mantencion o manejo de cuentas ahorros", 1,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Depositos efectivo - ahorros, cuentas corrientes", 2, 
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Deposito en cheque ahorros y cuentas corriente", 3,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Deposito Mixto - ahorros y cuenta corriente", 4, 
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Retiro en cajas cuentas de ahorros", 5,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Mantenimiento, administracion, mantencion o manejo de cuentas corriente", 6, 
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Tarjeta de debito, emision y renovacion",  7,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Tarjeta de debito, reposicion",8 ,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Mantenimiento tarjeta credito", 9,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Transacciones Baninter on Line", 10,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Atm - Otras Transacciones", 11,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Atm Retiros Clientes Propios (Sin costo)",12 ,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Otras transacciones", 13,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="SIN AGRUPACION TRIBUTARIO",99 ,20 ))))))))))))))</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Mantenimiento, administracion, mantencion o manejo de cuentas ahorros", 1,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Depositos efectivo - ahorros, cuentas corrientes", 2, 
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Deposito en cheque ahorros y cuentas corriente", 3,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Deposito Mixto - ahorros y cuenta corriente", 4, 
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Retiro en cajas cuentas de ahorros", 5,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Mantenimiento, administracion, mantencion o manejo de cuentas corriente", 6, 
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Tarjeta de debito, emision y renovacion",  7,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Tarjeta de debito, reposicion",8 ,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Mantenimiento tarjeta credito", 9,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Transacciones Baninter on Line", 10,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Atm - Otras Transacciones", 11,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Atm Retiros Clientes Propios (Sin costo)",12 ,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Otras transacciones", 13,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="SIN AGRUPACION TRIBUTARIO",99 ,20 ))))))))))))))</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>ccCuentaAdquirenciaTC</ID>
              <Name>ccCuentaAdquirenciaTC</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                    <ColumnID>ccCuentaAdquirenciaTC</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                  <ColumnID>ccCuentaAdquirenciaTC</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>ccCalCodigoAgrupacionRentabilidaN4</ID>
              <Name>ccCalCodigoAgrupacionRentabilidaN4</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                    <ColumnID>ccCalCodigoAgrupacionRentabilidaN4</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                  <ColumnID>ccCalCodigoAgrupacionRentabilidaN4</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>ccCodigoIndicadorRentabilidad</ID>
              <Name>ccCodigoIndicadorRentabilidad</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                    <ColumnID>ccCodigoIndicadorRentabilidad</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                  <ColumnID>ccCodigoIndicadorRentabilidad</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>ccCalAgrupacionTarifaBasica</ID>
              <Name>ccCalAgrupacionTarifaBasica</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                    <ColumnID>ccCalAgrupacionTarifaBasica</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                  <ColumnID>ccCalAgrupacionTarifaBasica</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
          </Attributes>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
        </Dimension>
        <Dimension>
          <ID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</ID>
          <Name>ParametrosJerarquia</Name>
          <Annotations>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
              <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on 

declare @RutaPortal varchar(50)

select @RutaPortal=
case when copTipoConstante like '%mis.bcointernacional%' then 'ReportServer_MIS/Pages/ReportViewer.aspx?' -- Produccion
     else 'ReportServer/Pages/ReportViewer.aspx?' end
from DWDConstanteOperacion
where copCodigoConstante = -2

if object_id('tempdb..#ConstanteOperacion') is not null begin drop table #ConstanteOperacion end

select
copIdConstante=copIdConstante*100,
concat(copTipoConstante,@RutaPortal, '/Monitores/MonitorRentabilidad/') as copServer,
cast('RENTABILIDAD' as varchar(20)) as Monitor
into #ConstanteOperacion
from DWDConstanteOperacion
where copCodigoConstante = -2


select
 CodigoCanal=jeCodigoN1
,Canal=jeNivel1
,CodigoNivel1=jeCodigoN2
,Nivel1=jeNivel2
,CodigoNivel2=jeCodigoN3
,Nivel2=lower( ltrim(rtrim(replace(replace(replace(replace(replace(jeNivel3,'á','a'),'é','e'),'í','i'),'ó','o'),'ú','u'))) )
from DWDJerarquia
where jeMonitor='Rentabilidad'
union 
select 
 CodigoCanal=copIdConstante
,Canal=Monitor
,CodigoNivel1=copIdConstante
,Nivel1=copServer
,CodigoNivel2=copIdConstante 
,Nivel2=Monitor
from #ConstanteOperacion
union 
select 
 CodigoCanal=copIdConstante
,Canal='PARAMETRORENTABILIDAD'
,CodigoNivel1=copIdConstante
,Nivel1=copTipoConstante
,CodigoNivel2=copIdConstante 
,Nivel2='PARAMETRORENTABILIDAD'
from DWDConstanteOperacion
where copIdConstante=-3&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
            </Annotation>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>True</Value>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>CodigoCanal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>CodigoCanal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>Canal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>Canal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>CodigoNivel1</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>CodigoNivel1</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>Nivel1</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>Nivel1</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>CodigoNivel2</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>CodigoNivel2</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>Nivel2</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>Nivel2</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <ID>CodigoCanal</ID>
              <Name>CodigoCanal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</TableID>
                    <ColumnID>CodigoCanal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</TableID>
                  <ColumnID>CodigoCanal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>Canal</ID>
              <Name>Canal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</TableID>
                    <ColumnID>Canal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</TableID>
                  <ColumnID>Canal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>CodigoNivel1</ID>
              <Name>CodigoNivel1</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</TableID>
                    <ColumnID>CodigoNivel1</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</TableID>
                  <ColumnID>CodigoNivel1</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>Nivel1</ID>
              <Name>Nivel1</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</TableID>
                    <ColumnID>Nivel1</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</TableID>
                  <ColumnID>Nivel1</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>CodigoNivel2</ID>
              <Name>CodigoNivel2</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</TableID>
                    <ColumnID>CodigoNivel2</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</TableID>
                  <ColumnID>CodigoNivel2</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>Nivel2</ID>
              <Name>Nivel2</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</TableID>
                    <ColumnID>Nivel2</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</TableID>
                  <ColumnID>Nivel2</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
          </Attributes>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
        </Dimension>
        <Dimension>
          <ID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</ID>
          <Name>DWDGrupoCliente</Name>
          <Annotations>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
              <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

if object_id('tempdb..#GrupoCliente') is not null begin drop table #GrupoCliente end

select 
 Bandera=ROW_NUMBER() over (partition by grCodigoGrupo order by grIdentificacionGrupo, grNombreGrupo )
,*
into #GrupoCliente
from
(
 SELECT distinct
  grCodigoGrupo = clCodigoGrupo
 ,grIdentificacionGrupo= clGrupoSBS
 ,grNombreGrupo= clGrupo
 from DWDCliente
 where clMaestroGrupo = 1 and clCodigoGrupo is not null
) as t


select
 grCodigoGrupo
,grIdentificacionGrupo
,grNombreGrupo
,grCodigoAsesor = '-1' 
,grCodigoAgencia= '-1'
,grCodigoAgrCanal = 'COR'--'-1'
,grDescripcionCanal= 'Corporativo'--'-1'
,grNombreAsesor= '-1'
,grCodigoRegion= '-1'
,grCodigoSubRegion= '-1'
,grCodigoZona= '-1'
,grCodigoRegional= '-1'
from #GrupoCliente
where Bandera=1  -- Se eliminan los registros duplicados
union
select -1,'0000000000000','GRUPO','NDI',0,'RED','Comercial','SIN NOMBRE',1,11,111,-1&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
            </Annotation>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>True</Value>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>grCodigoGrupo</AttributeID>
                  <Cardinality>One</Cardinality>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>grCodigoGrupo</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>grIdentificacionGrupo</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>grIdentificacionGrupo</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>grNombreGrupo</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>grNombreGrupo</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>grCodigoAsesor</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>grCodigoAsesor</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>grCodigoAgencia</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>grCodigoAgencia</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>grCodigoAgrCanal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>grCodigoAgrCanal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>grDescripcionCanal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>grDescripcionCanal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>grNombreAsesor</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>grNombreAsesor</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>grCodigoRegion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>grCodigoRegion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>grCodigoSubRegion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>grCodigoSubRegion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>grCodigoZona</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>grCodigoZona</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>grCodigoRegional</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>grCodigoRegional</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>grCodigoGrupo</ID>
              <Name>grCodigoGrupo</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                    <ColumnID>grCodigoGrupo</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                  <ColumnID>grCodigoGrupo</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>grIdentificacionGrupo</ID>
              <Name>grIdentificacionGrupo</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                    <ColumnID>grIdentificacionGrupo</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                  <ColumnID>grIdentificacionGrupo</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>grNombreGrupo</ID>
              <Name>grNombreGrupo</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                    <ColumnID>grNombreGrupo</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                  <ColumnID>grNombreGrupo</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>grCodigoAsesor</ID>
              <Name>grCodigoAsesor</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                    <ColumnID>grCodigoAsesor</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                  <ColumnID>grCodigoAsesor</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>grCodigoAgencia</ID>
              <Name>grCodigoAgencia</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                    <ColumnID>grCodigoAgencia</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                  <ColumnID>grCodigoAgencia</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>grCodigoAgrCanal</ID>
              <Name>grCodigoAgrCanal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                    <ColumnID>grCodigoAgrCanal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                  <ColumnID>grCodigoAgrCanal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>grDescripcionCanal</ID>
              <Name>grDescripcionCanal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                    <ColumnID>grDescripcionCanal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                  <ColumnID>grDescripcionCanal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>grNombreAsesor</ID>
              <Name>grNombreAsesor</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                    <ColumnID>grNombreAsesor</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                  <ColumnID>grNombreAsesor</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>grCodigoRegion</ID>
              <Name>grCodigoRegion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                    <ColumnID>grCodigoRegion</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                  <ColumnID>grCodigoRegion</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>grCodigoSubRegion</ID>
              <Name>grCodigoSubRegion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                    <ColumnID>grCodigoSubRegion</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                  <ColumnID>grCodigoSubRegion</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>grCodigoZona</ID>
              <Name>grCodigoZona</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                    <ColumnID>grCodigoZona</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                  <ColumnID>grCodigoZona</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <ID>grCodigoRegional</ID>
              <Name>grCodigoRegional</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                    <ColumnID>grCodigoRegional</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                  <ColumnID>grCodigoRegional</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
          </Attributes>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
        </Dimension>
        <Dimension>
          <ID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</ID>
          <Name>DWDTarjeta</Name>
          <Annotations>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>True</Value>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
              <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select taIdTarjeta, taCuenta, taIdCliente, taIdEstadoTarjeta,
convert(char(16), DecryptByKey(taNumeroTarjeta)) taNumeroTarjeta, 
taIndicadorEsPrincipal, taEstadoActivo, taBandera, taGama
from DWDTarjeta
order by taNumeroTarjeta

CLOSE SYMMETRIC KEY ClaveMIS02&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
            </Annotation>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>DataMarketWebBaseUrl</Name>
            </Annotation>
            <Annotation>
              <Name>DataMarketWebQueryUrl</Name>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>taIdTarjeta</AttributeID>
                  <Cardinality>One</Cardinality>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>taIdTarjeta</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>taCuenta</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>taCuenta</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>taIdCliente</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>taIdCliente</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>taIdEstadoTarjeta</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>taIdEstadoTarjeta</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>taNumeroTarjeta</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>taNumeroTarjeta</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>taIndicadorEsPrincipal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>taIndicadorEsPrincipal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>taEstadoActivo</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>taEstadoActivo</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>taBandera</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>taBandera</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>taGama</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>taGama</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>taIdTarjeta</ID>
              <Name>taIdTarjeta</Name>
              <Description>Identificar tarjeta</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                    <ColumnID>taIdTarjeta</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                  <ColumnID>taIdTarjeta</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>taCuenta</ID>
              <Name>taCuenta</Name>
              <Description>Identificador cuenta tarjeta</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                    <ColumnID>taCuenta</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                  <ColumnID>taCuenta</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>taIdCliente</ID>
              <Name>taIdCliente</Name>
              <Description>Identificador cliente</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                    <ColumnID>taIdCliente</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                  <ColumnID>taIdCliente</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>taIdEstadoTarjeta</ID>
              <Name>taIdEstadoTarjeta</Name>
              <Description>Estado tarjeta</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                    <ColumnID>taIdEstadoTarjeta</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                  <ColumnID>taIdEstadoTarjeta</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>taNumeroTarjeta</ID>
              <Name>taNumeroTarjeta</Name>
              <Description>Numero de tarjeta</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                    <ColumnID>taNumeroTarjeta</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                  <ColumnID>taNumeroTarjeta</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Boolean" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>taIndicadorEsPrincipal</ID>
              <Name>taIndicadorEsPrincipal</Name>
              <Description>Indicador si tarjetahabiente es principal (true) o adicional</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Boolean</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                    <ColumnID>taIndicadorEsPrincipal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                  <ColumnID>taIndicadorEsPrincipal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <ddl300_300:FormatString>"TRUE";"TRUE";"FALSE"</ddl300_300:FormatString>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Boolean" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>taEstadoActivo</ID>
              <Name>taEstadoActivo</Name>
              <Description>Indicador intmmaes</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Boolean</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                    <ColumnID>taEstadoActivo</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                  <ColumnID>taEstadoActivo</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <ddl300_300:FormatString>"TRUE";"TRUE";"FALSE"</ddl300_300:FormatString>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>taBandera</ID>
              <Name>taBandera</Name>
              <Description>Bandera o marca de la tarjeta</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                    <ColumnID>taBandera</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                  <ColumnID>taBandera</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>taGama</ID>
              <Name>taGama</Name>
              <Description>Gama a la que pertenece la tarjeta</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                    <ColumnID>taGama</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                  <ColumnID>taGama</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
          </Attributes>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
        </Dimension>
        <Dimension>
          <ID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</ID>
          <Name>DWHPosicionConsolidadaTarjeta</Name>
          <Annotations>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>True</Value>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
              <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;select pctIdFecha, 
pctIdTarjeta, 
(pctSaldoActual + pctSaldoDiferido) pctSaldoTotal, 
(pctCupoRotativo + pctCupoDiferido) pctCupoAsignado, 
case when pctSaldoActual &lt; 0 then abs(pctSaldoActual) else 0 end pctSaldoFavor
from DWHPosicionConsolidadaTarjeta pos
inner join DWDFecha fec on (pos.pctIdFecha = fec.feIdFecha and feMesAnterior = 1)&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
            </Annotation>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>DataMarketWebBaseUrl</Name>
            </Annotation>
            <Annotation>
              <Name>DataMarketWebQueryUrl</Name>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>pctIdFecha</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>pctIdFecha</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>pctIdTarjeta</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>pctIdTarjeta</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>pctSaldoTotal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>pctSaldoTotal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>pctCupoAsignado</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>pctCupoAsignado</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>pctSaldoFavor</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>pctSaldoFavor</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>Calculated Column 1</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>pctBandera</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>pctGama</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>pctGama</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>pctIdFecha</ID>
              <Name>pctIdFecha</Name>
              <Description>Identificador de Fecha</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</TableID>
                    <ColumnID>pctIdFecha</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</TableID>
                  <ColumnID>pctIdFecha</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>pctIdTarjeta</ID>
              <Name>pctIdTarjeta</Name>
              <Description>Identificador de tarjeta (DWDTarjeta[taIdTarjeta])</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</TableID>
                    <ColumnID>pctIdTarjeta</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</TableID>
                  <ColumnID>pctIdTarjeta</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>pctSaldoTotal</ID>
              <Name>pctSaldoTotal</Name>
              <Description>saldo total = saldo rotativo + saldo diferido</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</TableID>
                    <ColumnID>pctSaldoTotal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</TableID>
                  <ColumnID>pctSaldoTotal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>pctCupoAsignado</ID>
              <Name>pctCupoAsignado</Name>
              <Description>Cupo asignado = Cupo rotativo + Cupo diferido</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</TableID>
                    <ColumnID>pctCupoAsignado</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</TableID>
                  <ColumnID>pctCupoAsignado</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>pctSaldoFavor</ID>
              <Name>pctSaldoFavor</Name>
              <Description>Saldo a favor es el saldo por pago en exceso</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</TableID>
                    <ColumnID>pctSaldoFavor</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</TableID>
                  <ColumnID>pctSaldoFavor</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>Calculated Column 1</ID>
              <Name>pctBandera</Name>
              <Description>Marca o bandera de la tarjeta (Master, Visa, Otras)</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>RELATED(DWDTarjeta[taBandera])</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>RELATED(DWDTarjeta[taBandera])</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>pctGama</ID>
              <Name>pctGama</Name>
              <Description>Gama de la tarjeta (Alta, Media, Baja, etc.)</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>related(DWDTarjeta[taGama])</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>related(DWDTarjeta[taGama])</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
          </Attributes>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
          <ddl300_300:Relationships>
            <ddl300_300:Relationship>
              <ID>13fd4758-d793-49ee-bbe8-640222ac8dfd</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>pctIdTarjeta</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>taIdTarjeta</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>a21eaffa-bd30-4db8-81ca-1532dcab02b3</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>pctIdFecha</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>feIdFecha</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
          </ddl300_300:Relationships>
        </Dimension>
        <Dimension>
          <ID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</ID>
          <Name>DWDJerarquia</Name>
          <Annotations>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
              <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;/* Tabla Jerarquia */

set nocount on

if OBJECT_ID('[tempdb]..#DWDJerarquia') is not null
begin 
 drop table #DWDJerarquia
end

--*******************DWDJerarquia2
select
 jeCodigoCanal=a.jeCodigoN1
,jeCanal=upper(a.jeNivel1)
,jeCodigoNivel1=a.jeCodigoN2
,jeNivel1=a.jeNivel2
,jeCodigoNivel2=a.jeCodigoN3
,jeNivel2=lower( ltrim(rtrim(replace(replace(replace(replace(replace(a.jeNivel3,'á','a'),'é','e'),'í','i'),'ó','o'),'ú','u'))) )
into #DWDJerarquia
from DWDJerarquia a
where a.jeMonitor='Rentabilidad'


/* Tabla Jerarquia */

select 
 jeCodigoCanal 
,jeCanal 
,jeCodigoNivel1 
,jeNivel1 
,jeCodigoNivel2 
,jeNivel2
,Filtro=
case when ltrim(rtrim(jeNivel2))='Asesor' then '{([DWDAsesorOperacionCliente].[asCodigoAsesor].['
     when ltrim(rtrim(jeNivel2))='Banco' then '[DWDCanalCliente].[caCodigoAgrupacionCanal].[' -- &gt;Se va a realizar un filtro de All
     when ltrim(rtrim(jeNivel2))='Canal' then '[DWDCanalCliente].[caCodigoAgrupacionCanal].['
     when ltrim(rtrim(jeNivel2))='Cliente' then '{([DWDCliente].[clCodigoCliente].['
     when ltrim(rtrim(jeNivel2))='Oficina' then '{([DWDAgenciaOperacionCliente].[agCodigoAgencia].['
     when ltrim(rtrim(jeNivel2)) in ('Región','Region') then '{([DWDAgenciaOperacionCliente].[agCodigoRegion].['
     when ltrim(rtrim(jeNivel2))='Regional'then '{([DWDAsesorOperacionCliente].[asCodigoRegional].['
  when ltrim(rtrim(jeNivel2))='Subregion'then '{([DWDAsesorOperacionCliente].[asCodigoSubregion].['
     when ltrim(rtrim(jeNivel2))='Zona' then '{([DWDAgenciaOperacionCliente].[agCodigoZona].['
  when ltrim(rtrim(jeNivel2))='Grupo' then '[DWDGrupoCliente].[grCodigoGrupo].['
  else ''
end
,FiltroCanal=
case 
     when ltrim(rtrim(jeNivel2))='Banco' then '' 
     when ltrim(rtrim(jeNivel2))='Canal' then ''
	 when ltrim(rtrim(jeNivel2))='Grupo' then ''
     else '],[DWDCanalCliente].[caCodigoAgrupacionCanal].['	 
end

from #DWDJerarquia&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
            </Annotation>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>True</Value>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>jeCodigoCanal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>jeCodigoCanal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>jeCanal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>jeCanal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>jeCodigoNivel1</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>jeCodigoNivel1</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>jeNivel1</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>jeNivel1</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>jeCodigoNivel2</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>jeCodigoNivel2</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>jeNivel2</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>jeNivel2</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>Filtro</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>Filtro</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>FiltroCanal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>FiltroCanal</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>jeCodigoCanal</ID>
              <Name>jeCodigoCanal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                    <ColumnID>jeCodigoCanal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                  <ColumnID>jeCodigoCanal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>jeCanal</ID>
              <Name>jeCanal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                    <ColumnID>jeCanal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                  <ColumnID>jeCanal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>jeCodigoNivel1</ID>
              <Name>jeCodigoNivel1</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                    <ColumnID>jeCodigoNivel1</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                  <ColumnID>jeCodigoNivel1</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>jeNivel1</ID>
              <Name>jeNivel1</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                    <ColumnID>jeNivel1</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                  <ColumnID>jeNivel1</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>jeCodigoNivel2</ID>
              <Name>jeCodigoNivel2</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                    <ColumnID>jeCodigoNivel2</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                  <ColumnID>jeCodigoNivel2</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>jeNivel2</ID>
              <Name>jeNivel2</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                    <ColumnID>jeNivel2</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                  <ColumnID>jeNivel2</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>Filtro</ID>
              <Name>Filtro</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                    <ColumnID>Filtro</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                  <ColumnID>Filtro</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>FiltroCanal</ID>
              <Name>FiltroCanal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                    <ColumnID>FiltroCanal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                  <ColumnID>FiltroCanal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
          </Attributes>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
        </Dimension>
        <Dimension>
          <ID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</ID>
          <Name>DWHCuotaOperacion</Name>
          <Annotations>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>True</Value>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
              <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha 
,coIdAgencia 
,coIdAsesorPrincipal
,coIdCliente 
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join 
(
 select feIdFecha
 from DWDFecha
 where feCierrMesAnioAtras = 1--bandera para obtener los cierres de mes de un año en base a la fecha de corte actual
 and fecierremes=1
 and feCalMes between 1 and 6 -- Se filtra los meses que comprenden el primer semestre de un año

) as fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
            </Annotation>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>DataMarketWebBaseUrl</Name>
            </Annotation>
            <Annotation>
              <Name>DataMarketWebQueryUrl</Name>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>coIdFecha</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>coIdFecha</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>coIdAgencia</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>coIdAgencia</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>coIdAsesorPrincipal</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>coIdAsesorPrincipal</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>coIdCliente</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>coIdCliente</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>coIdCuentaContable</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>coIdCuentaContable</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>coIdProducto</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>coIdProducto</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>coIdMoneda</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>coIdMoneda</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>coNumeroOperacion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>coNumeroOperacion</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>coCuotaCapital</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>coCuotaCapital</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>prCalVehiculosAgrupacion</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>coCalAgrupacionVehiculosEstado</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>coCalCodigo</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>coCalCodigoProducto</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>coCalAgrupacionCobranza</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>coCalAgrupacionSubProducto</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>coCalAgrupacionVehiculosEstado</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>coCalAgrupacionVehiculos</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>coCalAgrupacionProducto</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>coCalAgrupacionProducto</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>coIdFecha</ID>
              <Name>coIdFecha</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                    <ColumnID>coIdFecha</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                  <ColumnID>coIdFecha</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>coIdAgencia</ID>
              <Name>coIdAgencia</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                    <ColumnID>coIdAgencia</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                  <ColumnID>coIdAgencia</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>coIdAsesorPrincipal</ID>
              <Name>coIdAsesorPrincipal</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                    <ColumnID>coIdAsesorPrincipal</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                  <ColumnID>coIdAsesorPrincipal</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>coIdCliente</ID>
              <Name>coIdCliente</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                    <ColumnID>coIdCliente</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                  <ColumnID>coIdCliente</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>coIdCuentaContable</ID>
              <Name>coIdCuentaContable</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                    <ColumnID>coIdCuentaContable</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                  <ColumnID>coIdCuentaContable</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>coIdProducto</ID>
              <Name>coIdProducto</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                    <ColumnID>coIdProducto</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                  <ColumnID>coIdProducto</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>coIdMoneda</ID>
              <Name>coIdMoneda</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                    <ColumnID>coIdMoneda</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                  <ColumnID>coIdMoneda</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>coNumeroOperacion</ID>
              <Name>coNumeroOperacion</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>WChar</DataType>
                  <DataSize>32766</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                    <ColumnID>coNumeroOperacion</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>32766</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                  <ColumnID>coNumeroOperacion</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>coCuotaCapital</ID>
              <Name>coCuotaCapital</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                    <ColumnID>coCuotaCapital</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                  <ColumnID>coCuotaCapital</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>prCalVehiculosAgrupacion</ID>
              <Name>coCalAgrupacionVehiculosEstado</Name>
              <Description>Destalle de los sub productos de vehiculos por su estado</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>UPPER(IF(RELATED(DWDProducto[prVehiculo])="Vehiculos",RELATED(DWDProducto[prSubGrupo]) &amp; " " &amp; RELATED(DWDCuentaContable[ccCalEstadoOpeCredito]),"NA"))</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>UPPER(IF(RELATED(DWDProducto[prVehiculo])="Vehiculos",RELATED(DWDProducto[prSubGrupo]) &amp; " " &amp; RELATED(DWDCuentaContable[ccCalEstadoOpeCredito]),"NA"))</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>coCalCodigo</ID>
              <Name>coCalCodigoProducto</Name>
              <Description>Codigo de indicador de nivel 2 pertenicientes a los productos de cartera</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>RELATED(DWDCuentaContable[cpCalIndicadorNivel2])</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>RELATED(DWDCuentaContable[cpCalIndicadorNivel2])</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>coCalAgrupacionCobranza</ID>
              <Name>coCalAgrupacionSubProducto</Name>
              <Description>Agrupacion de los subproductos de cartera</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>UPPER(
	IF(RELATED(DWDProducto[prVehiculo])="Vehiculos",
		RELATED(DWDCuentaContable[ccCalProductoNivel2]) &amp; " " &amp; RELATED(DWDProducto[prSubGrupo]),
		RELATED(DWDCuentaContable[ccCalProductoNivel2]))
)</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>UPPER(
	IF(RELATED(DWDProducto[prVehiculo])="Vehiculos",
		RELATED(DWDCuentaContable[ccCalProductoNivel2]) &amp; " " &amp; RELATED(DWDProducto[prSubGrupo]),
		RELATED(DWDCuentaContable[ccCalProductoNivel2]))
)</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>coCalAgrupacionVehiculosEstado</ID>
              <Name>coCalAgrupacionVehiculos</Name>
              <Description>Agrupacion de los productos pertenecientes al grupo de Vehiculos</Description>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>UPPER(IF(RELATED(DWDProducto[prVehiculo])="Vehiculos",RELATED(DWDCuentaContable[ccCalProductoNivel2]) &amp; " " &amp;RELATED(DWDProducto[prVehiculo]),"NA"))</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>UPPER(IF(RELATED(DWDProducto[prVehiculo])="Vehiculos",RELATED(DWDCuentaContable[ccCalProductoNivel2]) &amp; " " &amp;RELATED(DWDProducto[prVehiculo]),"NA"))</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="Text" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>coCalAgrupacionProducto</ID>
              <Name>coCalAgrupacionProducto</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Empty</DataType>
                  <Source xsi:type="ddl200_200:ExpressionBinding">
                    <Expression>upper(IF(DWHCuotaOperacion[coCalAgrupacionVehiculos]="NA",RELATED(DWDCuentaContable[ccCalProductoNivel2]),DWHCuotaOperacion[coCalAgrupacionVehiculos]))</Expression>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <Source xsi:type="ddl200_200:ExpressionBinding">
                  <Expression>upper(IF(DWHCuotaOperacion[coCalAgrupacionVehiculos]="NA",RELATED(DWDCuentaContable[ccCalProductoNivel2]),DWHCuotaOperacion[coCalAgrupacionVehiculos]))</Expression>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
          </Attributes>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
          <ddl300_300:Relationships>
            <ddl300_300:Relationship>
              <ID>933e83c6-3f87-41b0-97be-853c55214942</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>coIdCliente</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>clIdCliente</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>07da4a37-dc62-4087-86a9-897f187fdf4e</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>coIdCuentaContable</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>ccIdCuentaContable</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>58d0fef3-5939-4dfd-a54c-bedb5c4c3447</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>coIdFecha</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>feIdFecha</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>66b340fb-ff0c-469f-83a5-f55c8130b71c</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>coIdMoneda</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>moIdMoneda</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>2a1b5c5b-f0cc-4006-b4ac-e542e78298a8</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>coIdProducto</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>prIdProducto</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
          </ddl300_300:Relationships>
        </Dimension>
        <Dimension>
          <ID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</ID>
          <Name>DWHRankingRentabilidadCliente</Name>
          <Annotations>
            <Annotation>
              <Name>IsQueryEditorUsed</Name>
              <Value>True</Value>
            </Annotation>
            <Annotation>
              <Name>QueryEditorSerialization</Name>
              <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @FechaCarga int

--select @FechaCarga=20220630

select @FechaCarga=feIdFecha from DWDFecha where feMesAnterior=1
--select feIdFechaTresMesAtras from DWDFecha where feMesAnterior=1
--select feIdFechaSeisMesAtras from DWDFecha where feMesAnterior=1
--select feIdFechaDoceMesAtras from DWDFecha where feMesAnterior=1

--select @FechaCarga

/* -------------------------------------------------------- */
/*          PARTICION TABLA DWHACTIVOOPERACION				*/
/* -------------------------------------------------------- */

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

SELECT distinct
 cc.ccIdCuentaContable  
,cpCalIndicadorNivel1= cp.indicadorNivel1 
into #DWDCuentaContable
FROM DWDCuentaContable cc
inner join
( 
    SELECT DISTINCT 
    p.CpCodigoIndicador indicadorNivel1,p1.CpCodigoIndicador indicadorNivel2,p2.CpCodigoIndicador indicadorNivel3,
    p.CpProducto ProductoNivel1,p2.CpEstadoProducto
    FROM DWDClasificacionProductos p
    join DWDClasificacionProductos p1 ON p1.CpPadre=p.CpCodigoIndicador
    join DWDClasificacionProductos p2 ON p2.CpPadre=p1.CpCodigoIndicador
    WHERE p.CpCodigoIndicador in (1,2,3,72,80) -- Comente los indicadores 32,28 ; 72 (ficticias de ingresos); 80 (Portafolio)
    and  p.CpNivel=1 and p1.CpNivel=2 and p2.CpNivel=3
    and p1.CpCodigoIndicador not in (125,143,144) -- Se excluye las agrupaciones de Titularizada, Otros Depositos, Obligaciones Financieras
) cp ON ccCodigoIndicador=cp.indicadorNivel3

-- Cuenta Contable Indicadores de Tárifa Basica --

/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

if OBJECT_ID ('tempdb..#CuentaContableTB') is not null begin drop table #CuentaContableTB end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContableTB
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select
ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
where ct.ctIdFechaTransaccion=@FechaCarga

-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContableTB cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdClientePropietarioOperacion,ccIdCuentaContable

---  Activo Operacion --

if OBJECT_ID ('tempdb..#DatosFuentes') is not null begin drop table #DatosFuentes end

select 
 IdCliente=ao.aoIdCliente
,ValorActPondRiesgoPromAnual=sum(isnull(ao.aoValorActPondRiesgoPromAnual,0))
,ValorUtilidadOperativa=sum(isnull(ao.aoValorUtilidadOperativa,0))
into #DatosFuentes
from DWHActivoOperacion ao
inner join #DWDCuentaContable cc on ao.aoIdCuentaContable=cc.ccIdCuentaContable
where ao.aoIdFecha=@FechaCarga
group by ao.aoIdCliente


insert into #DatosFuentes
select
 ca.ctIdClientePropietarioOperacion
,aoValorActPondRiesgoPromAnual=0
,aoValorUtilidadOperativa=sum( 0-(isnull(cc.ccCostoOperativo,0)*ca.NumeroTransaccionesAnual) ) -- ValorMargenExplotacion - PerdidaEsperada
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0
group by ca.ctIdClientePropietarioOperacion


/* -------------------------------------------------------- */
/*         PARTICION TABLA DWHPASIVOSOPERACION				*/
/* -------------------------------------------------------- */


--- Cuenta Contable Ctas Ahorro y Credito ---

if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end 

select ccIdCuentaContable,ccCostoOperativo,ccCodigoIndicadorRentabilidad
into #CtasAhoCorr
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in
(60, -- Mantenimiento Cuenta Ahorro
 61  -- Mantenimiento Cuenta Corriente
)

--- Pasivo Operacion ---

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end

select
 poIdCliente
,poValorActPondRiesgoPromAnual
,poValorUtilidadOperativa
,poIdCuentaContable
,poSaldoAcumuladoMensualFiscal
--,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
into #PasivoOperacion
from DWHPasivoOperacion
where poIdFecha=@FechaCarga
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion


insert into #DatosFuentes
select
 poIdCliente
,poValorActPondRiesgoPromAnual=sum( isnull(poValorActPondRiesgoPromAnual,0) )
,poValorUtilidadOperativa=sum( isnull(poValorUtilidadOperativa,0) - (case when cta.ccIdCuentaContable is not null and po.poSaldoAcumuladoMensualFiscal!=0 then po.NumTRXAnualFiscal*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
from #PasivoOperacion po
inner join #DWDCuentaContable cc on po.poIdCuentaContable=cc.ccIdCuentaContable
left outer join #CtasAhoCorr cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdCliente

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* --------------------------------------------------------------- */
/*         PARTICION TABLA DWHTARJETACREDITOOPERACION			   */
/* --------------------------------------------------------------- */

-- Tarjeta --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in ( 
 62 --Mantenimiento tarjeta credito
)

if OBJECT_ID ('tempdb..#TarjetaCreditoOperacion') is not null begin drop table #TarjetaCreditoOperacion end

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 tcoIdCliente
--,poNoOperacion=CONVERT(varchar(30), DecryptByKey(poNoOperacion))
,tcoValorActPondRiesgoPromAnual=sum(tcoValorActPondRiesgoPromAnual)
,tcoSaldoAcumuladoMensualFiscal=sum(tcoSaldoAcumuladoMensualFiscal)
,tcoValorUtilidadOperativa=sum(tcoValorUtilidadOperativa)
,tcoIdCuentaContable=max(tcoIdCuentaContable)
--,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
into #TarjetaCreditoOperacion
from DWHTarjetaCreditoOperacion
where tcoIdFecha=@FechaCarga
group by tcoIdCliente,CONVERT(varchar(30), DecryptByKey(tcoNumeroOperacion)) -- debe tener la agrupacion por cleinte y operacion 

CLOSE SYMMETRIC KEY ClaveMIS02


insert into #DatosFuentes
select
 tcoIdCliente
,tcoValorActPondRiesgoPromAnual=sum(tcoValorActPondRiesgoPromAnual)
,tcoValorUtilidadOperativa=sum( isnull(tcoValorUtilidadOperativa,0) - (case when cta.ccIdCuentaContable is not null and tco.tcoSaldoAcumuladoMensualFiscal!=0 then tco.NumTRXAnualFiscal*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
FROM #TarjetaCreditoOperacion tco
inner join #DWDCuentaContable cc on tco.tcoIdCuentaContable=cc.ccIdCuentaContable
left outer join #CuentasPasivoTarjeta cta on tco.tcoIdCuentaContable=cta.ccIdCuentaContable
group by tcoIdCliente

if OBJECT_ID ('tempdb..#TarjetaCreditoOperacion') is not null begin drop table #TarjetaCreditoOperacion end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* ------------------------------------------ */
/*        CALCULO RANKING POR CANAL			  */
/* ------------------------------------------ */

if OBJECT_ID ('tempdb..#Cliente') is not null begin drop table #Cliente end

select
 cl.clIdCliente
,cl.clCodigoCliente
,ca.caCodigoAgrupacionCanal
into #Cliente
from DWDCliente cl
inner join DWDCanal ca on cl.clIdCanal=ca.caIdCanal
where cl.clCodigoCliente not in (-1,0) --- Son los clientes de ajuste que no deben mostrar en los ranking pero si en los totales


if OBJECT_ID ('tempdb..#Ranking') is not null begin drop table #Ranking end

select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
into #Ranking
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='RED'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='COR'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='ESP'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='TES'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

if OBJECT_ID ('tempdb..#Cliente') is not null begin drop table #Cliente end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* ------------------------------ */
/*        TABLA FINAL			  */
/* ------------------------------ */

if OBJECT_ID ('tempdb..#DWDCliente') is not null begin drop table #DWDCliente end

select clIdCliente=max(clIdCliente),clCodigoCliente 
into #DWDCliente
from DWDCliente
group by clCodigoCliente

select
 Orden=Row_Number() over (partition by tf.caCodigoAgrupacionCanal order by tf.ValorUtilidadOperativa desc )
,Fecha=@FechaCarga
,cl.clIdCliente
,tf.ValorActPondRiesgoPromAnual	
,tf.ValorUtilidadOperativa
from #Ranking tf
inner join #DWDCliente cl on tf.clCodigoCliente=cl.clCodigoCliente -- se toma el id del cliente maximo
order by tf.caCodigoAgrupacionCanal


if OBJECT_ID ('tempdb..#DWDCliente') is not null begin drop table #DWDCliente end
if OBJECT_ID ('tempdb..#DatosFuentes') is not null begin drop table #DatosFuentes end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end
if OBJECT_ID ('tempdb..#Ranking') is not null begin drop table #Ranking end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
            </Annotation>
            <Annotation>
              <Name>TableWidgetSerialization</Name>
            </Annotation>
            <Annotation>
              <Name>DataMarketWebBaseUrl</Name>
            </Annotation>
            <Annotation>
              <Name>DataMarketWebQueryUrl</Name>
            </Annotation>
          </Annotations>
          <Source xsi:type="DataSourceViewBinding">
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <UnknownMember valuens="ddl200_200">AutomaticNull</UnknownMember>
          <ErrorConfiguration>
            <KeyNotFound>IgnoreError</KeyNotFound>
            <KeyDuplicate>ReportAndStop</KeyDuplicate>
            <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
          </ErrorConfiguration>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <Language>12298</Language>
          <UnknownMemberName>Unknown</UnknownMemberName>
          <Attributes>
            <Attribute>
              <ID>__XL_RowNumber</ID>
              <Name>__XL_RowNumber</Name>
              <Type valuens="ddl200_200">RowNumber</Type>
              <Usage>Key</Usage>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>4</DataSize>
                  <NullProcessing>Error</NullProcessing>
                  <Source xsi:type="ddl200_200:RowNumberBinding" />
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>4</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <Source xsi:type="ddl200_200:RowNumberBinding" />
              </NameColumn>
              <AttributeRelationships>
                <AttributeRelationship>
                  <AttributeID>Orden</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>Orden</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>Fecha</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>Fecha</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>clIdCliente</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>clIdCliente</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ValorActPondRiesgoPromAnual</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ValorActPondRiesgoPromAnual</Name>
                </AttributeRelationship>
                <AttributeRelationship>
                  <AttributeID>ValorUtilidadOperativa</AttributeID>
                  <OverrideBehavior>None</OverrideBehavior>
                  <Name>ValorUtilidadOperativa</Name>
                </AttributeRelationship>
              </AttributeRelationships>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>Orden</ID>
              <Name>Orden</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>BigInt</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</TableID>
                    <ColumnID>Orden</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</TableID>
                  <ColumnID>Orden</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>Fecha</ID>
              <Name>Fecha</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</TableID>
                    <ColumnID>Fecha</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</TableID>
                  <ColumnID>Fecha</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>clIdCliente</ID>
              <Name>clIdCliente</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Integer</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</TableID>
                    <ColumnID>clIdCliente</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</TableID>
                  <ColumnID>clIdCliente</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ValorActPondRiesgoPromAnual</ID>
              <Name>ValorActPondRiesgoPromAnual</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</TableID>
                    <ColumnID>ValorActPondRiesgoPromAnual</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</TableID>
                  <ColumnID>ValorActPondRiesgoPromAnual</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
            <Attribute>
              <Annotations>
                <Annotation>
                  <Name>Format</Name>
                  <Value>
                    <Format Format="General" xmlns="" />
                  </Value>
                </Annotation>
              </Annotations>
              <ID>ValorUtilidadOperativa</ID>
              <Name>ValorUtilidadOperativa</Name>
              <KeyColumns>
                <KeyColumn>
                  <DataType>Double</DataType>
                  <DataSize>-1</DataSize>
                  <NullProcessing>Preserve</NullProcessing>
                  <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                  <Source xsi:type="ColumnBinding">
                    <TableID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</TableID>
                    <ColumnID>ValorUtilidadOperativa</ColumnID>
                  </Source>
                </KeyColumn>
              </KeyColumns>
              <NameColumn>
                <DataType>WChar</DataType>
                <DataSize>-1</DataSize>
                <NullProcessing>ZeroOrBlank</NullProcessing>
                <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                <Source xsi:type="ColumnBinding">
                  <TableID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</TableID>
                  <ColumnID>ValorUtilidadOperativa</ColumnID>
                </Source>
              </NameColumn>
              <OrderBy>Key</OrderBy>
              <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
            </Attribute>
          </Attributes>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
          <ddl300_300:Relationships>
            <ddl300_300:Relationship>
              <ID>597bc237-c897-49d5-be85-f283dc1ace6f</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>clIdCliente</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>clIdCliente</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
            <ddl300_300:Relationship>
              <ID>69b6d14f-368c-4557-b859-75a12f4c885c</ID>
              <ddl300_300:FromRelationshipEnd>
                <ddl300_300:Multiplicity>Many</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>Fecha</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:FromRelationshipEnd>
              <ddl300_300:ToRelationshipEnd>
                <ddl300_300:Multiplicity>One</ddl300_300:Multiplicity>
                <ddl300:VisualizationProperties />
                <DimensionID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</DimensionID>
                <Attributes>
                  <Attribute>
                    <AttributeID>feIdFecha</AttributeID>
                  </Attribute>
                </Attributes>
              </ddl300_300:ToRelationshipEnd>
            </ddl300_300:Relationship>
          </ddl300_300:Relationships>
        </Dimension>
      </Dimensions>
      <Cubes>
        <Cube>
          <ID>Model</ID>
          <Name>Model</Name>
          <Annotations>
            <Annotation>
              <Name>DefaultMeasure</Name>
              <Value>__No measures defined</Value>
            </Annotation>
            <Annotation>
              <Name>PerspectiveEmptyHierarchyNames</Name>
              <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Perspectives&gt;&lt;Perspective Name="AUMS"&gt;&lt;Tables&gt;&lt;Table Name="DWDCuentaContable" EmptyHierarchyNames="ccJerCuentasContables"/&gt;&lt;/Tables&gt;&lt;/Perspective&gt;&lt;/Perspectives&gt;</Value>
            </Annotation>
          </Annotations>
          <Language>12298</Language>
          <Dimensions>
            <Dimension>
              <ID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</ID>
              <Name>DWDCuentaContable</Name>
              <DimensionID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</DimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ccIdCuentaContable</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCodigoMoneda</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCodigoIndicador</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>CpEstadoProducto</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCodigoNivel6</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccAgrupacionContableNivel2</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>cpCalIndicadorNivel1</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>cpCalIndicadorNivel2</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalProductoNivel1</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalProductoNivel2</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccSubGrupo</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccTarifaTransaccion</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalAgrupacionRentabilidaN1</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalTipoIngresoN2</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalDescripcionNivel6N3</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalCodigoAgrupacionRentabilidaN1</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalCodigoTipoIngresoN2</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>cpCalOrdenIndicadorNivel1</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>cpCalOrdenIndicadorNivel2</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccAgrupacionTributario</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalOrdenAgrupacionTributario</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalBandera</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccAgrupacionRentabilidadTransaccion</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalProductoBruto</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalEstado</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCovid</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalProductoOperCredito</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalEstadoOpeCredito</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalAgrupacion</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCodigoNivel2</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCodigoNivel3</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalProductoCobranza</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCodigoIndicadorRentabilidad</AttributeID>
                </Attribute>
              </Attributes>
              <Hierarchies>
                <Hierarchy>
                  <HierarchyID>ccJerCuentasContables</HierarchyID>
                </Hierarchy>
              </Hierarchies>
            </Dimension>
            <Dimension>
              <ID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</ID>
              <Name>DWDFecha</Name>
              <DimensionID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</DimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>feIdFecha</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feFecha</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feDescripcionFecha</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feCalAnio</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feCalMes</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feCalDia</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feTrimNumero</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feTrimMes</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feTrimDia</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feFeriado</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feCierreMes</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feFinMes</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feFinSemana</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>EsDiaAnterior</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>fecIdAnterior</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>EsCierreAño</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feMesAntCierr</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feAnioAntCierr</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feIdFechaAnioAnt</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feIdFechaCierreAnioAnt</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feFechaCierreAnio</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feDiaActual</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feDiaAnterior</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feMesAnterior</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feAnioAnterior</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feHaceUnAnio</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feFinTrimestreAnt</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feCierreMesAnterior</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feFechaMesAntCierr</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feCierreMesTodosAnios</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feValorCalculoPromedio</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feEsMesActual</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feEsTrimestreActual</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feIdFechaHaceUnMesLab</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feIdFechaHaceUnTrimestreLab</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feIdFechaHaceUnSemestreLab</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feIdFechaHaceUnAnioLab</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feIdFechaHistoricoLab</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feNumDiasMesLab</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feNumDiasTrimLab</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feNumDiasTrimFiscLab</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feNumDiasSemestLab</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feNumDiasAnioLab</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feNumDiasHistLab</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feTrimestresAnteriores</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feCierrFechAnioActFut</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feMesAntAnioAnt</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feCierrMesAnioAtras</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>Column1</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>Column1 1</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feIdFechaTresMesAtras</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feIdFechaSeisMesAtras</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feIdFechaDoceMesAtras</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>feCalMesAnteriorRentabilidad</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>FechaMesAntRent</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>F</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>Agregar columna2</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <ID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</ID>
              <Name>DWDCanalCliente</Name>
              <DimensionID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</DimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>caIdCanal</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>caCodigoCanal</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>caDescripcionCanal</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>caCodigoAgrupacionCanal</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>caDescripcionAgrupacionCanal</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>caOrdenCanal</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>caAgrupacion</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>caEstado</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>caOrdenDescripcionCanal</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>caCodDescripcionAgrupacionCanal</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalCanalConsolidado</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <ID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</ID>
              <Name>DWDAgenciaOperacionCliente</Name>
              <DimensionID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</DimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>agIdAgencia</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agCodigoAgencia</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agNombreAgencia</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agDireccionAgencia</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agTelefonoAgencia</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agResponsableNombre</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agFechaApertura</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agFechaClausura</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agNumeroColaboradores</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agMontoInvertido</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agCodigoZona</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agNombreZona</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agCodigoSubregion</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agCodigoRegion</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agNombreRegion</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agCodigoCantonCompleto</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agNombreCanton</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agCodigoProvincia</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agNombreProvincia</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agCodigoRegionDescn</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agNombreRegionDescn</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agOrdenRegionAsesor</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agEstado</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agCodigoJefeAgencia</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agNombreJefeAgencia</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agCodigoAgrupacionCanal</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>agCodigoRegional</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <ID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</ID>
              <Name>DWDAsesorOperacionCliente</Name>
              <DimensionID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</DimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>asIdAsesor</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>asCodigoAsesor</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>asNombreAsesor</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>asUsuario</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>asNombreCanal</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>asAsesorPrincipal</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>asCodigoAgencia</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>asNombreAgencia</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>asEstado</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>asOrdenAsesor</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>Calculated Column 1</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>asCodigoRegion</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>asNombreRegion</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>asCodigoAgrupacionCanal</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>asCodigoZona</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>asNombreZona</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>asCodigoRegional</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>asNombreRegional</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>asCodigoSubRegion</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>asNombreSubRegion</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <ID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</ID>
              <Name>DWDCliente</Name>
              <DimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</DimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>clIdCliente</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>clCodigoCliente</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>clNombreCompleto</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>clIdCanal</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>clIdAsesorPrincipal</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>clIdAgencia</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>clVinculacionValor</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>clCodigoGrupo</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>clGrupo</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>clEstado</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>clFechaFin</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>clIdBanca</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>clIdSegmentacionCliente</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>clCalClienteDesde</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>CanalCliente</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>Calculated Column 1</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>Calculated Column 1 1</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>Calculated Column 1 2</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>Calculated Column 1 3</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>clSegmentacionTipoCliente</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ClCodigoCliente1</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>Calculated Column 1 4</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>Calculated Column 1 5</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>clCodigoAgrupacionCanal</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>clCodigoAgencia</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>clCodigoZona</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>clCodigoRegion</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>clCodigoRegion 1</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>clCodigoSubregion</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>clFechaIngreso</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <ID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</ID>
              <Name>DWHPasivoOperacion</Name>
              <DimensionID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</DimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>poIdFecha</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>poIdCliente</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>poIdCuentaContable</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>poSaldoOperacionUSD</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>poSaldoAcumuladoAnual</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>poSaldoPromedioAnual</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>poValorActPondRiesgoPromAnual</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>poValorComision</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>poValorIngresoServicio</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>poNumeroTransaccionesAnual</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>poValorCostoOperativo</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>poValorOperacionFinanciera</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>poValorInteresRealAnual</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>poValorInteresTasaPool</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>poValorMargenFinanciero</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>poValorMargenBancarioBasico</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>poValorMargenOrdinario</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>poValorMargenExplotacion</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>poValorUtilidadOperativa</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>poSaldoAcumuladoMensualFiscal</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>poCuentaAperturada</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <ID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</ID>
              <Name>DWHTarjetaCreditoOperacion</Name>
              <DimensionID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</DimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoIdFecha</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoIdCuentaContable</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoIdProducto</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoIdCliente</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoNumeroOperacion</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoSaldo</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoSaldoAcumuladoAnual</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoSaldoPromedioAnual</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoValorActPondRiesgoPromAnual</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoValorComision</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoValorIngresoServicio</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoValorOperacionFinanciera</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoValorInteresRealAnual</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoValorInteresTasaPool</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoValorMargenFinanciero</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoValorMargenBancarioBasico</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoValorMargenOrdinario</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoValorMargenExplotacion</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoValorUtilidadOperativa</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoValorCostoOperativo</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoValorPerdidaEsperada</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoNumeroTransaccionesAnual</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoTasaEfectiva</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoIdCalificacionOperacionCliente</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoIdTarjeta</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoValorPorcentajePerdidaEsperada</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>tcoSaldoAcumuladoMensualFiscal</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <ID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</ID>
              <Name>DWHActivoOperacion</Name>
              <DimensionID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</DimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>aoIdFecha</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>aoIdCliente</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>aoIdCuentaContable</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>aoIdProducto</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>aoNumeroOperacion</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>aoMontoSaldoDolar</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>aoSaldoAcumuladoAnual</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>aoSaldoPromedioAnual</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>aoValorActPondRiesgoPromAnual</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>aoValorComision</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>aoValorIngresoServicio</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>aoValorOperacionFinanciera</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>aoValorInteresRealAnual</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>aoValorInteresTasaPool</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>aoValorMargenFinanciero</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>aoValorMargenBancarioBasico</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>aoValorMargenOrdinario</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>aoValorMargenExplotacion</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>aoValorUtilidadOperativa</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>aoValorCostoOperativo</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>aoValorPerdidaEsperada</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>aoTasaPool</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>aoSpread</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>aoTasaImplicita</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>aoNumeroTransaccionesAnual</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>aoTasaEfectiva</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>aoIdCalificacionOperacionCliente</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>aoValorPorcentajePerdidaEsperada</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <ID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</ID>
              <Name>DWDSegmentacionCliente</Name>
              <DimensionID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</DimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>scIdSegmentacionCliente</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>scIdCodigo</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>scDetalleCodigo</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>scDetalleNombre</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>scSegmentacionCodigo</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>scSegmentacion</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>scSegmentacionTipoCodigo</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>scSegmentacionTipo</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>scSegmentacionOrden</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>scSegmentacionOrdenN2</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>scSegmentacionOrdenN3</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <ID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</ID>
              <Name>DWDBanca</Name>
              <DimensionID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</DimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>baIdBanca</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>baCodigoBanca</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>baDescripcionBanca</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <ID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</ID>
              <Name>DWDCalificacionOperacionCliente</Name>
              <DimensionID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</DimensionID>
              <Visible>false</Visible>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>cocIdCalificacionOperacionCliente</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>cocCodigoCalificacionOperacionCliente</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>cocCalificacionOperacionCiente</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <ID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</ID>
              <Name>DWHIngresoOperacion</Name>
              <DimensionID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</DimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ioIdFecha</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ioIdCliente</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ioIdCuentaContablePrincipal</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ioMontoIngreso</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ioSaldoAcumuladoMensualFiscal</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ioSaldoAcumuladoAnual</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ioMontoCostoTrx</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ioSaldoAcumuladoAnualCostoTrx</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ioSaldoAcumuladoMesCostoTrxFiscal</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ioSaldoInteresRealFiscal</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ioSaldoInteresRealAcumuladoAnualFiscal</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ioNumeroTransaccionesOperacionMesFiscal</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ioNumeroTransaccionesOperacionAnual</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ioNumeroTransaccionesOperacion</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ioConteoNumeroOperacionAnual</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ioCostoOperacionAnual</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ioIdCuentaContableVolumen</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <ID>DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b</ID>
              <Name>DWDMoneda</Name>
              <DimensionID>DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b</DimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>moIdMoneda</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>moCodigoMoneda</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>moMoneda</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <ID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</ID>
              <Name>DWDProducto</Name>
              <DimensionID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</DimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>prIdProducto</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>prCodigoProducto</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>prProducto</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>prSubGrupo</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>prGrupo</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>prFamiliaProducto</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>prVehiculo</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>prCodigoIndicador</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>prOrdenN1</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>prOrdenN2</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>prOrdenN3</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>prDescripcionProducto</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>prTipoProductoAUMS</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>prCalBanderaVehiculos</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <ID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</ID>
              <Name>DWHPerdidaEsperadaPortafolioGlobal</Name>
              <DimensionID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</DimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>peIdFecha</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>peIdCliente</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>peProbabilidadIncumplimientoPD</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>peSeveridadLGD</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>peExposicionIncumplimientoEAD</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>pePerdidaEsperadaPE</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>peNumeroOperacion</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>peCalculoOperacionPEMes</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>peValorOperacionPETrimestral</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>peValorOperacionPESemestral</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>peValorOperacionPEAnual</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <ID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</ID>
              <Name>DWDPerfilesAccesoMonitores</Name>
              <DimensionID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</DimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>pamIdPerfilAcceso</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>pamBinUsuario</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>pamBinPerfil</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>pamIdAsesor</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>pamBinUsuarioPadre</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>pamRegion</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>pamSubregion</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>pamDescripcionPerfil</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <ID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</ID>
              <Name>DWDCuentaContableIngresos</Name>
              <DimensionID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</DimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ccIdCuentaContable</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCodigoNivel6</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCodigoMoneda</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCodigoIndicador</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>cpCalIndicadorNivel1</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>cpCalIndicadorNivel2</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalProductoNivel1</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalProductoNivel2</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>CpEstadoProducto</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccAgrupacionContableNivel2</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccSubGrupo</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalCodigoAgrupacionRentabilidaN1</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalAgrupacionRentabilidaN1</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalCodigoTipoIngresoN2</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalTipoIngresoN2</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalDescripcionNivel6N3</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>cuentaPrueba</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccTarifaTransaccion</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccAgrupacionTributario</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>Calculated Column 1</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCuentaAdquirenciaTC</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalCodigoAgrupacionRentabilidaN4</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCodigoIndicadorRentabilidad</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>ccCalAgrupacionTarifaBasica</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <ID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</ID>
              <Name>ParametrosJerarquia</Name>
              <DimensionID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</DimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>CodigoCanal</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>Canal</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>CodigoNivel1</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>Nivel1</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>CodigoNivel2</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>Nivel2</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <ID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</ID>
              <Name>DWDGrupoCliente</Name>
              <DimensionID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</DimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>grCodigoGrupo</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>grIdentificacionGrupo</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>grNombreGrupo</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>grCodigoAsesor</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>grCodigoAgencia</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>grCodigoAgrCanal</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>grDescripcionCanal</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>grNombreAsesor</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>grCodigoRegion</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>grCodigoSubRegion</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>grCodigoZona</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>grCodigoRegional</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <ID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</ID>
              <Name>DWDTarjeta</Name>
              <DimensionID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</DimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>taIdTarjeta</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>taCuenta</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>taIdCliente</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>taIdEstadoTarjeta</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>taNumeroTarjeta</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>taIndicadorEsPrincipal</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>taEstadoActivo</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>taBandera</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>taGama</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <ID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</ID>
              <Name>DWHPosicionConsolidadaTarjeta</Name>
              <DimensionID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</DimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>pctIdFecha</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>pctIdTarjeta</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>pctSaldoTotal</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>pctCupoAsignado</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>pctSaldoFavor</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>Calculated Column 1</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>pctGama</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <ID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</ID>
              <Name>DWDJerarquia</Name>
              <DimensionID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</DimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>jeCodigoCanal</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>jeCanal</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>jeCodigoNivel1</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>jeNivel1</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>jeCodigoNivel2</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>jeNivel2</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>Filtro</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>FiltroCanal</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <ID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</ID>
              <Name>DWHCuotaOperacion</Name>
              <DimensionID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</DimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>coIdFecha</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>coIdAgencia</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>coIdAsesorPrincipal</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>coIdCliente</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>coIdCuentaContable</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>coIdProducto</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>coIdMoneda</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>coNumeroOperacion</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>coCuotaCapital</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>prCalVehiculosAgrupacion</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>coCalCodigo</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>coCalAgrupacionCobranza</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>coCalAgrupacionVehiculosEstado</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>coCalAgrupacionProducto</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <ID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</ID>
              <Name>DWHRankingRentabilidadCliente</Name>
              <DimensionID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</DimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>__XL_RowNumber</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>Orden</AttributeID>
                </Attribute>
                <Attribute>
                  <AttributeID>Fecha</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>clIdCliente</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ValorActPondRiesgoPromAnual</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
                <Attribute>
                  <AttributeID>ValorUtilidadOperativa</AttributeID>
                  <AttributeHierarchyVisible>false</AttributeHierarchyVisible>
                </Attribute>
              </Attributes>
            </Dimension>
          </Dimensions>
          <CubePermissions>
            <CubePermission>
              <ID>CubePermission</ID>
              <Name>CubePermission</Name>
              <RoleID>Role</RoleID>
              <Read>Allowed</Read>
              <ReadSourceData>None</ReadSourceData>
            </CubePermission>
            <CubePermission>
              <ID>CubePermission 1</ID>
              <Name>CubePermission 1</Name>
              <RoleID>Role2</RoleID>
              <ReadSourceData>None</ReadSourceData>
            </CubePermission>
          </CubePermissions>
          <Perspectives>
            <Perspective>
              <ID>AUMS</ID>
              <Name>AUMS</Name>
              <Dimensions>
                <Dimension>
                  <CubeDimensionID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>caCodigoCanal</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCanalConsolidado</AttributeID>
                    </Attribute>
                  </Attributes>
                </Dimension>
                <Dimension>
                  <CubeDimensionID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>asCodigoSubRegion</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAsesor</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreAsesor</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoRegion</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreRegion</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreSubRegion</AttributeID>
                    </Attribute>
                  </Attributes>
                </Dimension>
                <Dimension>
                  <CubeDimensionID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>agCodigoRegion</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreRegion</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agResponsableNombre</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreAgencia</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoAgencia</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoSubregion</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreZona</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agTelefonoAgencia</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoZona</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agDireccionAgencia</AttributeID>
                    </Attribute>
                  </Attributes>
                </Dimension>
                <Dimension>
                  <CubeDimensionID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>ccCalProductoBruto</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalIndicadorNivel1</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoNivel2</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoNivel6</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalEstado</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoNivel1</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalIndicadorNivel2</AttributeID>
                    </Attribute>
                  </Attributes>
                </Dimension>
                <Dimension>
                  <CubeDimensionID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>feFecha</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinMes</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinSemana</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimMes</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimNumero</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalDia</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalAnio</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalMes</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMes</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFeriado</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFecha</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimDia</AttributeID>
                    </Attribute>
                  </Attributes>
                </Dimension>
              </Dimensions>
              <MeasureGroups>
                <MeasureGroup>
                  <MeasureGroupID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</MeasureGroupID>
                </MeasureGroup>
                <MeasureGroup>
                  <MeasureGroupID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</MeasureGroupID>
                </MeasureGroup>
                <MeasureGroup>
                  <MeasureGroupID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</MeasureGroupID>
                </MeasureGroup>
              </MeasureGroups>
              <Calculations>
                <Calculation>
                  <Name>[Measures].[ValPasivoSaldoDia]</Name>
                  <Type>Member</Type>
                </Calculation>
                <Calculation>
                  <Name>[Measures].[ValTarjetaSaldoDia]</Name>
                  <Type>Member</Type>
                </Calculation>
                <Calculation>
                  <Name>[Measures].[ValConsolidadoSaldoDia]</Name>
                  <Type>Member</Type>
                </Calculation>
                <Calculation>
                  <Name>[Measures].[ValActivoSaldoDia]</Name>
                  <Type>Member</Type>
                </Calculation>
              </Calculations>
              <Kpis>
                <Kpi>
                  <KpiID>F58884D6-41AB-4D55-AF24-DA2F46B22AEE</KpiID>
                </Kpi>
                <Kpi>
                  <KpiID>20F5D96E-87C9-49CD-9C75-4135DCEA8961</KpiID>
                </Kpi>
                <Kpi>
                  <KpiID>A45FFD6B-A360-4ED0-9556-D538BE46F2E3</KpiID>
                </Kpi>
                <Kpi>
                  <KpiID>F1B2C8B6-AD5C-4585-9C7F-4ACB30A08179</KpiID>
                </Kpi>
                <Kpi>
                  <KpiID>20D2890B-7547-4180-B98E-06D3898BA607</KpiID>
                </Kpi>
                <Kpi>
                  <KpiID>C0A13771-4196-4E81-9291-C7E7E2A48BFD</KpiID>
                </Kpi>
                <Kpi>
                  <KpiID>C5C5D5E9-E16C-475D-8B31-961B8E564FD4</KpiID>
                </Kpi>
                <Kpi>
                  <KpiID>117F4A00-4F1C-426C-B84A-6BEF5DD74A0B</KpiID>
                </Kpi>
                <Kpi>
                  <KpiID>8A0BFA43-10F1-4924-BB6F-C753FF407959</KpiID>
                </Kpi>
              </Kpis>
            </Perspective>
            <Perspective>
              <ID>COBRANZA</ID>
              <Name>COBRANZA</Name>
              <Dimensions>
                <Dimension>
                  <CubeDimensionID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>caCodigoCanal</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodDescripcionAgrupacionCanal</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caEstado</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caDescripcionCanal</AttributeID>
                    </Attribute>
                  </Attributes>
                </Dimension>
                <Dimension>
                  <CubeDimensionID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>coCalAgrupacionCobranza</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>coCalAgrupacionVehiculosEstado</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prCalVehiculosAgrupacion</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>coCalCodigo</AttributeID>
                    </Attribute>
                  </Attributes>
                </Dimension>
                <Dimension>
                  <CubeDimensionID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>prCodigoProducto</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prCalBanderaVehiculos</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prCodigoIndicador</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prSubGrupo</AttributeID>
                    </Attribute>
                  </Attributes>
                </Dimension>
                <Dimension>
                  <CubeDimensionID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>feDiaActual</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFecha</AttributeID>
                    </Attribute>
                  </Attributes>
                </Dimension>
                <Dimension>
                  <CubeDimensionID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>cpCalIndicadorNivel1</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoNivel2</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoNivel1</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalIndicadorNivel2</AttributeID>
                    </Attribute>
                  </Attributes>
                </Dimension>
                <Dimension>
                  <CubeDimensionID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>agNombreAgencia</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoAgencia</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreZona</AttributeID>
                    </Attribute>
                  </Attributes>
                </Dimension>
              </Dimensions>
              <MeasureGroups>
                <MeasureGroup>
                  <MeasureGroupID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</MeasureGroupID>
                </MeasureGroup>
              </MeasureGroups>
              <Calculations>
                <Calculation>
                  <Name>[Measures].[ValCuotaQNDIActual]</Name>
                  <Type>Member</Type>
                </Calculation>
                <Calculation>
                  <Name>[Measures].[ValCuotaVencidoActual]</Name>
                  <Type>Member</Type>
                </Calculation>
                <Calculation>
                  <Name>[Measures].[ValCuotaVencidoTotalActual]</Name>
                  <Type>Member</Type>
                </Calculation>
                <Calculation>
                  <Name>[Measures].[ValCuotaVencerActual]</Name>
                  <Type>Member</Type>
                </Calculation>
                <Calculation>
                  <Name>[Measures].[ValCuotaVencidoQNDIActual]</Name>
                  <Type>Member</Type>
                </Calculation>
              </Calculations>
            </Perspective>
            <Perspective>
              <ID>INTERES</ID>
              <Name>INTERES</Name>
              <Dimensions>
                <Dimension>
                  <CubeDimensionID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>caCodigoCanal</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodDescripcionAgrupacionCanal</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caDescripcionAgrupacionCanal</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caEstado</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caDescripcionCanal</AttributeID>
                    </Attribute>
                  </Attributes>
                </Dimension>
                <Dimension>
                  <CubeDimensionID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>cpCalIndicadorNivel1</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoNivel2</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoNivel6</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoNivel1</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalIndicadorNivel2</AttributeID>
                    </Attribute>
                  </Attributes>
                </Dimension>
                <Dimension>
                  <CubeDimensionID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>feCalDia</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalAnio</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalMes</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFecha</AttributeID>
                    </Attribute>
                  </Attributes>
                </Dimension>
              </Dimensions>
              <MeasureGroups>
                <MeasureGroup>
                  <MeasureGroupID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</MeasureGroupID>
                </MeasureGroup>
              </MeasureGroups>
              <Calculations>
                <Calculation>
                  <Name>[Measures].[ValInteresCarteraMensual]</Name>
                  <Type>Member</Type>
                </Calculation>
                <Calculation>
                  <Name>[Measures].[ValInteresCaptacionesMensual]</Name>
                  <Type>Member</Type>
                </Calculation>
                <Calculation>
                  <Name>[Measures].[ValInteresMensual]</Name>
                  <Type>Member</Type>
                </Calculation>
              </Calculations>
            </Perspective>
          </Perspectives>
          <MeasureGroups>
            <MeasureGroup>
              <ID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</ID>
              <Name>DWDCuentaContable</Name>
              <Measures>
                <Measure>
                  <ID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</ID>
                  <Name>__XL_Count DWDCuentaContable</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccIdCuentaContable</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccIdCuentaContable</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoMoneda</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoMoneda</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoIndicador</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoIndicador</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>CpEstadoProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>CpEstadoProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoNivel6</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoNivel6</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccAgrupacionContableNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccAgrupacionContableNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalIndicadorNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>cpCalIndicadorNivel1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalIndicadorNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>cpCalIndicadorNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalProductoNivel1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalProductoNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccSubGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccSubGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccTarifaTransaccion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccTarifaTransaccion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalAgrupacionRentabilidaN1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalAgrupacionRentabilidaN1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalTipoIngresoN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalTipoIngresoN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalDescripcionNivel6N3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalDescripcionNivel6N3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCodigoAgrupacionRentabilidaN1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalCodigoAgrupacionRentabilidaN1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCodigoTipoIngresoN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalCodigoTipoIngresoN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalOrdenIndicadorNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>
IF(DWDCuentaContable[cpCalIndicadorNivel1]=1 ||  DWDCuentaContable[cpCalIndicadorNivel1]=80,20,
  IF(DWDCuentaContable[cpCalIndicadorNivel1]=2,10,
      IF(DWDCuentaContable[cpCalIndicadorNivel1]=2,30,
             IF(DWDCuentaContable[cpCalIndicadorNivel1]=72,40,99))))</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalOrdenIndicadorNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>
if(DWDCuentaContable[cpCalIndicadorNivel2]=140,11,
  if(DWDCuentaContable[cpCalIndicadorNivel2]=141,12,
    if(DWDCuentaContable[cpCalIndicadorNivel2]=142,13,
      if(DWDCuentaContable[cpCalIndicadorNivel2]=120 || DWDCuentaContable[cpCalIndicadorNivel2]=126,21,
         if(DWDCuentaContable[cpCalIndicadorNivel2]=121,22,
            if(DWDCuentaContable[cpCalIndicadorNivel2]=122,23,
               if(DWDCuentaContable[cpCalIndicadorNivel2]=124,24,
                  if(DWDCuentaContable[cpCalIndicadorNivel2]=200,25,
                  if(DWDCuentaContable[cpCalIndicadorNivel2]=160,31,
                     if(DWDCuentaContable[cpCalIndicadorNivel2]=161,32,
                       if(DWDCuentaContable[cpCalIndicadorNivel2]=162,33,
                          if(DWDCuentaContable[cpCalIndicadorNivel2]=100,40,99
                          ))))))))))))
                          
                        </Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccAgrupacionTributario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccAgrupacionTributario</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalOrdenAgrupacionTributario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalBandera</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccAgrupacionRentabilidadTransaccion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccAgrupacionRentabilidadTransaccion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoBruto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCovid</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCovid</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoOperCredito</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalEstadoOpeCredito</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalAgrupacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDCuentaContable[cpCalIndicadorNivel1]=1 &amp;&amp; DWDCuentaContable[ccCovid]=TRUE() , DWDCuentaContable[ccCalDescripcionNivel6N3], 
    IF(DWDCuentaContable[cpCalIndicadorNivel1]=1  &amp;&amp; (DWDCuentaContable[cpCalIndicadorNivel2]=122 || DWDCuentaContable[cpCalIndicadorNivel2]=126) ,  UPPER(DWDCuentaContable[ccSubGrupo]),
      IF(DWDCuentaContable[cpCalIndicadorNivel1]=1  , UPPER(DWDCuentaContable[ccCalProductoNivel2]) &amp; " " &amp;  UPPER(DWDCuentaContable[ccSubGrupo]),BLANK())))

&amp; " " &amp; DWDCuentaContable[ccCalProductoCobranza]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32768</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoNivel3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32768</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoNivel3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoCobranza</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32768</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalProductoCobranza</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoIndicadorRentabilidad</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoIndicadorRentabilidad</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</ID>
                  <Name>DWDCuentaContable</Name>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT DISTINCT 
  cc.ccIdCuentaContable,
  ccCodigoNivel6=CONVERT(varchar(12), DecryptByKey(cc.ccCodigoNivel6)),
  cc.ccCodigoMoneda,
  cc.ccCodigoIndicador,  
  
  cpCalIndicadorNivel1=case when cp.indicadorNivel1 is null then cr.CpCodigoIndicadorN2 else cp.indicadorNivel1 end, -- se tiene los codigos de rentabilidad de nivel unon para el filtro en el dataset
  cpCalIndicadorNivel2=cp.indicadorNivel2, 
  --cpCalIndicadorNivel3=cp.indicadorNivel3, -- Se comento porque la informacion ya tiene la columna cc.ccCodigoIndicador

  ccCalProductoNivel1= case when cp.ProductoNivel1 is null then cc.ccFamiliaProducto else ( case when cp.indicadorNivel1 in (72,80) then 'Cartera' else cp.ProductoNivel1 end)  end,
  --ccCalProductoNivel1= case when cp.ProductoNivel1 is null then cc.ccFamiliaProducto else  cp.ProductoNivel1  end,

  ccCalProductoNivel2= case when cp.ProductoNivel2 is null then cc.ccGrupo else cp.ProductoNivel2  end,

  cp.CpEstadoProducto,
  --cp.CpOrden, Comente porque no se usa
  cc.ccAgrupacionContableNivel2,
   
  ccSubGrupo,
  ccTarifaTransaccion=ltrim(rtrim(ccCostoOperativo)),

  ccCalCodigoAgrupacionRentabilidaN1=cr.CpCodigoIndicadorN2,
  ccCalAgrupacionRentabilidaN1=ltrim(rtrim(upper(CpProducto))),
  ccCalCodigoTipoIngresoN2=cr.CpCodigoIndicadorN3,
  ccCalTipoIngresoN2=ltrim(rtrim(upper(ccTipoIngreso))),
  ccCalDescripcionNivel6N3= case when CONVERT(varchar(150), DecryptByKey(cc.ccDescripcionNivel6)) like '%SIN%DESCRIPCION%NIVEL%' then 'SIN DESCRIPCION NIVEL' 
                            else substring(CONVERT(varchar(150), DecryptByKey(cc.ccDescripcionNivel6)),14,100) end,
  
  ccAgrupacionTributario,
  ccAgrupacionRentabilidadTransaccion,
  ccCovid,
  ccCodigoNivel2,
  ccCodigoNivel3,

  ccCalProductoCobranza=case when    ccCodigoNivel2 between '1409' and '1416' or ccCodigoNivel2 between '1421' and '1424' 
								  or ccCodigoNivel2 between '1433' and '1437' or ccCodigoNivel2 between '1439' and '1440' 
								  or ccCodigoNivel2 between '1457' and '1464' or ccCodigoNivel3='149105' then 'REF'

							 when    ccCodigoNivel2 between '1417' and '1420' or ccCodigoNivel2 in ('1441','1443','1444','1465','1467','1468')
							      or ccCodigoNivel3 in ( '14948025','14958025','14968025') then 'REES' else ''
							 end,
 ccCodigoIndicadorRentabilidad

--drop table #DWDCuentaContable
--into #DWDCuentaContable

FROM DWDCuentaContable cc
left outer join
( 
    SELECT DISTINCT 
    p.CpCodigoIndicador indicadorNivel1,p1.CpCodigoIndicador indicadorNivel2,p2.CpCodigoIndicador indicadorNivel3,
    p.CpProducto ProductoNivel1,
    ProductoNivel2=case when p1.CpCodigoIndicador=124  then 'Tarjeta de Credito' else p1.CpProducto end,
    p2.CpEstadoProducto,
    isnull(p1.CpOrden,1) CpOrden
    FROM DWDClasificacionProductos p
    join DWDClasificacionProductos p1 ON p1.CpPadre=p.CpCodigoIndicador
    join DWDClasificacionProductos p2 ON p2.CpPadre=p1.CpCodigoIndicador
    WHERE p.CpCodigoIndicador in (1,2,3,72,80,73) -- Comente los indicadores 32,28 ; 72 (ficticias de ingresos); 80 (Portafolio); 73(Cont)
    and  p.CpNivel=1 and p1.CpNivel=2 and p2.CpNivel=3
    and p1.CpCodigoIndicador not in (125,143,144) -- Se excluye estas agrupaciones que no pertenecen a captaciones EA

) cp ON ccCodigoIndicador=cp.indicadorNivel3
left outer join
(
   select distinct
   CpCodigoIndicadorN4=n4.CpCodigoIndicador,
   CpCodigoIndicadorN2=n2.CpCodigoIndicador,
   CpCodigoIndicadorN3=n3.CpCodigoIndicador,
   n2.CpProducto
   from DWDClasificacionProductos n1
   inner join DWDClasificacionProductos n2 on n2.CpPadre=n1.CpCodigoIndicador
   inner join DWDClasificacionProductos n3 on n3.CpPadre=n2.CpCodigoIndicador
   inner join DWDClasificacionProductos n4 on n4.CpPadre=n3.CpCodigoIndicador
   where n1.CpCodigoIndicador=71 -- Cuentas de rentabilidad
   and n1.CpNivel=1 and n2.CpNivel=2 and n3.CpNivel=3 and n4.CpNivel=4
) as cr on cc.ccCodigoIndicadorRentabilidad=cr.CpCodigoIndicadorN4


CLOSE SYMMETRIC KEY ClaveMIS02</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ErrorConfiguration>
                    <KeyNotFound>IgnoreError</KeyNotFound>
                    <KeyDuplicate>ReportAndStop</KeyDuplicate>
                    <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
                  </ErrorConfiguration>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
            <MeasureGroup>
              <ID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</ID>
              <Name>DWDFecha</Name>
              <Measures>
                <Measure>
                  <ID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</ID>
                  <Name>__XL_Count DWDFecha</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDescripcionFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDescripcionFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalDia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalDia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimNumero</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimNumero</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimDia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimDia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFeriado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFeriado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinSemana</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinSemana</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>EsDiaAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>EsDiaAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>fecIdAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>fecIdAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>EsCierreAño</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>EsCierreAño</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feAnioAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feAnioAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaCierreAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaCierreAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFechaCierreAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFechaCierreAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDiaActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDiaActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDiaAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDiaAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feAnioAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feAnioAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feHaceUnAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feHaceUnAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinTrimestreAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinTrimestreAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMesAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMesAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFechaMesAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFechaMesAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMesTodosAnios</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMesTodosAnios</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feValorCalculoPromedio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feValorCalculoPromedio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feEsMesActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feEsMesActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feEsTrimestreActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feEsTrimestreActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnMesLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnMesLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnTrimestreLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnTrimestreLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnSemestreLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnSemestreLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnAnioLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnAnioLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHistoricoLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHistoricoLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasMesLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasMesLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasTrimLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasTrimLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasTrimFiscLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasTrimFiscLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasSemestLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasSemestLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasAnioLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasAnioLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasHistLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasHistLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimestresAnteriores</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimestresAnteriores</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierrFechAnioActFut</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierrFechAnioActFut</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAntAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAntAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierrMesAnioAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierrMesAnioAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Column1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Column1 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaTresMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaTresMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaSeisMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaSeisMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaDoceMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaDoceMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalMesAnteriorRentabilidad</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDFecha[feIdFecha]=[ValFechaMesAntRent],1,0)</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>FechaMesAntRent</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>FechaMesAntRent</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>F</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Agregar columna2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</ID>
                  <Name>DWDFecha</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;declare @FechaMesAntRent  int, @FechaInicio int, @fechaCierreAnioAntMesAct int, @FechaFin int

select @fechaCierreAnioAntMesAct=feIdFechaCierreAnioAnt
from DWDFecha 
where feDiaActual = 1

select @FechaMesAntRent = feMesAntCierr from dwdfecha where femesanterior = 1 

select @FechaInicio=feMesAntCierr from DWDFecha -- Se obtiene el mes anterior de la fecha de dos años atras --
where  feIdFecha = ( select feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 ) 

select @FechaFin=feIdFecha from DWDFecha where feDiaActual=1 -- Dia Actual --

select 
 feIdFecha
,feFecha
,feDescripcionFecha
,feCalAnio
,feCalMes
,feCalDia
,feTrimNumero
,feTrimMes
,feTrimDia
,feFeriado
,feCierreMes
,feFinMes
,feFinSemana
,EsDiaAnterior
,fecIdAnterior
,EsCierreAño
,feMesAntCierr
,feAnioAntCierr
,feIdFechaAnioAnt
,feIdFechaCierreAnioAnt
,feFechaCierreAnio
,feDiaActual
,feDiaAnterior
,feMesAnterior--
,feAnioAnterior
,feHaceUnAnio
,feFinTrimestreAnt
,feCierreMesAnterior
,feFechaMesAntCierr
,feCierreMesTodosAnios
,feValorCalculoPromedio
,feEsMesActual
,feEsTrimestreActual
,feIdFechaHaceUnMesLab
,feIdFechaHaceUnTrimestreLab
,feIdFechaHaceUnSemestreLab
,feIdFechaHaceUnAnioLab
,feIdFechaHistoricoLab
,feNumDiasMesLab
,feNumDiasTrimLab
,feNumDiasTrimFiscLab
,feNumDiasSemestLab
,feNumDiasAnioLab
,feNumDiasHistLab
,feTrimestresAnteriores
,feCierrFechAnioActFut
,feMesAntAnioAnt
,case when feCierrMesAnioAtras=1 then 1
when  feidfecha = @fechaCierreAnioAntMesAct then 2
else 0 end as feCierrMesAnioAtras
,feIdFechaTresMesAtras
,feIdFechaSeisMesAtras
,feIdFechaDoceMesAtras
,FechaMesAntRent=case when feidfecha = @FechaMesAntRent then 1 else 0 end
from DWDFecha
where feidfecha between @FechaInicio and @FechaFin
and feCierreMes=1
order by 1&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>declare @FechaMesAntRent  int, @FechaInicio int, @fechaCierreAnioAntMesAct int, @FechaFin int

select @fechaCierreAnioAntMesAct=feIdFechaCierreAnioAnt
from DWDFecha 
where feDiaActual = 1

select @FechaMesAntRent = feMesAntCierr from dwdfecha where femesanterior = 1 

select @FechaInicio=feMesAntCierr from DWDFecha -- Se obtiene el mes anterior de la fecha de dos años atras --
where  feIdFecha = ( select feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 ) 

select @FechaFin=feIdFecha from DWDFecha where feDiaActual=1 -- Dia Actual --

select 
 feIdFecha
,feFecha
,feDescripcionFecha
,feCalAnio
,feCalMes
,feCalDia
,feTrimNumero
,feTrimMes
,feTrimDia
,feFeriado
,feCierreMes
,feFinMes
,feFinSemana
,EsDiaAnterior
,fecIdAnterior
,EsCierreAño
,feMesAntCierr
,feAnioAntCierr
,feIdFechaAnioAnt
,feIdFechaCierreAnioAnt
,feFechaCierreAnio
,feDiaActual
,feDiaAnterior
,feMesAnterior--
,feAnioAnterior
,feHaceUnAnio
,feFinTrimestreAnt
,feCierreMesAnterior
,feFechaMesAntCierr
,feCierreMesTodosAnios
,feValorCalculoPromedio
,feEsMesActual
,feEsTrimestreActual
,feIdFechaHaceUnMesLab
,feIdFechaHaceUnTrimestreLab
,feIdFechaHaceUnSemestreLab
,feIdFechaHaceUnAnioLab
,feIdFechaHistoricoLab
,feNumDiasMesLab
,feNumDiasTrimLab
,feNumDiasTrimFiscLab
,feNumDiasSemestLab
,feNumDiasAnioLab
,feNumDiasHistLab
,feTrimestresAnteriores
,feCierrFechAnioActFut
,feMesAntAnioAnt
,case when feCierrMesAnioAtras=1 then 1
when  feidfecha = @fechaCierreAnioAntMesAct then 2
else 0 end as feCierrMesAnioAtras
,feIdFechaTresMesAtras
,feIdFechaSeisMesAtras
,feIdFechaDoceMesAtras
,FechaMesAntRent=case when feidfecha = @FechaMesAntRent then 1 else 0 end
from DWDFecha
where feidfecha between @FechaInicio and @FechaFin
and feCierreMes=1
order by 1</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ErrorConfiguration>
                    <KeyNotFound>IgnoreError</KeyNotFound>
                    <KeyDuplicate>ReportAndStop</KeyDuplicate>
                    <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
                  </ErrorConfiguration>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
            <MeasureGroup>
              <ID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</ID>
              <Name>DWDCanalCliente</Name>
              <Measures>
                <Measure>
                  <ID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</ID>
                  <Name>__XL_Count DWDCanalCliente</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caIdCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caIdCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodigoCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodigoCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caDescripcionAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caDescripcionAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caOrdenCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caOrdenCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caAgrupacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caAgrupacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caOrdenDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caOrdenDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodDescripcionAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodDescripcionAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCanalConsolidado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</ID>
                  <Name>DWDCanal</Name>
                  <Annotations>
                    <Annotation>
                      <Name>IsQueryEditorUsed</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                    </Annotation>
                    <Annotation>
                      <Name>TableWidgetSerialization</Name>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>SELECT [dbo].[DWDCanal].* FROM [dbo].[DWDCanal]</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ErrorConfiguration>
                    <KeyNotFound>IgnoreError</KeyNotFound>
                    <KeyDuplicate>ReportAndStop</KeyDuplicate>
                    <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
                  </ErrorConfiguration>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
            <MeasureGroup>
              <ID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</ID>
              <Name>DWDAgenciaOperacionCliente</Name>
              <Measures>
                <Measure>
                  <ID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</ID>
                  <Name>__XL_Count DWDAgenciaOperacionCliente</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agIdAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agIdAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agDireccionAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agDireccionAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agTelefonoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agTelefonoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agResponsableNombre</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agResponsableNombre</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agFechaApertura</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agFechaApertura</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agFechaClausura</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agFechaClausura</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNumeroColaboradores</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNumeroColaboradores</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agMontoInvertido</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agMontoInvertido</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoSubregion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoSubregion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoCantonCompleto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoCantonCompleto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreCanton</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreCanton</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoProvincia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoProvincia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreProvincia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreProvincia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegionDescn</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegionDescn</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreRegionDescn</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreRegionDescn</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agOrdenRegionAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agOrdenRegionAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoJefeAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoJefeAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreJefeAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreJefeAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</ID>
                  <Name>DWDAgenciaOperacion</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;Set nocount ON

select
a.agIdAgencia
,a.agCodigoAgencia
,a.agNombreAgencia
,a.agDireccionAgencia
,a.agTelefonoAgencia
,a.agResponsableNombre
,a.agFechaApertura
,a.agFechaClausura
,a.agNumeroColaboradores
,a.agMontoInvertido
,a.agCodigoZona
,a.agNombreZona
--,a.agCodigoSubregion
--,a.agNombreSubregion
,a.agCodigoRegion
,a.agNombreRegion
,a.agCodigoCantonCompleto
,a.agNombreCanton
,a.agCodigoProvincia
,a.agNombreProvincia
,a.agCodigoRegionDescn
,a.agNombreRegionDescn
,a.agOrdenRegionAsesor
,a.agEstado
,a.agCodigoJefeAgencia
,agNombreJefeAgencia= b.asNombreAsesor
,'RED' agCodigoAgrupacionCanal
,agCodigoRegional=b.asCodigoRegion
,agCodigoSubregion=b.asCodigoSubregion
from DWDAgenciaOperacion a
left outer join DWDAsesorOperacion b on a.agCodigoJefeAgencia = b.asCodigoAsesor
--where agEstado = 'R'&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>Set nocount ON

select
a.agIdAgencia
,a.agCodigoAgencia
,a.agNombreAgencia
,a.agDireccionAgencia
,a.agTelefonoAgencia
,a.agResponsableNombre
,a.agFechaApertura
,a.agFechaClausura
,a.agNumeroColaboradores
,a.agMontoInvertido
,a.agCodigoZona
,a.agNombreZona
--,a.agCodigoSubregion
--,a.agNombreSubregion
,a.agCodigoRegion
,a.agNombreRegion
,a.agCodigoCantonCompleto
,a.agNombreCanton
,a.agCodigoProvincia
,a.agNombreProvincia
,a.agCodigoRegionDescn
,a.agNombreRegionDescn
,a.agOrdenRegionAsesor
,a.agEstado
,a.agCodigoJefeAgencia
,agNombreJefeAgencia= b.asNombreAsesor
,'RED' agCodigoAgrupacionCanal
,agCodigoRegional=b.asCodigoRegion
,agCodigoSubregion=b.asCodigoSubregion
from DWDAgenciaOperacion a
left outer join DWDAsesorOperacion b on a.agCodigoJefeAgencia = b.asCodigoAsesor
--where agEstado = 'R'</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ErrorConfiguration>
                    <KeyNotFound>IgnoreError</KeyNotFound>
                    <KeyDuplicate>ReportAndStop</KeyDuplicate>
                    <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
                  </ErrorConfiguration>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
            <MeasureGroup>
              <ID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</ID>
              <Name>DWDAsesorOperacionCliente</Name>
              <Measures>
                <Measure>
                  <ID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</ID>
                  <Name>__XL_Count DWDAsesorOperacionCliente</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asIdAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asIdAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asUsuario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asUsuario</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asAsesorPrincipal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asAsesorPrincipal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asOrdenAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asOrdenAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDAsesorOperacionCliente[asCodigoAsesor] &amp; "-" &amp; DWDAsesorOperacionCliente[asNombreAsesor]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</ID>
                  <Name>DWDAsesorOperacion</Name>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>Set nocount ON

select 
a.asIdAsesor
,a.asCodigoAsesor
,a.asNombreAsesor
,a.asUsuario
,asCodigoAgrupacionCanal=case when asNombreAsesor like '%SIN%ASESOR%' or ltrim(rtrim(asCodigoAsesor))='GRA' then 'NDF' else c.caCodigoAgrupacionCanal end
,a.asNombreCanal
,a.asAsesorPrincipal
,a.asCodigoAgencia
,a.asNombreAgencia
,a.asEstado
,a.asOrdenAsesor
,asCodigoRegion=b.agCodigoRegion
,asNombreRegion=b.agNombreRegion
,asCodigoZona=b.agCodigoZona
,asNombreZona=b.agNombreZona
,asCodigoRegional=a.asCodigoRegion
,asNombreRegional=a.asNombreRegion
,a.asCodigoSubregion
,a.asNombreSubregion
from DWDAsesorOperacion a
left join DWDAgenciaOperacion b on a.asCodigoAgencia = b.agCodigoAgencia
inner join DWDCanal c on a.asCodigoCanal = c.caCodigoCanal 


/*Set nocount ON

select 
a.asIdAsesor
,a.asCodigoAsesor
,a.asNombreAsesor
,a.asUsuario
--,a.asCodigoCanal
,c.caCodigoAgrupacionCanal
,a.asNombreCanal
,a.asAsesorPrincipal
,a.asCodigoAgencia
,a.asNombreAgencia
,a.asEstado
,a.asOrdenAsesor
,b.agCodigoRegion
,b.agNombreRegion
,b.agCodigoZona
,b.agNombreZona
,a.asCodigoRegion
,a.asNombreRegion
from DWDAsesorOperacion a
left join DWDAgenciaOperacion b on a.asCodigoAgencia = b.agCodigoAgencia
inner join DWDCanal c on a.asCodigoCanal = c.caCodigoCanal 
--where a.asEstado=1 
--and c.caCodigoAgrupacionCanal in ('COR','ESP','TES')*/</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ErrorConfiguration>
                    <KeyNotFound>IgnoreError</KeyNotFound>
                    <KeyDuplicate>ReportAndStop</KeyDuplicate>
                    <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
                  </ErrorConfiguration>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
            <MeasureGroup>
              <ID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</ID>
              <Name>DWDCliente</Name>
              <Measures>
                <Measure>
                  <ID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</ID>
                  <Name>__XL_Count DWDCliente</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clCodigoCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clNombreCompleto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clNombreCompleto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdAsesorPrincipal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdAsesorPrincipal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clVinculacionValor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clVinculacionValor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clCodigoGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clFechaFin</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clFechaFin</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdSegmentacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdSegmentacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCalClienteDesde</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clCalClienteDesde</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>CanalCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoAgencia])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreRegion])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreZona])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAsesorOperacionCliente[asNombreAsesor])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clSegmentacionTipoCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clSegmentacionTipoCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ClCodigoCliente1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 4</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDCliente[clCodigoCliente] &amp; "-" &amp; DWDCliente[clNombreCompleto]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 5</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED('DWDAsesorOperacionCliente'[asCodigoAsesor])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDCanalCliente[caCodigoAgrupacionCanal])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoAgencia])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoZona])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoRegion])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoRegion 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoRegional])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoSubregion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoSubregion])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clFechaIngreso</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clFechaIngreso</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caIdCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caIdCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodigoCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodigoCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caDescripcionAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caDescripcionAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caOrdenCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caOrdenCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caAgrupacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caAgrupacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caOrdenDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caOrdenDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodDescripcionAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodDescripcionAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCanalConsolidado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdCanal</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>1df0b318-cd0b-42dc-8632-fe0e895dd652</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agIdAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agIdAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agDireccionAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agDireccionAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agTelefonoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agTelefonoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agResponsableNombre</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agResponsableNombre</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agFechaApertura</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agFechaApertura</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agFechaClausura</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agFechaClausura</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNumeroColaboradores</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNumeroColaboradores</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agMontoInvertido</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agMontoInvertido</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoSubregion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoSubregion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoCantonCompleto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoCantonCompleto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreCanton</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreCanton</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoProvincia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoProvincia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreProvincia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreProvincia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegionDescn</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegionDescn</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreRegionDescn</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreRegionDescn</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agOrdenRegionAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agOrdenRegionAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoJefeAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoJefeAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreJefeAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreJefeAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdAgencia</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>101f6faa-d6b5-4794-bc99-7f2128495c8d</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asIdAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asIdAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asUsuario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asUsuario</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asAsesorPrincipal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asAsesorPrincipal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asOrdenAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asOrdenAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDAsesorOperacionCliente[asCodigoAsesor] &amp; "-" &amp; DWDAsesorOperacionCliente[asNombreAsesor]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdAsesorPrincipal</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>bf3db671-982b-4f8b-aa28-4b4970c164f9</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scIdSegmentacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scIdSegmentacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scIdCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scIdCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scDetalleCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scDetalleCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scDetalleNombre</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scDetalleNombre</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionTipoCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionTipoCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionTipo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionTipo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrden</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrden</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrdenN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrdenN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrdenN3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrdenN3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdSegmentacionCliente</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>1f2909a1-2e55-4995-baeb-256f7e9d6935</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baIdBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baIdBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baCodigoBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baCodigoBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baDescripcionBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baDescripcionBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdBanca</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>c70196b5-f7ef-4e1f-91fe-15172d035d8a</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grIdentificacionGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grIdentificacionGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grNombreGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grNombreGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAgrCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAgrCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grNombreAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grNombreAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clCodigoGrupo</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>7c08be2b-53c5-4ed1-b190-971d2fd8a2b6</ddl300:RelationshipID>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</ID>
                  <Name>DWDCliente</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;select
clIdCliente
,clCodigoCliente
,clNombreCompleto
,clIdCanal
,clIdAsesorPrincipal
,clIdAgencia
,clVinculacionValor
,clCodigoGrupo
,clGrupo
,clEstado
,clIdBanca
,clIdSegmentacionCliente
,concat(year(getdate())-left(clFechaIngreso,4),' año(s) ') clCalClienteDesde
,clFechaFin
,clSegmentacionTipoCliente
,clFechaIngreso
from DWDCliente&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>select
clIdCliente
,clCodigoCliente
,clNombreCompleto
,clIdCanal
,clIdAsesorPrincipal
,clIdAgencia
,clVinculacionValor
,clCodigoGrupo
,clGrupo
,clEstado
,clIdBanca
,clIdSegmentacionCliente
,concat(year(getdate())-left(clFechaIngreso,4),' año(s) ') clCalClienteDesde
,clFechaFin
,clSegmentacionTipoCliente
,clFechaIngreso
from DWDCliente</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ErrorConfiguration>
                    <KeyNotFound>IgnoreError</KeyNotFound>
                    <KeyDuplicate>ReportAndStop</KeyDuplicate>
                    <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
                  </ErrorConfiguration>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
            <MeasureGroup>
              <ID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</ID>
              <Name>DWHPasivoOperacion</Name>
              <Measures>
                <Measure>
                  <ID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</ID>
                  <Name>__XL_Count DWHPasivoOperacion</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPasivoOperacion</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>poIdFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                            <ColumnID>poIdFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>poIdCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                            <ColumnID>poIdCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>poIdCuentaContable</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                            <ColumnID>poIdCuentaContable</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>poSaldoOperacionUSD</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                            <ColumnID>poSaldoOperacionUSD</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>poSaldoAcumuladoAnual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                            <ColumnID>poSaldoAcumuladoAnual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>poSaldoPromedioAnual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                            <ColumnID>poSaldoPromedioAnual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>poValorActPondRiesgoPromAnual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                            <ColumnID>poValorActPondRiesgoPromAnual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>poValorComision</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                            <ColumnID>poValorComision</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>poValorIngresoServicio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                            <ColumnID>poValorIngresoServicio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>poNumeroTransaccionesAnual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                            <ColumnID>poNumeroTransaccionesAnual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>poValorCostoOperativo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                            <ColumnID>poValorCostoOperativo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>poValorOperacionFinanciera</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                            <ColumnID>poValorOperacionFinanciera</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>poValorInteresRealAnual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                            <ColumnID>poValorInteresRealAnual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>poValorInteresTasaPool</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                            <ColumnID>poValorInteresTasaPool</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>poValorMargenFinanciero</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                            <ColumnID>poValorMargenFinanciero</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>poValorMargenBancarioBasico</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                            <ColumnID>poValorMargenBancarioBasico</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>poValorMargenOrdinario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                            <ColumnID>poValorMargenOrdinario</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>poValorMargenExplotacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                            <ColumnID>poValorMargenExplotacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>poValorUtilidadOperativa</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                            <ColumnID>poValorUtilidadOperativa</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>poSaldoAcumuladoMensualFiscal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                            <ColumnID>poSaldoAcumuladoMensualFiscal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>poCuentaAperturada</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</TableID>
                            <ColumnID>poCuentaAperturada</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDescripcionFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDescripcionFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalDia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalDia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimNumero</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimNumero</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimDia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimDia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFeriado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFeriado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinSemana</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinSemana</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>EsDiaAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>EsDiaAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>fecIdAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>fecIdAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>EsCierreAño</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>EsCierreAño</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feAnioAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feAnioAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaCierreAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaCierreAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFechaCierreAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFechaCierreAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDiaActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDiaActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDiaAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDiaAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feAnioAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feAnioAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feHaceUnAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feHaceUnAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinTrimestreAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinTrimestreAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMesAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMesAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFechaMesAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFechaMesAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMesTodosAnios</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMesTodosAnios</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feValorCalculoPromedio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feValorCalculoPromedio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feEsMesActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feEsMesActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feEsTrimestreActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feEsTrimestreActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnMesLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnMesLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnTrimestreLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnTrimestreLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnSemestreLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnSemestreLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnAnioLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnAnioLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHistoricoLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHistoricoLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasMesLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasMesLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasTrimLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasTrimLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasTrimFiscLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasTrimFiscLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasSemestLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasSemestLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasAnioLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasAnioLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasHistLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasHistLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimestresAnteriores</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimestresAnteriores</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierrFechAnioActFut</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierrFechAnioActFut</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAntAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAntAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierrMesAnioAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierrMesAnioAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Column1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Column1 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaTresMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaTresMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaSeisMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaSeisMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaDoceMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaDoceMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalMesAnteriorRentabilidad</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDFecha[feIdFecha]=[ValFechaMesAntRent],1,0)</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>FechaMesAntRent</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>FechaMesAntRent</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>F</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Agregar columna2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>poIdFecha</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>93439458-7936-442d-a92f-c5741d518c39</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clCodigoCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clNombreCompleto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clNombreCompleto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdAsesorPrincipal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdAsesorPrincipal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clVinculacionValor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clVinculacionValor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clCodigoGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clFechaFin</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clFechaFin</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdSegmentacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdSegmentacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCalClienteDesde</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clCalClienteDesde</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>CanalCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoAgencia])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreRegion])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreZona])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAsesorOperacionCliente[asNombreAsesor])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clSegmentacionTipoCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clSegmentacionTipoCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ClCodigoCliente1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 4</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDCliente[clCodigoCliente] &amp; "-" &amp; DWDCliente[clNombreCompleto]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 5</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED('DWDAsesorOperacionCliente'[asCodigoAsesor])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDCanalCliente[caCodigoAgrupacionCanal])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoAgencia])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoZona])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoRegion])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoRegion 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoRegional])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoSubregion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoSubregion])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clFechaIngreso</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clFechaIngreso</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>poIdCliente</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>2d9daa2d-0280-427e-89bc-0bcd4781eca8</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caIdCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caIdCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodigoCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodigoCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caDescripcionAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caDescripcionAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caOrdenCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caOrdenCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caAgrupacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caAgrupacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caOrdenDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caOrdenDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodDescripcionAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodDescripcionAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCanalConsolidado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdCanal</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agIdAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agIdAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agDireccionAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agDireccionAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agTelefonoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agTelefonoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agResponsableNombre</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agResponsableNombre</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agFechaApertura</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agFechaApertura</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agFechaClausura</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agFechaClausura</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNumeroColaboradores</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNumeroColaboradores</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agMontoInvertido</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agMontoInvertido</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoSubregion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoSubregion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoCantonCompleto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoCantonCompleto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreCanton</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreCanton</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoProvincia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoProvincia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreProvincia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreProvincia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegionDescn</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegionDescn</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreRegionDescn</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreRegionDescn</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agOrdenRegionAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agOrdenRegionAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoJefeAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoJefeAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreJefeAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreJefeAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdAgencia</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccIdCuentaContable</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccIdCuentaContable</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoMoneda</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoMoneda</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoIndicador</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoIndicador</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>CpEstadoProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>CpEstadoProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoNivel6</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoNivel6</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccAgrupacionContableNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccAgrupacionContableNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalIndicadorNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>cpCalIndicadorNivel1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalIndicadorNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>cpCalIndicadorNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalProductoNivel1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalProductoNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccSubGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccSubGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccTarifaTransaccion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccTarifaTransaccion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalAgrupacionRentabilidaN1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalAgrupacionRentabilidaN1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalTipoIngresoN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalTipoIngresoN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalDescripcionNivel6N3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalDescripcionNivel6N3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCodigoAgrupacionRentabilidaN1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalCodigoAgrupacionRentabilidaN1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCodigoTipoIngresoN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalCodigoTipoIngresoN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalOrdenIndicadorNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>
IF(DWDCuentaContable[cpCalIndicadorNivel1]=1 ||  DWDCuentaContable[cpCalIndicadorNivel1]=80,20,
  IF(DWDCuentaContable[cpCalIndicadorNivel1]=2,10,
      IF(DWDCuentaContable[cpCalIndicadorNivel1]=2,30,
             IF(DWDCuentaContable[cpCalIndicadorNivel1]=72,40,99))))</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalOrdenIndicadorNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>
if(DWDCuentaContable[cpCalIndicadorNivel2]=140,11,
  if(DWDCuentaContable[cpCalIndicadorNivel2]=141,12,
    if(DWDCuentaContable[cpCalIndicadorNivel2]=142,13,
      if(DWDCuentaContable[cpCalIndicadorNivel2]=120 || DWDCuentaContable[cpCalIndicadorNivel2]=126,21,
         if(DWDCuentaContable[cpCalIndicadorNivel2]=121,22,
            if(DWDCuentaContable[cpCalIndicadorNivel2]=122,23,
               if(DWDCuentaContable[cpCalIndicadorNivel2]=124,24,
                  if(DWDCuentaContable[cpCalIndicadorNivel2]=200,25,
                  if(DWDCuentaContable[cpCalIndicadorNivel2]=160,31,
                     if(DWDCuentaContable[cpCalIndicadorNivel2]=161,32,
                       if(DWDCuentaContable[cpCalIndicadorNivel2]=162,33,
                          if(DWDCuentaContable[cpCalIndicadorNivel2]=100,40,99
                          ))))))))))))
                          
                        </Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccAgrupacionTributario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccAgrupacionTributario</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalOrdenAgrupacionTributario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalBandera</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccAgrupacionRentabilidadTransaccion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccAgrupacionRentabilidadTransaccion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoBruto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCovid</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCovid</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoOperCredito</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalEstadoOpeCredito</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalAgrupacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDCuentaContable[cpCalIndicadorNivel1]=1 &amp;&amp; DWDCuentaContable[ccCovid]=TRUE() , DWDCuentaContable[ccCalDescripcionNivel6N3], 
    IF(DWDCuentaContable[cpCalIndicadorNivel1]=1  &amp;&amp; (DWDCuentaContable[cpCalIndicadorNivel2]=122 || DWDCuentaContable[cpCalIndicadorNivel2]=126) ,  UPPER(DWDCuentaContable[ccSubGrupo]),
      IF(DWDCuentaContable[cpCalIndicadorNivel1]=1  , UPPER(DWDCuentaContable[ccCalProductoNivel2]) &amp; " " &amp;  UPPER(DWDCuentaContable[ccSubGrupo]),BLANK())))

&amp; " " &amp; DWDCuentaContable[ccCalProductoCobranza]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32768</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoNivel3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32768</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoNivel3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoCobranza</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32768</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalProductoCobranza</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoIndicadorRentabilidad</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoIndicadorRentabilidad</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>poIdCuentaContable</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>ffb0c8a6-40bb-447b-a8b0-5f77a0448931</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asIdAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asIdAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asUsuario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asUsuario</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asAsesorPrincipal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asAsesorPrincipal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asOrdenAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asOrdenAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDAsesorOperacionCliente[asCodigoAsesor] &amp; "-" &amp; DWDAsesorOperacionCliente[asNombreAsesor]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdAsesorPrincipal</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scIdSegmentacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scIdSegmentacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scIdCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scIdCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scDetalleCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scDetalleCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scDetalleNombre</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scDetalleNombre</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionTipoCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionTipoCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionTipo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionTipo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrden</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrden</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrdenN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrdenN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrdenN3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrdenN3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdSegmentacionCliente</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baIdBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baIdBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baCodigoBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baCodigoBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baDescripcionBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baDescripcionBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdBanca</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grIdentificacionGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grIdentificacionGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grNombreGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grNombreGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAgrCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAgrCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grNombreAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grNombreAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clCodigoGrupo</IntermediateGranularityAttributeID>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>DWHPasivoOperacion_1dcfe50c-759d-4f9d-aac4-acbab230c0c8</ID>
                  <Name>DWHPasivoOperacion_Diaria</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @FechaActual int

select @FechaActual=feIdFecha from DWDFecha where feDiaActual=1

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=0 
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=0 

,poValorComision=0 
,poValorIngresoServicio=0
,poNumeroTransaccionesAnual=0 
,poValorCostoOperativo=0 
,poValorOperacionFinanciera=0
,poValorInteresRealAnual=0

,poValorInteresTasaPool=0
,poValorMargenFinanciero=0
,poValorMargenBancarioBasico=0
,poValorMargenOrdinario=0
,poValorMargenExplotacion=0
,poValorUtilidadOperativa=0

,poSaldoAcumuladoMensualFiscal=0
,poCuentaAperturada = 0
from DWHPasivoOperacionMes po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
where poIdFecha=@FechaActual
group by poIdFecha
,poIdCliente
,poIdCuentaContable&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @FechaActual int

select @FechaActual=feIdFecha from DWDFecha where feDiaActual=1

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=0 
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=0 

,poValorComision=0 
,poValorIngresoServicio=0
,poNumeroTransaccionesAnual=0 
,poValorCostoOperativo=0 
,poValorOperacionFinanciera=0
,poValorInteresRealAnual=0

,poValorInteresTasaPool=0
,poValorMargenFinanciero=0
,poValorMargenBancarioBasico=0
,poValorMargenOrdinario=0
,poValorMargenExplotacion=0
,poValorUtilidadOperativa=0

,poSaldoAcumuladoMensualFiscal=0
,poCuentaAperturada = 0
from DWHPasivoOperacionMes po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
where poIdFecha=@FechaActual
group by poIdFecha
,poIdCliente
,poIdCuentaContable</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
                <Partition>
                  <ID>DWHPasivoOperacion_261f5411-a810-4e10-b528-95e89dab0708</ID>
                  <Name>DWHPasivoOperacion_Enero</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=1

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios

/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) + (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) ) 
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=1

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios

/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) + (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) ) 
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHPasivoOperacion_b14b5857-582a-4251-a503-42acee667913</ID>
                  <Name>DWHPasivoOperacion_Febrero</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=2

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios

/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) + (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=2

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios

/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) + (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHPasivoOperacion_3dde25f6-87ab-4107-b31c-65d3e4c059f2</ID>
                  <Name>DWHPasivoOperacion_Marzo</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=3

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios

/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) + (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=3

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios

/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) + (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHPasivoOperacion_3c74a121-aa5f-4d5f-a99c-c24e2da6bea3</ID>
                  <Name>DWHPasivoOperacion_Abril</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=4

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios

/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) + (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=4

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios

/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) + (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHPasivoOperacion_0737b9e9-12e7-4c5a-b329-dd4959d2d63b</ID>
                  <Name>DWHPasivoOperacion_Mayo</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=5

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios

/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) + (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=5

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios

/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) + (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHPasivoOperacion_efd8939b-a54d-4001-a8b4-e84a9cd07981</ID>
                  <Name>DWHPasivoOperacion_Junio</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=6

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios

/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) + (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=6

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios

/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) + (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHPasivoOperacion_a4673ffb-13ca-44fe-b348-2f24fe88e51a</ID>
                  <Name>DWHPasivoOperacion_Julio</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=7

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios

/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) + (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=7

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios

/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) + (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHPasivoOperacion_bf955d8b-9754-455c-ba1b-d906f5a59d5c</ID>
                  <Name>DWHPasivoOperacion_Agosto</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=8

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios

/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) + (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=8

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios

/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) + (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHPasivoOperacion_63ebe218-2cd8-4dd8-bb38-78060f73be6b</ID>
                  <Name>DWHPasivoOperacion_Septiembre</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=9

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios

/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) + (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=9

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios

/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) + (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHPasivoOperacion_30d12234-8226-43e1-8cc8-f494911eca29</ID>
                  <Name>DWHPasivoOperacion_Octubre</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=10

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios

/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) + (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=10

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios

/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) + (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHPasivoOperacion_20d70fe9-1307-4fac-9f65-58c3cb6ef9ac</ID>
                  <Name>DWHPasivoOperacion_Noviembre</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=11

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios

/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) + (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=11

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios

/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) + (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHPasivoOperacion_b276b6ee-e4d7-4244-bb6e-e50e064b7083</ID>
                  <Name>DWHPasivoOperacion_Diciembre</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=12

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios

/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) + (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int

set @Mes=12

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes

/*----- Cuenta Contable Ctas Ahorro y Credito -----*/

if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)
into #DWDCuentaContable
from DWDCuentaContable cc
inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3
where indicadorNivel1=2 -- Captaciones
union 
select distinct
ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=0
from DWDCuentaContable cc
where cc.ccCodigoIndicador=699 -- Cuenta Servicios

/*----- Pasivo Operacion -----*/

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end 

select
 poIdFecha
,poIdCliente
,poIdCuentaContable
,poSaldoOperacionUSD
,poSaldoAcumuladoAnual
,poSaldoPromedioAnual
,poValorActPondRiesgoPromAnual
,poValorComision
,poValorIngresoServicio
,poNumeroTransaccionesAnual
,poValorCostoOperativo
,poValorOperacionFinanciera
,poValorInteresRealAnual
,poValorInteresTasaPool
,poValorMargenFinanciero
,poValorMargenBancarioBasico
,poValorMargenOrdinario
,poValorMargenExplotacion
,poValorUtilidadOperativa
,poSaldoAcumuladoMensualFiscal
,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end 
into #PasivoOperacion
from DWHPasivoOperacion po
inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha


select
 poIdFecha
,poIdCliente
,poIdCuentaContable

,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))
,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))
,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))
,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))

,poValorComision=sum(isnull(poValorComision,0))
,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))
,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))
,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) + (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  
,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))
,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))
,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))
,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))
,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))
,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))
,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo
,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))
,poCuentaAperturada
from #PasivoOperacion po
inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdFecha
,poIdCliente
,poIdCuentaContable
,poCuentaAperturada

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 
if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end
if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
            <MeasureGroup>
              <ID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</ID>
              <Name>DWHTarjetaCreditoOperacion</Name>
              <Measures>
                <Measure>
                  <ID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</ID>
                  <Name>__XL_Count DWHTarjetaCreditoOperacion</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoIdFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoIdFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoIdCuentaContable</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoIdCuentaContable</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoIdProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoIdProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoIdCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoIdCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoNumeroOperacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoNumeroOperacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoSaldo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoSaldo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoSaldoAcumuladoAnual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoSaldoAcumuladoAnual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoSaldoPromedioAnual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoSaldoPromedioAnual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoValorActPondRiesgoPromAnual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoValorActPondRiesgoPromAnual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoValorComision</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoValorComision</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoValorIngresoServicio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoValorIngresoServicio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoValorOperacionFinanciera</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoValorOperacionFinanciera</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoValorInteresRealAnual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoValorInteresRealAnual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoValorInteresTasaPool</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoValorInteresTasaPool</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoValorMargenFinanciero</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoValorMargenFinanciero</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoValorMargenBancarioBasico</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoValorMargenBancarioBasico</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoValorMargenOrdinario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoValorMargenOrdinario</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoValorMargenExplotacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoValorMargenExplotacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoValorUtilidadOperativa</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoValorUtilidadOperativa</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoValorCostoOperativo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoValorCostoOperativo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoValorPerdidaEsperada</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoValorPerdidaEsperada</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoNumeroTransaccionesAnual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoNumeroTransaccionesAnual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoTasaEfectiva</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoTasaEfectiva</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoIdCalificacionOperacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoIdCalificacionOperacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoIdTarjeta</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoIdTarjeta</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoValorPorcentajePerdidaEsperada</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoValorPorcentajePerdidaEsperada</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>tcoSaldoAcumuladoMensualFiscal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</TableID>
                            <ColumnID>tcoSaldoAcumuladoMensualFiscal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDescripcionFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDescripcionFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalDia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalDia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimNumero</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimNumero</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimDia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimDia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFeriado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFeriado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinSemana</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinSemana</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>EsDiaAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>EsDiaAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>fecIdAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>fecIdAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>EsCierreAño</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>EsCierreAño</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feAnioAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feAnioAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaCierreAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaCierreAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFechaCierreAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFechaCierreAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDiaActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDiaActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDiaAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDiaAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feAnioAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feAnioAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feHaceUnAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feHaceUnAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinTrimestreAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinTrimestreAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMesAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMesAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFechaMesAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFechaMesAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMesTodosAnios</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMesTodosAnios</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feValorCalculoPromedio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feValorCalculoPromedio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feEsMesActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feEsMesActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feEsTrimestreActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feEsTrimestreActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnMesLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnMesLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnTrimestreLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnTrimestreLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnSemestreLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnSemestreLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnAnioLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnAnioLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHistoricoLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHistoricoLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasMesLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasMesLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasTrimLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasTrimLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasTrimFiscLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasTrimFiscLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasSemestLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasSemestLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasAnioLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasAnioLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasHistLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasHistLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimestresAnteriores</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimestresAnteriores</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierrFechAnioActFut</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierrFechAnioActFut</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAntAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAntAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierrMesAnioAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierrMesAnioAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Column1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Column1 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaTresMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaTresMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaSeisMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaSeisMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaDoceMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaDoceMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalMesAnteriorRentabilidad</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDFecha[feIdFecha]=[ValFechaMesAntRent],1,0)</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>FechaMesAntRent</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>FechaMesAntRent</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>F</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Agregar columna2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>tcoIdFecha</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>8d290665-7d3e-4b4e-9834-b8bb24a707c0</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccIdCuentaContable</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccIdCuentaContable</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoMoneda</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoMoneda</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoIndicador</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoIndicador</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>CpEstadoProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>CpEstadoProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoNivel6</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoNivel6</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccAgrupacionContableNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccAgrupacionContableNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalIndicadorNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>cpCalIndicadorNivel1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalIndicadorNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>cpCalIndicadorNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalProductoNivel1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalProductoNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccSubGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccSubGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccTarifaTransaccion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccTarifaTransaccion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalAgrupacionRentabilidaN1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalAgrupacionRentabilidaN1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalTipoIngresoN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalTipoIngresoN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalDescripcionNivel6N3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalDescripcionNivel6N3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCodigoAgrupacionRentabilidaN1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalCodigoAgrupacionRentabilidaN1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCodigoTipoIngresoN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalCodigoTipoIngresoN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalOrdenIndicadorNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>
IF(DWDCuentaContable[cpCalIndicadorNivel1]=1 ||  DWDCuentaContable[cpCalIndicadorNivel1]=80,20,
  IF(DWDCuentaContable[cpCalIndicadorNivel1]=2,10,
      IF(DWDCuentaContable[cpCalIndicadorNivel1]=2,30,
             IF(DWDCuentaContable[cpCalIndicadorNivel1]=72,40,99))))</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalOrdenIndicadorNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>
if(DWDCuentaContable[cpCalIndicadorNivel2]=140,11,
  if(DWDCuentaContable[cpCalIndicadorNivel2]=141,12,
    if(DWDCuentaContable[cpCalIndicadorNivel2]=142,13,
      if(DWDCuentaContable[cpCalIndicadorNivel2]=120 || DWDCuentaContable[cpCalIndicadorNivel2]=126,21,
         if(DWDCuentaContable[cpCalIndicadorNivel2]=121,22,
            if(DWDCuentaContable[cpCalIndicadorNivel2]=122,23,
               if(DWDCuentaContable[cpCalIndicadorNivel2]=124,24,
                  if(DWDCuentaContable[cpCalIndicadorNivel2]=200,25,
                  if(DWDCuentaContable[cpCalIndicadorNivel2]=160,31,
                     if(DWDCuentaContable[cpCalIndicadorNivel2]=161,32,
                       if(DWDCuentaContable[cpCalIndicadorNivel2]=162,33,
                          if(DWDCuentaContable[cpCalIndicadorNivel2]=100,40,99
                          ))))))))))))
                          
                        </Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccAgrupacionTributario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccAgrupacionTributario</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalOrdenAgrupacionTributario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalBandera</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccAgrupacionRentabilidadTransaccion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccAgrupacionRentabilidadTransaccion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoBruto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCovid</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCovid</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoOperCredito</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalEstadoOpeCredito</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalAgrupacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDCuentaContable[cpCalIndicadorNivel1]=1 &amp;&amp; DWDCuentaContable[ccCovid]=TRUE() , DWDCuentaContable[ccCalDescripcionNivel6N3], 
    IF(DWDCuentaContable[cpCalIndicadorNivel1]=1  &amp;&amp; (DWDCuentaContable[cpCalIndicadorNivel2]=122 || DWDCuentaContable[cpCalIndicadorNivel2]=126) ,  UPPER(DWDCuentaContable[ccSubGrupo]),
      IF(DWDCuentaContable[cpCalIndicadorNivel1]=1  , UPPER(DWDCuentaContable[ccCalProductoNivel2]) &amp; " " &amp;  UPPER(DWDCuentaContable[ccSubGrupo]),BLANK())))

&amp; " " &amp; DWDCuentaContable[ccCalProductoCobranza]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32768</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoNivel3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32768</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoNivel3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoCobranza</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32768</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalProductoCobranza</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoIndicadorRentabilidad</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoIndicadorRentabilidad</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>tcoIdCuentaContable</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>e5746a2f-8cd3-4021-9444-3cdd16957e2a</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clCodigoCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clNombreCompleto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clNombreCompleto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdAsesorPrincipal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdAsesorPrincipal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clVinculacionValor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clVinculacionValor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clCodigoGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clFechaFin</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clFechaFin</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdSegmentacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdSegmentacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCalClienteDesde</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clCalClienteDesde</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>CanalCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoAgencia])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreRegion])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreZona])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAsesorOperacionCliente[asNombreAsesor])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clSegmentacionTipoCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clSegmentacionTipoCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ClCodigoCliente1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 4</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDCliente[clCodigoCliente] &amp; "-" &amp; DWDCliente[clNombreCompleto]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 5</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED('DWDAsesorOperacionCliente'[asCodigoAsesor])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDCanalCliente[caCodigoAgrupacionCanal])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoAgencia])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoZona])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoRegion])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoRegion 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoRegional])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoSubregion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoSubregion])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clFechaIngreso</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clFechaIngreso</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>tcoIdCliente</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>980d9663-737e-44ab-8920-db4eacc33b12</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caIdCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caIdCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodigoCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodigoCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caDescripcionAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caDescripcionAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caOrdenCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caOrdenCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caAgrupacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caAgrupacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caOrdenDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caOrdenDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodDescripcionAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodDescripcionAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCanalConsolidado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdCanal</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agIdAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agIdAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agDireccionAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agDireccionAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agTelefonoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agTelefonoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agResponsableNombre</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agResponsableNombre</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agFechaApertura</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agFechaApertura</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agFechaClausura</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agFechaClausura</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNumeroColaboradores</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNumeroColaboradores</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agMontoInvertido</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agMontoInvertido</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoSubregion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoSubregion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoCantonCompleto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoCantonCompleto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreCanton</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreCanton</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoProvincia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoProvincia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreProvincia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreProvincia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegionDescn</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegionDescn</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreRegionDescn</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreRegionDescn</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agOrdenRegionAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agOrdenRegionAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoJefeAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoJefeAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreJefeAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreJefeAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdAgencia</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asIdAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asIdAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asUsuario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asUsuario</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asAsesorPrincipal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asAsesorPrincipal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asOrdenAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asOrdenAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDAsesorOperacionCliente[asCodigoAsesor] &amp; "-" &amp; DWDAsesorOperacionCliente[asNombreAsesor]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdAsesorPrincipal</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scIdSegmentacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scIdSegmentacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scIdCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scIdCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scDetalleCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scDetalleCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scDetalleNombre</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scDetalleNombre</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionTipoCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionTipoCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionTipo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionTipo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrden</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrden</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrdenN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrdenN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrdenN3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrdenN3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdSegmentacionCliente</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baIdBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baIdBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baCodigoBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baCodigoBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baDescripcionBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baDescripcionBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdBanca</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cocIdCalificacionOperacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</TableID>
                            <ColumnID>cocIdCalificacionOperacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cocCodigoCalificacionOperacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</TableID>
                            <ColumnID>cocCodigoCalificacionOperacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cocCalificacionOperacionCiente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</TableID>
                            <ColumnID>cocCalificacionOperacionCiente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>tcoIdCalificacionOperacionCliente</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>caea6a6f-7058-457e-904d-f19f1dcc0ff6</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grIdentificacionGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grIdentificacionGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grNombreGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grNombreGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAgrCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAgrCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grNombreAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grNombreAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clCodigoGrupo</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taIdTarjeta</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taIdTarjeta</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taCuenta</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taCuenta</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taIdCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taIdCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taIdEstadoTarjeta</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taIdEstadoTarjeta</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taNumeroTarjeta</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taNumeroTarjeta</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taIndicadorEsPrincipal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taIndicadorEsPrincipal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taEstadoActivo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taEstadoActivo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taBandera</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taBandera</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taGama</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taGama</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>tcoIdTarjeta</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>8f2e5e52-1181-43b5-8342-d814ff4498a2</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prIdProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prIdProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prCodigoProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prCodigoProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prSubGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prSubGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prFamiliaProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prFamiliaProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prVehiculo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prVehiculo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prCodigoIndicador</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prCodigoIndicador</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prOrdenN1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prOrdenN1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prOrdenN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prOrdenN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prOrdenN3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prOrdenN3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prDescripcionProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prDescripcionProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prTipoProductoAUMS</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prTipoProductoAUMS</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prCalBanderaVehiculos</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDProducto[prVehiculo]="Vehiculos",DWDProducto[prVehiculo],"Sin Vehiculos")</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>tcoIdProducto</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>a9a0c436-cfba-4327-a5b6-144b0b68f12e</ddl300:RelationshipID>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>DWHTarjetaCreditoOperacion_90139be1-88bc-4ef7-8643-d8e89e936517</ID>
                  <Name>DWHTarjetaCreditoOperacion_Diaria</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @FechaActual int, @tasaEfectiva float

/* Fecha */

select @FechaActual=feIdFecha from DWDFecha where feDiaActual=1

/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante)
from DWDConstanteOperacion
where copCodigoConstante = 15

/* Tarjeta Credito */

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)

,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)
,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion
where tcoIdFecha=@FechaActual

CLOSE SYMMETRIC KEY ClaveMIS02&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @FechaActual int, @tasaEfectiva float

/* Fecha */

select @FechaActual=feIdFecha from DWDFecha where feDiaActual=1

/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante)
from DWDConstanteOperacion
where copCodigoConstante = 15

/* Tarjeta Credito */

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)

,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)
,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion
where tcoIdFecha=@FechaActual

CLOSE SYMMETRIC KEY ClaveMIS02</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
                <Partition>
                  <ID>DWHTarjetaCreditoOperacion_251dd078-00cd-4e50-92ad-a45bb16e5235</ID>
                  <Name>DWHTarjetaCreditoOperacion_Enero</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=1

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=1

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHTarjetaCreditoOperacion_3e3fc11e-dc70-4bed-9a92-c8881b4a9da0</ID>
                  <Name>DWHTarjetaCreditoOperacion_Febrero</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=2

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=2

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHTarjetaCreditoOperacion_9ccb34ee-0711-4fee-ac1a-4cc473f1f129</ID>
                  <Name>DWHTarjetaCreditoOperacion_Marzo</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=3

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=3

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHTarjetaCreditoOperacion_bf3dae62-4b35-4778-b83d-19f47dfaa6fe</ID>
                  <Name>DWHTarjetaCreditoOperacion_Abril</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=4

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=4

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHTarjetaCreditoOperacion_51b45776-9243-4607-b7cd-914d2d75b0c8</ID>
                  <Name>DWHTarjetaCreditoOperacion_Mayo</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=5

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=5

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHTarjetaCreditoOperacion_2fe3a1a8-9f37-47a4-b701-f180206401e7</ID>
                  <Name>DWHTarjetaCreditoOperacion_Junio</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=6

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=6

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHTarjetaCreditoOperacion_4186aab7-1623-4559-9551-da7346104f2e</ID>
                  <Name>DWHTarjetaCreditoOperacion_Julio</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=7

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=7

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHTarjetaCreditoOperacion_f837dd34-8ad6-4016-9562-571c3a85367e</ID>
                  <Name>DWHTarjetaCreditoOperacion_Agosto</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=8

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=8

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHTarjetaCreditoOperacion_25a4c15d-826b-45b5-9944-4903ab4cdc1b</ID>
                  <Name>DWHTarjetaCreditoOperacion_Septiembre</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=9

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=9

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHTarjetaCreditoOperacion_5c89822e-7057-47d1-8428-39fc4c51ba46</ID>
                  <Name>DWHTarjetaCreditoOperacion_Octubre</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=10

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=10

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHTarjetaCreditoOperacion_a82c5924-c257-4e3c-9d93-cbeb7f2c0417</ID>
                  <Name>DWHTarjetaCreditoOperacion_Noviembre</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=11

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=11

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHTarjetaCreditoOperacion_95612383-cb62-4276-a833-abfbf80d9c7a</ID>
                  <Name>DWHTarjetaCreditoOperacion_Diciembre</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=12

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float

set @Mes=12

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1

/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/* Tasa Efectiva */

select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT
 tcoIdFecha
,tcoIdCuentaContable
,tcoIdProducto
,tcoIdCliente
,tcoIdCalificacionOperacionCliente

,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))

,tcoSaldo=isnull(tcoSaldo,0)
,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)
,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)

,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)

,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)

,tcoValorComision=isnull(tcoValorComision,0)
,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)
,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)
,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)
,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)
,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)
,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)
,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)
,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)
,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)
,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)
,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)

,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)

,tcoTasaEfectiva = @tasaEfectiva
,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)
,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)
FROM DWHTarjetaCreditoOperacion tco
inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
            <MeasureGroup>
              <ID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</ID>
              <Name>DWHActivoOperacion</Name>
              <Measures>
                <Measure>
                  <ID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</ID>
                  <Name>__XL_Count DWHActivoOperacion</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoIdFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoIdFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoIdCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoIdCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoIdCuentaContable</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoIdCuentaContable</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoIdProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoIdProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoNumeroOperacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoNumeroOperacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoMontoSaldoDolar</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoMontoSaldoDolar</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoSaldoAcumuladoAnual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoSaldoAcumuladoAnual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoSaldoPromedioAnual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoSaldoPromedioAnual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoValorActPondRiesgoPromAnual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoValorActPondRiesgoPromAnual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoValorComision</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoValorComision</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoValorIngresoServicio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoValorIngresoServicio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoValorOperacionFinanciera</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoValorOperacionFinanciera</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoValorInteresRealAnual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoValorInteresRealAnual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoValorInteresTasaPool</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoValorInteresTasaPool</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoValorMargenFinanciero</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoValorMargenFinanciero</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoValorMargenBancarioBasico</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoValorMargenBancarioBasico</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoValorMargenOrdinario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoValorMargenOrdinario</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoValorMargenExplotacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoValorMargenExplotacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoValorUtilidadOperativa</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoValorUtilidadOperativa</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoValorCostoOperativo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoValorCostoOperativo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoValorPerdidaEsperada</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoValorPerdidaEsperada</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoTasaPool</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoTasaPool</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoSpread</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoSpread</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoTasaImplicita</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoTasaImplicita</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoNumeroTransaccionesAnual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoNumeroTransaccionesAnual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoTasaEfectiva</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoTasaEfectiva</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoIdCalificacionOperacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoIdCalificacionOperacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>aoValorPorcentajePerdidaEsperada</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</TableID>
                            <ColumnID>aoValorPorcentajePerdidaEsperada</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clCodigoCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clNombreCompleto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clNombreCompleto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdAsesorPrincipal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdAsesorPrincipal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clVinculacionValor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clVinculacionValor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clCodigoGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clFechaFin</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clFechaFin</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdSegmentacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdSegmentacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCalClienteDesde</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clCalClienteDesde</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>CanalCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoAgencia])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreRegion])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreZona])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAsesorOperacionCliente[asNombreAsesor])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clSegmentacionTipoCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clSegmentacionTipoCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ClCodigoCliente1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 4</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDCliente[clCodigoCliente] &amp; "-" &amp; DWDCliente[clNombreCompleto]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 5</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED('DWDAsesorOperacionCliente'[asCodigoAsesor])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDCanalCliente[caCodigoAgrupacionCanal])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoAgencia])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoZona])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoRegion])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoRegion 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoRegional])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoSubregion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoSubregion])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clFechaIngreso</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clFechaIngreso</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>aoIdCliente</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>57fd781c-eb21-4f48-9b96-bfa993f5e8f1</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caIdCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caIdCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodigoCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodigoCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caDescripcionAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caDescripcionAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caOrdenCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caOrdenCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caAgrupacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caAgrupacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caOrdenDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caOrdenDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodDescripcionAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodDescripcionAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCanalConsolidado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdCanal</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agIdAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agIdAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agDireccionAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agDireccionAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agTelefonoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agTelefonoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agResponsableNombre</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agResponsableNombre</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agFechaApertura</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agFechaApertura</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agFechaClausura</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agFechaClausura</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNumeroColaboradores</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNumeroColaboradores</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agMontoInvertido</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agMontoInvertido</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoSubregion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoSubregion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoCantonCompleto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoCantonCompleto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreCanton</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreCanton</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoProvincia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoProvincia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreProvincia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreProvincia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegionDescn</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegionDescn</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreRegionDescn</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreRegionDescn</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agOrdenRegionAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agOrdenRegionAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoJefeAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoJefeAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreJefeAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreJefeAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdAgencia</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccIdCuentaContable</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccIdCuentaContable</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoMoneda</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoMoneda</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoIndicador</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoIndicador</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>CpEstadoProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>CpEstadoProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoNivel6</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoNivel6</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccAgrupacionContableNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccAgrupacionContableNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalIndicadorNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>cpCalIndicadorNivel1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalIndicadorNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>cpCalIndicadorNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalProductoNivel1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalProductoNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccSubGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccSubGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccTarifaTransaccion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccTarifaTransaccion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalAgrupacionRentabilidaN1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalAgrupacionRentabilidaN1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalTipoIngresoN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalTipoIngresoN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalDescripcionNivel6N3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalDescripcionNivel6N3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCodigoAgrupacionRentabilidaN1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalCodigoAgrupacionRentabilidaN1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCodigoTipoIngresoN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalCodigoTipoIngresoN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalOrdenIndicadorNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>
IF(DWDCuentaContable[cpCalIndicadorNivel1]=1 ||  DWDCuentaContable[cpCalIndicadorNivel1]=80,20,
  IF(DWDCuentaContable[cpCalIndicadorNivel1]=2,10,
      IF(DWDCuentaContable[cpCalIndicadorNivel1]=2,30,
             IF(DWDCuentaContable[cpCalIndicadorNivel1]=72,40,99))))</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalOrdenIndicadorNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>
if(DWDCuentaContable[cpCalIndicadorNivel2]=140,11,
  if(DWDCuentaContable[cpCalIndicadorNivel2]=141,12,
    if(DWDCuentaContable[cpCalIndicadorNivel2]=142,13,
      if(DWDCuentaContable[cpCalIndicadorNivel2]=120 || DWDCuentaContable[cpCalIndicadorNivel2]=126,21,
         if(DWDCuentaContable[cpCalIndicadorNivel2]=121,22,
            if(DWDCuentaContable[cpCalIndicadorNivel2]=122,23,
               if(DWDCuentaContable[cpCalIndicadorNivel2]=124,24,
                  if(DWDCuentaContable[cpCalIndicadorNivel2]=200,25,
                  if(DWDCuentaContable[cpCalIndicadorNivel2]=160,31,
                     if(DWDCuentaContable[cpCalIndicadorNivel2]=161,32,
                       if(DWDCuentaContable[cpCalIndicadorNivel2]=162,33,
                          if(DWDCuentaContable[cpCalIndicadorNivel2]=100,40,99
                          ))))))))))))
                          
                        </Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccAgrupacionTributario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccAgrupacionTributario</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalOrdenAgrupacionTributario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalBandera</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccAgrupacionRentabilidadTransaccion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccAgrupacionRentabilidadTransaccion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoBruto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCovid</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCovid</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoOperCredito</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalEstadoOpeCredito</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalAgrupacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDCuentaContable[cpCalIndicadorNivel1]=1 &amp;&amp; DWDCuentaContable[ccCovid]=TRUE() , DWDCuentaContable[ccCalDescripcionNivel6N3], 
    IF(DWDCuentaContable[cpCalIndicadorNivel1]=1  &amp;&amp; (DWDCuentaContable[cpCalIndicadorNivel2]=122 || DWDCuentaContable[cpCalIndicadorNivel2]=126) ,  UPPER(DWDCuentaContable[ccSubGrupo]),
      IF(DWDCuentaContable[cpCalIndicadorNivel1]=1  , UPPER(DWDCuentaContable[ccCalProductoNivel2]) &amp; " " &amp;  UPPER(DWDCuentaContable[ccSubGrupo]),BLANK())))

&amp; " " &amp; DWDCuentaContable[ccCalProductoCobranza]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32768</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoNivel3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32768</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoNivel3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoCobranza</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32768</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalProductoCobranza</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoIndicadorRentabilidad</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoIndicadorRentabilidad</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>aoIdCuentaContable</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>12f0298f-0579-4f3e-b032-013f1b5ed5f5</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asIdAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asIdAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asUsuario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asUsuario</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asAsesorPrincipal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asAsesorPrincipal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asOrdenAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asOrdenAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDAsesorOperacionCliente[asCodigoAsesor] &amp; "-" &amp; DWDAsesorOperacionCliente[asNombreAsesor]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdAsesorPrincipal</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDescripcionFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDescripcionFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalDia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalDia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimNumero</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimNumero</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimDia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimDia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFeriado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFeriado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinSemana</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinSemana</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>EsDiaAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>EsDiaAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>fecIdAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>fecIdAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>EsCierreAño</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>EsCierreAño</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feAnioAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feAnioAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaCierreAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaCierreAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFechaCierreAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFechaCierreAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDiaActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDiaActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDiaAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDiaAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feAnioAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feAnioAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feHaceUnAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feHaceUnAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinTrimestreAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinTrimestreAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMesAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMesAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFechaMesAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFechaMesAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMesTodosAnios</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMesTodosAnios</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feValorCalculoPromedio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feValorCalculoPromedio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feEsMesActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feEsMesActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feEsTrimestreActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feEsTrimestreActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnMesLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnMesLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnTrimestreLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnTrimestreLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnSemestreLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnSemestreLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnAnioLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnAnioLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHistoricoLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHistoricoLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasMesLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasMesLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasTrimLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasTrimLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasTrimFiscLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasTrimFiscLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasSemestLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasSemestLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasAnioLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasAnioLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasHistLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasHistLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimestresAnteriores</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimestresAnteriores</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierrFechAnioActFut</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierrFechAnioActFut</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAntAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAntAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierrMesAnioAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierrMesAnioAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Column1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Column1 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaTresMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaTresMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaSeisMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaSeisMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaDoceMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaDoceMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalMesAnteriorRentabilidad</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDFecha[feIdFecha]=[ValFechaMesAntRent],1,0)</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>FechaMesAntRent</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>FechaMesAntRent</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>F</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Agregar columna2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>aoIdFecha</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>de082024-84ed-4cb5-86da-b45ebec9019c</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scIdSegmentacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scIdSegmentacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scIdCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scIdCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scDetalleCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scDetalleCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scDetalleNombre</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scDetalleNombre</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionTipoCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionTipoCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionTipo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionTipo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrden</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrden</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrdenN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrdenN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrdenN3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrdenN3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdSegmentacionCliente</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baIdBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baIdBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baCodigoBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baCodigoBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baDescripcionBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baDescripcionBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdBanca</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cocIdCalificacionOperacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</TableID>
                            <ColumnID>cocIdCalificacionOperacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cocCodigoCalificacionOperacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</TableID>
                            <ColumnID>cocCodigoCalificacionOperacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cocCalificacionOperacionCiente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</TableID>
                            <ColumnID>cocCalificacionOperacionCiente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>aoIdCalificacionOperacionCliente</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>5edcc5d2-66ec-4abb-8080-def1a3831a39</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grIdentificacionGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grIdentificacionGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grNombreGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grNombreGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAgrCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAgrCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grNombreAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grNombreAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clCodigoGrupo</IntermediateGranularityAttributeID>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>DWHActivoOperacion_50b0bbdd-d31b-4bec-a650-6a420dbde58c</ID>
                  <Name>DWHActivoOperacion_Diaria</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;declare @FechaActual int

select @FechaActual=feIdFecha from DWDFecha where feDiaActual=1


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto

,aoIdCalificacionOperacionCliente
 
,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0) 

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)
,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)
,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)
,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion
where aoIdFecha=@FechaActual

CLOSE SYMMETRIC KEY ClaveMIS02&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>declare @FechaActual int

select @FechaActual=feIdFecha from DWDFecha where feDiaActual=1


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto

,aoIdCalificacionOperacionCliente
 
,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0) 

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)
,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)
,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)
,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion
where aoIdFecha=@FechaActual

CLOSE SYMMETRIC KEY ClaveMIS02</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
                <Partition>
                  <ID>DWHActivoOperacion_c7e496a7-1ee7-4640-ae06-de49f5e10ce4</ID>
                  <Name>DWHActivoOperacion_Enero</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @FechaHaceUnAnio int,@IdCtaSeviciosFinancieros int 

set @Mes=1

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'
select @IdCtaSeviciosFinancieros=ccIdCuentaContable from DWDCuentaContable where ccCodigoIndicador=599 -- '1402000000000000'; Cta Servicios Financieros 

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end

select feIdFecha
into #FechaUnAnio
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #FechaUnAnio fe on ct.ctIdFechaTransaccion=fe.feIdFecha -- Se obtiene la informacion solo de un año
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdMoneda=@IdMoneda
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
--inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ccIdCuentaContable



OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto
,aoIdCalificacionOperacionCliente

,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0)

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)

,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)

,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)

,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion ao
inner join #DWDFecha fe on ao.aoIdFecha=fe.feIdFecha -- Dos Años Atras

union all

select 
 aoIdFecha=ctIdFechaTransaccion
,aoIdCliente=ctIdClientePropietarioOperacion
,aoIdCuentaContable=@IdCtaSeviciosFinancieros --Servicios Financieros IdCuentaContable
,aoIdProducto=-1
,aoIdCalificacionOperacionCliente=-1

,aoNumeroOperacion='0'
,aoMontoSaldoDolar=0

,aoSaldoAcumuladoAnual=0
,aoSaldoPromedioAnual=0

,aoValorActPondRiesgoPromAnual=0

,aoValorComision=0
,aoValorIngresoServicio=0
,aoValorOperacionFinanciera=0
,aoValorInteresRealAnual=0
,aoValorInteresTasaPool=0
,aoValorMargenFinanciero=0
,aoValorMargenBancarioBasico=0
,aoValorMargenOrdinario=0
,aoValorMargenExplotacion=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenOrdinario - CostoOperativo
,aoValorUtilidadOperativa=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenExplotacion - PerdidaEsperada
,aoValorCostoOperativo=isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual
,aoValorPerdidaEsperada=0
,aoTasaPool=0
,aoSpread=0
,aoTasaImplicita=0
,aoNumeroTransaccionesAnual=0
,aoTasaEfectiva=0
,aoValorPorcentajePerdidaEsperada=0
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0

CLOSE SYMMETRIC KEY ClaveMIS02

-- Eliminar Tablas Temporales
if OBJECT_ID ('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end
if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end
if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end
if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @FechaHaceUnAnio int,@IdCtaSeviciosFinancieros int 

set @Mes=1

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'
select @IdCtaSeviciosFinancieros=ccIdCuentaContable from DWDCuentaContable where ccCodigoIndicador=599 -- '1402000000000000'; Cta Servicios Financieros 

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end

select feIdFecha
into #FechaUnAnio
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #FechaUnAnio fe on ct.ctIdFechaTransaccion=fe.feIdFecha -- Se obtiene la informacion solo de un año
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdMoneda=@IdMoneda
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
--inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ccIdCuentaContable



OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto
,aoIdCalificacionOperacionCliente

,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0)

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)

,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)

,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)

,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion ao
inner join #DWDFecha fe on ao.aoIdFecha=fe.feIdFecha -- Dos Años Atras

union all

select 
 aoIdFecha=ctIdFechaTransaccion
,aoIdCliente=ctIdClientePropietarioOperacion
,aoIdCuentaContable=@IdCtaSeviciosFinancieros --Servicios Financieros IdCuentaContable
,aoIdProducto=-1
,aoIdCalificacionOperacionCliente=-1

,aoNumeroOperacion='0'
,aoMontoSaldoDolar=0

,aoSaldoAcumuladoAnual=0
,aoSaldoPromedioAnual=0

,aoValorActPondRiesgoPromAnual=0

,aoValorComision=0
,aoValorIngresoServicio=0
,aoValorOperacionFinanciera=0
,aoValorInteresRealAnual=0
,aoValorInteresTasaPool=0
,aoValorMargenFinanciero=0
,aoValorMargenBancarioBasico=0
,aoValorMargenOrdinario=0
,aoValorMargenExplotacion=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenOrdinario - CostoOperativo
,aoValorUtilidadOperativa=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenExplotacion - PerdidaEsperada
,aoValorCostoOperativo=isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual
,aoValorPerdidaEsperada=0
,aoTasaPool=0
,aoSpread=0
,aoTasaImplicita=0
,aoNumeroTransaccionesAnual=0
,aoTasaEfectiva=0
,aoValorPorcentajePerdidaEsperada=0
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0

CLOSE SYMMETRIC KEY ClaveMIS02

-- Eliminar Tablas Temporales
if OBJECT_ID ('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end
if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end
if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end
if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHActivoOperacion_08f048b6-9e13-471e-ac18-2d42925ab43a</ID>
                  <Name>DWHActivoOperacion_Febrero</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @FechaHaceUnAnio int,@IdCtaSeviciosFinancieros int 

set @Mes=2

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'
select @IdCtaSeviciosFinancieros=ccIdCuentaContable from DWDCuentaContable where ccCodigoIndicador=599 -- '1402000000000000'; Cta Servicios Financieros 

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end

select feIdFecha
into #FechaUnAnio
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #FechaUnAnio fe on ct.ctIdFechaTransaccion=fe.feIdFecha -- Se obtiene la informacion solo de un año
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdMoneda=@IdMoneda
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
--inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ccIdCuentaContable



OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto
,aoIdCalificacionOperacionCliente

,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0)

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)

,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)

,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)

,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion ao
inner join #DWDFecha fe on ao.aoIdFecha=fe.feIdFecha -- Dos Años Atras

union all

select 
 aoIdFecha=ctIdFechaTransaccion
,aoIdCliente=ctIdClientePropietarioOperacion
,aoIdCuentaContable=@IdCtaSeviciosFinancieros --Servicios Financieros IdCuentaContable
,aoIdProducto=-1
,aoIdCalificacionOperacionCliente=-1

,aoNumeroOperacion='0'
,aoMontoSaldoDolar=0

,aoSaldoAcumuladoAnual=0
,aoSaldoPromedioAnual=0

,aoValorActPondRiesgoPromAnual=0

,aoValorComision=0
,aoValorIngresoServicio=0
,aoValorOperacionFinanciera=0
,aoValorInteresRealAnual=0
,aoValorInteresTasaPool=0
,aoValorMargenFinanciero=0
,aoValorMargenBancarioBasico=0
,aoValorMargenOrdinario=0
,aoValorMargenExplotacion=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenOrdinario - CostoOperativo
,aoValorUtilidadOperativa=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenExplotacion - PerdidaEsperada
,aoValorCostoOperativo=isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual
,aoValorPerdidaEsperada=0
,aoTasaPool=0
,aoSpread=0
,aoTasaImplicita=0
,aoNumeroTransaccionesAnual=0
,aoTasaEfectiva=0
,aoValorPorcentajePerdidaEsperada=0
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0

CLOSE SYMMETRIC KEY ClaveMIS02

-- Eliminar Tablas Temporales
if OBJECT_ID ('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end
if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end
if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end
if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @FechaHaceUnAnio int,@IdCtaSeviciosFinancieros int 

set @Mes=2

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'
select @IdCtaSeviciosFinancieros=ccIdCuentaContable from DWDCuentaContable where ccCodigoIndicador=599 -- '1402000000000000'; Cta Servicios Financieros 

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end

select feIdFecha
into #FechaUnAnio
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #FechaUnAnio fe on ct.ctIdFechaTransaccion=fe.feIdFecha -- Se obtiene la informacion solo de un año
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdMoneda=@IdMoneda
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
--inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ccIdCuentaContable



OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto
,aoIdCalificacionOperacionCliente

,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0)

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)

,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)

,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)

,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion ao
inner join #DWDFecha fe on ao.aoIdFecha=fe.feIdFecha -- Dos Años Atras

union all

select 
 aoIdFecha=ctIdFechaTransaccion
,aoIdCliente=ctIdClientePropietarioOperacion
,aoIdCuentaContable=@IdCtaSeviciosFinancieros --Servicios Financieros IdCuentaContable
,aoIdProducto=-1
,aoIdCalificacionOperacionCliente=-1

,aoNumeroOperacion='0'
,aoMontoSaldoDolar=0

,aoSaldoAcumuladoAnual=0
,aoSaldoPromedioAnual=0

,aoValorActPondRiesgoPromAnual=0

,aoValorComision=0
,aoValorIngresoServicio=0
,aoValorOperacionFinanciera=0
,aoValorInteresRealAnual=0
,aoValorInteresTasaPool=0
,aoValorMargenFinanciero=0
,aoValorMargenBancarioBasico=0
,aoValorMargenOrdinario=0
,aoValorMargenExplotacion=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenOrdinario - CostoOperativo
,aoValorUtilidadOperativa=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenExplotacion - PerdidaEsperada
,aoValorCostoOperativo=isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual
,aoValorPerdidaEsperada=0
,aoTasaPool=0
,aoSpread=0
,aoTasaImplicita=0
,aoNumeroTransaccionesAnual=0
,aoTasaEfectiva=0
,aoValorPorcentajePerdidaEsperada=0
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0

CLOSE SYMMETRIC KEY ClaveMIS02

-- Eliminar Tablas Temporales
if OBJECT_ID ('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end
if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end
if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end
if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHActivoOperacion_adae9d82-94e2-4865-93ba-2ef657ead886</ID>
                  <Name>DWHActivoOperacion_Marzo</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @FechaHaceUnAnio int,@IdCtaSeviciosFinancieros int 

set @Mes=3

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'
select @IdCtaSeviciosFinancieros=ccIdCuentaContable from DWDCuentaContable where ccCodigoIndicador=599 -- '1402000000000000'; Cta Servicios Financieros 

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end

select feIdFecha
into #FechaUnAnio
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #FechaUnAnio fe on ct.ctIdFechaTransaccion=fe.feIdFecha -- Se obtiene la informacion solo de un año
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdMoneda=@IdMoneda
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
--inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ccIdCuentaContable



OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto
,aoIdCalificacionOperacionCliente

,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0)

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)

,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)

,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)

,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion ao
inner join #DWDFecha fe on ao.aoIdFecha=fe.feIdFecha -- Dos Años Atras

union all

select 
 aoIdFecha=ctIdFechaTransaccion
,aoIdCliente=ctIdClientePropietarioOperacion
,aoIdCuentaContable=@IdCtaSeviciosFinancieros --Servicios Financieros IdCuentaContable
,aoIdProducto=-1
,aoIdCalificacionOperacionCliente=-1

,aoNumeroOperacion='0'
,aoMontoSaldoDolar=0

,aoSaldoAcumuladoAnual=0
,aoSaldoPromedioAnual=0

,aoValorActPondRiesgoPromAnual=0

,aoValorComision=0
,aoValorIngresoServicio=0
,aoValorOperacionFinanciera=0
,aoValorInteresRealAnual=0
,aoValorInteresTasaPool=0
,aoValorMargenFinanciero=0
,aoValorMargenBancarioBasico=0
,aoValorMargenOrdinario=0
,aoValorMargenExplotacion=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenOrdinario - CostoOperativo
,aoValorUtilidadOperativa=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenExplotacion - PerdidaEsperada
,aoValorCostoOperativo=isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual
,aoValorPerdidaEsperada=0
,aoTasaPool=0
,aoSpread=0
,aoTasaImplicita=0
,aoNumeroTransaccionesAnual=0
,aoTasaEfectiva=0
,aoValorPorcentajePerdidaEsperada=0
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0

CLOSE SYMMETRIC KEY ClaveMIS02

-- Eliminar Tablas Temporales
if OBJECT_ID ('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end
if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end
if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end
if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @FechaHaceUnAnio int,@IdCtaSeviciosFinancieros int 

set @Mes=3

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'
select @IdCtaSeviciosFinancieros=ccIdCuentaContable from DWDCuentaContable where ccCodigoIndicador=599 -- '1402000000000000'; Cta Servicios Financieros 

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end

select feIdFecha
into #FechaUnAnio
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #FechaUnAnio fe on ct.ctIdFechaTransaccion=fe.feIdFecha -- Se obtiene la informacion solo de un año
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdMoneda=@IdMoneda
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
--inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ccIdCuentaContable



OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto
,aoIdCalificacionOperacionCliente

,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0)

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)

,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)

,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)

,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion ao
inner join #DWDFecha fe on ao.aoIdFecha=fe.feIdFecha -- Dos Años Atras

union all

select 
 aoIdFecha=ctIdFechaTransaccion
,aoIdCliente=ctIdClientePropietarioOperacion
,aoIdCuentaContable=@IdCtaSeviciosFinancieros --Servicios Financieros IdCuentaContable
,aoIdProducto=-1
,aoIdCalificacionOperacionCliente=-1

,aoNumeroOperacion='0'
,aoMontoSaldoDolar=0

,aoSaldoAcumuladoAnual=0
,aoSaldoPromedioAnual=0

,aoValorActPondRiesgoPromAnual=0

,aoValorComision=0
,aoValorIngresoServicio=0
,aoValorOperacionFinanciera=0
,aoValorInteresRealAnual=0
,aoValorInteresTasaPool=0
,aoValorMargenFinanciero=0
,aoValorMargenBancarioBasico=0
,aoValorMargenOrdinario=0
,aoValorMargenExplotacion=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenOrdinario - CostoOperativo
,aoValorUtilidadOperativa=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenExplotacion - PerdidaEsperada
,aoValorCostoOperativo=isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual
,aoValorPerdidaEsperada=0
,aoTasaPool=0
,aoSpread=0
,aoTasaImplicita=0
,aoNumeroTransaccionesAnual=0
,aoTasaEfectiva=0
,aoValorPorcentajePerdidaEsperada=0
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0

CLOSE SYMMETRIC KEY ClaveMIS02

-- Eliminar Tablas Temporales
if OBJECT_ID ('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end
if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end
if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end
if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHActivoOperacion_c34eaa93-3407-483f-b630-4c27004206ec</ID>
                  <Name>DWHActivoOperacion_Abril</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @FechaHaceUnAnio int,@IdCtaSeviciosFinancieros int 

set @Mes=4

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'
select @IdCtaSeviciosFinancieros=ccIdCuentaContable from DWDCuentaContable where ccCodigoIndicador=599 -- '1402000000000000'; Cta Servicios Financieros 

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end

select feIdFecha
into #FechaUnAnio
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #FechaUnAnio fe on ct.ctIdFechaTransaccion=fe.feIdFecha -- Se obtiene la informacion solo de un año
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdMoneda=@IdMoneda
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
--inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ccIdCuentaContable



OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto
,aoIdCalificacionOperacionCliente

,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0)

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)

,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)

,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)

,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion ao
inner join #DWDFecha fe on ao.aoIdFecha=fe.feIdFecha -- Dos Años Atras

union all

select 
 aoIdFecha=ctIdFechaTransaccion
,aoIdCliente=ctIdClientePropietarioOperacion
,aoIdCuentaContable=@IdCtaSeviciosFinancieros --Servicios Financieros IdCuentaContable
,aoIdProducto=-1
,aoIdCalificacionOperacionCliente=-1

,aoNumeroOperacion='0'
,aoMontoSaldoDolar=0

,aoSaldoAcumuladoAnual=0
,aoSaldoPromedioAnual=0

,aoValorActPondRiesgoPromAnual=0

,aoValorComision=0
,aoValorIngresoServicio=0
,aoValorOperacionFinanciera=0
,aoValorInteresRealAnual=0
,aoValorInteresTasaPool=0
,aoValorMargenFinanciero=0
,aoValorMargenBancarioBasico=0
,aoValorMargenOrdinario=0
,aoValorMargenExplotacion=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenOrdinario - CostoOperativo
,aoValorUtilidadOperativa=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenExplotacion - PerdidaEsperada
,aoValorCostoOperativo=isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual
,aoValorPerdidaEsperada=0
,aoTasaPool=0
,aoSpread=0
,aoTasaImplicita=0
,aoNumeroTransaccionesAnual=0
,aoTasaEfectiva=0
,aoValorPorcentajePerdidaEsperada=0
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0

CLOSE SYMMETRIC KEY ClaveMIS02

-- Eliminar Tablas Temporales
if OBJECT_ID ('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end
if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end
if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end
if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @FechaHaceUnAnio int,@IdCtaSeviciosFinancieros int 

set @Mes=4

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'
select @IdCtaSeviciosFinancieros=ccIdCuentaContable from DWDCuentaContable where ccCodigoIndicador=599 -- '1402000000000000'; Cta Servicios Financieros 

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end

select feIdFecha
into #FechaUnAnio
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #FechaUnAnio fe on ct.ctIdFechaTransaccion=fe.feIdFecha -- Se obtiene la informacion solo de un año
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdMoneda=@IdMoneda
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
--inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ccIdCuentaContable



OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto
,aoIdCalificacionOperacionCliente

,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0)

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)

,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)

,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)

,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion ao
inner join #DWDFecha fe on ao.aoIdFecha=fe.feIdFecha -- Dos Años Atras

union all

select 
 aoIdFecha=ctIdFechaTransaccion
,aoIdCliente=ctIdClientePropietarioOperacion
,aoIdCuentaContable=@IdCtaSeviciosFinancieros --Servicios Financieros IdCuentaContable
,aoIdProducto=-1
,aoIdCalificacionOperacionCliente=-1

,aoNumeroOperacion='0'
,aoMontoSaldoDolar=0

,aoSaldoAcumuladoAnual=0
,aoSaldoPromedioAnual=0

,aoValorActPondRiesgoPromAnual=0

,aoValorComision=0
,aoValorIngresoServicio=0
,aoValorOperacionFinanciera=0
,aoValorInteresRealAnual=0
,aoValorInteresTasaPool=0
,aoValorMargenFinanciero=0
,aoValorMargenBancarioBasico=0
,aoValorMargenOrdinario=0
,aoValorMargenExplotacion=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenOrdinario - CostoOperativo
,aoValorUtilidadOperativa=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenExplotacion - PerdidaEsperada
,aoValorCostoOperativo=isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual
,aoValorPerdidaEsperada=0
,aoTasaPool=0
,aoSpread=0
,aoTasaImplicita=0
,aoNumeroTransaccionesAnual=0
,aoTasaEfectiva=0
,aoValorPorcentajePerdidaEsperada=0
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0

CLOSE SYMMETRIC KEY ClaveMIS02

-- Eliminar Tablas Temporales
if OBJECT_ID ('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end
if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end
if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end
if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHActivoOperacion_860654b8-e672-4f20-8dc8-54d8218f1ded</ID>
                  <Name>DWHActivoOperacion_Mayo</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @FechaHaceUnAnio int,@IdCtaSeviciosFinancieros int 

set @Mes=5

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'
select @IdCtaSeviciosFinancieros=ccIdCuentaContable from DWDCuentaContable where ccCodigoIndicador=599 -- '1402000000000000'; Cta Servicios Financieros 

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end

select feIdFecha
into #FechaUnAnio
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #FechaUnAnio fe on ct.ctIdFechaTransaccion=fe.feIdFecha -- Se obtiene la informacion solo de un año
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdMoneda=@IdMoneda
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
--inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ccIdCuentaContable



OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto
,aoIdCalificacionOperacionCliente

,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0)

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)

,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)

,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)

,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion ao
inner join #DWDFecha fe on ao.aoIdFecha=fe.feIdFecha -- Dos Años Atras

union all

select 
 aoIdFecha=ctIdFechaTransaccion
,aoIdCliente=ctIdClientePropietarioOperacion
,aoIdCuentaContable=@IdCtaSeviciosFinancieros --Servicios Financieros IdCuentaContable
,aoIdProducto=-1
,aoIdCalificacionOperacionCliente=-1

,aoNumeroOperacion='0'
,aoMontoSaldoDolar=0

,aoSaldoAcumuladoAnual=0
,aoSaldoPromedioAnual=0

,aoValorActPondRiesgoPromAnual=0

,aoValorComision=0
,aoValorIngresoServicio=0
,aoValorOperacionFinanciera=0
,aoValorInteresRealAnual=0
,aoValorInteresTasaPool=0
,aoValorMargenFinanciero=0
,aoValorMargenBancarioBasico=0
,aoValorMargenOrdinario=0
,aoValorMargenExplotacion=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenOrdinario - CostoOperativo
,aoValorUtilidadOperativa=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenExplotacion - PerdidaEsperada
,aoValorCostoOperativo=isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual
,aoValorPerdidaEsperada=0
,aoTasaPool=0
,aoSpread=0
,aoTasaImplicita=0
,aoNumeroTransaccionesAnual=0
,aoTasaEfectiva=0
,aoValorPorcentajePerdidaEsperada=0
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0

CLOSE SYMMETRIC KEY ClaveMIS02

-- Eliminar Tablas Temporales
if OBJECT_ID ('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end
if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end
if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end
if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @FechaHaceUnAnio int,@IdCtaSeviciosFinancieros int 

set @Mes=5

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'
select @IdCtaSeviciosFinancieros=ccIdCuentaContable from DWDCuentaContable where ccCodigoIndicador=599 -- '1402000000000000'; Cta Servicios Financieros 

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end

select feIdFecha
into #FechaUnAnio
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #FechaUnAnio fe on ct.ctIdFechaTransaccion=fe.feIdFecha -- Se obtiene la informacion solo de un año
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdMoneda=@IdMoneda
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
--inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ccIdCuentaContable



OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto
,aoIdCalificacionOperacionCliente

,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0)

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)

,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)

,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)

,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion ao
inner join #DWDFecha fe on ao.aoIdFecha=fe.feIdFecha -- Dos Años Atras

union all

select 
 aoIdFecha=ctIdFechaTransaccion
,aoIdCliente=ctIdClientePropietarioOperacion
,aoIdCuentaContable=@IdCtaSeviciosFinancieros --Servicios Financieros IdCuentaContable
,aoIdProducto=-1
,aoIdCalificacionOperacionCliente=-1

,aoNumeroOperacion='0'
,aoMontoSaldoDolar=0

,aoSaldoAcumuladoAnual=0
,aoSaldoPromedioAnual=0

,aoValorActPondRiesgoPromAnual=0

,aoValorComision=0
,aoValorIngresoServicio=0
,aoValorOperacionFinanciera=0
,aoValorInteresRealAnual=0
,aoValorInteresTasaPool=0
,aoValorMargenFinanciero=0
,aoValorMargenBancarioBasico=0
,aoValorMargenOrdinario=0
,aoValorMargenExplotacion=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenOrdinario - CostoOperativo
,aoValorUtilidadOperativa=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenExplotacion - PerdidaEsperada
,aoValorCostoOperativo=isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual
,aoValorPerdidaEsperada=0
,aoTasaPool=0
,aoSpread=0
,aoTasaImplicita=0
,aoNumeroTransaccionesAnual=0
,aoTasaEfectiva=0
,aoValorPorcentajePerdidaEsperada=0
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0

CLOSE SYMMETRIC KEY ClaveMIS02

-- Eliminar Tablas Temporales
if OBJECT_ID ('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end
if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end
if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end
if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHActivoOperacion_0b6a48e7-146a-45a9-9e31-c4968b0bf20a</ID>
                  <Name>DWHActivoOperacion_Junio</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @FechaHaceUnAnio int,@IdCtaSeviciosFinancieros int 

set @Mes=6

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'
select @IdCtaSeviciosFinancieros=ccIdCuentaContable from DWDCuentaContable where ccCodigoIndicador=599 -- '1402000000000000'; Cta Servicios Financieros 

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end

select feIdFecha
into #FechaUnAnio
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #FechaUnAnio fe on ct.ctIdFechaTransaccion=fe.feIdFecha -- Se obtiene la informacion solo de un año
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdMoneda=@IdMoneda
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
--inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ccIdCuentaContable



OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto
,aoIdCalificacionOperacionCliente

,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0)

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)

,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)

,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)

,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion ao
inner join #DWDFecha fe on ao.aoIdFecha=fe.feIdFecha -- Dos Años Atras

union all

select 
 aoIdFecha=ctIdFechaTransaccion
,aoIdCliente=ctIdClientePropietarioOperacion
,aoIdCuentaContable=@IdCtaSeviciosFinancieros --Servicios Financieros IdCuentaContable
,aoIdProducto=-1
,aoIdCalificacionOperacionCliente=-1

,aoNumeroOperacion='0'
,aoMontoSaldoDolar=0

,aoSaldoAcumuladoAnual=0
,aoSaldoPromedioAnual=0

,aoValorActPondRiesgoPromAnual=0

,aoValorComision=0
,aoValorIngresoServicio=0
,aoValorOperacionFinanciera=0
,aoValorInteresRealAnual=0
,aoValorInteresTasaPool=0
,aoValorMargenFinanciero=0
,aoValorMargenBancarioBasico=0
,aoValorMargenOrdinario=0
,aoValorMargenExplotacion=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenOrdinario - CostoOperativo
,aoValorUtilidadOperativa=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenExplotacion - PerdidaEsperada
,aoValorCostoOperativo=isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual
,aoValorPerdidaEsperada=0
,aoTasaPool=0
,aoSpread=0
,aoTasaImplicita=0
,aoNumeroTransaccionesAnual=0
,aoTasaEfectiva=0
,aoValorPorcentajePerdidaEsperada=0
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0

CLOSE SYMMETRIC KEY ClaveMIS02

-- Eliminar Tablas Temporales
if OBJECT_ID ('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end
if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end
if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end
if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @FechaHaceUnAnio int,@IdCtaSeviciosFinancieros int 

set @Mes=6

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'
select @IdCtaSeviciosFinancieros=ccIdCuentaContable from DWDCuentaContable where ccCodigoIndicador=599 -- '1402000000000000'; Cta Servicios Financieros 

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end

select feIdFecha
into #FechaUnAnio
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #FechaUnAnio fe on ct.ctIdFechaTransaccion=fe.feIdFecha -- Se obtiene la informacion solo de un año
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdMoneda=@IdMoneda
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
--inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ccIdCuentaContable



OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto
,aoIdCalificacionOperacionCliente

,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0)

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)

,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)

,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)

,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion ao
inner join #DWDFecha fe on ao.aoIdFecha=fe.feIdFecha -- Dos Años Atras

union all

select 
 aoIdFecha=ctIdFechaTransaccion
,aoIdCliente=ctIdClientePropietarioOperacion
,aoIdCuentaContable=@IdCtaSeviciosFinancieros --Servicios Financieros IdCuentaContable
,aoIdProducto=-1
,aoIdCalificacionOperacionCliente=-1

,aoNumeroOperacion='0'
,aoMontoSaldoDolar=0

,aoSaldoAcumuladoAnual=0
,aoSaldoPromedioAnual=0

,aoValorActPondRiesgoPromAnual=0

,aoValorComision=0
,aoValorIngresoServicio=0
,aoValorOperacionFinanciera=0
,aoValorInteresRealAnual=0
,aoValorInteresTasaPool=0
,aoValorMargenFinanciero=0
,aoValorMargenBancarioBasico=0
,aoValorMargenOrdinario=0
,aoValorMargenExplotacion=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenOrdinario - CostoOperativo
,aoValorUtilidadOperativa=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenExplotacion - PerdidaEsperada
,aoValorCostoOperativo=isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual
,aoValorPerdidaEsperada=0
,aoTasaPool=0
,aoSpread=0
,aoTasaImplicita=0
,aoNumeroTransaccionesAnual=0
,aoTasaEfectiva=0
,aoValorPorcentajePerdidaEsperada=0
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0

CLOSE SYMMETRIC KEY ClaveMIS02

-- Eliminar Tablas Temporales
if OBJECT_ID ('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end
if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end
if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end
if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHActivoOperacion_e08b442e-ea05-455a-82a1-0f111529231e</ID>
                  <Name>DWHActivoOperacion_Julio</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @FechaHaceUnAnio int,@IdCtaSeviciosFinancieros int 

set @Mes=7

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'
select @IdCtaSeviciosFinancieros=ccIdCuentaContable from DWDCuentaContable where ccCodigoIndicador=599 -- '1402000000000000'; Cta Servicios Financieros 

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end

select feIdFecha
into #FechaUnAnio
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #FechaUnAnio fe on ct.ctIdFechaTransaccion=fe.feIdFecha -- Se obtiene la informacion solo de un año
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdMoneda=@IdMoneda
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
--inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ccIdCuentaContable



OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto
,aoIdCalificacionOperacionCliente

,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0)

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)

,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)

,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)

,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion ao
inner join #DWDFecha fe on ao.aoIdFecha=fe.feIdFecha -- Dos Años Atras

union all

select 
 aoIdFecha=ctIdFechaTransaccion
,aoIdCliente=ctIdClientePropietarioOperacion
,aoIdCuentaContable=@IdCtaSeviciosFinancieros --Servicios Financieros IdCuentaContable
,aoIdProducto=-1
,aoIdCalificacionOperacionCliente=-1

,aoNumeroOperacion='0'
,aoMontoSaldoDolar=0

,aoSaldoAcumuladoAnual=0
,aoSaldoPromedioAnual=0

,aoValorActPondRiesgoPromAnual=0

,aoValorComision=0
,aoValorIngresoServicio=0
,aoValorOperacionFinanciera=0
,aoValorInteresRealAnual=0
,aoValorInteresTasaPool=0
,aoValorMargenFinanciero=0
,aoValorMargenBancarioBasico=0
,aoValorMargenOrdinario=0
,aoValorMargenExplotacion=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenOrdinario - CostoOperativo
,aoValorUtilidadOperativa=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenExplotacion - PerdidaEsperada
,aoValorCostoOperativo=isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual
,aoValorPerdidaEsperada=0
,aoTasaPool=0
,aoSpread=0
,aoTasaImplicita=0
,aoNumeroTransaccionesAnual=0
,aoTasaEfectiva=0
,aoValorPorcentajePerdidaEsperada=0
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0

CLOSE SYMMETRIC KEY ClaveMIS02

-- Eliminar Tablas Temporales
if OBJECT_ID ('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end
if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end
if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end
if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @FechaHaceUnAnio int,@IdCtaSeviciosFinancieros int 

set @Mes=7

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'
select @IdCtaSeviciosFinancieros=ccIdCuentaContable from DWDCuentaContable where ccCodigoIndicador=599 -- '1402000000000000'; Cta Servicios Financieros 

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end

select feIdFecha
into #FechaUnAnio
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #FechaUnAnio fe on ct.ctIdFechaTransaccion=fe.feIdFecha -- Se obtiene la informacion solo de un año
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdMoneda=@IdMoneda
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
--inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ccIdCuentaContable



OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto
,aoIdCalificacionOperacionCliente

,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0)

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)

,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)

,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)

,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion ao
inner join #DWDFecha fe on ao.aoIdFecha=fe.feIdFecha -- Dos Años Atras

union all

select 
 aoIdFecha=ctIdFechaTransaccion
,aoIdCliente=ctIdClientePropietarioOperacion
,aoIdCuentaContable=@IdCtaSeviciosFinancieros --Servicios Financieros IdCuentaContable
,aoIdProducto=-1
,aoIdCalificacionOperacionCliente=-1

,aoNumeroOperacion='0'
,aoMontoSaldoDolar=0

,aoSaldoAcumuladoAnual=0
,aoSaldoPromedioAnual=0

,aoValorActPondRiesgoPromAnual=0

,aoValorComision=0
,aoValorIngresoServicio=0
,aoValorOperacionFinanciera=0
,aoValorInteresRealAnual=0
,aoValorInteresTasaPool=0
,aoValorMargenFinanciero=0
,aoValorMargenBancarioBasico=0
,aoValorMargenOrdinario=0
,aoValorMargenExplotacion=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenOrdinario - CostoOperativo
,aoValorUtilidadOperativa=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenExplotacion - PerdidaEsperada
,aoValorCostoOperativo=isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual
,aoValorPerdidaEsperada=0
,aoTasaPool=0
,aoSpread=0
,aoTasaImplicita=0
,aoNumeroTransaccionesAnual=0
,aoTasaEfectiva=0
,aoValorPorcentajePerdidaEsperada=0
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0

CLOSE SYMMETRIC KEY ClaveMIS02

-- Eliminar Tablas Temporales
if OBJECT_ID ('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end
if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end
if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end
if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHActivoOperacion_0d1599b7-7c11-4e58-9aa2-d4f557a7152a</ID>
                  <Name>DWHActivoOperacion_Agosto</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @FechaHaceUnAnio int,@IdCtaSeviciosFinancieros int 

set @Mes=8

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'
select @IdCtaSeviciosFinancieros=ccIdCuentaContable from DWDCuentaContable where ccCodigoIndicador=599 -- '1402000000000000'; Cta Servicios Financieros 

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end

select feIdFecha
into #FechaUnAnio
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #FechaUnAnio fe on ct.ctIdFechaTransaccion=fe.feIdFecha -- Se obtiene la informacion solo de un año
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdMoneda=@IdMoneda
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
--inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ccIdCuentaContable



OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto
,aoIdCalificacionOperacionCliente

,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0)

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)

,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)

,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)

,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion ao
inner join #DWDFecha fe on ao.aoIdFecha=fe.feIdFecha -- Dos Años Atras

union all

select 
 aoIdFecha=ctIdFechaTransaccion
,aoIdCliente=ctIdClientePropietarioOperacion
,aoIdCuentaContable=@IdCtaSeviciosFinancieros --Servicios Financieros IdCuentaContable
,aoIdProducto=-1
,aoIdCalificacionOperacionCliente=-1

,aoNumeroOperacion='0'
,aoMontoSaldoDolar=0

,aoSaldoAcumuladoAnual=0
,aoSaldoPromedioAnual=0

,aoValorActPondRiesgoPromAnual=0

,aoValorComision=0
,aoValorIngresoServicio=0
,aoValorOperacionFinanciera=0
,aoValorInteresRealAnual=0
,aoValorInteresTasaPool=0
,aoValorMargenFinanciero=0
,aoValorMargenBancarioBasico=0
,aoValorMargenOrdinario=0
,aoValorMargenExplotacion=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenOrdinario - CostoOperativo
,aoValorUtilidadOperativa=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenExplotacion - PerdidaEsperada
,aoValorCostoOperativo=isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual
,aoValorPerdidaEsperada=0
,aoTasaPool=0
,aoSpread=0
,aoTasaImplicita=0
,aoNumeroTransaccionesAnual=0
,aoTasaEfectiva=0
,aoValorPorcentajePerdidaEsperada=0
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0

CLOSE SYMMETRIC KEY ClaveMIS02

-- Eliminar Tablas Temporales
if OBJECT_ID ('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end
if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end
if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end
if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @FechaHaceUnAnio int,@IdCtaSeviciosFinancieros int 

set @Mes=8

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'
select @IdCtaSeviciosFinancieros=ccIdCuentaContable from DWDCuentaContable where ccCodigoIndicador=599 -- '1402000000000000'; Cta Servicios Financieros 

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end

select feIdFecha
into #FechaUnAnio
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #FechaUnAnio fe on ct.ctIdFechaTransaccion=fe.feIdFecha -- Se obtiene la informacion solo de un año
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdMoneda=@IdMoneda
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
--inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ccIdCuentaContable



OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto
,aoIdCalificacionOperacionCliente

,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0)

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)

,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)

,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)

,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion ao
inner join #DWDFecha fe on ao.aoIdFecha=fe.feIdFecha -- Dos Años Atras

union all

select 
 aoIdFecha=ctIdFechaTransaccion
,aoIdCliente=ctIdClientePropietarioOperacion
,aoIdCuentaContable=@IdCtaSeviciosFinancieros --Servicios Financieros IdCuentaContable
,aoIdProducto=-1
,aoIdCalificacionOperacionCliente=-1

,aoNumeroOperacion='0'
,aoMontoSaldoDolar=0

,aoSaldoAcumuladoAnual=0
,aoSaldoPromedioAnual=0

,aoValorActPondRiesgoPromAnual=0

,aoValorComision=0
,aoValorIngresoServicio=0
,aoValorOperacionFinanciera=0
,aoValorInteresRealAnual=0
,aoValorInteresTasaPool=0
,aoValorMargenFinanciero=0
,aoValorMargenBancarioBasico=0
,aoValorMargenOrdinario=0
,aoValorMargenExplotacion=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenOrdinario - CostoOperativo
,aoValorUtilidadOperativa=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenExplotacion - PerdidaEsperada
,aoValorCostoOperativo=isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual
,aoValorPerdidaEsperada=0
,aoTasaPool=0
,aoSpread=0
,aoTasaImplicita=0
,aoNumeroTransaccionesAnual=0
,aoTasaEfectiva=0
,aoValorPorcentajePerdidaEsperada=0
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0

CLOSE SYMMETRIC KEY ClaveMIS02

-- Eliminar Tablas Temporales
if OBJECT_ID ('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end
if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end
if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end
if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHActivoOperacion_97489334-08cd-466d-83ae-5b252f06fb1a</ID>
                  <Name>DWHActivoOperacion_Septiembre</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @FechaHaceUnAnio int,@IdCtaSeviciosFinancieros int 

set @Mes=9

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'
select @IdCtaSeviciosFinancieros=ccIdCuentaContable from DWDCuentaContable where ccCodigoIndicador=599 -- '1402000000000000'; Cta Servicios Financieros 

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end

select feIdFecha
into #FechaUnAnio
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #FechaUnAnio fe on ct.ctIdFechaTransaccion=fe.feIdFecha -- Se obtiene la informacion solo de un año
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdMoneda=@IdMoneda
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
--inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ccIdCuentaContable



OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto
,aoIdCalificacionOperacionCliente

,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0)

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)

,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)

,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)

,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion ao
inner join #DWDFecha fe on ao.aoIdFecha=fe.feIdFecha -- Dos Años Atras

union all

select 
 aoIdFecha=ctIdFechaTransaccion
,aoIdCliente=ctIdClientePropietarioOperacion
,aoIdCuentaContable=@IdCtaSeviciosFinancieros --Servicios Financieros IdCuentaContable
,aoIdProducto=-1
,aoIdCalificacionOperacionCliente=-1

,aoNumeroOperacion='0'
,aoMontoSaldoDolar=0

,aoSaldoAcumuladoAnual=0
,aoSaldoPromedioAnual=0

,aoValorActPondRiesgoPromAnual=0

,aoValorComision=0
,aoValorIngresoServicio=0
,aoValorOperacionFinanciera=0
,aoValorInteresRealAnual=0
,aoValorInteresTasaPool=0
,aoValorMargenFinanciero=0
,aoValorMargenBancarioBasico=0
,aoValorMargenOrdinario=0
,aoValorMargenExplotacion=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenOrdinario - CostoOperativo
,aoValorUtilidadOperativa=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenExplotacion - PerdidaEsperada
,aoValorCostoOperativo=isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual
,aoValorPerdidaEsperada=0
,aoTasaPool=0
,aoSpread=0
,aoTasaImplicita=0
,aoNumeroTransaccionesAnual=0
,aoTasaEfectiva=0
,aoValorPorcentajePerdidaEsperada=0
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0

CLOSE SYMMETRIC KEY ClaveMIS02

-- Eliminar Tablas Temporales
if OBJECT_ID ('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end
if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end
if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end
if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @FechaHaceUnAnio int,@IdCtaSeviciosFinancieros int 

set @Mes=9

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'
select @IdCtaSeviciosFinancieros=ccIdCuentaContable from DWDCuentaContable where ccCodigoIndicador=599 -- '1402000000000000'; Cta Servicios Financieros 

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end

select feIdFecha
into #FechaUnAnio
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #FechaUnAnio fe on ct.ctIdFechaTransaccion=fe.feIdFecha -- Se obtiene la informacion solo de un año
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdMoneda=@IdMoneda
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
--inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ccIdCuentaContable



OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto
,aoIdCalificacionOperacionCliente

,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0)

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)

,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)

,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)

,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion ao
inner join #DWDFecha fe on ao.aoIdFecha=fe.feIdFecha -- Dos Años Atras

union all

select 
 aoIdFecha=ctIdFechaTransaccion
,aoIdCliente=ctIdClientePropietarioOperacion
,aoIdCuentaContable=@IdCtaSeviciosFinancieros --Servicios Financieros IdCuentaContable
,aoIdProducto=-1
,aoIdCalificacionOperacionCliente=-1

,aoNumeroOperacion='0'
,aoMontoSaldoDolar=0

,aoSaldoAcumuladoAnual=0
,aoSaldoPromedioAnual=0

,aoValorActPondRiesgoPromAnual=0

,aoValorComision=0
,aoValorIngresoServicio=0
,aoValorOperacionFinanciera=0
,aoValorInteresRealAnual=0
,aoValorInteresTasaPool=0
,aoValorMargenFinanciero=0
,aoValorMargenBancarioBasico=0
,aoValorMargenOrdinario=0
,aoValorMargenExplotacion=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenOrdinario - CostoOperativo
,aoValorUtilidadOperativa=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenExplotacion - PerdidaEsperada
,aoValorCostoOperativo=isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual
,aoValorPerdidaEsperada=0
,aoTasaPool=0
,aoSpread=0
,aoTasaImplicita=0
,aoNumeroTransaccionesAnual=0
,aoTasaEfectiva=0
,aoValorPorcentajePerdidaEsperada=0
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0

CLOSE SYMMETRIC KEY ClaveMIS02

-- Eliminar Tablas Temporales
if OBJECT_ID ('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end
if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end
if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end
if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHActivoOperacion_df7c76f4-db07-4643-a990-2c7543025c21</ID>
                  <Name>DWHActivoOperacion_Octubre</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @FechaHaceUnAnio int,@IdCtaSeviciosFinancieros int 

set @Mes=10

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'
select @IdCtaSeviciosFinancieros=ccIdCuentaContable from DWDCuentaContable where ccCodigoIndicador=599 -- '1402000000000000'; Cta Servicios Financieros 

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end

select feIdFecha
into #FechaUnAnio
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #FechaUnAnio fe on ct.ctIdFechaTransaccion=fe.feIdFecha -- Se obtiene la informacion solo de un año
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdMoneda=@IdMoneda
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
--inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ccIdCuentaContable



OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto
,aoIdCalificacionOperacionCliente

,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0)

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)

,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)

,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)

,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion ao
inner join #DWDFecha fe on ao.aoIdFecha=fe.feIdFecha -- Dos Años Atras

union all

select 
 aoIdFecha=ctIdFechaTransaccion
,aoIdCliente=ctIdClientePropietarioOperacion
,aoIdCuentaContable=@IdCtaSeviciosFinancieros --Servicios Financieros IdCuentaContable
,aoIdProducto=-1
,aoIdCalificacionOperacionCliente=-1

,aoNumeroOperacion='0'
,aoMontoSaldoDolar=0

,aoSaldoAcumuladoAnual=0
,aoSaldoPromedioAnual=0

,aoValorActPondRiesgoPromAnual=0

,aoValorComision=0
,aoValorIngresoServicio=0
,aoValorOperacionFinanciera=0
,aoValorInteresRealAnual=0
,aoValorInteresTasaPool=0
,aoValorMargenFinanciero=0
,aoValorMargenBancarioBasico=0
,aoValorMargenOrdinario=0
,aoValorMargenExplotacion=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenOrdinario - CostoOperativo
,aoValorUtilidadOperativa=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenExplotacion - PerdidaEsperada
,aoValorCostoOperativo=isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual
,aoValorPerdidaEsperada=0
,aoTasaPool=0
,aoSpread=0
,aoTasaImplicita=0
,aoNumeroTransaccionesAnual=0
,aoTasaEfectiva=0
,aoValorPorcentajePerdidaEsperada=0
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0

CLOSE SYMMETRIC KEY ClaveMIS02

-- Eliminar Tablas Temporales
if OBJECT_ID ('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end
if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end
if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end
if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @FechaHaceUnAnio int,@IdCtaSeviciosFinancieros int 

set @Mes=10

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'
select @IdCtaSeviciosFinancieros=ccIdCuentaContable from DWDCuentaContable where ccCodigoIndicador=599 -- '1402000000000000'; Cta Servicios Financieros 

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end

select feIdFecha
into #FechaUnAnio
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #FechaUnAnio fe on ct.ctIdFechaTransaccion=fe.feIdFecha -- Se obtiene la informacion solo de un año
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdMoneda=@IdMoneda
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
--inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ccIdCuentaContable



OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto
,aoIdCalificacionOperacionCliente

,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0)

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)

,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)

,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)

,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion ao
inner join #DWDFecha fe on ao.aoIdFecha=fe.feIdFecha -- Dos Años Atras

union all

select 
 aoIdFecha=ctIdFechaTransaccion
,aoIdCliente=ctIdClientePropietarioOperacion
,aoIdCuentaContable=@IdCtaSeviciosFinancieros --Servicios Financieros IdCuentaContable
,aoIdProducto=-1
,aoIdCalificacionOperacionCliente=-1

,aoNumeroOperacion='0'
,aoMontoSaldoDolar=0

,aoSaldoAcumuladoAnual=0
,aoSaldoPromedioAnual=0

,aoValorActPondRiesgoPromAnual=0

,aoValorComision=0
,aoValorIngresoServicio=0
,aoValorOperacionFinanciera=0
,aoValorInteresRealAnual=0
,aoValorInteresTasaPool=0
,aoValorMargenFinanciero=0
,aoValorMargenBancarioBasico=0
,aoValorMargenOrdinario=0
,aoValorMargenExplotacion=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenOrdinario - CostoOperativo
,aoValorUtilidadOperativa=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenExplotacion - PerdidaEsperada
,aoValorCostoOperativo=isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual
,aoValorPerdidaEsperada=0
,aoTasaPool=0
,aoSpread=0
,aoTasaImplicita=0
,aoNumeroTransaccionesAnual=0
,aoTasaEfectiva=0
,aoValorPorcentajePerdidaEsperada=0
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0

CLOSE SYMMETRIC KEY ClaveMIS02

-- Eliminar Tablas Temporales
if OBJECT_ID ('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end
if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end
if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end
if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHActivoOperacion_6097c334-73e8-4a42-b883-d8cfe60aaab4</ID>
                  <Name>DWHActivoOperacion_Noviembre</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @FechaHaceUnAnio int,@IdCtaSeviciosFinancieros int 

set @Mes=11

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'
select @IdCtaSeviciosFinancieros=ccIdCuentaContable from DWDCuentaContable where ccCodigoIndicador=599 -- '1402000000000000'; Cta Servicios Financieros 

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end

select feIdFecha
into #FechaUnAnio
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #FechaUnAnio fe on ct.ctIdFechaTransaccion=fe.feIdFecha -- Se obtiene la informacion solo de un año
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdMoneda=@IdMoneda
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
--inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ccIdCuentaContable



OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto
,aoIdCalificacionOperacionCliente

,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0)

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)

,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)

,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)

,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion ao
inner join #DWDFecha fe on ao.aoIdFecha=fe.feIdFecha -- Dos Años Atras

union all

select 
 aoIdFecha=ctIdFechaTransaccion
,aoIdCliente=ctIdClientePropietarioOperacion
,aoIdCuentaContable=@IdCtaSeviciosFinancieros --Servicios Financieros IdCuentaContable
,aoIdProducto=-1
,aoIdCalificacionOperacionCliente=-1

,aoNumeroOperacion='0'
,aoMontoSaldoDolar=0

,aoSaldoAcumuladoAnual=0
,aoSaldoPromedioAnual=0

,aoValorActPondRiesgoPromAnual=0

,aoValorComision=0
,aoValorIngresoServicio=0
,aoValorOperacionFinanciera=0
,aoValorInteresRealAnual=0
,aoValorInteresTasaPool=0
,aoValorMargenFinanciero=0
,aoValorMargenBancarioBasico=0
,aoValorMargenOrdinario=0
,aoValorMargenExplotacion=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenOrdinario - CostoOperativo
,aoValorUtilidadOperativa=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenExplotacion - PerdidaEsperada
,aoValorCostoOperativo=isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual
,aoValorPerdidaEsperada=0
,aoTasaPool=0
,aoSpread=0
,aoTasaImplicita=0
,aoNumeroTransaccionesAnual=0
,aoTasaEfectiva=0
,aoValorPorcentajePerdidaEsperada=0
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0

CLOSE SYMMETRIC KEY ClaveMIS02

-- Eliminar Tablas Temporales
if OBJECT_ID ('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end
if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end
if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end
if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @FechaHaceUnAnio int,@IdCtaSeviciosFinancieros int 

set @Mes=11

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'
select @IdCtaSeviciosFinancieros=ccIdCuentaContable from DWDCuentaContable where ccCodigoIndicador=599 -- '1402000000000000'; Cta Servicios Financieros 

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end

select feIdFecha
into #FechaUnAnio
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #FechaUnAnio fe on ct.ctIdFechaTransaccion=fe.feIdFecha -- Se obtiene la informacion solo de un año
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdMoneda=@IdMoneda
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
--inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ccIdCuentaContable



OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto
,aoIdCalificacionOperacionCliente

,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0)

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)

,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)

,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)

,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion ao
inner join #DWDFecha fe on ao.aoIdFecha=fe.feIdFecha -- Dos Años Atras

union all

select 
 aoIdFecha=ctIdFechaTransaccion
,aoIdCliente=ctIdClientePropietarioOperacion
,aoIdCuentaContable=@IdCtaSeviciosFinancieros --Servicios Financieros IdCuentaContable
,aoIdProducto=-1
,aoIdCalificacionOperacionCliente=-1

,aoNumeroOperacion='0'
,aoMontoSaldoDolar=0

,aoSaldoAcumuladoAnual=0
,aoSaldoPromedioAnual=0

,aoValorActPondRiesgoPromAnual=0

,aoValorComision=0
,aoValorIngresoServicio=0
,aoValorOperacionFinanciera=0
,aoValorInteresRealAnual=0
,aoValorInteresTasaPool=0
,aoValorMargenFinanciero=0
,aoValorMargenBancarioBasico=0
,aoValorMargenOrdinario=0
,aoValorMargenExplotacion=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenOrdinario - CostoOperativo
,aoValorUtilidadOperativa=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenExplotacion - PerdidaEsperada
,aoValorCostoOperativo=isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual
,aoValorPerdidaEsperada=0
,aoTasaPool=0
,aoSpread=0
,aoTasaImplicita=0
,aoNumeroTransaccionesAnual=0
,aoTasaEfectiva=0
,aoValorPorcentajePerdidaEsperada=0
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0

CLOSE SYMMETRIC KEY ClaveMIS02

-- Eliminar Tablas Temporales
if OBJECT_ID ('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end
if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end
if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end
if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHActivoOperacion_ea9a95db-71f3-4cc1-846e-fd5af707e570</ID>
                  <Name>DWHActivoOperacion_Diciembre</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @FechaHaceUnAnio int,@IdCtaSeviciosFinancieros int 

set @Mes=12

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'
select @IdCtaSeviciosFinancieros=ccIdCuentaContable from DWDCuentaContable where ccCodigoIndicador=599 -- '1402000000000000'; Cta Servicios Financieros 

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end

select feIdFecha
into #FechaUnAnio
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #FechaUnAnio fe on ct.ctIdFechaTransaccion=fe.feIdFecha -- Se obtiene la informacion solo de un año
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdMoneda=@IdMoneda
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
--inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ccIdCuentaContable



OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto
,aoIdCalificacionOperacionCliente

,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0)

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)

,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)

,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)

,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion ao
inner join #DWDFecha fe on ao.aoIdFecha=fe.feIdFecha -- Dos Años Atras

union all

select 
 aoIdFecha=ctIdFechaTransaccion
,aoIdCliente=ctIdClientePropietarioOperacion
,aoIdCuentaContable=@IdCtaSeviciosFinancieros --Servicios Financieros IdCuentaContable
,aoIdProducto=-1
,aoIdCalificacionOperacionCliente=-1

,aoNumeroOperacion='0'
,aoMontoSaldoDolar=0

,aoSaldoAcumuladoAnual=0
,aoSaldoPromedioAnual=0

,aoValorActPondRiesgoPromAnual=0

,aoValorComision=0
,aoValorIngresoServicio=0
,aoValorOperacionFinanciera=0
,aoValorInteresRealAnual=0
,aoValorInteresTasaPool=0
,aoValorMargenFinanciero=0
,aoValorMargenBancarioBasico=0
,aoValorMargenOrdinario=0
,aoValorMargenExplotacion=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenOrdinario - CostoOperativo
,aoValorUtilidadOperativa=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenExplotacion - PerdidaEsperada
,aoValorCostoOperativo=isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual
,aoValorPerdidaEsperada=0
,aoTasaPool=0
,aoSpread=0
,aoTasaImplicita=0
,aoNumeroTransaccionesAnual=0
,aoTasaEfectiva=0
,aoValorPorcentajePerdidaEsperada=0
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0

CLOSE SYMMETRIC KEY ClaveMIS02

-- Eliminar Tablas Temporales
if OBJECT_ID ('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end
if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end
if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end
if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @FechaHaceUnAnio int,@IdCtaSeviciosFinancieros int 

set @Mes=12

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'
select @IdCtaSeviciosFinancieros=ccIdCuentaContable from DWDCuentaContable where ccCodigoIndicador=599 -- '1402000000000000'; Cta Servicios Financieros 

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end

select feIdFecha
into #FechaUnAnio
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #FechaUnAnio fe on ct.ctIdFechaTransaccion=fe.feIdFecha -- Se obtiene la informacion solo de un año
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdMoneda=@IdMoneda
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
--inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ccIdCuentaContable



OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 aoIdFecha
,aoIdCliente
,aoIdCuentaContable
,aoIdProducto
,aoIdCalificacionOperacionCliente

,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))
,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0)

,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)

,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)

,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)

,aoValorComision=isnull(aoValorComision,0)
,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)
,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)
,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)
,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)
,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)
,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)
,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)
,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)
,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)
,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)
,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)
,aoTasaPool=isnull(aoTasaPool,0)
,aoSpread=isnull(aoSpread,0)
,aoTasaImplicita=isnull(aoTasaImplicita,0)
,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)
--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)
,aoTasaEfectiva=isnull(aoTasaEfectiva,0)
,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)
from DWHActivoOperacion ao
inner join #DWDFecha fe on ao.aoIdFecha=fe.feIdFecha -- Dos Años Atras

union all

select 
 aoIdFecha=ctIdFechaTransaccion
,aoIdCliente=ctIdClientePropietarioOperacion
,aoIdCuentaContable=@IdCtaSeviciosFinancieros --Servicios Financieros IdCuentaContable
,aoIdProducto=-1
,aoIdCalificacionOperacionCliente=-1

,aoNumeroOperacion='0'
,aoMontoSaldoDolar=0

,aoSaldoAcumuladoAnual=0
,aoSaldoPromedioAnual=0

,aoValorActPondRiesgoPromAnual=0

,aoValorComision=0
,aoValorIngresoServicio=0
,aoValorOperacionFinanciera=0
,aoValorInteresRealAnual=0
,aoValorInteresTasaPool=0
,aoValorMargenFinanciero=0
,aoValorMargenBancarioBasico=0
,aoValorMargenOrdinario=0
,aoValorMargenExplotacion=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenOrdinario - CostoOperativo
,aoValorUtilidadOperativa=0-(isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual) -- ValorMargenExplotacion - PerdidaEsperada
,aoValorCostoOperativo=isnull(ccCostoOperativo,0)*NumeroTransaccionesAnual
,aoValorPerdidaEsperada=0
,aoTasaPool=0
,aoSpread=0
,aoTasaImplicita=0
,aoNumeroTransaccionesAnual=0
,aoTasaEfectiva=0
,aoValorPorcentajePerdidaEsperada=0
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0

CLOSE SYMMETRIC KEY ClaveMIS02

-- Eliminar Tablas Temporales
if OBJECT_ID ('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end
if OBJECT_ID ('tempdb..#FechaUnAnio') is not null begin drop table #FechaUnAnio end
if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end
if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
            <MeasureGroup>
              <ID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</ID>
              <Name>DWDSegmentacionCliente</Name>
              <Measures>
                <Measure>
                  <ID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</ID>
                  <Name>__XL_Count DWDSegmentacionCliente</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scIdSegmentacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scIdSegmentacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scIdCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scIdCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scDetalleCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scDetalleCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scDetalleNombre</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scDetalleNombre</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionTipoCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionTipoCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionTipo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionTipo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrden</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrden</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrdenN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrdenN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrdenN3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrdenN3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</ID>
                  <Name>DWDSegmentacionCliente</Name>
                  <Annotations>
                    <Annotation>
                      <Name>TableWidgetSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="TableWidgetSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;?xml version="1.0"?&gt;
&lt;TableWidgetGridSerialization xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"&gt;
  &lt;ColumnSuggestedType /&gt;
  &lt;ColumnFormat /&gt;
  &lt;ColumnAccuracy /&gt;
  &lt;ColumnCurrencySymbol /&gt;
  &lt;ColumnPositivePattern /&gt;
  &lt;ColumnNegativePattern /&gt;
  &lt;ColumnWidths&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scIdSegmentacionCliente&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;150&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scIdCodigo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;83&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scDetalleCodigo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;106&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scDetalleNombre&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;110&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacionCodigo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;140&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacion&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;107&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacionTipoCodigo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;160&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacionTipo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;127&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacionOrden&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;137&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacionOrdenN2&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;150&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacionOrdenN3&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;150&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
  &lt;/ColumnWidths&gt;
  &lt;ColumnDisplayIndex&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scIdSegmentacionCliente&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;0&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scIdCodigo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;1&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scDetalleCodigo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;2&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scDetalleNombre&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;3&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacionCodigo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;4&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacion&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;5&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacionTipoCodigo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;6&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacionTipo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;7&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacionOrden&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;8&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacionOrdenN2&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;9&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;scSegmentacionOrdenN3&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;10&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
  &lt;/ColumnDisplayIndex&gt;
  &lt;ColumnFrozen /&gt;
  &lt;ColumnChecked /&gt;
  &lt;ColumnFilter /&gt;
  &lt;SelectionFilter /&gt;
  &lt;FilterParameters /&gt;
  &lt;IsSortDescending&gt;false&lt;/IsSortDescending&gt;
&lt;/TableWidgetGridSerialization&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>SELECT [dbo].[DWDSegmentacionCliente].* FROM [dbo].[DWDSegmentacionCliente]</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ErrorConfiguration>
                    <KeyNotFound>IgnoreError</KeyNotFound>
                    <KeyDuplicate>ReportAndStop</KeyDuplicate>
                    <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
                  </ErrorConfiguration>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
            <MeasureGroup>
              <ID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</ID>
              <Name>DWDBanca</Name>
              <Measures>
                <Measure>
                  <ID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</ID>
                  <Name>__XL_Count DWDBanca</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baIdBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baIdBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baCodigoBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baCodigoBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baDescripcionBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baDescripcionBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</ID>
                  <Name>DWDBanca</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;SELECT 
baidbanca,
baCodigoBanca,
baDescripcionBanca 
FROM [dbo].[DWDBanca]&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>SELECT 
baidbanca,
baCodigoBanca,
baDescripcionBanca 
FROM [dbo].[DWDBanca]</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ErrorConfiguration>
                    <KeyNotFound>IgnoreError</KeyNotFound>
                    <KeyDuplicate>ReportAndStop</KeyDuplicate>
                    <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
                  </ErrorConfiguration>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
            <MeasureGroup>
              <ID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</ID>
              <Name>DWDCalificacionOperacionCliente</Name>
              <Measures>
                <Measure>
                  <ID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</ID>
                  <Name>__XL_Count DWDCalificacionOperacionCliente</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCalificacionOperacionCliente</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cocIdCalificacionOperacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</TableID>
                            <ColumnID>cocIdCalificacionOperacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cocCodigoCalificacionOperacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</TableID>
                            <ColumnID>cocCodigoCalificacionOperacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cocCalificacionOperacionCiente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</TableID>
                            <ColumnID>cocCalificacionOperacionCiente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10</ID>
                  <Name>DWDCalificacionOperacionCliente</Name>
                  <Annotations>
                    <Annotation>
                      <Name>IsQueryEditorUsed</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                    </Annotation>
                    <Annotation>
                      <Name>TableWidgetSerialization</Name>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>SELECT [dbo].[DWDCalificacionOperacionCliente].* FROM [dbo].[DWDCalificacionOperacionCliente]</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ErrorConfiguration>
                    <KeyNotFound>IgnoreError</KeyNotFound>
                    <KeyDuplicate>ReportAndStop</KeyDuplicate>
                    <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
                  </ErrorConfiguration>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
            <MeasureGroup>
              <ID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</ID>
              <Name>DWHIngresoOperacion</Name>
              <Measures>
                <Measure>
                  <ID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</ID>
                  <Name>__XL_Count DWHIngresoOperacion</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHIngresoOperacion</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ioIdFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                            <ColumnID>ioIdFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ioIdCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                            <ColumnID>ioIdCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ioIdCuentaContablePrincipal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                            <ColumnID>ioIdCuentaContablePrincipal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ioMontoIngreso</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                            <ColumnID>ioMontoIngreso</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ioSaldoAcumuladoMensualFiscal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                            <ColumnID>ioSaldoAcumuladoMensualFiscal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ioSaldoAcumuladoAnual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                            <ColumnID>ioSaldoAcumuladoAnual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ioMontoCostoTrx</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                            <ColumnID>ioMontoCostoTrx</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ioSaldoAcumuladoAnualCostoTrx</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                            <ColumnID>ioSaldoAcumuladoAnualCostoTrx</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ioSaldoAcumuladoMesCostoTrxFiscal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                            <ColumnID>ioSaldoAcumuladoMesCostoTrxFiscal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ioSaldoInteresRealFiscal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                            <ColumnID>ioSaldoInteresRealFiscal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ioSaldoInteresRealAcumuladoAnualFiscal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                            <ColumnID>ioSaldoInteresRealAcumuladoAnualFiscal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ioNumeroTransaccionesOperacionMesFiscal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                            <ColumnID>ioNumeroTransaccionesOperacionMesFiscal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ioNumeroTransaccionesOperacionAnual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                            <ColumnID>ioNumeroTransaccionesOperacionAnual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ioNumeroTransaccionesOperacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                            <ColumnID>ioNumeroTransaccionesOperacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ioConteoNumeroOperacionAnual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                            <ColumnID>ioConteoNumeroOperacionAnual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ioCostoOperacionAnual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                            <ColumnID>ioCostoOperacionAnual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ioIdCuentaContableVolumen</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</TableID>
                            <ColumnID>ioIdCuentaContableVolumen</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDescripcionFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDescripcionFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalDia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalDia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimNumero</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimNumero</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimDia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimDia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFeriado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFeriado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinSemana</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinSemana</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>EsDiaAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>EsDiaAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>fecIdAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>fecIdAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>EsCierreAño</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>EsCierreAño</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feAnioAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feAnioAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaCierreAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaCierreAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFechaCierreAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFechaCierreAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDiaActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDiaActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDiaAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDiaAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feAnioAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feAnioAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feHaceUnAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feHaceUnAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinTrimestreAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinTrimestreAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMesAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMesAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFechaMesAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFechaMesAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMesTodosAnios</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMesTodosAnios</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feValorCalculoPromedio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feValorCalculoPromedio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feEsMesActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feEsMesActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feEsTrimestreActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feEsTrimestreActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnMesLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnMesLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnTrimestreLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnTrimestreLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnSemestreLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnSemestreLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnAnioLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnAnioLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHistoricoLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHistoricoLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasMesLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasMesLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasTrimLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasTrimLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasTrimFiscLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasTrimFiscLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasSemestLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasSemestLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasAnioLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasAnioLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasHistLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasHistLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimestresAnteriores</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimestresAnteriores</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierrFechAnioActFut</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierrFechAnioActFut</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAntAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAntAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierrMesAnioAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierrMesAnioAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Column1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDFecha[feCalMes]=1,"Ene",
IF(DWDFecha[feCalMes]=2,"Feb",
IF(DWDFecha[feCalMes]=3,"Mar",
IF(DWDFecha[feCalMes]=4,"Abr",
IF(DWDFecha[feCalMes]=5,"May",
IF(DWDFecha[feCalMes]=6,"Jun",
IF(DWDFecha[feCalMes]=7,"Jul",
IF(DWDFecha[feCalMes]=8,"Ago",
IF(DWDFecha[feCalMes]=9,"Sep",
IF(DWDFecha[feCalMes]=10,"Oct",
IF(DWDFecha[feCalMes]=11,"Nov","Dic")
))))))))))

</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Column1 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDFecha[feCalMesCorto] &amp; " " &amp; DWDFecha[feCalAnio]
</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaTresMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaTresMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaSeisMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaSeisMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaDoceMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaDoceMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalMesAnteriorRentabilidad</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDFecha[feIdFecha]=[ValFechaMesAntRent],1,0)</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>FechaMesAntRent</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>FechaMesAntRent</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>F</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Agregar columna2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>ioIdFecha</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>8832beb8-3b8e-4df3-98ed-1dfbed58ea42</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clCodigoCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clNombreCompleto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clNombreCompleto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdAsesorPrincipal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdAsesorPrincipal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clVinculacionValor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clVinculacionValor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clCodigoGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clFechaFin</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clFechaFin</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdSegmentacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdSegmentacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCalClienteDesde</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clCalClienteDesde</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>CanalCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDCanalCliente[caDescripcionAgrupacionCanal])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreAgencia])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreRegion])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreZona])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAsesorOperacionCliente[asNombreAsesor])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clSegmentacionTipoCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clSegmentacionTipoCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ClCodigoCliente1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 4</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDCliente[clCodigoCliente] &amp; "-" &amp; DWDCliente[clNombreCompleto]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 5</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED('DWDAsesorOperacionCliente'[asCodigoAsesor])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDCanalCliente[caCodigoAgrupacionCanal])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoAgencia])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoZona])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoRegion])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoRegion 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoRegional])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoSubregion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoSubregion])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clFechaIngreso</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clFechaIngreso</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>ioIdCliente</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>c36c566a-ff4f-402e-ac8e-146baee30bab</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caIdCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caIdCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodigoCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodigoCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caDescripcionAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caDescripcionAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caOrdenCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caOrdenCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caAgrupacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caAgrupacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caOrdenDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caOrdenDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodDescripcionAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodDescripcionAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCanalConsolidado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdCanal</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agIdAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agIdAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agDireccionAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agDireccionAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agTelefonoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agTelefonoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agResponsableNombre</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agResponsableNombre</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agFechaApertura</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agFechaApertura</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agFechaClausura</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agFechaClausura</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNumeroColaboradores</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNumeroColaboradores</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agMontoInvertido</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agMontoInvertido</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoSubregion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoSubregion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoCantonCompleto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoCantonCompleto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreCanton</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreCanton</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoProvincia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoProvincia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreProvincia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreProvincia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegionDescn</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegionDescn</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreRegionDescn</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreRegionDescn</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agOrdenRegionAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agOrdenRegionAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoJefeAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoJefeAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreJefeAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreJefeAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdAgencia</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asIdAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asIdAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asUsuario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asUsuario</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asAsesorPrincipal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asAsesorPrincipal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asOrdenAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asOrdenAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDAsesorOperacionCliente[asCodigoAsesor] &amp; "-" &amp; DWDAsesorOperacionCliente[asNombreAsesor]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdAsesorPrincipal</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scIdSegmentacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scIdSegmentacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scIdCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scIdCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scDetalleCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scDetalleCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scDetalleNombre</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scDetalleNombre</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionTipoCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionTipoCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionTipo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionTipo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrden</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrden</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrdenN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrdenN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrdenN3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrdenN3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdSegmentacionCliente</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baIdBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baIdBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baCodigoBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baCodigoBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baDescripcionBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baDescripcionBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdBanca</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccIdCuentaContable</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccIdCuentaContable</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoNivel6</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCodigoNivel6</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoMoneda</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCodigoMoneda</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoIndicador</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCodigoIndicador</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalIndicadorNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>cpCalIndicadorNivel1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalIndicadorNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>cpCalIndicadorNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCalProductoNivel1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCalProductoNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>CpEstadoProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>CpEstadoProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccAgrupacionContableNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccAgrupacionContableNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccSubGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccSubGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCodigoAgrupacionRentabilidaN1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCalCodigoAgrupacionRentabilidaN1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalAgrupacionRentabilidaN1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCalAgrupacionRentabilidaN1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCodigoTipoIngresoN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCalCodigoTipoIngresoN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalTipoIngresoN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCalTipoIngresoN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalDescripcionNivel6N3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCalDescripcionNivel6N3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cuentaPrueba</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDCuentaContableIngresos[ccCodigoNivel6]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccTarifaTransaccion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccTarifaTransaccion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccAgrupacionTributario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccAgrupacionTributario</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Tarjeta de debito, emision y renovacion",  7,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Tarjeta de debito, reposicion",8 ,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Mantenimiento de tarjeta de credito", 9,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Atm - Otras Transacciones", 11,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Atm - Retiros clientes propios (Sin costo)",12 ,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Otras transacciones", 13,99))))))


</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCuentaAdquirenciaTC</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCuentaAdquirenciaTC</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCodigoAgrupacionRentabilidaN4</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCalCodigoAgrupacionRentabilidaN4</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoIndicadorRentabilidad</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCodigoIndicadorRentabilidad</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalAgrupacionTarifaBasica</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCalAgrupacionTarifaBasica</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>ioIdCuentaContablePrincipal</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>7df4f545-e4d3-4b88-b372-0443485183ba</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccIdCuentaContable</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccIdCuentaContable</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoMoneda</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoMoneda</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoIndicador</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoIndicador</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>CpEstadoProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>CpEstadoProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoNivel6</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoNivel6</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccAgrupacionContableNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccAgrupacionContableNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalIndicadorNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>cpCalIndicadorNivel1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalIndicadorNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>cpCalIndicadorNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalProductoNivel1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalProductoNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccSubGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccSubGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccTarifaTransaccion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccTarifaTransaccion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalAgrupacionRentabilidaN1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalAgrupacionRentabilidaN1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalTipoIngresoN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalTipoIngresoN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalDescripcionNivel6N3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalDescripcionNivel6N3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCodigoAgrupacionRentabilidaN1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalCodigoAgrupacionRentabilidaN1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCodigoTipoIngresoN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalCodigoTipoIngresoN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalOrdenIndicadorNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>
IF(DWDCuentaContable[cpCalIndicadorNivel1]=1 ||  DWDCuentaContable[cpCalIndicadorNivel1]=80,20,
  IF(DWDCuentaContable[cpCalIndicadorNivel1]=2,10,
      IF(DWDCuentaContable[cpCalIndicadorNivel1]=3,30,
             IF(DWDCuentaContable[cpCalIndicadorNivel1]=72,40,99))))</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalOrdenIndicadorNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>
if(DWDCuentaContable[cpCalIndicadorNivel2]=140,11,
  if(DWDCuentaContable[cpCalIndicadorNivel2]=141,12,
    if(DWDCuentaContable[cpCalIndicadorNivel2]=142,13,
      if(DWDCuentaContable[cpCalIndicadorNivel2]=120 || DWDCuentaContable[cpCalIndicadorNivel2]=126,21,
         if(DWDCuentaContable[cpCalIndicadorNivel2]=121,22,
            if(DWDCuentaContable[cpCalIndicadorNivel2]=122,23,
               if(DWDCuentaContable[cpCalIndicadorNivel2]=124,24,
                  if(DWDCuentaContable[cpCalIndicadorNivel2]=200,25,
                  if(DWDCuentaContable[cpCalIndicadorNivel2]=160,31,
                     if(DWDCuentaContable[cpCalIndicadorNivel2]=161,32,
                       if(DWDCuentaContable[cpCalIndicadorNivel2]=162,33,
                          if(DWDCuentaContable[cpCalIndicadorNivel2]=100,40,99
                          ))))))))))))
                          
                        </Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccAgrupacionTributario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccAgrupacionTributario</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalOrdenAgrupacionTributario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalBandera</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccAgrupacionRentabilidadTransaccion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccAgrupacionRentabilidadTransaccion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoBruto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCovid</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCovid</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoOperCredito</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalEstadoOpeCredito</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalAgrupacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDCuentaContable[cpCalIndicadorNivel1]=1 &amp;&amp; DWDCuentaContable[ccCovid]=TRUE() , DWDCuentaContable[ccCalDescripcionNivel6N3], 
    IF(DWDCuentaContable[cpCalIndicadorNivel1]=1  &amp;&amp; (DWDCuentaContable[cpCalIndicadorNivel2]=122 || DWDCuentaContable[cpCalIndicadorNivel2]=126) ,  UPPER(DWDCuentaContable[ccSubGrupo]),
      IF(DWDCuentaContable[cpCalIndicadorNivel1]=1  , UPPER(DWDCuentaContable[ccCalProductoNivel2]) &amp; " " &amp;  UPPER(DWDCuentaContable[ccSubGrupo]),BLANK())))

&amp; " " &amp; DWDCuentaContable[ccCalProductoCobranza]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32768</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoNivel3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32768</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoNivel3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoCobranza</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32768</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalProductoCobranza</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoIndicadorRentabilidad</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoIndicadorRentabilidad</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>ioIdCuentaContableVolumen</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>b6fa4a5e-c7e7-4591-b791-3b09f0a9f5ec</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grIdentificacionGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grIdentificacionGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grNombreGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grNombreGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAgrCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAgrCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grNombreAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grNombreAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clCodigoGrupo</IntermediateGranularityAttributeID>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>DWHIngresoOperacion_6e347228-c53b-4c15-9dc0-d1678065adf6</ID>
                  <Name>DWHIngresoOperacion_Enero</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=1

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal
,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable
,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=1

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal
,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable
,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
                <Partition>
                  <ID>DWHIngresoOperacion_7674b741-b2b1-4ed3-bf50-6ef0693d1942</ID>
                  <Name>DWHIngresoOperacion_Febrero</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=2

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal
,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable
,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=2

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal
,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable
,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHIngresoOperacion_6ec407de-4e3b-42a4-ae08-d48f5c727925</ID>
                  <Name>DWHIngresoOperacion_Marzo</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=3

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal
,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable
,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=3

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal
,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable
,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHIngresoOperacion_1f81ce86-bafd-4cea-9206-33334faa8fc1</ID>
                  <Name>DWHIngresoOperacion_Abril</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=4

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal
,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable
,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=4

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal
,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable
,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHIngresoOperacion_39b67ffc-c607-430e-8de7-b612faef9df2</ID>
                  <Name>DWHIngresoOperacion_Mayo</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=5

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal
,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable
,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=5

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal
,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable
,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHIngresoOperacion_3b364a45-c3d6-4ee3-ad77-1f9dce676258</ID>
                  <Name>DWHIngresoOperacion_Junio</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=6

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal
,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable
,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=6

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal
,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable
,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHIngresoOperacion_af175655-a39c-4fcc-9ba8-0c960d4ab1e3</ID>
                  <Name>DWHIngresoOperacion_Julio</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=7

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal
,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable
,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=7

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal
,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable
,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHIngresoOperacion_bbb1660c-19c8-40cc-ba1a-9ab7124f1164</ID>
                  <Name>DWHIngresoOperacion_Agosto</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=8

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal
,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable
,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=8

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal
,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable
,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHIngresoOperacion_bd5ea1ee-e3c9-4ff2-ae70-de9510294634</ID>
                  <Name>DWHIngresoOperacion_Septiembre</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=9

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal
,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable
,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=9

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal
,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable
,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHIngresoOperacion_1e1a4a6b-31b3-4289-94ea-8ac70a8f6dea</ID>
                  <Name>DWHIngresoOperacion_Octubre</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=10

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal
,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable
,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=10

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal
,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable
,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHIngresoOperacion_39da2d7c-5870-4a6b-873c-4191c04bcc50</ID>
                  <Name>DWHIngresoOperacion_Noviembre</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=11

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal
,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable
,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=11

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal
,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable
,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHIngresoOperacion_d51e61cf-2680-46f9-90f4-621fb3b15114</ID>
                  <Name>DWHIngresoOperacion_Diciembre</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=12

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal
,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable
,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int

set @Mes=12

/* -------  Parametros ------------ */

select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end

select feIdFecha
into #Fecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes 
and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente

-- Tarjeta / Pasivo --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in (
 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros
,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente
,62 --Mantenimiento tarjeta credito
)


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01


if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end

select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal 
into #Pasivo
from DWHPasivoOperacion po
inner join #Fecha fe on po.poIdFecha=fe.feIdFecha


if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end

select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal
into #Tarjeta
from DWHTarjetaCreditoOperacion tco
inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02


-- Cuenta Contable --

/* 
 50	Pago de Cheque por Ventanilla 
 51	Pago de cheques por cámara 
 52	Pago de Cheque Certificado 
 53	Retiro en cajas cuentas de ahorros 
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios 
 56	Depósitos Efectivo - Ahorros, cuentas corrientes 
 57	Deposito en cheque ahorros y cuentas corriente 
*/

if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContable
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select 
ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccional
from DWHCanalTransaccional ct
inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion

-- Cliente --

if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end

select 
 clIdClienteND=max(clIdCliente) -- Id No Duplicado
,clCodigoCliente 
into #NoDuplicadoCliente
from DWDCliente
group by clCodigoCliente

if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end

select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND
into #Cliente
from DWDCliente cl1
inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente


-- Resultado Final --

if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end

select
 ctIdFechaTransaccion
,ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroOperacion=cast('0' as varchar(30))
,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo
                                else ctNumeroTransaccionesMesFiscal  end )
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #IndicadoresSaldos
from #CanalTransaccional ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos
inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable


insert into #IndicadoresSaldos
select 
 poidfecha
,poidcliente --max(poidcliente)
,poidcuentacontable --=max(poidcuentacontable)
,poNoOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Pasivo po
inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable
where poSaldoAcumuladoMensualFiscal!=0
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion

insert into #IndicadoresSaldos
select 
 tcoidfecha
,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente 
,tcoidcuentacontable=max(tcoIdCuentaContable)
,tcoNumeroOperacion
,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
from #Tarjeta tco
inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable
inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente
where tcoSaldoAcumuladoMensualFiscal!=0
group by tcoidfecha,tcoNumeroOperacion,clIdClienteND


select
 ioIdFecha
,ioIdCliente
,ioIdCuentaContablePrincipal
,ioMontoIngreso=sum(ioMontoIngreso)
,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)
,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)
,ioMontoCostoTrx=sum(ioMontoCostoTrx)
,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)
,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)
,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)
,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)
,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)
,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)
,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)
,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)
,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)
,ioIdCuentaContableVolumen
from DWHIngresoOperacion iop
inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha
group by ioIdFecha,ioIdCliente
,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen

union all

select
 ioIdFecha=ct.ctIdFechaTransaccion
,ioIdCliente=ct.ctIdClientePropietarioOperacion
,ioIdCuentaContablePrincipal=ct.IdCuentaContable
,ioMontoIngreso=0
,ioSaldoAcumuladoMensualFiscal=0
,ioSaldoAcumuladoAnual=0
,ioMontoCostoTrx=0
,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )
,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )
,ioSaldoInteresRealFiscal=0
,ioSaldoInteresRealAcumuladoAnualFiscal=0
,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )
,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )
,ioNumeroTransaccionesOperacion=0
,ioConteoNumeroOperacionAnual=0
,ioCostoOperacionAnual=0
,ioIdCuentaContableVolumen=-1
from #IndicadoresSaldos ct
inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable
where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0
group by ct.ctIdFechaTransaccion
,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable

if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end
if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end
if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end
if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
            <MeasureGroup>
              <ID>DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b</ID>
              <Name>DWDMoneda</Name>
              <Measures>
                <Measure>
                  <ID>DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b</ID>
                  <Name>__XL_Count DWDMoneda</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDMoneda</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>moIdMoneda</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b</TableID>
                            <ColumnID>moIdMoneda</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>moCodigoMoneda</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b</TableID>
                            <ColumnID>moCodigoMoneda</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>moMoneda</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b</TableID>
                            <ColumnID>moMoneda</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b</ID>
                  <Name>DWDMoneda</Name>
                  <Annotations>
                    <Annotation>
                      <Name>IsQueryEditorUsed</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                    </Annotation>
                    <Annotation>
                      <Name>TableWidgetSerialization</Name>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>SELECT [dbo].[DWDMoneda].* FROM [dbo].[DWDMoneda]</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ErrorConfiguration>
                    <KeyNotFound>IgnoreError</KeyNotFound>
                    <KeyDuplicate>ReportAndStop</KeyDuplicate>
                    <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
                  </ErrorConfiguration>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
            <MeasureGroup>
              <ID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</ID>
              <Name>DWDProducto</Name>
              <Measures>
                <Measure>
                  <ID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</ID>
                  <Name>__XL_Count DWDProducto</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prIdProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prIdProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prCodigoProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prCodigoProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prSubGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prSubGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prFamiliaProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prFamiliaProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prVehiculo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prVehiculo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prCodigoIndicador</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prCodigoIndicador</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prOrdenN1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prOrdenN1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prOrdenN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prOrdenN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prOrdenN3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prOrdenN3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prDescripcionProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prDescripcionProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prTipoProductoAUMS</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prTipoProductoAUMS</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prCalBanderaVehiculos</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDProducto[prVehiculo]="Vehiculos",DWDProducto[prVehiculo],"Sin Vehiculos")</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</ID>
                  <Name>DWDProducto</Name>
                  <Annotations>
                    <Annotation>
                      <Name>TableWidgetSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="TableWidgetSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;?xml version="1.0"?&gt;
&lt;TableWidgetGridSerialization xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"&gt;
  &lt;ColumnSuggestedType /&gt;
  &lt;ColumnFormat /&gt;
  &lt;ColumnAccuracy /&gt;
  &lt;ColumnCurrencySymbol /&gt;
  &lt;ColumnPositivePattern /&gt;
  &lt;ColumnNegativePattern /&gt;
  &lt;ColumnWidths&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prIdProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;117&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prCodigoProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;148&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;105&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prSubGrupo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;110&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prGrupo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;86&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prFamiliaProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;144&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prVehiculo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;98&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prCodigoIndicador&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;148&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prOrdenN1&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;103&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prOrdenN2&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;103&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prOrdenN3&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;103&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prDescripcionProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;175&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prCodigoTipoProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;174&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prDescripcionTipoProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;201&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prTipoProductoAUMS&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;166&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
  &lt;/ColumnWidths&gt;
  &lt;ColumnDisplayIndex&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prIdProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;0&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prCodigoProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;1&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;2&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prSubGrupo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;3&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prGrupo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;4&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prFamiliaProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;5&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prVehiculo&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;6&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prCodigoIndicador&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;7&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prOrdenN1&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;8&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prOrdenN2&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;9&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prOrdenN3&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;10&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prDescripcionProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;11&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prCodigoTipoProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;12&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prDescripcionTipoProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;13&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prTipoProductoAUMS&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;int&gt;14&lt;/int&gt;
      &lt;/value&gt;
    &lt;/item&gt;
  &lt;/ColumnDisplayIndex&gt;
  &lt;ColumnFrozen /&gt;
  &lt;ColumnChecked&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prCodigoTipoProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;boolean&gt;false&lt;/boolean&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prDescripcionTipoProducto&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;boolean&gt;false&lt;/boolean&gt;
      &lt;/value&gt;
    &lt;/item&gt;
    &lt;item&gt;
      &lt;key&gt;
        &lt;string&gt;prTipoProductoAUMS&lt;/string&gt;
      &lt;/key&gt;
      &lt;value&gt;
        &lt;boolean&gt;true&lt;/boolean&gt;
      &lt;/value&gt;
    &lt;/item&gt;
  &lt;/ColumnChecked&gt;
  &lt;ColumnFilter /&gt;
  &lt;SelectionFilter /&gt;
  &lt;FilterParameters /&gt;
  &lt;IsSortDescending&gt;false&lt;/IsSortDescending&gt;
&lt;/TableWidgetGridSerialization&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>SELECT [dbo].[DWDProducto].[prIdProducto],[dbo].[DWDProducto].[prCodigoProducto],[dbo].[DWDProducto].[prProducto],[dbo].[DWDProducto].[prSubGrupo],[dbo].[DWDProducto].[prGrupo],[dbo].[DWDProducto].[prFamiliaProducto],[dbo].[DWDProducto].[prVehiculo],[dbo].[DWDProducto].[prCodigoIndicador],[dbo].[DWDProducto].[prOrdenN1],[dbo].[DWDProducto].[prOrdenN2],[dbo].[DWDProducto].[prOrdenN3],[dbo].[DWDProducto].[prDescripcionProducto],[dbo].[DWDProducto].[prTipoProductoAUMS] FROM [dbo].[DWDProducto]</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ErrorConfiguration>
                    <KeyNotFound>IgnoreError</KeyNotFound>
                    <KeyDuplicate>ReportAndStop</KeyDuplicate>
                    <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
                  </ErrorConfiguration>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
            <MeasureGroup>
              <ID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</ID>
              <Name>DWHPerdidaEsperadaPortafolioGlobal</Name>
              <Measures>
                <Measure>
                  <ID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</ID>
                  <Name>__XL_Count DWHPerdidaEsperadaPortafolioGlobal</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPerdidaEsperadaPortafolioGlobal</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>peIdFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                            <ColumnID>peIdFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>peIdCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                            <ColumnID>peIdCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>peProbabilidadIncumplimientoPD</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                            <ColumnID>peProbabilidadIncumplimientoPD</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>peSeveridadLGD</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                            <ColumnID>peSeveridadLGD</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>peExposicionIncumplimientoEAD</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                            <ColumnID>peExposicionIncumplimientoEAD</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>pePerdidaEsperadaPE</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                            <ColumnID>pePerdidaEsperadaPE</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>peNumeroOperacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                            <ColumnID>peNumeroOperacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>peCalculoOperacionPEMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                            <ColumnID>peCalculoOperacionPEMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>peValorOperacionPETrimestral</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                            <ColumnID>peValorOperacionPETrimestral</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>peValorOperacionPESemestral</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                            <ColumnID>peValorOperacionPESemestral</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>peValorOperacionPEAnual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</TableID>
                            <ColumnID>peValorOperacionPEAnual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clCodigoCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clNombreCompleto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clNombreCompleto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdAsesorPrincipal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdAsesorPrincipal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clVinculacionValor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clVinculacionValor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clCodigoGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clFechaFin</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clFechaFin</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdSegmentacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdSegmentacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCalClienteDesde</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clCalClienteDesde</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>CanalCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDCanalCliente[caDescripcionAgrupacionCanal])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreAgencia])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreRegion])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreZona])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAsesorOperacionCliente[asNombreAsesor])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clSegmentacionTipoCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clSegmentacionTipoCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ClCodigoCliente1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 4</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDCliente[clCodigoCliente] &amp; "-" &amp; DWDCliente[clNombreCompleto]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 5</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED('DWDAsesorOperacionCliente'[asCodigoAsesor])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDCanalCliente[caCodigoAgrupacionCanal])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoAgencia])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoZona])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoRegion])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoRegion 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoRegional])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoSubregion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoSubregion])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clFechaIngreso</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clFechaIngreso</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>peIdCliente</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>505a30ae-c4f9-4200-b404-8daa70a56a93</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caIdCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caIdCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodigoCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodigoCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caDescripcionAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caDescripcionAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caOrdenCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caOrdenCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caAgrupacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caAgrupacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caOrdenDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caOrdenDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodDescripcionAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodDescripcionAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCanalConsolidado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdCanal</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agIdAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agIdAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agDireccionAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agDireccionAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agTelefonoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agTelefonoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agResponsableNombre</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agResponsableNombre</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agFechaApertura</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agFechaApertura</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agFechaClausura</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agFechaClausura</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNumeroColaboradores</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNumeroColaboradores</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agMontoInvertido</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agMontoInvertido</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoSubregion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoSubregion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoCantonCompleto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoCantonCompleto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreCanton</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreCanton</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoProvincia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoProvincia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreProvincia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreProvincia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegionDescn</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegionDescn</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreRegionDescn</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreRegionDescn</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agOrdenRegionAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agOrdenRegionAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoJefeAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoJefeAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreJefeAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreJefeAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdAgencia</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asIdAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asIdAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asUsuario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asUsuario</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asAsesorPrincipal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asAsesorPrincipal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asOrdenAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asOrdenAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDAsesorOperacionCliente[asCodigoAsesor] &amp; "-" &amp; DWDAsesorOperacionCliente[asNombreAsesor]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdAsesorPrincipal</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scIdSegmentacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scIdSegmentacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scIdCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scIdCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scDetalleCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scDetalleCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scDetalleNombre</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scDetalleNombre</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionTipoCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionTipoCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionTipo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionTipo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrden</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrden</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrdenN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrdenN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrdenN3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrdenN3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdSegmentacionCliente</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baIdBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baIdBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baCodigoBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baCodigoBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baDescripcionBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baDescripcionBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdBanca</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDescripcionFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDescripcionFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalDia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalDia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimNumero</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimNumero</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimDia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimDia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFeriado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFeriado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinSemana</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinSemana</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>EsDiaAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>EsDiaAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>fecIdAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>fecIdAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>EsCierreAño</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>EsCierreAño</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feAnioAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feAnioAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaCierreAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaCierreAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFechaCierreAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFechaCierreAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDiaActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDiaActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDiaAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDiaAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feAnioAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feAnioAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feHaceUnAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feHaceUnAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinTrimestreAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinTrimestreAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMesAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMesAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFechaMesAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFechaMesAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMesTodosAnios</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMesTodosAnios</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feValorCalculoPromedio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feValorCalculoPromedio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feEsMesActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feEsMesActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feEsTrimestreActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feEsTrimestreActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnMesLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnMesLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnTrimestreLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnTrimestreLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnSemestreLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnSemestreLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnAnioLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnAnioLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHistoricoLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHistoricoLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasMesLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasMesLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasTrimLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasTrimLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasTrimFiscLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasTrimFiscLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasSemestLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasSemestLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasAnioLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasAnioLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasHistLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasHistLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimestresAnteriores</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimestresAnteriores</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierrFechAnioActFut</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierrFechAnioActFut</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAntAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAntAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierrMesAnioAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierrMesAnioAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Column1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDFecha[feCalMes]=1,"Ene",
IF(DWDFecha[feCalMes]=2,"Feb",
IF(DWDFecha[feCalMes]=3,"Mar",
IF(DWDFecha[feCalMes]=4,"Abr",
IF(DWDFecha[feCalMes]=5,"May",
IF(DWDFecha[feCalMes]=6,"Jun",
IF(DWDFecha[feCalMes]=7,"Jul",
IF(DWDFecha[feCalMes]=8,"Ago",
IF(DWDFecha[feCalMes]=9,"Sep",
IF(DWDFecha[feCalMes]=10,"Oct",
IF(DWDFecha[feCalMes]=11,"Nov","Dic")
))))))))))

</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Column1 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDFecha[feCalMesCorto] &amp; " " &amp; DWDFecha[feCalAnio]
</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaTresMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaTresMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaSeisMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaSeisMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaDoceMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaDoceMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalMesAnteriorRentabilidad</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDFecha[feIdFecha]=[ValFechaMesAntRent],1,0)</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>FechaMesAntRent</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>FechaMesAntRent</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>F</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Agregar columna2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>peIdFecha</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>9cbd90a4-082b-484f-a39f-7ddeea344d5f</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grIdentificacionGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grIdentificacionGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grNombreGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grNombreGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAgrCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAgrCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grNombreAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grNombreAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clCodigoGrupo</IntermediateGranularityAttributeID>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa</ID>
                  <Name>DWHPerdidaEsperadaPortafolioGlobal</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @FechaMesAnt int, @FechaHaceDosAnios int

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 peIdFecha
,peIdCliente
,peNumeroOperacion=CONVERT(varchar(25), DecryptByKey(peNumeroOperacion))
,peProbabilidadIncumplimientoPD
,peSeveridadLGD
,peExposicionIncumplimientoEAD
,pePerdidaEsperadaPE
,peCalculoOperacionPEMes
,peValorOperacionPETrimestral
,peValorOperacionPESemestral
,peValorOperacionPEAnual

--,pePerdidaEsperadaPEAnual
--,peExposicionIncumplimientoEADAnual
--,peValorPorcentajePE

from DWHPerdidaEsperadaPortafolioGlobal pe
inner join #DWDFecha fe on pe.peIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @FechaMesAnt int, @FechaHaceDosAnios int

-- Fecha hace dos años corrido --
select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt
and fecierremes=1


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select
 peIdFecha
,peIdCliente
,peNumeroOperacion=CONVERT(varchar(25), DecryptByKey(peNumeroOperacion))
,peProbabilidadIncumplimientoPD
,peSeveridadLGD
,peExposicionIncumplimientoEAD
,pePerdidaEsperadaPE
,peCalculoOperacionPEMes
,peValorOperacionPETrimestral
,peValorOperacionPESemestral
,peValorOperacionPEAnual

--,pePerdidaEsperadaPEAnual
--,peExposicionIncumplimientoEADAnual
--,peValorPorcentajePE

from DWHPerdidaEsperadaPortafolioGlobal pe
inner join #DWDFecha fe on pe.peIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ErrorConfiguration>
                    <KeyNotFound>IgnoreError</KeyNotFound>
                    <KeyDuplicate>ReportAndStop</KeyDuplicate>
                    <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
                  </ErrorConfiguration>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
            <MeasureGroup>
              <ID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</ID>
              <Name>DWDPerfilesAccesoMonitores</Name>
              <Measures>
                <Measure>
                  <ID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</ID>
                  <Name>__XL_Count DWDPerfilesAccesoMonitores</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDPerfilesAccesoMonitores</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>pamIdPerfilAcceso</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                            <ColumnID>pamIdPerfilAcceso</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>pamBinUsuario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                            <ColumnID>pamBinUsuario</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>pamBinPerfil</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                            <ColumnID>pamBinPerfil</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>pamIdAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                            <ColumnID>pamIdAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>pamBinUsuarioPadre</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                            <ColumnID>pamBinUsuarioPadre</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>pamRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                            <ColumnID>pamRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>pamSubregion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                            <ColumnID>pamSubregion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>pamDescripcionPerfil</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</TableID>
                            <ColumnID>pamDescripcionPerfil</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11</ID>
                  <Name>DWDPerfilesAccesoMonitores</Name>
                  <Annotations>
                    <Annotation>
                      <Name>IsQueryEditorUsed</Name>
                      <Value>True</Value>
                    </Annotation>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;select * from DWDPerfilesAccesoMonitores&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                    <Annotation>
                      <Name>TableWidgetSerialization</Name>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>select * from DWDPerfilesAccesoMonitores</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ErrorConfiguration>
                    <KeyNotFound>IgnoreError</KeyNotFound>
                    <KeyDuplicate>ReportAndStop</KeyDuplicate>
                    <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
                  </ErrorConfiguration>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
            <MeasureGroup>
              <ID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</ID>
              <Name>DWDCuentaContableIngresos</Name>
              <Measures>
                <Measure>
                  <ID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</ID>
                  <Name>__XL_Count DWDCuentaContableIngresos</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccIdCuentaContable</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccIdCuentaContable</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoNivel6</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCodigoNivel6</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoMoneda</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCodigoMoneda</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoIndicador</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCodigoIndicador</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalIndicadorNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>cpCalIndicadorNivel1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalIndicadorNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>cpCalIndicadorNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCalProductoNivel1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCalProductoNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>CpEstadoProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>CpEstadoProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccAgrupacionContableNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccAgrupacionContableNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccSubGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccSubGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCodigoAgrupacionRentabilidaN1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCalCodigoAgrupacionRentabilidaN1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalAgrupacionRentabilidaN1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCalAgrupacionRentabilidaN1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCodigoTipoIngresoN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCalCodigoTipoIngresoN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalTipoIngresoN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCalTipoIngresoN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalDescripcionNivel6N3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCalDescripcionNivel6N3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cuentaPrueba</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDCuentaContableIngresos[ccCodigoNivel6]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccTarifaTransaccion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccTarifaTransaccion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccAgrupacionTributario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccAgrupacionTributario</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Tarjeta de debito, emision y renovacion",  7,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Tarjeta de debito, reposicion",8 ,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Mantenimiento de tarjeta de credito", 9,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Atm - Otras Transacciones", 11,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Atm - Retiros clientes propios (Sin costo)",12 ,
IF(DWDCuentaContableIngresos[ccAgrupacionTributario]="Otras transacciones", 13,99))))))


</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCuentaAdquirenciaTC</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCuentaAdquirenciaTC</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCodigoAgrupacionRentabilidaN4</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCalCodigoAgrupacionRentabilidaN4</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoIndicadorRentabilidad</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCodigoIndicadorRentabilidad</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalAgrupacionTarifaBasica</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</TableID>
                            <ColumnID>ccCalAgrupacionTarifaBasica</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a</ID>
                  <Name>DWDCuentaContableIngresos</Name>
                  <Annotations>
                    <Annotation>
                      <Name>TableWidgetSerialization</Name>
                    </Annotation>
                    <Annotation>
                      <Name>TableWidgetSourceTable</Name>
                    </Annotation>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT DISTINCT 
  cc.ccIdCuentaContable,
  ccCodigoNivel6=CONVERT(varchar(12), DecryptByKey(cc.ccCodigoNivel6)),
  cc.ccCodigoMoneda,
  cc.ccCodigoIndicador,  
  
  cpCalIndicadorNivel1=case when cp.indicadorNivel1 is null then cr.CpCodigoIndicadorN2 else cp.indicadorNivel1 end, -- se tiene los codigos de rentabilidad de nivel unon para el filtro en el dataset
  cpCalIndicadorNivel2=cp.indicadorNivel2, 
  --cpCalIndicadorNivel3=cp.indicadorNivel3, -- Se comento porque la informacion ya tiene la columna cc.ccCodigoIndicador

  ccCalProductoNivel1= case when cp.ProductoNivel1 is null then cc.ccFamiliaProducto else cp.ProductoNivel1  end,
  ccCalProductoNivel2= case when cp.ProductoNivel2 is null then cc.ccGrupo else cp.ProductoNivel2  end,

  cp.CpEstadoProducto,
  --cp.CpOrden, Comente porque no se usa
  cc.ccAgrupacionContableNivel2,
   
  ccSubGrupo,
  ccTarifaTransaccion=ccCostoOperativo,

  ccCalCodigoAgrupacionRentabilidaN1=cr.CpCodigoIndicadorN2,
  ccCalAgrupacionRentabilidaN1=ltrim(rtrim(upper(CpProducto))),
  ccCalCodigoTipoIngresoN2=cr.CpCodigoIndicadorN3,
  ccCalTipoIngresoN2=ltrim(rtrim(upper(ccTipoIngreso))),
  ccCalDescripcionNivel6N3= case when CONVERT(varchar(150), DecryptByKey(cc.ccDescripcionNivel6)) like '%SIN%DESCRIPCION%NIVEL%' then 'SIN DESCRIPCION NIVEL' 
                            else substring(CONVERT(varchar(150), DecryptByKey(cc.ccDescripcionNivel6)),14,100) end,

  ccCodigoIndicadorRentabilidad,
  ccCalAgrupacionTarifaBasica=isnull(cr.CpProductoN4,'SIN AGRUPACION'),

  ccAgrupacionTributario,
  ccCuentaAdquirenciaTC=case when ccCodigoIndicadorRentabilidad=40 then 1 else 0 end,ccCalCodigoAgrupacionRentabilidaN4=cr.CpCodigoIndicadorN4
  
  --drop table #DWDCuentaContable
  --into #DWDCuentaContable

FROM DWDCuentaContable cc
left outer join
( 
    SELECT DISTINCT 
    p.CpCodigoIndicador indicadorNivel1,p1.CpCodigoIndicador indicadorNivel2,p2.CpCodigoIndicador indicadorNivel3,
    p.CpProducto ProductoNivel1,
    ProductoNivel2=case when p1.CpCodigoIndicador=124  then 'Tarjeta de Credito' else p1.CpProducto end,
    p2.CpEstadoProducto,
    isnull(p1.CpOrden,1) CpOrden
    FROM DWDClasificacionProductos p
    join DWDClasificacionProductos p1 ON p1.CpPadre=p.CpCodigoIndicador
    join DWDClasificacionProductos p2 ON p2.CpPadre=p1.CpCodigoIndicador
    WHERE p.CpCodigoIndicador in (1,2,3,72,80) -- Comente los indicadores 32,28 ; 72 (ficticias de ingresos); 80 (Portafolio)
    and  p.CpNivel=1 and p1.CpNivel=2 and p2.CpNivel=3
    and p1.CpCodigoIndicador not in (143,144) -- Se excluye estas agrupaciones que no pertenecen a captaciones EA

) cp ON ccCodigoIndicador=cp.indicadorNivel3
left outer join
(
   select distinct
   CpCodigoIndicadorN4=n4.CpCodigoIndicador,
   CpProductoN4=case when n3.CpCodigoIndicador between 460 and 465 then n4.CpProducto else 'SIN AGRUPACION' end, -- Solo se obtiene las agrupaciones de tarifa básica / Conteo Tributario
   CpCodigoIndicadorN2=n2.CpCodigoIndicador,
   CpCodigoIndicadorN3=n3.CpCodigoIndicador,
   n2.CpProducto
   from DWDClasificacionProductos n1
   inner join DWDClasificacionProductos n2 on n2.CpPadre=n1.CpCodigoIndicador
   inner join DWDClasificacionProductos n3 on n3.CpPadre=n2.CpCodigoIndicador
   inner join DWDClasificacionProductos n4 on n4.CpPadre=n3.CpCodigoIndicador
   where n1.CpCodigoIndicador=71 -- Cuentas de rentabilidad
   and n1.CpNivel=1 and n2.CpNivel=2 and n3.CpNivel=3 and n4.CpNivel=4
) as cr on cc.ccCodigoIndicadorRentabilidad=cr.CpCodigoIndicadorN4

CLOSE SYMMETRIC KEY ClaveMIS02&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsQueryEditorUsed</Name>
                      <Value>True</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

SELECT DISTINCT 
  cc.ccIdCuentaContable,
  ccCodigoNivel6=CONVERT(varchar(12), DecryptByKey(cc.ccCodigoNivel6)),
  cc.ccCodigoMoneda,
  cc.ccCodigoIndicador,  
  
  cpCalIndicadorNivel1=case when cp.indicadorNivel1 is null then cr.CpCodigoIndicadorN2 else cp.indicadorNivel1 end, -- se tiene los codigos de rentabilidad de nivel unon para el filtro en el dataset
  cpCalIndicadorNivel2=cp.indicadorNivel2, 
  --cpCalIndicadorNivel3=cp.indicadorNivel3, -- Se comento porque la informacion ya tiene la columna cc.ccCodigoIndicador

  ccCalProductoNivel1= case when cp.ProductoNivel1 is null then cc.ccFamiliaProducto else cp.ProductoNivel1  end,
  ccCalProductoNivel2= case when cp.ProductoNivel2 is null then cc.ccGrupo else cp.ProductoNivel2  end,

  cp.CpEstadoProducto,
  --cp.CpOrden, Comente porque no se usa
  cc.ccAgrupacionContableNivel2,
   
  ccSubGrupo,
  ccTarifaTransaccion=ccCostoOperativo,

  ccCalCodigoAgrupacionRentabilidaN1=cr.CpCodigoIndicadorN2,
  ccCalAgrupacionRentabilidaN1=ltrim(rtrim(upper(CpProducto))),
  ccCalCodigoTipoIngresoN2=cr.CpCodigoIndicadorN3,
  ccCalTipoIngresoN2=ltrim(rtrim(upper(ccTipoIngreso))),
  ccCalDescripcionNivel6N3= case when CONVERT(varchar(150), DecryptByKey(cc.ccDescripcionNivel6)) like '%SIN%DESCRIPCION%NIVEL%' then 'SIN DESCRIPCION NIVEL' 
                            else substring(CONVERT(varchar(150), DecryptByKey(cc.ccDescripcionNivel6)),14,100) end,

  ccCodigoIndicadorRentabilidad,
  ccCalAgrupacionTarifaBasica=isnull(cr.CpProductoN4,'SIN AGRUPACION'),

  ccAgrupacionTributario,
  ccCuentaAdquirenciaTC=case when ccCodigoIndicadorRentabilidad=40 then 1 else 0 end,ccCalCodigoAgrupacionRentabilidaN4=cr.CpCodigoIndicadorN4
  
  --drop table #DWDCuentaContable
  --into #DWDCuentaContable

FROM DWDCuentaContable cc
left outer join
( 
    SELECT DISTINCT 
    p.CpCodigoIndicador indicadorNivel1,p1.CpCodigoIndicador indicadorNivel2,p2.CpCodigoIndicador indicadorNivel3,
    p.CpProducto ProductoNivel1,
    ProductoNivel2=case when p1.CpCodigoIndicador=124  then 'Tarjeta de Credito' else p1.CpProducto end,
    p2.CpEstadoProducto,
    isnull(p1.CpOrden,1) CpOrden
    FROM DWDClasificacionProductos p
    join DWDClasificacionProductos p1 ON p1.CpPadre=p.CpCodigoIndicador
    join DWDClasificacionProductos p2 ON p2.CpPadre=p1.CpCodigoIndicador
    WHERE p.CpCodigoIndicador in (1,2,3,72,80) -- Comente los indicadores 32,28 ; 72 (ficticias de ingresos); 80 (Portafolio)
    and  p.CpNivel=1 and p1.CpNivel=2 and p2.CpNivel=3
    and p1.CpCodigoIndicador not in (143,144) -- Se excluye estas agrupaciones que no pertenecen a captaciones EA

) cp ON ccCodigoIndicador=cp.indicadorNivel3
left outer join
(
   select distinct
   CpCodigoIndicadorN4=n4.CpCodigoIndicador,
   CpProductoN4=case when n3.CpCodigoIndicador between 460 and 465 then n4.CpProducto else 'SIN AGRUPACION' end, -- Solo se obtiene las agrupaciones de tarifa básica / Conteo Tributario
   CpCodigoIndicadorN2=n2.CpCodigoIndicador,
   CpCodigoIndicadorN3=n3.CpCodigoIndicador,
   n2.CpProducto
   from DWDClasificacionProductos n1
   inner join DWDClasificacionProductos n2 on n2.CpPadre=n1.CpCodigoIndicador
   inner join DWDClasificacionProductos n3 on n3.CpPadre=n2.CpCodigoIndicador
   inner join DWDClasificacionProductos n4 on n4.CpPadre=n3.CpCodigoIndicador
   where n1.CpCodigoIndicador=71 -- Cuentas de rentabilidad
   and n1.CpNivel=1 and n2.CpNivel=2 and n3.CpNivel=3 and n4.CpNivel=4
) as cr on cc.ccCodigoIndicadorRentabilidad=cr.CpCodigoIndicadorN4

CLOSE SYMMETRIC KEY ClaveMIS02</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ErrorConfiguration>
                    <KeyNotFound>IgnoreError</KeyNotFound>
                    <KeyDuplicate>ReportAndStop</KeyDuplicate>
                    <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
                  </ErrorConfiguration>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
            <MeasureGroup>
              <ID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</ID>
              <Name>ParametrosJerarquia</Name>
              <Measures>
                <Measure>
                  <ID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</ID>
                  <Name>__XL_Count ParametrosJerarquia</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>ParametrosJeraquia</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>CodigoCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</TableID>
                            <ColumnID>CodigoCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Canal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</TableID>
                            <ColumnID>Canal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>CodigoNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</TableID>
                            <ColumnID>CodigoNivel1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Nivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</TableID>
                            <ColumnID>Nivel1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>CodigoNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</TableID>
                            <ColumnID>CodigoNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Nivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</TableID>
                            <ColumnID>Nivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105</ID>
                  <Name>ParametrosJeraquia</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on 

declare @RutaPortal varchar(50)

select @RutaPortal=
case when copTipoConstante like '%mis.bcointernacional%' then 'ReportServer_MIS/Pages/ReportViewer.aspx?' -- Produccion
     else 'ReportServer/Pages/ReportViewer.aspx?' end
from DWDConstanteOperacion
where copCodigoConstante = -2

if object_id('tempdb..#ConstanteOperacion') is not null begin drop table #ConstanteOperacion end

select
copIdConstante=copIdConstante*100,
concat(copTipoConstante,@RutaPortal, '/Monitores/MonitorRentabilidad/') as copServer,
cast('RENTABILIDAD' as varchar(20)) as Monitor
into #ConstanteOperacion
from DWDConstanteOperacion
where copCodigoConstante = -2


select
 CodigoCanal=jeCodigoN1
,Canal=jeNivel1
,CodigoNivel1=jeCodigoN2
,Nivel1=jeNivel2
,CodigoNivel2=jeCodigoN3
,Nivel2=lower( ltrim(rtrim(replace(replace(replace(replace(replace(jeNivel3,'á','a'),'é','e'),'í','i'),'ó','o'),'ú','u'))) )
from DWDJerarquia
where jeMonitor='Rentabilidad'
union 
select 
 CodigoCanal=copIdConstante
,Canal=Monitor
,CodigoNivel1=copIdConstante
,Nivel1=copServer
,CodigoNivel2=copIdConstante 
,Nivel2=Monitor
from #ConstanteOperacion
union 
select 
 CodigoCanal=copIdConstante
,Canal='PARAMETRORENTABILIDAD'
,CodigoNivel1=copIdConstante
,Nivel1=copTipoConstante
,CodigoNivel2=copIdConstante 
,Nivel2='PARAMETRORENTABILIDAD'
from DWDConstanteOperacion
where copIdConstante=-3&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on 

declare @RutaPortal varchar(50)

select @RutaPortal=
case when copTipoConstante like '%mis.bcointernacional%' then 'ReportServer_MIS/Pages/ReportViewer.aspx?' -- Produccion
     else 'ReportServer/Pages/ReportViewer.aspx?' end
from DWDConstanteOperacion
where copCodigoConstante = -2

if object_id('tempdb..#ConstanteOperacion') is not null begin drop table #ConstanteOperacion end

select
copIdConstante=copIdConstante*100,
concat(copTipoConstante,@RutaPortal, '/Monitores/MonitorRentabilidad/') as copServer,
cast('RENTABILIDAD' as varchar(20)) as Monitor
into #ConstanteOperacion
from DWDConstanteOperacion
where copCodigoConstante = -2


select
 CodigoCanal=jeCodigoN1
,Canal=jeNivel1
,CodigoNivel1=jeCodigoN2
,Nivel1=jeNivel2
,CodigoNivel2=jeCodigoN3
,Nivel2=lower( ltrim(rtrim(replace(replace(replace(replace(replace(jeNivel3,'á','a'),'é','e'),'í','i'),'ó','o'),'ú','u'))) )
from DWDJerarquia
where jeMonitor='Rentabilidad'
union 
select 
 CodigoCanal=copIdConstante
,Canal=Monitor
,CodigoNivel1=copIdConstante
,Nivel1=copServer
,CodigoNivel2=copIdConstante 
,Nivel2=Monitor
from #ConstanteOperacion
union 
select 
 CodigoCanal=copIdConstante
,Canal='PARAMETRORENTABILIDAD'
,CodigoNivel1=copIdConstante
,Nivel1=copTipoConstante
,CodigoNivel2=copIdConstante 
,Nivel2='PARAMETRORENTABILIDAD'
from DWDConstanteOperacion
where copIdConstante=-3</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ErrorConfiguration>
                    <KeyNotFound>IgnoreError</KeyNotFound>
                    <KeyDuplicate>ReportAndStop</KeyDuplicate>
                    <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
                  </ErrorConfiguration>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
            <MeasureGroup>
              <ID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</ID>
              <Name>DWDGrupoCliente</Name>
              <Measures>
                <Measure>
                  <ID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</ID>
                  <Name>__XL_Count DWDGrupoCliente</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grIdentificacionGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grIdentificacionGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grNombreGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grNombreGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAgrCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAgrCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grNombreAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grNombreAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</ID>
                  <Name>DWDGrupoCliente</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

if object_id('tempdb..#GrupoCliente') is not null begin drop table #GrupoCliente end

select 
 Bandera=ROW_NUMBER() over (partition by grCodigoGrupo order by grIdentificacionGrupo, grNombreGrupo )
,*
into #GrupoCliente
from
(
 SELECT distinct
  grCodigoGrupo = clCodigoGrupo
 ,grIdentificacionGrupo= clGrupoSBS
 ,grNombreGrupo= clGrupo
 from DWDCliente
 where clMaestroGrupo = 1 and clCodigoGrupo is not null
) as t


select
 grCodigoGrupo
,grIdentificacionGrupo
,grNombreGrupo
,grCodigoAsesor = '-1' 
,grCodigoAgencia= '-1'
,grCodigoAgrCanal = 'COR'--'-1'
,grDescripcionCanal= 'Corporativo'--'-1'
,grNombreAsesor= '-1'
,grCodigoRegion= '-1'
,grCodigoSubRegion= '-1'
,grCodigoZona= '-1'
,grCodigoRegional= '-1'
from #GrupoCliente
where Bandera=1  -- Se eliminan los registros duplicados
union
select -1,'0000000000000','GRUPO','NDI',0,'RED','Comercial','SIN NOMBRE',1,11,111,-1&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

if object_id('tempdb..#GrupoCliente') is not null begin drop table #GrupoCliente end

select 
 Bandera=ROW_NUMBER() over (partition by grCodigoGrupo order by grIdentificacionGrupo, grNombreGrupo )
,*
into #GrupoCliente
from
(
 SELECT distinct
  grCodigoGrupo = clCodigoGrupo
 ,grIdentificacionGrupo= clGrupoSBS
 ,grNombreGrupo= clGrupo
 from DWDCliente
 where clMaestroGrupo = 1 and clCodigoGrupo is not null
) as t


select
 grCodigoGrupo
,grIdentificacionGrupo
,grNombreGrupo
,grCodigoAsesor = '-1' 
,grCodigoAgencia= '-1'
,grCodigoAgrCanal = 'COR'--'-1'
,grDescripcionCanal= 'Corporativo'--'-1'
,grNombreAsesor= '-1'
,grCodigoRegion= '-1'
,grCodigoSubRegion= '-1'
,grCodigoZona= '-1'
,grCodigoRegional= '-1'
from #GrupoCliente
where Bandera=1  -- Se eliminan los registros duplicados
union
select -1,'0000000000000','GRUPO','NDI',0,'RED','Comercial','SIN NOMBRE',1,11,111,-1</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ErrorConfiguration>
                    <KeyNotFound>IgnoreError</KeyNotFound>
                    <KeyDuplicate>ReportAndStop</KeyDuplicate>
                    <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
                  </ErrorConfiguration>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
            <MeasureGroup>
              <ID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</ID>
              <Name>DWDTarjeta</Name>
              <Measures>
                <Measure>
                  <ID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</ID>
                  <Name>__XL_Count DWDTarjeta</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taIdTarjeta</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taIdTarjeta</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taCuenta</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taCuenta</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taIdCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taIdCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taIdEstadoTarjeta</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taIdEstadoTarjeta</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taNumeroTarjeta</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taNumeroTarjeta</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taIndicadorEsPrincipal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taIndicadorEsPrincipal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taEstadoActivo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taEstadoActivo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taBandera</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taBandera</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taGama</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taGama</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</ID>
                  <Name>DWDTarjeta</Name>
                  <Annotations>
                    <Annotation>
                      <Name>IsQueryEditorUsed</Name>
                      <Value>True</Value>
                    </Annotation>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select taIdTarjeta, taCuenta, taIdCliente, taIdEstadoTarjeta,
convert(char(16), DecryptByKey(taNumeroTarjeta)) taNumeroTarjeta, 
taIndicadorEsPrincipal, taEstadoActivo, taBandera, taGama
from DWDTarjeta
order by taNumeroTarjeta

CLOSE SYMMETRIC KEY ClaveMIS02&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                    <Annotation>
                      <Name>TableWidgetSerialization</Name>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select taIdTarjeta, taCuenta, taIdCliente, taIdEstadoTarjeta,
convert(char(16), DecryptByKey(taNumeroTarjeta)) taNumeroTarjeta, 
taIndicadorEsPrincipal, taEstadoActivo, taBandera, taGama
from DWDTarjeta
order by taNumeroTarjeta

CLOSE SYMMETRIC KEY ClaveMIS02</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ErrorConfiguration>
                    <KeyNotFound>IgnoreError</KeyNotFound>
                    <KeyDuplicate>ReportAndStop</KeyDuplicate>
                    <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
                  </ErrorConfiguration>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
            <MeasureGroup>
              <ID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</ID>
              <Name>DWHPosicionConsolidadaTarjeta</Name>
              <Measures>
                <Measure>
                  <ID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</ID>
                  <Name>__XL_Count DWHPosicionConsolidadaTarjeta</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPosicionConsolidadaTarjeta</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>pctIdFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</TableID>
                            <ColumnID>pctIdFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>pctIdTarjeta</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</TableID>
                            <ColumnID>pctIdTarjeta</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>pctSaldoTotal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</TableID>
                            <ColumnID>pctSaldoTotal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>pctCupoAsignado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</TableID>
                            <ColumnID>pctCupoAsignado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>pctSaldoFavor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</TableID>
                            <ColumnID>pctSaldoFavor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDTarjeta[taBandera])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>pctGama</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taIdTarjeta</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taIdTarjeta</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taCuenta</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taCuenta</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taIdCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taIdCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taIdEstadoTarjeta</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taIdEstadoTarjeta</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taNumeroTarjeta</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taNumeroTarjeta</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taIndicadorEsPrincipal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taIndicadorEsPrincipal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taEstadoActivo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taEstadoActivo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taBandera</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taBandera</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>taGama</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718</TableID>
                            <ColumnID>taGama</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>pctIdTarjeta</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>13fd4758-d793-49ee-bbe8-640222ac8dfd</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDescripcionFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDescripcionFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalDia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalDia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimNumero</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimNumero</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimDia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimDia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFeriado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFeriado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinSemana</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinSemana</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>EsDiaAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>EsDiaAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>fecIdAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>fecIdAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>EsCierreAño</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>EsCierreAño</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feAnioAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feAnioAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaCierreAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaCierreAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFechaCierreAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFechaCierreAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDiaActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDiaActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDiaAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDiaAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feAnioAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feAnioAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feHaceUnAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feHaceUnAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinTrimestreAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinTrimestreAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMesAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMesAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFechaMesAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFechaMesAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMesTodosAnios</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMesTodosAnios</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feValorCalculoPromedio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feValorCalculoPromedio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feEsMesActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feEsMesActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feEsTrimestreActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feEsTrimestreActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnMesLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnMesLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnTrimestreLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnTrimestreLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnSemestreLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnSemestreLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnAnioLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnAnioLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHistoricoLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHistoricoLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasMesLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasMesLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasTrimLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasTrimLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasTrimFiscLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasTrimFiscLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasSemestLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasSemestLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasAnioLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasAnioLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasHistLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasHistLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimestresAnteriores</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimestresAnteriores</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierrFechAnioActFut</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierrFechAnioActFut</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAntAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAntAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierrMesAnioAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierrMesAnioAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Column1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDFecha[feCalMes]=1,"Ene",
IF(DWDFecha[feCalMes]=2,"Feb",
IF(DWDFecha[feCalMes]=3,"Mar",
IF(DWDFecha[feCalMes]=4,"Abr",
IF(DWDFecha[feCalMes]=5,"May",
IF(DWDFecha[feCalMes]=6,"Jun",
IF(DWDFecha[feCalMes]=7,"Jul",
IF(DWDFecha[feCalMes]=8,"Ago",
IF(DWDFecha[feCalMes]=9,"Sep",
IF(DWDFecha[feCalMes]=10,"Oct",
IF(DWDFecha[feCalMes]=11,"Nov","Dic")
))))))))))

</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Column1 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDFecha[feCalMesCorto] &amp; " " &amp; DWDFecha[feCalAnio]
</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaTresMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaTresMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaSeisMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaSeisMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaDoceMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaDoceMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalMesAnteriorRentabilidad</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDFecha[feIdFecha]=[ValFechaMesAntRent],1,0)</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>FechaMesAntRent</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>FechaMesAntRent</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>F</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Agregar columna2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>pctIdFecha</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>a21eaffa-bd30-4db8-81ca-1532dcab02b3</ddl300:RelationshipID>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12</ID>
                  <Name>DWHPosicionConsolidadaTarjeta</Name>
                  <Annotations>
                    <Annotation>
                      <Name>IsQueryEditorUsed</Name>
                      <Value>True</Value>
                    </Annotation>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;select pctIdFecha, 
pctIdTarjeta, 
(pctSaldoActual + pctSaldoDiferido) pctSaldoTotal, 
(pctCupoRotativo + pctCupoDiferido) pctCupoAsignado, 
case when pctSaldoActual &lt; 0 then abs(pctSaldoActual) else 0 end pctSaldoFavor
from DWHPosicionConsolidadaTarjeta pos
inner join DWDFecha fec on (pos.pctIdFecha = fec.feIdFecha and feMesAnterior = 1)&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                    <Annotation>
                      <Name>TableWidgetSerialization</Name>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>select pctIdFecha, 
pctIdTarjeta, 
(pctSaldoActual + pctSaldoDiferido) pctSaldoTotal, 
(pctCupoRotativo + pctCupoDiferido) pctCupoAsignado, 
case when pctSaldoActual &lt; 0 then abs(pctSaldoActual) else 0 end pctSaldoFavor
from DWHPosicionConsolidadaTarjeta pos
inner join DWDFecha fec on (pos.pctIdFecha = fec.feIdFecha and feMesAnterior = 1)</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ErrorConfiguration>
                    <KeyNotFound>IgnoreError</KeyNotFound>
                    <KeyDuplicate>ReportAndStop</KeyDuplicate>
                    <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
                  </ErrorConfiguration>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
            <MeasureGroup>
              <ID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</ID>
              <Name>DWDJerarquia</Name>
              <Measures>
                <Measure>
                  <ID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</ID>
                  <Name>__XL_Count DWDJerarquia</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDJerarquia2</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>jeCodigoCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                            <ColumnID>jeCodigoCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>jeCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                            <ColumnID>jeCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>jeCodigoNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                            <ColumnID>jeCodigoNivel1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>jeNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                            <ColumnID>jeNivel1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>jeCodigoNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                            <ColumnID>jeCodigoNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>jeNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                            <ColumnID>jeNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Filtro</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                            <ColumnID>Filtro</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>FiltroCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</TableID>
                            <ColumnID>FiltroCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261</ID>
                  <Name>DWDJerarquia2</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;/* Tabla Jerarquia */

set nocount on

if OBJECT_ID('[tempdb]..#DWDJerarquia') is not null
begin 
 drop table #DWDJerarquia
end

--*******************DWDJerarquia2
select
 jeCodigoCanal=a.jeCodigoN1
,jeCanal=upper(a.jeNivel1)
,jeCodigoNivel1=a.jeCodigoN2
,jeNivel1=a.jeNivel2
,jeCodigoNivel2=a.jeCodigoN3
,jeNivel2=lower( ltrim(rtrim(replace(replace(replace(replace(replace(a.jeNivel3,'á','a'),'é','e'),'í','i'),'ó','o'),'ú','u'))) )
into #DWDJerarquia
from DWDJerarquia a
where a.jeMonitor='Rentabilidad'


/* Tabla Jerarquia */

select 
 jeCodigoCanal 
,jeCanal 
,jeCodigoNivel1 
,jeNivel1 
,jeCodigoNivel2 
,jeNivel2
,Filtro=
case when ltrim(rtrim(jeNivel2))='Asesor' then '{([DWDAsesorOperacionCliente].[asCodigoAsesor].['
     when ltrim(rtrim(jeNivel2))='Banco' then '[DWDCanalCliente].[caCodigoAgrupacionCanal].[' -- &gt;Se va a realizar un filtro de All
     when ltrim(rtrim(jeNivel2))='Canal' then '[DWDCanalCliente].[caCodigoAgrupacionCanal].['
     when ltrim(rtrim(jeNivel2))='Cliente' then '{([DWDCliente].[clCodigoCliente].['
     when ltrim(rtrim(jeNivel2))='Oficina' then '{([DWDAgenciaOperacionCliente].[agCodigoAgencia].['
     when ltrim(rtrim(jeNivel2)) in ('Región','Region') then '{([DWDAgenciaOperacionCliente].[agCodigoRegion].['
     when ltrim(rtrim(jeNivel2))='Regional'then '{([DWDAsesorOperacionCliente].[asCodigoRegional].['
  when ltrim(rtrim(jeNivel2))='Subregion'then '{([DWDAsesorOperacionCliente].[asCodigoSubregion].['
     when ltrim(rtrim(jeNivel2))='Zona' then '{([DWDAgenciaOperacionCliente].[agCodigoZona].['
  when ltrim(rtrim(jeNivel2))='Grupo' then '[DWDGrupoCliente].[grCodigoGrupo].['
  else ''
end
,FiltroCanal=
case 
     when ltrim(rtrim(jeNivel2))='Banco' then '' 
     when ltrim(rtrim(jeNivel2))='Canal' then ''
	 when ltrim(rtrim(jeNivel2))='Grupo' then ''
     else '],[DWDCanalCliente].[caCodigoAgrupacionCanal].['	 
end

from #DWDJerarquia&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>/* Tabla Jerarquia */

set nocount on

if OBJECT_ID('[tempdb]..#DWDJerarquia') is not null
begin 
 drop table #DWDJerarquia
end

--*******************DWDJerarquia2
select
 jeCodigoCanal=a.jeCodigoN1
,jeCanal=upper(a.jeNivel1)
,jeCodigoNivel1=a.jeCodigoN2
,jeNivel1=a.jeNivel2
,jeCodigoNivel2=a.jeCodigoN3
,jeNivel2=lower( ltrim(rtrim(replace(replace(replace(replace(replace(a.jeNivel3,'á','a'),'é','e'),'í','i'),'ó','o'),'ú','u'))) )
into #DWDJerarquia
from DWDJerarquia a
where a.jeMonitor='Rentabilidad'


/* Tabla Jerarquia */

select 
 jeCodigoCanal 
,jeCanal 
,jeCodigoNivel1 
,jeNivel1 
,jeCodigoNivel2 
,jeNivel2
,Filtro=
case when ltrim(rtrim(jeNivel2))='Asesor' then '{([DWDAsesorOperacionCliente].[asCodigoAsesor].['
     when ltrim(rtrim(jeNivel2))='Banco' then '[DWDCanalCliente].[caCodigoAgrupacionCanal].[' -- &gt;Se va a realizar un filtro de All
     when ltrim(rtrim(jeNivel2))='Canal' then '[DWDCanalCliente].[caCodigoAgrupacionCanal].['
     when ltrim(rtrim(jeNivel2))='Cliente' then '{([DWDCliente].[clCodigoCliente].['
     when ltrim(rtrim(jeNivel2))='Oficina' then '{([DWDAgenciaOperacionCliente].[agCodigoAgencia].['
     when ltrim(rtrim(jeNivel2)) in ('Región','Region') then '{([DWDAgenciaOperacionCliente].[agCodigoRegion].['
     when ltrim(rtrim(jeNivel2))='Regional'then '{([DWDAsesorOperacionCliente].[asCodigoRegional].['
  when ltrim(rtrim(jeNivel2))='Subregion'then '{([DWDAsesorOperacionCliente].[asCodigoSubregion].['
     when ltrim(rtrim(jeNivel2))='Zona' then '{([DWDAgenciaOperacionCliente].[agCodigoZona].['
  when ltrim(rtrim(jeNivel2))='Grupo' then '[DWDGrupoCliente].[grCodigoGrupo].['
  else ''
end
,FiltroCanal=
case 
     when ltrim(rtrim(jeNivel2))='Banco' then '' 
     when ltrim(rtrim(jeNivel2))='Canal' then ''
	 when ltrim(rtrim(jeNivel2))='Grupo' then ''
     else '],[DWDCanalCliente].[caCodigoAgrupacionCanal].['	 
end

from #DWDJerarquia</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ErrorConfiguration>
                    <KeyNotFound>IgnoreError</KeyNotFound>
                    <KeyDuplicate>ReportAndStop</KeyDuplicate>
                    <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
                  </ErrorConfiguration>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
            <MeasureGroup>
              <ID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</ID>
              <Name>DWHCuotaOperacion</Name>
              <Measures>
                <Measure>
                  <ID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</ID>
                  <Name>__XL_Count DWHCuotaOperacion</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHCuotaOperacion</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>coIdFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                            <ColumnID>coIdFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>coIdAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                            <ColumnID>coIdAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>coIdAsesorPrincipal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                            <ColumnID>coIdAsesorPrincipal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>coIdCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                            <ColumnID>coIdCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>coIdCuentaContable</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                            <ColumnID>coIdCuentaContable</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>coIdProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                            <ColumnID>coIdProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>coIdMoneda</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                            <ColumnID>coIdMoneda</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>coNumeroOperacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                            <ColumnID>coNumeroOperacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>coCuotaCapital</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</TableID>
                            <ColumnID>coCuotaCapital</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prCalVehiculosAgrupacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDProducto[prCalAgrupacionVehiculos])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>coCalCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDCuentaContable[cpCalIndicadorNivel2])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>coCalAgrupacionCobranza</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWHCuotaOperacion[coCalAgrupacionVehiculos]="NA","NA",DWHCuotaOperacion[coCalAgrupacionVehiculos])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>coCalAgrupacionVehiculosEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>UPPER(IF(RELATED(DWDProducto[prVehiculo])="Vehiculos",RELATED(DWDCuentaContable[ccCalProductoNivel2]) &amp; " " &amp;RELATED(DWDProducto[prVehiculo]),"NA"))</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>coCalAgrupacionProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>upper(IF(DWHCuotaOperacion[coCalAgrupacionVehiculos]="NA",RELATED(DWDCuentaContable[ccCalProductoNivel2]),DWHCuotaOperacion[coCalAgrupacionVehiculos]))</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clCodigoCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clNombreCompleto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clNombreCompleto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdAsesorPrincipal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdAsesorPrincipal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clVinculacionValor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clVinculacionValor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clCodigoGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clFechaFin</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clFechaFin</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdSegmentacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdSegmentacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCalClienteDesde</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clCalClienteDesde</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>CanalCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDCanalCliente[caDescripcionAgrupacionCanal])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreAgencia])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreRegion])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreZona])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAsesorOperacionCliente[asNombreAsesor])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clSegmentacionTipoCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clSegmentacionTipoCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ClCodigoCliente1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDCliente[clCodigoCliente]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 4</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDCliente[clCodigoCliente] &amp; "-" &amp; DWDCliente[clNombreCompleto]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 5</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED('DWDAsesorOperacionCliente'[asCodigoAsesor])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDCanalCliente[caCodigoAgrupacionCanal])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoAgencia])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoZona])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoRegion])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoRegion 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAsesorOperacionCliente[asCodigoRegional])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoSubregion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAsesorOperacionCliente[asCodigoSubregion])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clFechaIngreso</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clFechaIngreso</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>coIdCliente</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>933e83c6-3f87-41b0-97be-853c55214942</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caIdCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caIdCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodigoCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodigoCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caDescripcionAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caDescripcionAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caOrdenCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caOrdenCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caAgrupacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caAgrupacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caOrdenDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caOrdenDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodDescripcionAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodDescripcionAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCanalConsolidado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDCanalCliente[caEstado]=TRUE() &amp;&amp; DWDCanalCliente[caCodigoCanal]&lt;&gt;"-1" &amp;&amp; DWDCanalCliente[caCodigoCanal]&lt;&gt;"CEX", left(DWDCanalCliente[caAgrupacion],5) &amp;" "&amp;DWDCanalCliente[caDescripcionAgrupacionCanal]   , BLANK() )</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdCanal</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agIdAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agIdAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agDireccionAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agDireccionAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agTelefonoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agTelefonoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agResponsableNombre</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agResponsableNombre</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agFechaApertura</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agFechaApertura</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agFechaClausura</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agFechaClausura</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNumeroColaboradores</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNumeroColaboradores</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agMontoInvertido</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agMontoInvertido</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoSubregion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoSubregion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoCantonCompleto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoCantonCompleto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreCanton</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreCanton</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoProvincia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoProvincia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreProvincia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreProvincia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegionDescn</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegionDescn</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreRegionDescn</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreRegionDescn</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agOrdenRegionAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agOrdenRegionAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoJefeAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoJefeAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreJefeAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreJefeAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdAgencia</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asIdAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asIdAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asUsuario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asUsuario</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asAsesorPrincipal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asAsesorPrincipal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asOrdenAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asOrdenAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDAsesorOperacionCliente[asCodigoAsesor] &amp; "-" &amp; DWDAsesorOperacionCliente[asNombreAsesor]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdAsesorPrincipal</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scIdSegmentacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scIdSegmentacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scIdCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scIdCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scDetalleCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scDetalleCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scDetalleNombre</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scDetalleNombre</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionTipoCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionTipoCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionTipo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionTipo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrden</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrden</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrdenN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrdenN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrdenN3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrdenN3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdSegmentacionCliente</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baIdBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baIdBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baCodigoBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baCodigoBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baDescripcionBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baDescripcionBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdBanca</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grIdentificacionGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grIdentificacionGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grNombreGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grNombreGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAgrCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAgrCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grNombreAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grNombreAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clCodigoGrupo</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccIdCuentaContable</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccIdCuentaContable</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoMoneda</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoMoneda</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoIndicador</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoIndicador</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>CpEstadoProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>CpEstadoProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoNivel6</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoNivel6</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccAgrupacionContableNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccAgrupacionContableNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalIndicadorNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>cpCalIndicadorNivel1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalIndicadorNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>cpCalIndicadorNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalProductoNivel1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalProductoNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccSubGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccSubGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccTarifaTransaccion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccTarifaTransaccion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalAgrupacionRentabilidaN1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalAgrupacionRentabilidaN1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalTipoIngresoN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalTipoIngresoN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalDescripcionNivel6N3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalDescripcionNivel6N3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCodigoAgrupacionRentabilidaN1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalCodigoAgrupacionRentabilidaN1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCodigoTipoIngresoN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalCodigoTipoIngresoN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalOrdenIndicadorNivel1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>
IF(DWDCuentaContable[cpCalIndicadorNivel1]=1 ||  DWDCuentaContable[cpCalIndicadorNivel1]=80,20,
  IF(DWDCuentaContable[cpCalIndicadorNivel1]=2,10,
      IF(DWDCuentaContable[cpCalIndicadorNivel1]=3,30,
             IF(DWDCuentaContable[cpCalIndicadorNivel1]=72,40,99))))</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>cpCalOrdenIndicadorNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>
if(DWDCuentaContable[cpCalIndicadorNivel2]=140,11,
  if(DWDCuentaContable[cpCalIndicadorNivel2]=141,12,
    if(DWDCuentaContable[cpCalIndicadorNivel2]=142,13,
      if(DWDCuentaContable[cpCalIndicadorNivel2]=120 || DWDCuentaContable[cpCalIndicadorNivel2]=126,21,
         if(DWDCuentaContable[cpCalIndicadorNivel2]=121,22,
            if(DWDCuentaContable[cpCalIndicadorNivel2]=122,23,
               if(DWDCuentaContable[cpCalIndicadorNivel2]=124,24,
                  if(DWDCuentaContable[cpCalIndicadorNivel2]=200,25,
                  if(DWDCuentaContable[cpCalIndicadorNivel2]=160,31,
                     if(DWDCuentaContable[cpCalIndicadorNivel2]=161,32,
                       if(DWDCuentaContable[cpCalIndicadorNivel2]=162,33,
                          if(DWDCuentaContable[cpCalIndicadorNivel2]=100,40,99
                          ))))))))))))
                          
                        </Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccAgrupacionTributario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccAgrupacionTributario</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalOrdenAgrupacionTributario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>
IF(DWDCuentaContable[ccAgrupacionTributario]="Mantenimiento, administracion, mantencion o manejo de cuentas de ahorro", 1,
IF(DWDCuentaContable[ccAgrupacionTributario]="Mantenimiento, administracion, mantencion o manejo de cuentas de corriente", 6,
IF(DWDCuentaContable[ccAgrupacionTributario]="Tarjeta de debito, emision y renovacion",  7,
IF(DWDCuentaContable[ccAgrupacionTributario]="Tarjeta de debito, reposicion",8 ,
IF(DWDCuentaContable[ccAgrupacionTributario]="Mantenimiento de tarjeta de credito", 9,
IF(DWDCuentaContable[ccAgrupacionTributario]="Atm - Otras Transacciones", 11,
IF(DWDCuentaContable[ccAgrupacionTributario]="Atm - Retiros clientes propios (Sin costo)",12 ,
IF(DWDCuentaContable[ccAgrupacionTributario]="Otras transacciones", 13,99))))))))</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalBandera</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(LEFT(DWDCuentaContable[ccCodigoNivel6],6)="210105" || LEFT(DWDCuentaContable[ccCodigoNivel6],6)="210110" || LEFT(DWDCuentaContable[ccCodigoNivel6],6)="210115" 
|| LEFT(DWDCuentaContable[ccCodigoNivel6],6)="210125" || LEFT(DWDCuentaContable[ccCodigoNivel6],6)="210135",1,0)
</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccAgrupacionRentabilidadTransaccion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccAgrupacionRentabilidadTransaccion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoBruto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDCuentaContable[cpCalIndicadorNivel1]=2, "Depósitos " &amp; DWDCuentaContable[ccCalProductoNivel2], 
   IF(DWDCuentaContable[cpCalIndicadorNivel1]=1, DWDCuentaContable[ccCalProductoNivel1] &amp;" " &amp; DWDCuentaContable[ccCalProductoNivel2],""))</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(UPPER(DWDCuentaContable[CpEstadoProducto])="VIG","Por Vencer",
  IF(UPPER(DWDCuentaContable[CpEstadoProducto])="VEN" ||  UPPER(DWDCuentaContable[CpEstadoProducto])="NDE","En Dificultades","No Aplica"))</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCovid</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCovid</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoOperCredito</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalEstadoOpeCredito</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalAgrupacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDCuentaContable[cpCalIndicadorNivel1]=1 &amp;&amp; DWDCuentaContable[ccCovid]=TRUE() , DWDCuentaContable[ccCalDescripcionNivel6N3], 
    IF(DWDCuentaContable[cpCalIndicadorNivel1]=1  &amp;&amp; (DWDCuentaContable[cpCalIndicadorNivel2]=122 || DWDCuentaContable[cpCalIndicadorNivel2]=126) ,  UPPER(DWDCuentaContable[ccSubGrupo]),
      IF(DWDCuentaContable[cpCalIndicadorNivel1]=1  , UPPER(DWDCuentaContable[ccCalProductoNivel2]) &amp; " " &amp;  UPPER(DWDCuentaContable[ccSubGrupo]),BLANK())))

&amp; " " &amp; DWDCuentaContable[ccCalProductoCobranza]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoNivel2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32768</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoNivel2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoNivel3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32768</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoNivel3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalProductoCobranza</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32768</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCalProductoCobranza</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCodigoIndicadorRentabilidad</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933</TableID>
                            <ColumnID>ccCodigoIndicadorRentabilidad</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>coIdCuentaContable</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>07da4a37-dc62-4087-86a9-897f187fdf4e</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDescripcionFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDescripcionFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalDia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalDia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimNumero</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimNumero</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimDia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimDia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFeriado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFeriado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinSemana</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinSemana</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>EsDiaAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>EsDiaAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>fecIdAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>fecIdAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>EsCierreAño</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>EsCierreAño</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feAnioAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feAnioAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaCierreAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaCierreAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFechaCierreAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFechaCierreAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDiaActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDiaActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDiaAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDiaAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feAnioAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feAnioAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feHaceUnAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feHaceUnAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinTrimestreAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinTrimestreAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMesAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMesAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFechaMesAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFechaMesAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMesTodosAnios</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMesTodosAnios</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feValorCalculoPromedio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feValorCalculoPromedio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feEsMesActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feEsMesActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feEsTrimestreActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feEsTrimestreActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnMesLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnMesLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnTrimestreLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnTrimestreLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnSemestreLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnSemestreLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnAnioLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnAnioLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHistoricoLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHistoricoLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasMesLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasMesLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasTrimLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasTrimLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasTrimFiscLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasTrimFiscLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasSemestLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasSemestLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasAnioLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasAnioLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasHistLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasHistLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimestresAnteriores</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimestresAnteriores</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierrFechAnioActFut</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierrFechAnioActFut</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAntAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAntAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierrMesAnioAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierrMesAnioAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Column1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDFecha[feCalMes]=1,"Ene",
IF(DWDFecha[feCalMes]=2,"Feb",
IF(DWDFecha[feCalMes]=3,"Mar",
IF(DWDFecha[feCalMes]=4,"Abr",
IF(DWDFecha[feCalMes]=5,"May",
IF(DWDFecha[feCalMes]=6,"Jun",
IF(DWDFecha[feCalMes]=7,"Jul",
IF(DWDFecha[feCalMes]=8,"Ago",
IF(DWDFecha[feCalMes]=9,"Sep",
IF(DWDFecha[feCalMes]=10,"Oct",
IF(DWDFecha[feCalMes]=11,"Nov","Dic")
))))))))))

</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Column1 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDFecha[feCalMesCorto] &amp; " " &amp; DWDFecha[feCalAnio]
</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaTresMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaTresMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaSeisMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaSeisMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaDoceMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaDoceMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalMesAnteriorRentabilidad</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDFecha[feIdFecha]=[ValFechaMesAntRent],1,0)</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>FechaMesAntRent</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>FechaMesAntRent</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>F</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Agregar columna2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>coIdFecha</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>58d0fef3-5939-4dfd-a54c-bedb5c4c3447</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>moIdMoneda</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b</TableID>
                            <ColumnID>moIdMoneda</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>moCodigoMoneda</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b</TableID>
                            <ColumnID>moCodigoMoneda</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>moMoneda</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b</TableID>
                            <ColumnID>moMoneda</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>coIdMoneda</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>66b340fb-ff0c-469f-83a5-f55c8130b71c</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prIdProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prIdProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prCodigoProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prCodigoProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prSubGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prSubGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prFamiliaProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prFamiliaProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prVehiculo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prVehiculo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prCodigoIndicador</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prCodigoIndicador</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prOrdenN1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prOrdenN1</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prOrdenN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prOrdenN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prOrdenN3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prOrdenN3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prDescripcionProducto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prDescripcionProducto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prTipoProductoAUMS</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791</TableID>
                            <ColumnID>prTipoProductoAUMS</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>prCalBanderaVehiculos</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDProducto[prVehiculo]="Vehiculos",DWDProducto[prVehiculo],"Sin Vehiculos")</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>coIdProducto</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>2a1b5c5b-f0cc-4006-b4ac-e542e78298a8</ddl300:RelationshipID>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>DWHCuotaOperacion_c964b8ef-e1ea-4f0f-a4c5-3f1085260c9f</ID>
                  <Name>DWHCuotaOperacion_Diaria</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;declare @FechaActual int

select @FechaActual=feIdFecha from DWDFecha where feDiaActual=1

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacionMes 
where coIdFecha=@FechaActual

CLOSE SYMMETRIC KEY ClaveMIS02&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>declare @FechaActual int

select @FechaActual=feIdFecha from DWDFecha where feDiaActual=1

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacionMes 
where coIdFecha=@FechaActual

CLOSE SYMMETRIC KEY ClaveMIS02</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
                <Partition>
                  <ID>DWHCuotaOperacion_d4252917-f62a-4f62-b7c9-e8bca098ef26</ID>
                  <Name>DWHCuotaOperacion_Enero</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int , @FechaHaceUnAnio int

set @Mes=1

/* -------  Parametros ------------ */

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join #DWDFecha fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int , @FechaHaceUnAnio int

set @Mes=1

/* -------  Parametros ------------ */

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join #DWDFecha fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHCuotaOperacion_b8928ae3-dd39-4b7b-91f0-2e02d6f252c6</ID>
                  <Name>DWHCuotaOperacion_Febrero</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int , @FechaHaceUnAnio int

set @Mes=2

/* -------  Parametros ------------ */

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join #DWDFecha fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int , @FechaHaceUnAnio int

set @Mes=2

/* -------  Parametros ------------ */

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join #DWDFecha fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHCuotaOperacion_1c2f7813-33bc-4d3a-b084-d4e93a56875c</ID>
                  <Name>DWHCuotaOperacion_Marzo</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int , @FechaHaceUnAnio int

set @Mes=3

/* -------  Parametros ------------ */

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join #DWDFecha fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int , @FechaHaceUnAnio int

set @Mes=3

/* -------  Parametros ------------ */

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join #DWDFecha fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHCuotaOperacion_9a2f4445-01e2-4c83-9362-5fe5cfa73799</ID>
                  <Name>DWHCuotaOperacion_Abril</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int , @FechaHaceUnAnio int

set @Mes=4

/* -------  Parametros ------------ */

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join #DWDFecha fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int , @FechaHaceUnAnio int

set @Mes=4

/* -------  Parametros ------------ */

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join #DWDFecha fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHCuotaOperacion_f1636f0a-cc93-41f7-850e-00af6b4a7a8d</ID>
                  <Name>DWHCuotaOperacion_Mayo</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int , @FechaHaceUnAnio int

set @Mes=5

/* -------  Parametros ------------ */

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join #DWDFecha fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int , @FechaHaceUnAnio int

set @Mes=5

/* -------  Parametros ------------ */

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join #DWDFecha fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHCuotaOperacion_6a862a06-9674-4c5b-bd91-8e035cf03b43</ID>
                  <Name>DWHCuotaOperacion_Junio</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int , @FechaHaceUnAnio int

set @Mes=6

/* -------  Parametros ------------ */

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join #DWDFecha fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int , @FechaHaceUnAnio int

set @Mes=6

/* -------  Parametros ------------ */

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join #DWDFecha fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHCuotaOperacion_bb9500aa-f371-4fd7-af9f-71caed1dcae2</ID>
                  <Name>DWHCuotaOperacion_Julio</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int , @FechaHaceUnAnio int

set @Mes=7

/* -------  Parametros ------------ */

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join #DWDFecha fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int , @FechaHaceUnAnio int

set @Mes=7

/* -------  Parametros ------------ */

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join #DWDFecha fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHCuotaOperacion_4805dff8-4f06-4120-a93a-3f8d2ec7febf</ID>
                  <Name>DWHCuotaOperacion_Agosto</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int , @FechaHaceUnAnio int

set @Mes=8

/* -------  Parametros ------------ */

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join #DWDFecha fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int , @FechaHaceUnAnio int

set @Mes=8

/* -------  Parametros ------------ */

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join #DWDFecha fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHCuotaOperacion_0a6c5648-4218-457e-b57c-f973fa26fa82</ID>
                  <Name>DWHCuotaOperacion_Septiembre</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int , @FechaHaceUnAnio int

set @Mes=9

/* -------  Parametros ------------ */

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join #DWDFecha fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int , @FechaHaceUnAnio int

set @Mes=9

/* -------  Parametros ------------ */

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join #DWDFecha fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHCuotaOperacion_e020f784-0807-48f0-8192-098eb75aefa5</ID>
                  <Name>DWHCuotaOperacion_Octubre</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int , @FechaHaceUnAnio int

set @Mes=10

/* -------  Parametros ------------ */

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join #DWDFecha fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int , @FechaHaceUnAnio int

set @Mes=10

/* -------  Parametros ------------ */

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join #DWDFecha fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHCuotaOperacion_8659ebed-b31a-41dd-92d1-a470bd9802ef</ID>
                  <Name>DWHCuotaOperacion_Noviembre</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int , @FechaHaceUnAnio int

set @Mes=11

/* -------  Parametros ------------ */

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join #DWDFecha fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int , @FechaHaceUnAnio int

set @Mes=11

/* -------  Parametros ------------ */

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join #DWDFecha fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHCuotaOperacion_f4013f72-3634-48c7-b399-fdc5fbab4107</ID>
                  <Name>DWHCuotaOperacion_Diciembre</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @Mes int, @FechaMesAnt int , @FechaHaceUnAnio int

set @Mes=12

/* -------  Parametros ------------ */

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join #DWDFecha fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @Mes int, @FechaMesAnt int , @FechaHaceUnAnio int

set @Mes=12

/* -------  Parametros ------------ */

-- Fecha hace un año corrido ---
select @FechaHaceUnAnio=feIdFechaHaceUnAnioLab from DWDFecha where feMesAnterior=1

-- Fecha Mes Anterior --
select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1


/*---- Fecha ----*/

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end 

select feIdFecha
into #DWDFecha
from DWDFecha
where feIdFecha between @FechaHaceUnAnio and @FechaMesAnt
and fecierremes=1
and feCalMes=@Mes


OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 coIdFecha	
,coIdAgencia	
,coIdAsesorPrincipal
,coIdCliente	
,coIdCuentaContable
,coIdProducto
,coIdMoneda
,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))
,coCuotaCapital
from DWHCuotaOperacion co
inner join #DWDFecha fe on co.coIdFecha=fe.feIdFecha

CLOSE SYMMETRIC KEY ClaveMIS02

if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
            <MeasureGroup>
              <ID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</ID>
              <Name>DWHRankingRentabilidadCliente</Name>
              <Measures>
                <Measure>
                  <ID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</ID>
                  <Name>__XL_Count DWHRankingRentabilidadCliente</Name>
                  <AggregateFunction>Count</AggregateFunction>
                  <DataType>BigInt</DataType>
                  <Source>
                    <DataType>BigInt</DataType>
                    <DataSize>8</DataSize>
                    <Source xsi:type="RowBinding">
                      <TableID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</TableID>
                    </Source>
                  </Source>
                  <Visible>false</Visible>
                </Measure>
              </Measures>
              <StorageMode valuens="ddl200_200">InMemory</StorageMode>
              <ErrorConfiguration>
                <KeyNotFound>IgnoreError</KeyNotFound>
                <KeyDuplicate>ReportAndStop</KeyDuplicate>
                <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
              </ErrorConfiguration>
              <ProcessingMode>Regular</ProcessingMode>
              <Dimensions>
                <Dimension xsi:type="DegenerateMeasureGroupDimension">
                  <CubeDimensionID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHRankingRentabilidadCliente</TableID>
                            <ColumnID>__XL_RowNumber</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Orden</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</TableID>
                            <ColumnID>Orden</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Fecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</TableID>
                            <ColumnID>Fecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</TableID>
                            <ColumnID>clIdCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ValorActPondRiesgoPromAnual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</TableID>
                            <ColumnID>ValorActPondRiesgoPromAnual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ValorUtilidadOperativa</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</TableID>
                            <ColumnID>ValorUtilidadOperativa</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <ddl200_200:ShareDimensionStorage>Shared</ddl200_200:ShareDimensionStorage>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clCodigoCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clNombreCompleto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clNombreCompleto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdAsesorPrincipal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdAsesorPrincipal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clVinculacionValor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clVinculacionValor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clCodigoGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clFechaFin</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clFechaFin</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clIdSegmentacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clIdSegmentacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCalClienteDesde</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clCalClienteDesde</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>CanalCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDCanalCliente[caDescripcionAgrupacionCanal])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreAgencia])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreRegion])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agNombreZona])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAsesorOperacionCliente[asNombreAsesor])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clSegmentacionTipoCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clSegmentacionTipoCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ClCodigoCliente1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDCliente[clCodigoCliente]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 4</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDCliente[clCodigoCliente] &amp; "-" &amp; DWDCliente[clNombreCompleto]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1 5</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED('DWDAsesorOperacionCliente'[asCodigoAsesor])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDCanalCliente[caCodigoAgrupacionCanal])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoAgencia])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoZona])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAgenciaOperacionCliente[agCodigoRegion])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoRegion 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAsesorOperacionCliente[asCodigoRegional])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clCodigoSubregion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>RELATED(DWDAsesorOperacionCliente[asCodigoSubregion])</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>clFechaIngreso</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</TableID>
                            <ColumnID>clFechaIngreso</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdCliente</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>597bc237-c897-49d5-be85-f283dc1ace6f</ddl300:RelationshipID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caIdCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caIdCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodigoCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodigoCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caDescripcionAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caDescripcionAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caOrdenCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caOrdenCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caAgrupacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caAgrupacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caOrdenDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caOrdenDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>caCodDescripcionAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9</TableID>
                            <ColumnID>caCodDescripcionAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>ccCalCanalConsolidado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDCanalCliente[caEstado]=TRUE() &amp;&amp; DWDCanalCliente[caCodigoCanal]&lt;&gt;"-1" &amp;&amp; DWDCanalCliente[caCodigoCanal]&lt;&gt;"CEX", left(DWDCanalCliente[caAgrupacion],5) &amp;" "&amp;DWDCanalCliente[caDescripcionAgrupacionCanal]   , BLANK() )</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdCanal</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agIdAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agIdAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agDireccionAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agDireccionAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agTelefonoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agTelefonoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agResponsableNombre</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agResponsableNombre</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agFechaApertura</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agFechaApertura</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agFechaClausura</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agFechaClausura</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNumeroColaboradores</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNumeroColaboradores</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agMontoInvertido</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Double</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agMontoInvertido</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoSubregion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoSubregion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoCantonCompleto</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoCantonCompleto</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreCanton</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreCanton</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoProvincia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoProvincia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreProvincia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreProvincia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegionDescn</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegionDescn</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreRegionDescn</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreRegionDescn</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agOrdenRegionAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agOrdenRegionAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoJefeAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoJefeAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agNombreJefeAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agNombreJefeAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>agCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9</TableID>
                            <ColumnID>agCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdAgencia</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asIdAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asIdAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asUsuario</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asUsuario</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asAsesorPrincipal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asAsesorPrincipal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asEstado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asEstado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asOrdenAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asOrdenAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Calculated Column 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDAsesorOperacionCliente[asCodigoAsesor] &amp; "-" &amp; DWDAsesorOperacionCliente[asNombreAsesor]</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoAgrupacionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoAgrupacionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asCodigoSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asCodigoSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>asNombreSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489</TableID>
                            <ColumnID>asNombreSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdAsesorPrincipal</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scIdSegmentacionCliente</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scIdSegmentacionCliente</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scIdCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scIdCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scDetalleCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scDetalleCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scDetalleNombre</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scDetalleNombre</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionTipoCodigo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionTipoCodigo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionTipo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionTipo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrden</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrden</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrdenN2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrdenN2</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>scSegmentacionOrdenN3</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461</TableID>
                            <ColumnID>scSegmentacionOrdenN3</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdSegmentacionCliente</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baIdBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baIdBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baCodigoBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baCodigoBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>baDescripcionBanca</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997</TableID>
                            <ColumnID>baDescripcionBanca</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clIdBanca</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grIdentificacionGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grIdentificacionGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grNombreGrupo</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grNombreGrupo</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAgencia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAgencia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoAgrCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoAgrCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grDescripcionCanal</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grDescripcionCanal</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grNombreAsesor</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grNombreAsesor</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoSubRegion</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoSubRegion</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoZona</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoZona</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>grCodigoRegional</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da</TableID>
                            <ColumnID>grCodigoRegional</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>clCodigoGrupo</IntermediateGranularityAttributeID>
                </Dimension>
                <Dimension xsi:type="ReferenceMeasureGroupDimension">
                  <CubeDimensionID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>__XL_RowNumber</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>4</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <Source xsi:type="ddl200_200:RowNumberBinding" />
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Error</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                      <Type>Granularity</Type>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDescripcionFecha</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>WChar</DataType>
                          <DataSize>32766</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDescripcionFecha</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalDia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCalDia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimNumero</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimNumero</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimDia</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimDia</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFeriado</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFeriado</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinMes</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinMes</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinSemana</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinSemana</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>EsDiaAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>EsDiaAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>fecIdAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>fecIdAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>EsCierreAño</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>EsCierreAño</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feAnioAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feAnioAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaCierreAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaCierreAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFechaCierreAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFechaCierreAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDiaActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDiaActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feDiaAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feDiaAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feAnioAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feAnioAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feHaceUnAnio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feHaceUnAnio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFinTrimestreAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFinTrimestreAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMesAnterior</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMesAnterior</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feFechaMesAntCierr</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Date</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feFechaMesAntCierr</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierreMesTodosAnios</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierreMesTodosAnios</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feValorCalculoPromedio</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>BigInt</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feValorCalculoPromedio</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feEsMesActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feEsMesActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feEsTrimestreActual</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Boolean</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feEsTrimestreActual</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnMesLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnMesLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnTrimestreLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnTrimestreLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnSemestreLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnSemestreLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHaceUnAnioLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHaceUnAnioLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaHistoricoLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaHistoricoLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasMesLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasMesLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasTrimLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasTrimLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasTrimFiscLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasTrimFiscLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasSemestLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasSemestLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasAnioLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasAnioLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feNumDiasHistLab</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feNumDiasHistLab</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feTrimestresAnteriores</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feTrimestresAnteriores</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierrFechAnioActFut</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierrFechAnioActFut</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feMesAntAnioAnt</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feMesAntAnioAnt</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCierrMesAnioAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feCierrMesAnioAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Column1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDFecha[feCalMes]=1,"Ene",
IF(DWDFecha[feCalMes]=2,"Feb",
IF(DWDFecha[feCalMes]=3,"Mar",
IF(DWDFecha[feCalMes]=4,"Abr",
IF(DWDFecha[feCalMes]=5,"May",
IF(DWDFecha[feCalMes]=6,"Jun",
IF(DWDFecha[feCalMes]=7,"Jul",
IF(DWDFecha[feCalMes]=8,"Ago",
IF(DWDFecha[feCalMes]=9,"Sep",
IF(DWDFecha[feCalMes]=10,"Oct",
IF(DWDFecha[feCalMes]=11,"Nov","Dic")
))))))))))

</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Column1 1</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>DWDFecha[feCalMesCorto] &amp; " " &amp; DWDFecha[feCalAnio]
</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaTresMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaTresMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaSeisMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaSeisMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feIdFechaDoceMesAtras</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>feIdFechaDoceMesAtras</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>feCalMesAnteriorRentabilidad</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression>IF(DWDFecha[feIdFecha]=[ValFechaMesAntRent],1,0)</Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>FechaMesAntRent</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Integer</DataType>
                          <DataSize>-1</DataSize>
                          <NullProcessing>Preserve</NullProcessing>
                          <InvalidXmlCharacters>Remove</InvalidXmlCharacters>
                          <Source xsi:type="ColumnBinding">
                            <TableID>DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e</TableID>
                            <ColumnID>FechaMesAntRent</ColumnID>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>F</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Agregar columna2</AttributeID>
                      <KeyColumns>
                        <KeyColumn>
                          <DataType>Empty</DataType>
                          <Source xsi:type="ddl200_200:ExpressionBinding">
                            <Expression></Expression>
                          </Source>
                        </KeyColumn>
                      </KeyColumns>
                    </Attribute>
                  </Attributes>
                  <IntermediateCubeDimensionID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</IntermediateCubeDimensionID>
                  <IntermediateGranularityAttributeID>Fecha</IntermediateGranularityAttributeID>
                  <Materialization>Regular</Materialization>
                  <ddl300:RelationshipID>69b6d14f-368c-4557-b859-75a12f4c885c</ddl300:RelationshipID>
                </Dimension>
              </Dimensions>
              <Partitions>
                <Partition>
                  <ID>DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944</ID>
                  <Name>DWHRankingRentabilidadCliente_HaceUnMes</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @FechaCarga int

select @FechaCarga=feIdFecha from DWDFecha where feMesAnterior=1

/* -------------------------------------------------------- */
/*          PARTICION TABLA DWHACTIVOOPERACION				*/
/* -------------------------------------------------------- */

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

SELECT distinct
 cc.ccIdCuentaContable  
,cpCalIndicadorNivel1= cp.indicadorNivel1 
into #DWDCuentaContable
FROM DWDCuentaContable cc
inner join
( 
    SELECT DISTINCT 
    p.CpCodigoIndicador indicadorNivel1,p1.CpCodigoIndicador indicadorNivel2,p2.CpCodigoIndicador indicadorNivel3,
    p.CpProducto ProductoNivel1,p2.CpEstadoProducto
    FROM DWDClasificacionProductos p
    join DWDClasificacionProductos p1 ON p1.CpPadre=p.CpCodigoIndicador
    join DWDClasificacionProductos p2 ON p2.CpPadre=p1.CpCodigoIndicador
    WHERE p.CpCodigoIndicador in (1,2,3,72,80) -- Comente los indicadores 32,28 ; 72 (ficticias de ingresos); 80 (Portafolio)
    and  p.CpNivel=1 and p1.CpNivel=2 and p2.CpNivel=3
    and p1.CpCodigoIndicador not in (125,143,144) -- Se excluye las agrupaciones de Titularizada, Otros Depositos, Obligaciones Financieras
) cp ON ccCodigoIndicador=cp.indicadorNivel3

-- Cuenta Contable Indicadores de Tárifa Basica --

/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

if OBJECT_ID ('tempdb..#CuentaContableTB') is not null begin drop table #CuentaContableTB end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContableTB
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select
ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
where ct.ctIdFechaTransaccion=@FechaCarga

-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContableTB cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdClientePropietarioOperacion,ccIdCuentaContable

---  Activo Operacion --

if OBJECT_ID ('tempdb..#DatosFuentes') is not null begin drop table #DatosFuentes end

select 
 IdCliente=ao.aoIdCliente
,ValorActPondRiesgoPromAnual=sum(isnull(ao.aoValorActPondRiesgoPromAnual,0))
,ValorUtilidadOperativa=sum(isnull(ao.aoValorUtilidadOperativa,0))
into #DatosFuentes
from DWHActivoOperacion ao
inner join #DWDCuentaContable cc on ao.aoIdCuentaContable=cc.ccIdCuentaContable
where ao.aoIdFecha=@FechaCarga
group by ao.aoIdCliente


insert into #DatosFuentes
select
 ca.ctIdClientePropietarioOperacion
,aoValorActPondRiesgoPromAnual=0
,aoValorUtilidadOperativa=sum( 0-(isnull(cc.ccCostoOperativo,0)*ca.NumeroTransaccionesAnual) ) -- ValorMargenExplotacion - PerdidaEsperada
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0
group by ca.ctIdClientePropietarioOperacion


/* -------------------------------------------------------- */
/*         PARTICION TABLA DWHPASIVOSOPERACION				*/
/* -------------------------------------------------------- */


--- Cuenta Contable Ctas Ahorro y Credito ---

if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end 

select ccIdCuentaContable,ccCostoOperativo,ccCodigoIndicadorRentabilidad
into #CtasAhoCorr
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in
(60, -- Mantenimiento Cuenta Ahorro
 61  -- Mantenimiento Cuenta Corriente
)

--- Pasivo Operacion ---

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end

select
 poIdCliente
,poValorActPondRiesgoPromAnual
,poValorUtilidadOperativa
,poIdCuentaContable
,poSaldoAcumuladoMensualFiscal
--,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
into #PasivoOperacion
from DWHPasivoOperacion
where poIdFecha=@FechaCarga
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion


insert into #DatosFuentes
select
 poIdCliente
,poValorActPondRiesgoPromAnual=sum( isnull(poValorActPondRiesgoPromAnual,0) )
,poValorUtilidadOperativa=sum( isnull(poValorUtilidadOperativa,0) - (case when cta.ccIdCuentaContable is not null and po.poSaldoAcumuladoMensualFiscal!=0 then po.NumTRXAnualFiscal*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
from #PasivoOperacion po
inner join #DWDCuentaContable cc on po.poIdCuentaContable=cc.ccIdCuentaContable
left outer join #CtasAhoCorr cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdCliente

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* --------------------------------------------------------------- */
/*         PARTICION TABLA DWHTARJETACREDITOOPERACION			   */
/* --------------------------------------------------------------- */

-- Tarjeta --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in ( 
 62 --Mantenimiento tarjeta credito
)

if OBJECT_ID ('tempdb..#TarjetaCreditoOperacion') is not null begin drop table #TarjetaCreditoOperacion end

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 tcoIdCliente
--,poNoOperacion=CONVERT(varchar(30), DecryptByKey(poNoOperacion))
,tcoValorActPondRiesgoPromAnual=sum(tcoValorActPondRiesgoPromAnual)
,tcoSaldoAcumuladoMensualFiscal=sum(tcoSaldoAcumuladoMensualFiscal)
,tcoValorUtilidadOperativa=sum(tcoValorUtilidadOperativa)
,tcoIdCuentaContable=max(tcoIdCuentaContable)
--,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
into #TarjetaCreditoOperacion
from DWHTarjetaCreditoOperacion
where tcoIdFecha=@FechaCarga
group by tcoIdCliente,CONVERT(varchar(30), DecryptByKey(tcoNumeroOperacion)) -- debe tener la agrupacion por cleinte y operacion 

CLOSE SYMMETRIC KEY ClaveMIS02


insert into #DatosFuentes
select
 tcoIdCliente
,tcoValorActPondRiesgoPromAnual=sum(tcoValorActPondRiesgoPromAnual)
,tcoValorUtilidadOperativa=sum( isnull(tcoValorUtilidadOperativa,0) - (case when cta.ccIdCuentaContable is not null and tco.tcoSaldoAcumuladoMensualFiscal!=0 then tco.NumTRXAnualFiscal*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
FROM #TarjetaCreditoOperacion tco
inner join #DWDCuentaContable cc on tco.tcoIdCuentaContable=cc.ccIdCuentaContable
left outer join #CuentasPasivoTarjeta cta on tco.tcoIdCuentaContable=cta.ccIdCuentaContable
group by tcoIdCliente

if OBJECT_ID ('tempdb..#TarjetaCreditoOperacion') is not null begin drop table #TarjetaCreditoOperacion end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* ------------------------------------------ */
/*        CALCULO RANKING POR CANAL			  */
/* ------------------------------------------ */

if OBJECT_ID ('tempdb..#Cliente') is not null begin drop table #Cliente end

select
 cl.clIdCliente
,cl.clCodigoCliente
,ca.caCodigoAgrupacionCanal
into #Cliente
from DWDCliente cl
inner join DWDCanal ca on cl.clIdCanal=ca.caIdCanal
where cl.clCodigoCliente not in (-1,0) --- Son los clientes de ajuste que no deben mostrar en los ranking pero si en los totales


if OBJECT_ID ('tempdb..#Ranking') is not null begin drop table #Ranking end

select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
into #Ranking
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='RED'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='COR'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='ESP'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='TES'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

if OBJECT_ID ('tempdb..#Cliente') is not null begin drop table #Cliente end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* ------------------------------ */
/*        TABLA FINAL			  */
/* ------------------------------ */

if OBJECT_ID ('tempdb..#DWDCliente') is not null begin drop table #DWDCliente end

select clIdCliente=max(clIdCliente),clCodigoCliente 
into #DWDCliente
from DWDCliente
group by clCodigoCliente

select
 Orden=Row_Number() over (partition by tf.caCodigoAgrupacionCanal order by tf.ValorUtilidadOperativa desc )
,Fecha=@FechaCarga
,cl.clIdCliente
,tf.ValorActPondRiesgoPromAnual	
,tf.ValorUtilidadOperativa
from #Ranking tf
inner join #DWDCliente cl on tf.clCodigoCliente=cl.clCodigoCliente -- se toma el id del cliente maximo
order by tf.caCodigoAgrupacionCanal


if OBJECT_ID ('tempdb..#DWDCliente') is not null begin drop table #DWDCliente end
if OBJECT_ID ('tempdb..#DatosFuentes') is not null begin drop table #DatosFuentes end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end
if OBJECT_ID ('tempdb..#Ranking') is not null begin drop table #Ranking end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @FechaCarga int

select @FechaCarga=feIdFecha from DWDFecha where feMesAnterior=1

/* -------------------------------------------------------- */
/*          PARTICION TABLA DWHACTIVOOPERACION				*/
/* -------------------------------------------------------- */

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

SELECT distinct
 cc.ccIdCuentaContable  
,cpCalIndicadorNivel1= cp.indicadorNivel1 
into #DWDCuentaContable
FROM DWDCuentaContable cc
inner join
( 
    SELECT DISTINCT 
    p.CpCodigoIndicador indicadorNivel1,p1.CpCodigoIndicador indicadorNivel2,p2.CpCodigoIndicador indicadorNivel3,
    p.CpProducto ProductoNivel1,p2.CpEstadoProducto
    FROM DWDClasificacionProductos p
    join DWDClasificacionProductos p1 ON p1.CpPadre=p.CpCodigoIndicador
    join DWDClasificacionProductos p2 ON p2.CpPadre=p1.CpCodigoIndicador
    WHERE p.CpCodigoIndicador in (1,2,3,72,80) -- Comente los indicadores 32,28 ; 72 (ficticias de ingresos); 80 (Portafolio)
    and  p.CpNivel=1 and p1.CpNivel=2 and p2.CpNivel=3
    and p1.CpCodigoIndicador not in (125,143,144) -- Se excluye las agrupaciones de Titularizada, Otros Depositos, Obligaciones Financieras
) cp ON ccCodigoIndicador=cp.indicadorNivel3

-- Cuenta Contable Indicadores de Tárifa Basica --

/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

if OBJECT_ID ('tempdb..#CuentaContableTB') is not null begin drop table #CuentaContableTB end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContableTB
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select
ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
where ct.ctIdFechaTransaccion=@FechaCarga

-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContableTB cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdClientePropietarioOperacion,ccIdCuentaContable

---  Activo Operacion --

if OBJECT_ID ('tempdb..#DatosFuentes') is not null begin drop table #DatosFuentes end

select 
 IdCliente=ao.aoIdCliente
,ValorActPondRiesgoPromAnual=sum(isnull(ao.aoValorActPondRiesgoPromAnual,0))
,ValorUtilidadOperativa=sum(isnull(ao.aoValorUtilidadOperativa,0))
into #DatosFuentes
from DWHActivoOperacion ao
inner join #DWDCuentaContable cc on ao.aoIdCuentaContable=cc.ccIdCuentaContable
where ao.aoIdFecha=@FechaCarga
group by ao.aoIdCliente


insert into #DatosFuentes
select
 ca.ctIdClientePropietarioOperacion
,aoValorActPondRiesgoPromAnual=0
,aoValorUtilidadOperativa=sum( 0-(isnull(cc.ccCostoOperativo,0)*ca.NumeroTransaccionesAnual) ) -- ValorMargenExplotacion - PerdidaEsperada
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0
group by ca.ctIdClientePropietarioOperacion


/* -------------------------------------------------------- */
/*         PARTICION TABLA DWHPASIVOSOPERACION				*/
/* -------------------------------------------------------- */


--- Cuenta Contable Ctas Ahorro y Credito ---

if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end 

select ccIdCuentaContable,ccCostoOperativo,ccCodigoIndicadorRentabilidad
into #CtasAhoCorr
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in
(60, -- Mantenimiento Cuenta Ahorro
 61  -- Mantenimiento Cuenta Corriente
)

--- Pasivo Operacion ---

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end

select
 poIdCliente
,poValorActPondRiesgoPromAnual
,poValorUtilidadOperativa
,poIdCuentaContable
,poSaldoAcumuladoMensualFiscal
--,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
into #PasivoOperacion
from DWHPasivoOperacion
where poIdFecha=@FechaCarga
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion


insert into #DatosFuentes
select
 poIdCliente
,poValorActPondRiesgoPromAnual=sum( isnull(poValorActPondRiesgoPromAnual,0) )
,poValorUtilidadOperativa=sum( isnull(poValorUtilidadOperativa,0) - (case when cta.ccIdCuentaContable is not null and po.poSaldoAcumuladoMensualFiscal!=0 then po.NumTRXAnualFiscal*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
from #PasivoOperacion po
inner join #DWDCuentaContable cc on po.poIdCuentaContable=cc.ccIdCuentaContable
left outer join #CtasAhoCorr cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdCliente

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* --------------------------------------------------------------- */
/*         PARTICION TABLA DWHTARJETACREDITOOPERACION			   */
/* --------------------------------------------------------------- */

-- Tarjeta --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in ( 
 62 --Mantenimiento tarjeta credito
)

if OBJECT_ID ('tempdb..#TarjetaCreditoOperacion') is not null begin drop table #TarjetaCreditoOperacion end

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 tcoIdCliente
--,poNoOperacion=CONVERT(varchar(30), DecryptByKey(poNoOperacion))
,tcoValorActPondRiesgoPromAnual=sum(tcoValorActPondRiesgoPromAnual)
,tcoSaldoAcumuladoMensualFiscal=sum(tcoSaldoAcumuladoMensualFiscal)
,tcoValorUtilidadOperativa=sum(tcoValorUtilidadOperativa)
,tcoIdCuentaContable=max(tcoIdCuentaContable)
--,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
into #TarjetaCreditoOperacion
from DWHTarjetaCreditoOperacion
where tcoIdFecha=@FechaCarga
group by tcoIdCliente,CONVERT(varchar(30), DecryptByKey(tcoNumeroOperacion)) -- debe tener la agrupacion por cleinte y operacion 

CLOSE SYMMETRIC KEY ClaveMIS02


insert into #DatosFuentes
select
 tcoIdCliente
,tcoValorActPondRiesgoPromAnual=sum(tcoValorActPondRiesgoPromAnual)
,tcoValorUtilidadOperativa=sum( isnull(tcoValorUtilidadOperativa,0) - (case when cta.ccIdCuentaContable is not null and tco.tcoSaldoAcumuladoMensualFiscal!=0 then tco.NumTRXAnualFiscal*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
FROM #TarjetaCreditoOperacion tco
inner join #DWDCuentaContable cc on tco.tcoIdCuentaContable=cc.ccIdCuentaContable
left outer join #CuentasPasivoTarjeta cta on tco.tcoIdCuentaContable=cta.ccIdCuentaContable
group by tcoIdCliente

if OBJECT_ID ('tempdb..#TarjetaCreditoOperacion') is not null begin drop table #TarjetaCreditoOperacion end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* ------------------------------------------ */
/*        CALCULO RANKING POR CANAL			  */
/* ------------------------------------------ */

if OBJECT_ID ('tempdb..#Cliente') is not null begin drop table #Cliente end

select
 cl.clIdCliente
,cl.clCodigoCliente
,ca.caCodigoAgrupacionCanal
into #Cliente
from DWDCliente cl
inner join DWDCanal ca on cl.clIdCanal=ca.caIdCanal
where cl.clCodigoCliente not in (-1,0) --- Son los clientes de ajuste que no deben mostrar en los ranking pero si en los totales


if OBJECT_ID ('tempdb..#Ranking') is not null begin drop table #Ranking end

select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
into #Ranking
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='RED'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='COR'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='ESP'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='TES'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

if OBJECT_ID ('tempdb..#Cliente') is not null begin drop table #Cliente end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* ------------------------------ */
/*        TABLA FINAL			  */
/* ------------------------------ */

if OBJECT_ID ('tempdb..#DWDCliente') is not null begin drop table #DWDCliente end

select clIdCliente=max(clIdCliente),clCodigoCliente 
into #DWDCliente
from DWDCliente
group by clCodigoCliente

select
 Orden=Row_Number() over (partition by tf.caCodigoAgrupacionCanal order by tf.ValorUtilidadOperativa desc )
,Fecha=@FechaCarga
,cl.clIdCliente
,tf.ValorActPondRiesgoPromAnual	
,tf.ValorUtilidadOperativa
from #Ranking tf
inner join #DWDCliente cl on tf.clCodigoCliente=cl.clCodigoCliente -- se toma el id del cliente maximo
order by tf.caCodigoAgrupacionCanal


if OBJECT_ID ('tempdb..#DWDCliente') is not null begin drop table #DWDCliente end
if OBJECT_ID ('tempdb..#DatosFuentes') is not null begin drop table #DatosFuentes end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end
if OBJECT_ID ('tempdb..#Ranking') is not null begin drop table #Ranking end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ErrorConfiguration>
                    <KeyNotFound>IgnoreError</KeyNotFound>
                    <KeyDuplicate>ReportAndStop</KeyDuplicate>
                    <NullKeyNotAllowed>ReportAndStop</NullKeyNotAllowed>
                  </ErrorConfiguration>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                </Partition>
                <Partition>
                  <ID>DWHRankingRentabilidadCliente_ad50a2f8-0501-4c6f-8a5a-73e61e067f1d</ID>
                  <Name>DWHRankingRentabilidadCliente_HaceTresMes</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @FechaCarga int

select @FechaCarga=feIdFechaTresMesAtras from DWDFecha where feMesAnterior=1

/* -------------------------------------------------------- */
/*          PARTICION TABLA DWHACTIVOOPERACION				*/
/* -------------------------------------------------------- */

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

SELECT distinct
 cc.ccIdCuentaContable  
,cpCalIndicadorNivel1= cp.indicadorNivel1 
into #DWDCuentaContable
FROM DWDCuentaContable cc
inner join
( 
    SELECT DISTINCT 
    p.CpCodigoIndicador indicadorNivel1,p1.CpCodigoIndicador indicadorNivel2,p2.CpCodigoIndicador indicadorNivel3,
    p.CpProducto ProductoNivel1,p2.CpEstadoProducto
    FROM DWDClasificacionProductos p
    join DWDClasificacionProductos p1 ON p1.CpPadre=p.CpCodigoIndicador
    join DWDClasificacionProductos p2 ON p2.CpPadre=p1.CpCodigoIndicador
    WHERE p.CpCodigoIndicador in (1,2,3,72,80) -- Comente los indicadores 32,28 ; 72 (ficticias de ingresos); 80 (Portafolio)
    and  p.CpNivel=1 and p1.CpNivel=2 and p2.CpNivel=3
    and p1.CpCodigoIndicador not in (125,143,144) -- Se excluye las agrupaciones de Titularizada, Otros Depositos, Obligaciones Financieras
) cp ON ccCodigoIndicador=cp.indicadorNivel3

-- Cuenta Contable Indicadores de Tárifa Basica --

/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

if OBJECT_ID ('tempdb..#CuentaContableTB') is not null begin drop table #CuentaContableTB end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContableTB
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select
ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
where ct.ctIdFechaTransaccion=@FechaCarga

-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContableTB cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdClientePropietarioOperacion,ccIdCuentaContable

---  Activo Operacion --

if OBJECT_ID ('tempdb..#DatosFuentes') is not null begin drop table #DatosFuentes end

select 
 IdCliente=ao.aoIdCliente
,ValorActPondRiesgoPromAnual=sum(isnull(ao.aoValorActPondRiesgoPromAnual,0))
,ValorUtilidadOperativa=sum(isnull(ao.aoValorUtilidadOperativa,0))
into #DatosFuentes
from DWHActivoOperacion ao
inner join #DWDCuentaContable cc on ao.aoIdCuentaContable=cc.ccIdCuentaContable
where ao.aoIdFecha=@FechaCarga
group by ao.aoIdCliente


insert into #DatosFuentes
select
 ca.ctIdClientePropietarioOperacion
,aoValorActPondRiesgoPromAnual=0
,aoValorUtilidadOperativa=sum( 0-(isnull(cc.ccCostoOperativo,0)*ca.NumeroTransaccionesAnual) ) -- ValorMargenExplotacion - PerdidaEsperada
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0
group by ca.ctIdClientePropietarioOperacion


/* -------------------------------------------------------- */
/*         PARTICION TABLA DWHPASIVOSOPERACION				*/
/* -------------------------------------------------------- */


--- Cuenta Contable Ctas Ahorro y Credito ---

if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end 

select ccIdCuentaContable,ccCostoOperativo,ccCodigoIndicadorRentabilidad
into #CtasAhoCorr
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in
(60, -- Mantenimiento Cuenta Ahorro
 61  -- Mantenimiento Cuenta Corriente
)

--- Pasivo Operacion ---

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end

select
 poIdCliente
,poValorActPondRiesgoPromAnual
,poValorUtilidadOperativa
,poIdCuentaContable
,poSaldoAcumuladoMensualFiscal
--,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
into #PasivoOperacion
from DWHPasivoOperacion
where poIdFecha=@FechaCarga
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion


insert into #DatosFuentes
select
 poIdCliente
,poValorActPondRiesgoPromAnual=sum( isnull(poValorActPondRiesgoPromAnual,0) )
,poValorUtilidadOperativa=sum( isnull(poValorUtilidadOperativa,0) - (case when cta.ccIdCuentaContable is not null and po.poSaldoAcumuladoMensualFiscal!=0 then po.NumTRXAnualFiscal*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
from #PasivoOperacion po
inner join #DWDCuentaContable cc on po.poIdCuentaContable=cc.ccIdCuentaContable
left outer join #CtasAhoCorr cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdCliente

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* --------------------------------------------------------------- */
/*         PARTICION TABLA DWHTARJETACREDITOOPERACION			   */
/* --------------------------------------------------------------- */

-- Tarjeta --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in ( 
 62 --Mantenimiento tarjeta credito
)

if OBJECT_ID ('tempdb..#TarjetaCreditoOperacion') is not null begin drop table #TarjetaCreditoOperacion end

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 tcoIdCliente
--,poNoOperacion=CONVERT(varchar(30), DecryptByKey(poNoOperacion))
,tcoValorActPondRiesgoPromAnual=sum(tcoValorActPondRiesgoPromAnual)
,tcoSaldoAcumuladoMensualFiscal=sum(tcoSaldoAcumuladoMensualFiscal)
,tcoValorUtilidadOperativa=sum(tcoValorUtilidadOperativa)
,tcoIdCuentaContable=max(tcoIdCuentaContable)
--,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
into #TarjetaCreditoOperacion
from DWHTarjetaCreditoOperacion
where tcoIdFecha=@FechaCarga
group by tcoIdCliente,CONVERT(varchar(30), DecryptByKey(tcoNumeroOperacion)) -- debe tener la agrupacion por cleinte y operacion 

CLOSE SYMMETRIC KEY ClaveMIS02


insert into #DatosFuentes
select
 tcoIdCliente
,tcoValorActPondRiesgoPromAnual=sum(tcoValorActPondRiesgoPromAnual)
,tcoValorUtilidadOperativa=sum( isnull(tcoValorUtilidadOperativa,0) - (case when cta.ccIdCuentaContable is not null and tco.tcoSaldoAcumuladoMensualFiscal!=0 then tco.NumTRXAnualFiscal*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
FROM #TarjetaCreditoOperacion tco
inner join #DWDCuentaContable cc on tco.tcoIdCuentaContable=cc.ccIdCuentaContable
left outer join #CuentasPasivoTarjeta cta on tco.tcoIdCuentaContable=cta.ccIdCuentaContable
group by tcoIdCliente

if OBJECT_ID ('tempdb..#TarjetaCreditoOperacion') is not null begin drop table #TarjetaCreditoOperacion end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* ------------------------------------------ */
/*        CALCULO RANKING POR CANAL			  */
/* ------------------------------------------ */

if OBJECT_ID ('tempdb..#Cliente') is not null begin drop table #Cliente end

select
 cl.clIdCliente
,cl.clCodigoCliente
,ca.caCodigoAgrupacionCanal
into #Cliente
from DWDCliente cl
inner join DWDCanal ca on cl.clIdCanal=ca.caIdCanal
where cl.clCodigoCliente not in (-1,0) --- Son los clientes de ajuste que no deben mostrar en los ranking pero si en los totales


if OBJECT_ID ('tempdb..#Ranking') is not null begin drop table #Ranking end

select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
into #Ranking
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='RED'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='COR'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='ESP'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='TES'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

if OBJECT_ID ('tempdb..#Cliente') is not null begin drop table #Cliente end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* ------------------------------ */
/*        TABLA FINAL			  */
/* ------------------------------ */

if OBJECT_ID ('tempdb..#DWDCliente') is not null begin drop table #DWDCliente end

select clIdCliente=max(clIdCliente),clCodigoCliente 
into #DWDCliente
from DWDCliente
group by clCodigoCliente

select
 Orden=Row_Number() over (partition by tf.caCodigoAgrupacionCanal order by tf.ValorUtilidadOperativa desc )
,Fecha=@FechaCarga
,cl.clIdCliente
,tf.ValorActPondRiesgoPromAnual	
,tf.ValorUtilidadOperativa
from #Ranking tf
inner join #DWDCliente cl on tf.clCodigoCliente=cl.clCodigoCliente -- se toma el id del cliente maximo
order by tf.caCodigoAgrupacionCanal


if OBJECT_ID ('tempdb..#DWDCliente') is not null begin drop table #DWDCliente end
if OBJECT_ID ('tempdb..#DatosFuentes') is not null begin drop table #DatosFuentes end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end
if OBJECT_ID ('tempdb..#Ranking') is not null begin drop table #Ranking end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @FechaCarga int

select @FechaCarga=feIdFechaTresMesAtras from DWDFecha where feMesAnterior=1

/* -------------------------------------------------------- */
/*          PARTICION TABLA DWHACTIVOOPERACION				*/
/* -------------------------------------------------------- */

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

SELECT distinct
 cc.ccIdCuentaContable  
,cpCalIndicadorNivel1= cp.indicadorNivel1 
into #DWDCuentaContable
FROM DWDCuentaContable cc
inner join
( 
    SELECT DISTINCT 
    p.CpCodigoIndicador indicadorNivel1,p1.CpCodigoIndicador indicadorNivel2,p2.CpCodigoIndicador indicadorNivel3,
    p.CpProducto ProductoNivel1,p2.CpEstadoProducto
    FROM DWDClasificacionProductos p
    join DWDClasificacionProductos p1 ON p1.CpPadre=p.CpCodigoIndicador
    join DWDClasificacionProductos p2 ON p2.CpPadre=p1.CpCodigoIndicador
    WHERE p.CpCodigoIndicador in (1,2,3,72,80) -- Comente los indicadores 32,28 ; 72 (ficticias de ingresos); 80 (Portafolio)
    and  p.CpNivel=1 and p1.CpNivel=2 and p2.CpNivel=3
    and p1.CpCodigoIndicador not in (125,143,144) -- Se excluye las agrupaciones de Titularizada, Otros Depositos, Obligaciones Financieras
) cp ON ccCodigoIndicador=cp.indicadorNivel3

-- Cuenta Contable Indicadores de Tárifa Basica --

/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

if OBJECT_ID ('tempdb..#CuentaContableTB') is not null begin drop table #CuentaContableTB end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContableTB
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select
ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
where ct.ctIdFechaTransaccion=@FechaCarga

-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContableTB cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdClientePropietarioOperacion,ccIdCuentaContable

---  Activo Operacion --

if OBJECT_ID ('tempdb..#DatosFuentes') is not null begin drop table #DatosFuentes end

select 
 IdCliente=ao.aoIdCliente
,ValorActPondRiesgoPromAnual=sum(isnull(ao.aoValorActPondRiesgoPromAnual,0))
,ValorUtilidadOperativa=sum(isnull(ao.aoValorUtilidadOperativa,0))
into #DatosFuentes
from DWHActivoOperacion ao
inner join #DWDCuentaContable cc on ao.aoIdCuentaContable=cc.ccIdCuentaContable
where ao.aoIdFecha=@FechaCarga
group by ao.aoIdCliente


insert into #DatosFuentes
select
 ca.ctIdClientePropietarioOperacion
,aoValorActPondRiesgoPromAnual=0
,aoValorUtilidadOperativa=sum( 0-(isnull(cc.ccCostoOperativo,0)*ca.NumeroTransaccionesAnual) ) -- ValorMargenExplotacion - PerdidaEsperada
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0
group by ca.ctIdClientePropietarioOperacion


/* -------------------------------------------------------- */
/*         PARTICION TABLA DWHPASIVOSOPERACION				*/
/* -------------------------------------------------------- */


--- Cuenta Contable Ctas Ahorro y Credito ---

if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end 

select ccIdCuentaContable,ccCostoOperativo,ccCodigoIndicadorRentabilidad
into #CtasAhoCorr
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in
(60, -- Mantenimiento Cuenta Ahorro
 61  -- Mantenimiento Cuenta Corriente
)

--- Pasivo Operacion ---

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end

select
 poIdCliente
,poValorActPondRiesgoPromAnual
,poValorUtilidadOperativa
,poIdCuentaContable
,poSaldoAcumuladoMensualFiscal
--,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
into #PasivoOperacion
from DWHPasivoOperacion
where poIdFecha=@FechaCarga
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion


insert into #DatosFuentes
select
 poIdCliente
,poValorActPondRiesgoPromAnual=sum( isnull(poValorActPondRiesgoPromAnual,0) )
,poValorUtilidadOperativa=sum( isnull(poValorUtilidadOperativa,0) - (case when cta.ccIdCuentaContable is not null and po.poSaldoAcumuladoMensualFiscal!=0 then po.NumTRXAnualFiscal*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
from #PasivoOperacion po
inner join #DWDCuentaContable cc on po.poIdCuentaContable=cc.ccIdCuentaContable
left outer join #CtasAhoCorr cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdCliente

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* --------------------------------------------------------------- */
/*         PARTICION TABLA DWHTARJETACREDITOOPERACION			   */
/* --------------------------------------------------------------- */

-- Tarjeta --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in ( 
 62 --Mantenimiento tarjeta credito
)

if OBJECT_ID ('tempdb..#TarjetaCreditoOperacion') is not null begin drop table #TarjetaCreditoOperacion end

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 tcoIdCliente
--,poNoOperacion=CONVERT(varchar(30), DecryptByKey(poNoOperacion))
,tcoValorActPondRiesgoPromAnual=sum(tcoValorActPondRiesgoPromAnual)
,tcoSaldoAcumuladoMensualFiscal=sum(tcoSaldoAcumuladoMensualFiscal)
,tcoValorUtilidadOperativa=sum(tcoValorUtilidadOperativa)
,tcoIdCuentaContable=max(tcoIdCuentaContable)
--,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
into #TarjetaCreditoOperacion
from DWHTarjetaCreditoOperacion
where tcoIdFecha=@FechaCarga
group by tcoIdCliente,CONVERT(varchar(30), DecryptByKey(tcoNumeroOperacion)) -- debe tener la agrupacion por cleinte y operacion 

CLOSE SYMMETRIC KEY ClaveMIS02


insert into #DatosFuentes
select
 tcoIdCliente
,tcoValorActPondRiesgoPromAnual=sum(tcoValorActPondRiesgoPromAnual)
,tcoValorUtilidadOperativa=sum( isnull(tcoValorUtilidadOperativa,0) - (case when cta.ccIdCuentaContable is not null and tco.tcoSaldoAcumuladoMensualFiscal!=0 then tco.NumTRXAnualFiscal*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
FROM #TarjetaCreditoOperacion tco
inner join #DWDCuentaContable cc on tco.tcoIdCuentaContable=cc.ccIdCuentaContable
left outer join #CuentasPasivoTarjeta cta on tco.tcoIdCuentaContable=cta.ccIdCuentaContable
group by tcoIdCliente

if OBJECT_ID ('tempdb..#TarjetaCreditoOperacion') is not null begin drop table #TarjetaCreditoOperacion end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* ------------------------------------------ */
/*        CALCULO RANKING POR CANAL			  */
/* ------------------------------------------ */

if OBJECT_ID ('tempdb..#Cliente') is not null begin drop table #Cliente end

select
 cl.clIdCliente
,cl.clCodigoCliente
,ca.caCodigoAgrupacionCanal
into #Cliente
from DWDCliente cl
inner join DWDCanal ca on cl.clIdCanal=ca.caIdCanal
where cl.clCodigoCliente not in (-1,0) --- Son los clientes de ajuste que no deben mostrar en los ranking pero si en los totales


if OBJECT_ID ('tempdb..#Ranking') is not null begin drop table #Ranking end

select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
into #Ranking
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='RED'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='COR'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='ESP'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='TES'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

if OBJECT_ID ('tempdb..#Cliente') is not null begin drop table #Cliente end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* ------------------------------ */
/*        TABLA FINAL			  */
/* ------------------------------ */

if OBJECT_ID ('tempdb..#DWDCliente') is not null begin drop table #DWDCliente end

select clIdCliente=max(clIdCliente),clCodigoCliente 
into #DWDCliente
from DWDCliente
group by clCodigoCliente

select
 Orden=Row_Number() over (partition by tf.caCodigoAgrupacionCanal order by tf.ValorUtilidadOperativa desc )
,Fecha=@FechaCarga
,cl.clIdCliente
,tf.ValorActPondRiesgoPromAnual	
,tf.ValorUtilidadOperativa
from #Ranking tf
inner join #DWDCliente cl on tf.clCodigoCliente=cl.clCodigoCliente -- se toma el id del cliente maximo
order by tf.caCodigoAgrupacionCanal


if OBJECT_ID ('tempdb..#DWDCliente') is not null begin drop table #DWDCliente end
if OBJECT_ID ('tempdb..#DatosFuentes') is not null begin drop table #DatosFuentes end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end
if OBJECT_ID ('tempdb..#Ranking') is not null begin drop table #Ranking end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHRankingRentabilidadCliente_514da934-cc7a-40ff-a2fc-0e3953d57a10</ID>
                  <Name>DWHRankingRentabilidadCliente_HaceSeisMes</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @FechaCarga int

select @FechaCarga=feIdFechaSeisMesAtras from DWDFecha where feMesAnterior=1

/* -------------------------------------------------------- */
/*          PARTICION TABLA DWHACTIVOOPERACION				*/
/* -------------------------------------------------------- */

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

SELECT distinct
 cc.ccIdCuentaContable  
,cpCalIndicadorNivel1= cp.indicadorNivel1 
into #DWDCuentaContable
FROM DWDCuentaContable cc
inner join
( 
    SELECT DISTINCT 
    p.CpCodigoIndicador indicadorNivel1,p1.CpCodigoIndicador indicadorNivel2,p2.CpCodigoIndicador indicadorNivel3,
    p.CpProducto ProductoNivel1,p2.CpEstadoProducto
    FROM DWDClasificacionProductos p
    join DWDClasificacionProductos p1 ON p1.CpPadre=p.CpCodigoIndicador
    join DWDClasificacionProductos p2 ON p2.CpPadre=p1.CpCodigoIndicador
    WHERE p.CpCodigoIndicador in (1,2,3,72,80) -- Comente los indicadores 32,28 ; 72 (ficticias de ingresos); 80 (Portafolio)
    and  p.CpNivel=1 and p1.CpNivel=2 and p2.CpNivel=3
    and p1.CpCodigoIndicador not in (125,143,144) -- Se excluye las agrupaciones de Titularizada, Otros Depositos, Obligaciones Financieras
) cp ON ccCodigoIndicador=cp.indicadorNivel3

-- Cuenta Contable Indicadores de Tárifa Basica --

/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

if OBJECT_ID ('tempdb..#CuentaContableTB') is not null begin drop table #CuentaContableTB end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContableTB
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select
ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
where ct.ctIdFechaTransaccion=@FechaCarga

-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContableTB cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdClientePropietarioOperacion,ccIdCuentaContable

---  Activo Operacion --

if OBJECT_ID ('tempdb..#DatosFuentes') is not null begin drop table #DatosFuentes end

select 
 IdCliente=ao.aoIdCliente
,ValorActPondRiesgoPromAnual=sum(isnull(ao.aoValorActPondRiesgoPromAnual,0))
,ValorUtilidadOperativa=sum(isnull(ao.aoValorUtilidadOperativa,0))
into #DatosFuentes
from DWHActivoOperacion ao
inner join #DWDCuentaContable cc on ao.aoIdCuentaContable=cc.ccIdCuentaContable
where ao.aoIdFecha=@FechaCarga
group by ao.aoIdCliente


insert into #DatosFuentes
select
 ca.ctIdClientePropietarioOperacion
,aoValorActPondRiesgoPromAnual=0
,aoValorUtilidadOperativa=sum( 0-(isnull(cc.ccCostoOperativo,0)*ca.NumeroTransaccionesAnual) ) -- ValorMargenExplotacion - PerdidaEsperada
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0
group by ca.ctIdClientePropietarioOperacion


/* -------------------------------------------------------- */
/*         PARTICION TABLA DWHPASIVOSOPERACION				*/
/* -------------------------------------------------------- */


--- Cuenta Contable Ctas Ahorro y Credito ---

if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end 

select ccIdCuentaContable,ccCostoOperativo,ccCodigoIndicadorRentabilidad
into #CtasAhoCorr
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in
(60, -- Mantenimiento Cuenta Ahorro
 61  -- Mantenimiento Cuenta Corriente
)

--- Pasivo Operacion ---

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end

select
 poIdCliente
,poValorActPondRiesgoPromAnual
,poValorUtilidadOperativa
,poIdCuentaContable
,poSaldoAcumuladoMensualFiscal
--,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
into #PasivoOperacion
from DWHPasivoOperacion
where poIdFecha=@FechaCarga
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion


insert into #DatosFuentes
select
 poIdCliente
,poValorActPondRiesgoPromAnual=sum( isnull(poValorActPondRiesgoPromAnual,0) )
,poValorUtilidadOperativa=sum( isnull(poValorUtilidadOperativa,0) - (case when cta.ccIdCuentaContable is not null and po.poSaldoAcumuladoMensualFiscal!=0 then po.NumTRXAnualFiscal*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
from #PasivoOperacion po
inner join #DWDCuentaContable cc on po.poIdCuentaContable=cc.ccIdCuentaContable
left outer join #CtasAhoCorr cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdCliente

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* --------------------------------------------------------------- */
/*         PARTICION TABLA DWHTARJETACREDITOOPERACION			   */
/* --------------------------------------------------------------- */

-- Tarjeta --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in ( 
 62 --Mantenimiento tarjeta credito
)

if OBJECT_ID ('tempdb..#TarjetaCreditoOperacion') is not null begin drop table #TarjetaCreditoOperacion end

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 tcoIdCliente
--,poNoOperacion=CONVERT(varchar(30), DecryptByKey(poNoOperacion))
,tcoValorActPondRiesgoPromAnual=sum(tcoValorActPondRiesgoPromAnual)
,tcoSaldoAcumuladoMensualFiscal=sum(tcoSaldoAcumuladoMensualFiscal)
,tcoValorUtilidadOperativa=sum(tcoValorUtilidadOperativa)
,tcoIdCuentaContable=max(tcoIdCuentaContable)
--,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
into #TarjetaCreditoOperacion
from DWHTarjetaCreditoOperacion
where tcoIdFecha=@FechaCarga
group by tcoIdCliente,CONVERT(varchar(30), DecryptByKey(tcoNumeroOperacion)) -- debe tener la agrupacion por cleinte y operacion 

CLOSE SYMMETRIC KEY ClaveMIS02


insert into #DatosFuentes
select
 tcoIdCliente
,tcoValorActPondRiesgoPromAnual=sum(tcoValorActPondRiesgoPromAnual)
,tcoValorUtilidadOperativa=sum( isnull(tcoValorUtilidadOperativa,0) - (case when cta.ccIdCuentaContable is not null and tco.tcoSaldoAcumuladoMensualFiscal!=0 then tco.NumTRXAnualFiscal*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
FROM #TarjetaCreditoOperacion tco
inner join #DWDCuentaContable cc on tco.tcoIdCuentaContable=cc.ccIdCuentaContable
left outer join #CuentasPasivoTarjeta cta on tco.tcoIdCuentaContable=cta.ccIdCuentaContable
group by tcoIdCliente

if OBJECT_ID ('tempdb..#TarjetaCreditoOperacion') is not null begin drop table #TarjetaCreditoOperacion end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* ------------------------------------------ */
/*        CALCULO RANKING POR CANAL			  */
/* ------------------------------------------ */

if OBJECT_ID ('tempdb..#Cliente') is not null begin drop table #Cliente end

select
 cl.clIdCliente
,cl.clCodigoCliente
,ca.caCodigoAgrupacionCanal
into #Cliente
from DWDCliente cl
inner join DWDCanal ca on cl.clIdCanal=ca.caIdCanal
where cl.clCodigoCliente not in (-1,0) --- Son los clientes de ajuste que no deben mostrar en los ranking pero si en los totales


if OBJECT_ID ('tempdb..#Ranking') is not null begin drop table #Ranking end

select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
into #Ranking
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='RED'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='COR'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='ESP'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='TES'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

if OBJECT_ID ('tempdb..#Cliente') is not null begin drop table #Cliente end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* ------------------------------ */
/*        TABLA FINAL			  */
/* ------------------------------ */

if OBJECT_ID ('tempdb..#DWDCliente') is not null begin drop table #DWDCliente end

select clIdCliente=max(clIdCliente),clCodigoCliente 
into #DWDCliente
from DWDCliente
group by clCodigoCliente

select
 Orden=Row_Number() over (partition by tf.caCodigoAgrupacionCanal order by tf.ValorUtilidadOperativa desc )
,Fecha=@FechaCarga
,cl.clIdCliente
,tf.ValorActPondRiesgoPromAnual	
,tf.ValorUtilidadOperativa
from #Ranking tf
inner join #DWDCliente cl on tf.clCodigoCliente=cl.clCodigoCliente -- se toma el id del cliente maximo
order by tf.caCodigoAgrupacionCanal


if OBJECT_ID ('tempdb..#DWDCliente') is not null begin drop table #DWDCliente end
if OBJECT_ID ('tempdb..#DatosFuentes') is not null begin drop table #DatosFuentes end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end
if OBJECT_ID ('tempdb..#Ranking') is not null begin drop table #Ranking end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @FechaCarga int

select @FechaCarga=feIdFechaSeisMesAtras from DWDFecha where feMesAnterior=1

/* -------------------------------------------------------- */
/*          PARTICION TABLA DWHACTIVOOPERACION				*/
/* -------------------------------------------------------- */

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

SELECT distinct
 cc.ccIdCuentaContable  
,cpCalIndicadorNivel1= cp.indicadorNivel1 
into #DWDCuentaContable
FROM DWDCuentaContable cc
inner join
( 
    SELECT DISTINCT 
    p.CpCodigoIndicador indicadorNivel1,p1.CpCodigoIndicador indicadorNivel2,p2.CpCodigoIndicador indicadorNivel3,
    p.CpProducto ProductoNivel1,p2.CpEstadoProducto
    FROM DWDClasificacionProductos p
    join DWDClasificacionProductos p1 ON p1.CpPadre=p.CpCodigoIndicador
    join DWDClasificacionProductos p2 ON p2.CpPadre=p1.CpCodigoIndicador
    WHERE p.CpCodigoIndicador in (1,2,3,72,80) -- Comente los indicadores 32,28 ; 72 (ficticias de ingresos); 80 (Portafolio)
    and  p.CpNivel=1 and p1.CpNivel=2 and p2.CpNivel=3
    and p1.CpCodigoIndicador not in (125,143,144) -- Se excluye las agrupaciones de Titularizada, Otros Depositos, Obligaciones Financieras
) cp ON ccCodigoIndicador=cp.indicadorNivel3

-- Cuenta Contable Indicadores de Tárifa Basica --

/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

if OBJECT_ID ('tempdb..#CuentaContableTB') is not null begin drop table #CuentaContableTB end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContableTB
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select
ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
where ct.ctIdFechaTransaccion=@FechaCarga

-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContableTB cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdClientePropietarioOperacion,ccIdCuentaContable

---  Activo Operacion --

if OBJECT_ID ('tempdb..#DatosFuentes') is not null begin drop table #DatosFuentes end

select 
 IdCliente=ao.aoIdCliente
,ValorActPondRiesgoPromAnual=sum(isnull(ao.aoValorActPondRiesgoPromAnual,0))
,ValorUtilidadOperativa=sum(isnull(ao.aoValorUtilidadOperativa,0))
into #DatosFuentes
from DWHActivoOperacion ao
inner join #DWDCuentaContable cc on ao.aoIdCuentaContable=cc.ccIdCuentaContable
where ao.aoIdFecha=@FechaCarga
group by ao.aoIdCliente


insert into #DatosFuentes
select
 ca.ctIdClientePropietarioOperacion
,aoValorActPondRiesgoPromAnual=0
,aoValorUtilidadOperativa=sum( 0-(isnull(cc.ccCostoOperativo,0)*ca.NumeroTransaccionesAnual) ) -- ValorMargenExplotacion - PerdidaEsperada
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0
group by ca.ctIdClientePropietarioOperacion


/* -------------------------------------------------------- */
/*         PARTICION TABLA DWHPASIVOSOPERACION				*/
/* -------------------------------------------------------- */


--- Cuenta Contable Ctas Ahorro y Credito ---

if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end 

select ccIdCuentaContable,ccCostoOperativo,ccCodigoIndicadorRentabilidad
into #CtasAhoCorr
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in
(60, -- Mantenimiento Cuenta Ahorro
 61  -- Mantenimiento Cuenta Corriente
)

--- Pasivo Operacion ---

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end

select
 poIdCliente
,poValorActPondRiesgoPromAnual
,poValorUtilidadOperativa
,poIdCuentaContable
,poSaldoAcumuladoMensualFiscal
--,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
into #PasivoOperacion
from DWHPasivoOperacion
where poIdFecha=@FechaCarga
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion


insert into #DatosFuentes
select
 poIdCliente
,poValorActPondRiesgoPromAnual=sum( isnull(poValorActPondRiesgoPromAnual,0) )
,poValorUtilidadOperativa=sum( isnull(poValorUtilidadOperativa,0) - (case when cta.ccIdCuentaContable is not null and po.poSaldoAcumuladoMensualFiscal!=0 then po.NumTRXAnualFiscal*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
from #PasivoOperacion po
inner join #DWDCuentaContable cc on po.poIdCuentaContable=cc.ccIdCuentaContable
left outer join #CtasAhoCorr cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdCliente

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* --------------------------------------------------------------- */
/*         PARTICION TABLA DWHTARJETACREDITOOPERACION			   */
/* --------------------------------------------------------------- */

-- Tarjeta --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in ( 
 62 --Mantenimiento tarjeta credito
)

if OBJECT_ID ('tempdb..#TarjetaCreditoOperacion') is not null begin drop table #TarjetaCreditoOperacion end

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 tcoIdCliente
--,poNoOperacion=CONVERT(varchar(30), DecryptByKey(poNoOperacion))
,tcoValorActPondRiesgoPromAnual=sum(tcoValorActPondRiesgoPromAnual)
,tcoSaldoAcumuladoMensualFiscal=sum(tcoSaldoAcumuladoMensualFiscal)
,tcoValorUtilidadOperativa=sum(tcoValorUtilidadOperativa)
,tcoIdCuentaContable=max(tcoIdCuentaContable)
--,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
into #TarjetaCreditoOperacion
from DWHTarjetaCreditoOperacion
where tcoIdFecha=@FechaCarga
group by tcoIdCliente,CONVERT(varchar(30), DecryptByKey(tcoNumeroOperacion)) -- debe tener la agrupacion por cleinte y operacion 

CLOSE SYMMETRIC KEY ClaveMIS02


insert into #DatosFuentes
select
 tcoIdCliente
,tcoValorActPondRiesgoPromAnual=sum(tcoValorActPondRiesgoPromAnual)
,tcoValorUtilidadOperativa=sum( isnull(tcoValorUtilidadOperativa,0) - (case when cta.ccIdCuentaContable is not null and tco.tcoSaldoAcumuladoMensualFiscal!=0 then tco.NumTRXAnualFiscal*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
FROM #TarjetaCreditoOperacion tco
inner join #DWDCuentaContable cc on tco.tcoIdCuentaContable=cc.ccIdCuentaContable
left outer join #CuentasPasivoTarjeta cta on tco.tcoIdCuentaContable=cta.ccIdCuentaContable
group by tcoIdCliente

if OBJECT_ID ('tempdb..#TarjetaCreditoOperacion') is not null begin drop table #TarjetaCreditoOperacion end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* ------------------------------------------ */
/*        CALCULO RANKING POR CANAL			  */
/* ------------------------------------------ */

if OBJECT_ID ('tempdb..#Cliente') is not null begin drop table #Cliente end

select
 cl.clIdCliente
,cl.clCodigoCliente
,ca.caCodigoAgrupacionCanal
into #Cliente
from DWDCliente cl
inner join DWDCanal ca on cl.clIdCanal=ca.caIdCanal
where cl.clCodigoCliente not in (-1,0) --- Son los clientes de ajuste que no deben mostrar en los ranking pero si en los totales


if OBJECT_ID ('tempdb..#Ranking') is not null begin drop table #Ranking end

select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
into #Ranking
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='RED'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='COR'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='ESP'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='TES'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

if OBJECT_ID ('tempdb..#Cliente') is not null begin drop table #Cliente end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* ------------------------------ */
/*        TABLA FINAL			  */
/* ------------------------------ */

if OBJECT_ID ('tempdb..#DWDCliente') is not null begin drop table #DWDCliente end

select clIdCliente=max(clIdCliente),clCodigoCliente 
into #DWDCliente
from DWDCliente
group by clCodigoCliente

select
 Orden=Row_Number() over (partition by tf.caCodigoAgrupacionCanal order by tf.ValorUtilidadOperativa desc )
,Fecha=@FechaCarga
,cl.clIdCliente
,tf.ValorActPondRiesgoPromAnual	
,tf.ValorUtilidadOperativa
from #Ranking tf
inner join #DWDCliente cl on tf.clCodigoCliente=cl.clCodigoCliente -- se toma el id del cliente maximo
order by tf.caCodigoAgrupacionCanal


if OBJECT_ID ('tempdb..#DWDCliente') is not null begin drop table #DWDCliente end
if OBJECT_ID ('tempdb..#DatosFuentes') is not null begin drop table #DatosFuentes end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end
if OBJECT_ID ('tempdb..#Ranking') is not null begin drop table #Ranking end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
                <Partition>
                  <ID>DWHRankingRentabilidadCliente_fa34b545-e639-4e5b-94e1-e519e33e1a58</ID>
                  <Name>DWHRankingRentabilidadCliente_HaceDoceMes</Name>
                  <Annotations>
                    <Annotation>
                      <Name>QueryEditorSerialization</Name>
                      <Value>&lt;?xml version="1.0" encoding="UTF-16"?&gt;&lt;Gemini xmlns="QueryEditorSerialization"&gt;&lt;AnnotationContent&gt;&lt;![CDATA[&lt;RSQueryCommandText&gt;set nocount on

declare @FechaCarga int

select @FechaCarga=feIdFechaDoceMesAtras from DWDFecha where feMesAnterior=1

/* -------------------------------------------------------- */
/*          PARTICION TABLA DWHACTIVOOPERACION				*/
/* -------------------------------------------------------- */

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

SELECT distinct
 cc.ccIdCuentaContable  
,cpCalIndicadorNivel1= cp.indicadorNivel1 
into #DWDCuentaContable
FROM DWDCuentaContable cc
inner join
( 
    SELECT DISTINCT 
    p.CpCodigoIndicador indicadorNivel1,p1.CpCodigoIndicador indicadorNivel2,p2.CpCodigoIndicador indicadorNivel3,
    p.CpProducto ProductoNivel1,p2.CpEstadoProducto
    FROM DWDClasificacionProductos p
    join DWDClasificacionProductos p1 ON p1.CpPadre=p.CpCodigoIndicador
    join DWDClasificacionProductos p2 ON p2.CpPadre=p1.CpCodigoIndicador
    WHERE p.CpCodigoIndicador in (1,2,3,72,80) -- Comente los indicadores 32,28 ; 72 (ficticias de ingresos); 80 (Portafolio)
    and  p.CpNivel=1 and p1.CpNivel=2 and p2.CpNivel=3
    and p1.CpCodigoIndicador not in (125,143,144) -- Se excluye las agrupaciones de Titularizada, Otros Depositos, Obligaciones Financieras
) cp ON ccCodigoIndicador=cp.indicadorNivel3

-- Cuenta Contable Indicadores de Tárifa Basica --

/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

if OBJECT_ID ('tempdb..#CuentaContableTB') is not null begin drop table #CuentaContableTB end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContableTB
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select
ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
where ct.ctIdFechaTransaccion=@FechaCarga

-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContableTB cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdClientePropietarioOperacion,ccIdCuentaContable

---  Activo Operacion --

if OBJECT_ID ('tempdb..#DatosFuentes') is not null begin drop table #DatosFuentes end

select 
 IdCliente=ao.aoIdCliente
,ValorActPondRiesgoPromAnual=sum(isnull(ao.aoValorActPondRiesgoPromAnual,0))
,ValorUtilidadOperativa=sum(isnull(ao.aoValorUtilidadOperativa,0))
into #DatosFuentes
from DWHActivoOperacion ao
inner join #DWDCuentaContable cc on ao.aoIdCuentaContable=cc.ccIdCuentaContable
where ao.aoIdFecha=@FechaCarga
group by ao.aoIdCliente


insert into #DatosFuentes
select
 ca.ctIdClientePropietarioOperacion
,aoValorActPondRiesgoPromAnual=0
,aoValorUtilidadOperativa=sum( 0-(isnull(cc.ccCostoOperativo,0)*ca.NumeroTransaccionesAnual) ) -- ValorMargenExplotacion - PerdidaEsperada
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0
group by ca.ctIdClientePropietarioOperacion


/* -------------------------------------------------------- */
/*         PARTICION TABLA DWHPASIVOSOPERACION				*/
/* -------------------------------------------------------- */


--- Cuenta Contable Ctas Ahorro y Credito ---

if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end 

select ccIdCuentaContable,ccCostoOperativo,ccCodigoIndicadorRentabilidad
into #CtasAhoCorr
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in
(60, -- Mantenimiento Cuenta Ahorro
 61  -- Mantenimiento Cuenta Corriente
)

--- Pasivo Operacion ---

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end

select
 poIdCliente
,poValorActPondRiesgoPromAnual
,poValorUtilidadOperativa
,poIdCuentaContable
,poSaldoAcumuladoMensualFiscal
--,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
into #PasivoOperacion
from DWHPasivoOperacion
where poIdFecha=@FechaCarga
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion


insert into #DatosFuentes
select
 poIdCliente
,poValorActPondRiesgoPromAnual=sum( isnull(poValorActPondRiesgoPromAnual,0) )
,poValorUtilidadOperativa=sum( isnull(poValorUtilidadOperativa,0) - (case when cta.ccIdCuentaContable is not null and po.poSaldoAcumuladoMensualFiscal!=0 then po.NumTRXAnualFiscal*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
from #PasivoOperacion po
inner join #DWDCuentaContable cc on po.poIdCuentaContable=cc.ccIdCuentaContable
left outer join #CtasAhoCorr cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdCliente

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* --------------------------------------------------------------- */
/*         PARTICION TABLA DWHTARJETACREDITOOPERACION			   */
/* --------------------------------------------------------------- */

-- Tarjeta --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in ( 
 62 --Mantenimiento tarjeta credito
)

if OBJECT_ID ('tempdb..#TarjetaCreditoOperacion') is not null begin drop table #TarjetaCreditoOperacion end

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 tcoIdCliente
--,poNoOperacion=CONVERT(varchar(30), DecryptByKey(poNoOperacion))
,tcoValorActPondRiesgoPromAnual=sum(tcoValorActPondRiesgoPromAnual)
,tcoSaldoAcumuladoMensualFiscal=sum(tcoSaldoAcumuladoMensualFiscal)
,tcoValorUtilidadOperativa=sum(tcoValorUtilidadOperativa)
,tcoIdCuentaContable=max(tcoIdCuentaContable)
--,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
into #TarjetaCreditoOperacion
from DWHTarjetaCreditoOperacion
where tcoIdFecha=@FechaCarga
group by tcoIdCliente,CONVERT(varchar(30), DecryptByKey(tcoNumeroOperacion)) -- debe tener la agrupacion por cleinte y operacion 

CLOSE SYMMETRIC KEY ClaveMIS02


insert into #DatosFuentes
select
 tcoIdCliente
,tcoValorActPondRiesgoPromAnual=sum(tcoValorActPondRiesgoPromAnual)
,tcoValorUtilidadOperativa=sum( isnull(tcoValorUtilidadOperativa,0) - (case when cta.ccIdCuentaContable is not null and tco.tcoSaldoAcumuladoMensualFiscal!=0 then tco.NumTRXAnualFiscal*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
FROM #TarjetaCreditoOperacion tco
inner join #DWDCuentaContable cc on tco.tcoIdCuentaContable=cc.ccIdCuentaContable
left outer join #CuentasPasivoTarjeta cta on tco.tcoIdCuentaContable=cta.ccIdCuentaContable
group by tcoIdCliente

if OBJECT_ID ('tempdb..#TarjetaCreditoOperacion') is not null begin drop table #TarjetaCreditoOperacion end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* ------------------------------------------ */
/*        CALCULO RANKING POR CANAL			  */
/* ------------------------------------------ */

if OBJECT_ID ('tempdb..#Cliente') is not null begin drop table #Cliente end

select
 cl.clIdCliente
,cl.clCodigoCliente
,ca.caCodigoAgrupacionCanal
into #Cliente
from DWDCliente cl
inner join DWDCanal ca on cl.clIdCanal=ca.caIdCanal
where cl.clCodigoCliente not in (-1,0) --- Son los clientes de ajuste que no deben mostrar en los ranking pero si en los totales


if OBJECT_ID ('tempdb..#Ranking') is not null begin drop table #Ranking end

select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
into #Ranking
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='RED'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='COR'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='ESP'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='TES'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

if OBJECT_ID ('tempdb..#Cliente') is not null begin drop table #Cliente end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* ------------------------------ */
/*        TABLA FINAL			  */
/* ------------------------------ */

if OBJECT_ID ('tempdb..#DWDCliente') is not null begin drop table #DWDCliente end

select clIdCliente=max(clIdCliente),clCodigoCliente 
into #DWDCliente
from DWDCliente
group by clCodigoCliente

select
 Orden=Row_Number() over (partition by tf.caCodigoAgrupacionCanal order by tf.ValorUtilidadOperativa desc )
,Fecha=@FechaCarga
,cl.clIdCliente
,tf.ValorActPondRiesgoPromAnual	
,tf.ValorUtilidadOperativa
from #Ranking tf
inner join #DWDCliente cl on tf.clCodigoCliente=cl.clCodigoCliente -- se toma el id del cliente maximo
order by tf.caCodigoAgrupacionCanal


if OBJECT_ID ('tempdb..#DWDCliente') is not null begin drop table #DWDCliente end
if OBJECT_ID ('tempdb..#DatosFuentes') is not null begin drop table #DatosFuentes end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end
if OBJECT_ID ('tempdb..#Ranking') is not null begin drop table #Ranking end&lt;/RSQueryCommandText&gt;&lt;RSQueryCommandType&gt;Text&lt;/RSQueryCommandType&gt;&lt;RSQueryDesignState&gt;&lt;/RSQueryDesignState&gt;]]&gt;&lt;/AnnotationContent&gt;&lt;/Gemini&gt;</Value>
                    </Annotation>
                  </Annotations>
                  <Source xsi:type="QueryBinding">
                    <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
                    <QueryDefinition>set nocount on

declare @FechaCarga int

select @FechaCarga=feIdFechaDoceMesAtras from DWDFecha where feMesAnterior=1

/* -------------------------------------------------------- */
/*          PARTICION TABLA DWHACTIVOOPERACION				*/
/* -------------------------------------------------------- */

-- Cuenta Contable --

if OBJECT_ID ('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end

SELECT distinct
 cc.ccIdCuentaContable  
,cpCalIndicadorNivel1= cp.indicadorNivel1 
into #DWDCuentaContable
FROM DWDCuentaContable cc
inner join
( 
    SELECT DISTINCT 
    p.CpCodigoIndicador indicadorNivel1,p1.CpCodigoIndicador indicadorNivel2,p2.CpCodigoIndicador indicadorNivel3,
    p.CpProducto ProductoNivel1,p2.CpEstadoProducto
    FROM DWDClasificacionProductos p
    join DWDClasificacionProductos p1 ON p1.CpPadre=p.CpCodigoIndicador
    join DWDClasificacionProductos p2 ON p2.CpPadre=p1.CpCodigoIndicador
    WHERE p.CpCodigoIndicador in (1,2,3,72,80) -- Comente los indicadores 32,28 ; 72 (ficticias de ingresos); 80 (Portafolio)
    and  p.CpNivel=1 and p1.CpNivel=2 and p2.CpNivel=3
    and p1.CpCodigoIndicador not in (125,143,144) -- Se excluye las agrupaciones de Titularizada, Otros Depositos, Obligaciones Financieras
) cp ON ccCodigoIndicador=cp.indicadorNivel3

-- Cuenta Contable Indicadores de Tárifa Basica --

/*
 50	Pago de Cheque por Ventanilla -- ok
 51	Pago de cheques por cámara -- ok
 52	Pago de Cheque Certificado -- ok
 53	Retiro en cajas cuentas de ahorros -- ok
 54	Deposito Mixto - Ahorros. Cuenta Corriente 
 55	Atm Retiros Clientes Propios -- Pendiente Revisar ------
 56	Depósitos Efectivo - Ahorros, cuentas corrientes -- ok
 57	Deposito en cheque ahorros y cuentas corriente -- ok
*/

if OBJECT_ID ('tempdb..#CuentaContableTB') is not null begin drop table #CuentaContableTB end

select 
 ccIdCuentaContable=max(ccIdCuentaContable)
,ccCodigoIndicadorRentabilidad
into #CuentaContableTB
from DWDCuentaContable cc
where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)
group by ccCodigoIndicadorRentabilidad


-- Tipo Transaccion --

if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end

select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 
						   when ttCodigoTransaccion in ('150','3110','3111')  then 56
						   when ttCodigoTransaccion='6211' then  53
						   when ttCodigoTransaccion in ('6210','6301') then 52
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51
						   when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50
					   end
into #TipoTransaccion
from DWDTipoTransaccion
where  ttCodigoTransaccion in (
 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)
,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente
,'6210','6301' -- Pago de Cheque Certificado
,'6212' -- 6212	CQ	Pago de Cheque por Camara ; 6212	CV	Pago de Cheque por Ventanilla
,'6211' -- Retiro en cajas cuentas de ahorros
)
union all
select 
 ttIdTipoTransaccion
,ttCodigoTransaccion
,ttCodigoServicioMovimiento
,IndicadorCtaContable=54
from DWDTipoTransaccion
where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional


if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end

select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional
into #TipoTransaccionTmp
from #TipoTransaccion


-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end

select
ctIdClientePropietarioOperacion,ctIdTipoTransaccion, 
ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,
ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido
into #CanalTransaccionalTmp
from DWHCanalTransaccional ct
inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
where ct.ctIdFechaTransaccion=@FechaCarga

-- Canal Transaccional --

if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end

select
 ctIdClientePropietarioOperacion
,IdCuentaContable=ccIdCuentaContable
,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto
						        when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo
                                else ctNumeroTransaccionesAnioCorrido  end )
into #CanalTransaccional

from #CanalTransaccionalTmp ct
inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion
inner join #CuentaContableTB cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad
group by ctIdClientePropietarioOperacion,ccIdCuentaContable

---  Activo Operacion --

if OBJECT_ID ('tempdb..#DatosFuentes') is not null begin drop table #DatosFuentes end

select 
 IdCliente=ao.aoIdCliente
,ValorActPondRiesgoPromAnual=sum(isnull(ao.aoValorActPondRiesgoPromAnual,0))
,ValorUtilidadOperativa=sum(isnull(ao.aoValorUtilidadOperativa,0))
into #DatosFuentes
from DWHActivoOperacion ao
inner join #DWDCuentaContable cc on ao.aoIdCuentaContable=cc.ccIdCuentaContable
where ao.aoIdFecha=@FechaCarga
group by ao.aoIdCliente


insert into #DatosFuentes
select
 ca.ctIdClientePropietarioOperacion
,aoValorActPondRiesgoPromAnual=0
,aoValorUtilidadOperativa=sum( 0-(isnull(cc.ccCostoOperativo,0)*ca.NumeroTransaccionesAnual) ) -- ValorMargenExplotacion - PerdidaEsperada
from #CanalTransaccional ca
inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable
where NumeroTransaccionesAnual!=0
group by ca.ctIdClientePropietarioOperacion


/* -------------------------------------------------------- */
/*         PARTICION TABLA DWHPASIVOSOPERACION				*/
/* -------------------------------------------------------- */


--- Cuenta Contable Ctas Ahorro y Credito ---

if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end 

select ccIdCuentaContable,ccCostoOperativo,ccCodigoIndicadorRentabilidad
into #CtasAhoCorr
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in
(60, -- Mantenimiento Cuenta Ahorro
 61  -- Mantenimiento Cuenta Corriente
)

--- Pasivo Operacion ---

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end

select
 poIdCliente
,poValorActPondRiesgoPromAnual
,poValorUtilidadOperativa
,poIdCuentaContable
,poSaldoAcumuladoMensualFiscal
--,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
into #PasivoOperacion
from DWHPasivoOperacion
where poIdFecha=@FechaCarga
--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion


insert into #DatosFuentes
select
 poIdCliente
,poValorActPondRiesgoPromAnual=sum( isnull(poValorActPondRiesgoPromAnual,0) )
,poValorUtilidadOperativa=sum( isnull(poValorUtilidadOperativa,0) - (case when cta.ccIdCuentaContable is not null and po.poSaldoAcumuladoMensualFiscal!=0 then po.NumTRXAnualFiscal*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
from #PasivoOperacion po
inner join #DWDCuentaContable cc on po.poIdCuentaContable=cc.ccIdCuentaContable
left outer join #CtasAhoCorr cta on po.poIdCuentaContable=cta.ccIdCuentaContable
group by poIdCliente

if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* --------------------------------------------------------------- */
/*         PARTICION TABLA DWHTARJETACREDITOOPERACION			   */
/* --------------------------------------------------------------- */

-- Tarjeta --

if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end

select ccIdCuentaContable
,ccCostoOperativo
into #CuentasPasivoTarjeta
from DWDCuentaContable
where ccCodigoIndicadorRentabilidad in ( 
 62 --Mantenimiento tarjeta credito
)

if OBJECT_ID ('tempdb..#TarjetaCreditoOperacion') is not null begin drop table #TarjetaCreditoOperacion end

OPEN SYMMETRIC KEY ClaveMIS02
DECRYPTION BY CERTIFICATE Certi01

select 
 tcoIdCliente
--,poNoOperacion=CONVERT(varchar(30), DecryptByKey(poNoOperacion))
,tcoValorActPondRiesgoPromAnual=sum(tcoValorActPondRiesgoPromAnual)
,tcoSaldoAcumuladoMensualFiscal=sum(tcoSaldoAcumuladoMensualFiscal)
,tcoValorUtilidadOperativa=sum(tcoValorUtilidadOperativa)
,tcoIdCuentaContable=max(tcoIdCuentaContable)
--,NumTRXMesFiscal=cast(1 as int)
,NumTRXAnualFiscal=cast(1 as int)*12
into #TarjetaCreditoOperacion
from DWHTarjetaCreditoOperacion
where tcoIdFecha=@FechaCarga
group by tcoIdCliente,CONVERT(varchar(30), DecryptByKey(tcoNumeroOperacion)) -- debe tener la agrupacion por cleinte y operacion 

CLOSE SYMMETRIC KEY ClaveMIS02


insert into #DatosFuentes
select
 tcoIdCliente
,tcoValorActPondRiesgoPromAnual=sum(tcoValorActPondRiesgoPromAnual)
,tcoValorUtilidadOperativa=sum( isnull(tcoValorUtilidadOperativa,0) - (case when cta.ccIdCuentaContable is not null and tco.tcoSaldoAcumuladoMensualFiscal!=0 then tco.NumTRXAnualFiscal*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada
FROM #TarjetaCreditoOperacion tco
inner join #DWDCuentaContable cc on tco.tcoIdCuentaContable=cc.ccIdCuentaContable
left outer join #CuentasPasivoTarjeta cta on tco.tcoIdCuentaContable=cta.ccIdCuentaContable
group by tcoIdCliente

if OBJECT_ID ('tempdb..#TarjetaCreditoOperacion') is not null begin drop table #TarjetaCreditoOperacion end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* ------------------------------------------ */
/*        CALCULO RANKING POR CANAL			  */
/* ------------------------------------------ */

if OBJECT_ID ('tempdb..#Cliente') is not null begin drop table #Cliente end

select
 cl.clIdCliente
,cl.clCodigoCliente
,ca.caCodigoAgrupacionCanal
into #Cliente
from DWDCliente cl
inner join DWDCanal ca on cl.clIdCanal=ca.caIdCanal
where cl.clCodigoCliente not in (-1,0) --- Son los clientes de ajuste que no deben mostrar en los ranking pero si en los totales


if OBJECT_ID ('tempdb..#Ranking') is not null begin drop table #Ranking end

select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
into #Ranking
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='RED'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='COR'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='ESP'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

insert into #Ranking
select top 50
 cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)
,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)
from #DatosFuentes df
inner join #Cliente cl on df.IdCliente=cl.clIdCliente
where cl.caCodigoAgrupacionCanal='TES'
group by cl.clCodigoCliente
,cl.caCodigoAgrupacionCanal
order by ValorUtilidadOperativa desc

if OBJECT_ID ('tempdb..#Cliente') is not null begin drop table #Cliente end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea


/* ------------------------------ */
/*        TABLA FINAL			  */
/* ------------------------------ */

if OBJECT_ID ('tempdb..#DWDCliente') is not null begin drop table #DWDCliente end

select clIdCliente=max(clIdCliente),clCodigoCliente 
into #DWDCliente
from DWDCliente
group by clCodigoCliente

select
 Orden=Row_Number() over (partition by tf.caCodigoAgrupacionCanal order by tf.ValorUtilidadOperativa desc )
,Fecha=@FechaCarga
,cl.clIdCliente
,tf.ValorActPondRiesgoPromAnual	
,tf.ValorUtilidadOperativa
from #Ranking tf
inner join #DWDCliente cl on tf.clCodigoCliente=cl.clCodigoCliente -- se toma el id del cliente maximo
order by tf.caCodigoAgrupacionCanal


if OBJECT_ID ('tempdb..#DWDCliente') is not null begin drop table #DWDCliente end
if OBJECT_ID ('tempdb..#DatosFuentes') is not null begin drop table #DatosFuentes end
if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end
if OBJECT_ID ('tempdb..#Ranking') is not null begin drop table #Ranking end</QueryDefinition>
                  </Source>
                  <StorageMode valuens="ddl200_200">InMemory</StorageMode>
                  <ProcessingMode>Regular</ProcessingMode>
                  <ProactiveCaching>
                    <SilenceInterval>-PT1S</SilenceInterval>
                    <Latency>-PT1S</Latency>
                    <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                    <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                    <Source xsi:type="ProactiveCachingInheritedBinding" />
                  </ProactiveCaching>
                  <ddl300_300:DirectQueryUsage>InMemoryOnly</ddl300_300:DirectQueryUsage>
                </Partition>
              </Partitions>
              <ProactiveCaching>
                <SilenceInterval>-PT1S</SilenceInterval>
                <Latency>-PT1S</Latency>
                <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
                <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
                <Source xsi:type="ProactiveCachingInheritedBinding" />
              </ProactiveCaching>
            </MeasureGroup>
          </MeasureGroups>
          <Source>
            <DataSourceViewID>Sandbox</DataSourceViewID>
          </Source>
          <MdxScripts>
            <MdxScript>
              <ID>MdxScript</ID>
              <Name>MdxScript</Name>
              <Commands>
                <Command>
                  <Text>CALCULATE; 
CREATE MEMBER CURRENTCUBE.Measures.[__No measures defined] AS 1, VISIBLE = 0; 
ALTER CUBE CURRENTCUBE UPDATE DIMENSION Measures, Default_Member = [__No measures defined]; </Text>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDFecha'[ValFechaActual]=LOOKUPVALUE(DWDFecha[feIdFecha],DWDFecha[feDiaActual],1);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValFechaActual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDFecha</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPasivoOperacion'[ValPasivoSaldoDia]=SUM(DWHPasivoOperacion[poSaldoOperacionUSD]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValPasivoSaldoDia</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPasivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPasivoOperacion'[ValPasivoAcumuladoAnual]=SUM(DWHPasivoOperacion[poSaldoAcumuladoAnual]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValPasivoAcumuladoAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPasivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPasivoOperacion'[ValPasivoPromedioAnual]=SUM(DWHPasivoOperacion[poSaldoPromedioAnual]) + 0;
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValPasivoPromedioAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPasivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPasivoOperacion'[ValPasivoPonderadoAnual]=SUM(DWHPasivoOperacion[poValorActPondRiesgoPromAnual]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValPasivoPonderadoAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPasivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPasivoOperacion'[ValPasivoComision]=SUM(DWHPasivoOperacion[poValorComision]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValPasivoComision</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPasivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPasivoOperacion'[ValPasivoIngresoServicio]=SUM(DWHPasivoOperacion[poValorIngresoServicio]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValPasivoIngresoServicio</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPasivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPasivoOperacion'[ValPasivoNumeroTransacciones]=SUM(DWHPasivoOperacion[poNumeroTransaccionesAnual]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValPasivoNumeroTransacciones</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPasivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPasivoOperacion'[ValPasivoOperacionFinanciera]=SUM(DWHPasivoOperacion[poValorOperacionFinanciera]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValPasivoOperacionFinanciera</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPasivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPasivoOperacion'[ValPasivoInteresAnual]=SUM(DWHPasivoOperacion[poValorInteresRealAnual]) + 0;
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValPasivoInteresAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPasivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPasivoOperacion'[ValPasivoTasaPool]=SUM(DWHPasivoOperacion[poValorInteresTasaPool]) + 0;
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValPasivoTasaPool</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPasivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPasivoOperacion'[ValPasivoMargenFinanciero]=SUM(DWHPasivoOperacion[poValorMargenFinanciero]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValPasivoMargenFinanciero</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPasivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPasivoOperacion'[ValPasivoMargenBancario]=sum([poValorMargenBancarioBasico]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValPasivoMargenBancario</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPasivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPasivoOperacion'[ValPasivoMargenOrdinario]=SUM([poValorMargenOrdinario]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValPasivoMargenOrdinario</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPasivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPasivoOperacion'[ValPasivoMargenExplotacion]=SUM([poValorMargenExplotacion]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValPasivoMargenExplotacion</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPasivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPasivoOperacion'[ValPasivoUtilidadOperativa]=SUM([poValorUtilidadOperativa]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValPasivoUtilidadOperativa</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPasivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValActivoSaldoDia]=SUM(DWHActivoOperacion[aoMontoSaldoDolar]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValActivoSaldoDia</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValActivoPromedioAnual]=SUM(DWHActivoOperacion[aoSaldoPromedioAnual]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValActivoPromedioAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValActivoAcumuladoAnual]=SUM([aoSaldoAcumuladoAnual]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValActivoAcumuladoAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValActivoPonderadoAnual]=SUM([aoValorActPondRiesgoPromAnual]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValActivoPonderadoAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValActivoComision]=SUM([aoValorComision]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValActivoComision</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValActivoIngresoServicio]=SUM([aoValorIngresoServicio]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValActivoIngresoServicio</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValActivoOperacionFinanciera]=SUM([aoValorOperacionFinanciera]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValActivoOperacionFinanciera</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValActivoInteresAnual]=SUM([aoValorInteresRealAnual]) + 0;
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValActivoInteresAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValActivoTasaPool]=SUM([aoValorInteresTasaPool]) + 0;
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValActivoTasaPool</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValActivoMargenFinanciero]=SUM([aoValorMargenFinanciero]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValActivoMargenFinanciero</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValActivoMargenBancario]=SUM([aoValorMargenBancarioBasico]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValActivoMargenBancario</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValActivoMargenOrdinario]=SUM([aoValorMargenOrdinario]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValActivoMargenOrdinario</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValActivoMargenExplotacion]=SUM([aoValorMargenExplotacion]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValActivoMargenExplotacion</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValActivoUtilidadOperativa]=SUM([aoValorUtilidadOperativa]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValActivoUtilidadOperativa</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValActivoCostoOperativo]=SUM([aoValorCostoOperativo]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValActivoCostoOperativo</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValActivoPerdidaEsperada]=SUM([aoValorPerdidaEsperada]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValActivoPerdidaEsperada</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValActivoNumeroTransacciones]=SUM([aoNumeroTransaccionesAnual]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValActivoNumeroTransacciones</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTarjetaSaldoDia]=SUM([tcoSaldo]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTarjetaSaldoDia</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTarjetaAcumuladoAnual]=SUM([tcoSaldoAcumuladoAnual]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTarjetaAcumuladoAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTarjetaPromedioAnual]=SUM([tcoSaldoPromedioAnual]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTarjetaPromedioAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTarjetaPonderadoAnual]=SUM([tcoValorActPondRiesgoPromAnual]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTarjetaPonderadoAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTarjetaComision]=SUM([tcoValorComision]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTarjetaComision</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTarjetaIngresoServicio]=SUM([tcoValorIngresoServicio]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTarjetaIngresoServicio</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTarjetaOperacionFinanciera]=sum([tcoValorOperacionFinanciera]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTarjetaOperacionFinanciera</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTarjetaInteresAnual]=SUM([tcoValorInteresRealAnual]) + 0;
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTarjetaInteresAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTarjetaTasaPool]=SUM([tcoValorInteresTasaPool]) + 0;
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTarjetaTasaPool</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTarjetaMargenFinanciero]=SUM([tcoValorMargenFinanciero]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTarjetaMargenFinanciero</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTarjetaMargenBancario]=SUM([tcoValorMargenBancarioBasico]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTarjetaMargenBancario</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTarjetaMargenOrdinario]=SUM([tcoValorMargenOrdinario]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTarjetaMargenOrdinario</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTarjetaMargenExplotacion]=sum([tcoValorMargenExplotacion])-[ValCostoMantenimientoTCAnual];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTarjetaMargenExplotacion</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTarjetaUtilidadOperativa]=SUM([tcoValorUtilidadOperativa])-[ValCostoMantenimientoTCAnual];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTarjetaUtilidadOperativa</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTarjetaCostoOperativo]=sum([tcoValorCostoOperativo])+[ValCostoMantenimientoTCAnual];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTarjetaCostoOperativo</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTarjetaPerdidaEsperada]=SUM([tcoValorPerdidaEsperada]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTarjetaPerdidaEsperada</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTarjetaNumeroTransacciones]=sum([tcoNumeroTransaccionesAnual]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTarjetaNumeroTransacciones</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValConsolidadoSaldoDia]=[ValActivoSaldoDia]+[ValPasivoSaldoDia]+[ValTarjetaSaldoDia];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValConsolidadoSaldoDia</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValConsolidadoAcumuladoAnual]=[ValActivoAcumuladoAnual]+[ValPasivoAcumuladoAnual]+[ValTarjetaAcumuladoAnual];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValConsolidadoAcumuladoAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValConsolidadoPromedioAnual]=[ValActivoPromedioAnual]+[ValPasivoPromedioAnual]+[ValTarjetaPromedioAnual];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValConsolidadoPromedioAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValConsolidadoPonderadoAnual]=[ValActivoPonderadoAnual]+[ValPasivoPonderadoAnual]+[ValTarjetaPonderadoAnual];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValConsolidadoPonderadoAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValConsolidadoComision]=[ValActivoComision]+
[ValPasivoComision]+
[ValTarjetaComision];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValConsolidadoComision</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValConsolidadoIngresoServicio]=[ValActivoIngresoServicio]+[ValPasivoIngresoServicio]+[ValTarjetaIngresoServicio];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValConsolidadoIngresoServicio</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValConsolidadoOperacionFinanciera]=[ValActivoOperacionFinanciera]+[ValPasivoOperacionFinanciera]+[ValTarjetaOperacionFinanciera];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValConsolidadoOperacionFinanciera</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValConsolidadoInteresAnual]=[ValActivoInteresAnual]+[ValPasivoInteresAnual]+[ValTarjetaInteresAnual];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValConsolidadoInteresAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValConsolidadoTasaPool]=[ValActivoTasaPool]+[ValPasivoTasaPool]+[ValTarjetaTasaPool];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValConsolidadoTasaPool</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValConsolidadoMargenFinanciero]=[ValActivoMargenFinanciero]+[ValPasivoMargenFinanciero]+[ValTarjetaMargenFinanciero];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValConsolidadoMargenFinanciero</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValConsolidadoMargenBancario]=[ValActivoMargenBancario]+[ValPasivoMargenBancario]+[ValTarjetaMargenBancario];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValConsolidadoMargenBancario</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValConsolidadoMargenOrdinario]=[ValActivoMargenOrdinario]+[ValPasivoMargenOrdinario]+[ValTarjetaMargenOrdinario];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValConsolidadoMargenOrdinario</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValConsolidadoMargenExplotacion]=[ValActivoMargenExplotacion]+[ValPasivoMargenExplotacion]+[ValTarjetaMargenExplotacion];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValConsolidadoMargenExplotacion</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValConsolidadoUtilidadOperativa]=[ValActivoUtilidadOperativa]+[ValPasivoUtilidadOperativa]+[ValTarjetaUtilidadOperativa];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValConsolidadoUtilidadOperativa</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValConsolidadoCostoOperativo]=[ValActivoCostoOperativo]+[ValPasivoCostoOperativo]+[ValTarjetaCostoOperativo];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValConsolidadoCostoOperativo</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValConsolidadoPerdidaEsperada]=[ValActivoPerdidaEsperada]+[ValTarjetaPerdidaEsperada];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValConsolidadoPerdidaEsperada</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValConsolidadoNumeroTransacciones]=[ValActivoNumeroTransacciones]+[ValPasivoNumeroTransacciones]+[ValTarjetaNumeroTransacciones];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValConsolidadoNumeroTransacciones</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDCliente'[ValClienteCodigo]=SUM([clCodigoCliente]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValClienteCodigo</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValConsolidadoRorac]=DIVIDE( [ValConsolidadoUtilidadOperativa],[ValConsolidadoPonderadoAnual], 0 );
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValConsolidadoRorac</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDFecha'[ValFechaAnioAtras]=CALCULATE(MAX(DWDFecha[feIdFecha]),DWDFecha[feCierrMesAnioAtras]=1);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValFechaAnioAtras</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDFecha</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDFecha'[ValFechaConteo]=COUNT(DWDFecha[feIdFecha]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValFechaConteo</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDFecha</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValConsolidadoCarteraCaptaciones]=CALCULATE([ValConsolidadoAcumuladoAnual],
       FILTER(ALL(DWDCuentaContable)
      ,DWDCuentaContable[ccCalProductoNivel1]="Cartera" ||  DWDCuentaContable[ccCalProductoNivel1]="Captaciones" ||  DWDCuentaContable[ccCalProductoNivel1]="Contingentes")
      );
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValConsolidadoCarteraCaptaciones</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDFecha'[ValFechaMinima]=CALCULATE(MIN(DWDFecha[feIdFecha]));
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValFechaMinima</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDFecha</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValPromedioCarteraCaptaciones]=CALCULATE([ValConsolidadoPromedioAnual],
       FILTER(ALL(DWDCuentaContable)
      ,DWDCuentaContable[ccCalProductoNivel1]="Cartera" ||  DWDCuentaContable[ccCalProductoNivel1]="Captaciones" ||  DWDCuentaContable[ccCalProductoNivel1]="Contingentes")
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValPromedioCarteraCaptaciones</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValActivoIngresos]=[ValActivoComision]+[ValActivoIngresoServicio]+[ValActivoOperacionFinanciera]+[ValActivoInteresAnual];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValActivoIngresos</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPasivoOperacion'[ValPasivoIngresos]=[ValPasivoComision]+[ValPasivoIngresoServicio]+[ValPasivoOperacionFinanciera]+[ValPasivoInteresAnual];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValPasivoIngresos</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPasivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTarjetaIngresos]=[ValTarjetaComision]+[ValTarjetaIngresoServicio]+[ValTarjetaOperacionFinanciera]+[ValTarjetaInteresAnual];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTarjetaIngresos</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTarjetaPromedioTasaEfectiva]=AVERAGE(DWHTarjetaCreditoOperacion[tcoTasaEfectiva]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTarjetaPromedioTasaEfectiva</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValActivoPromedioTasaEfectiva]=AVERAGE(DWHActivoOperacion[aoTasaEfectiva]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValActivoPromedioTasaEfectiva</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValParticipacionCarteraCaptaciones]=DIVIDE( [ValConsolidadoPromedioAnual], [ValPromedioCarteraCaptaciones], 0 );
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValParticipacionCarteraCaptaciones</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValActivoPromedioTasaPool]=AVERAGE(DWHActivoOperacion[aoTasaPool])/100;
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValActivoPromedioTasaPool</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDAsesorOperacionCliente'[ValNumeroAsesores]=COUNT(DWDAsesorOperacionCliente[asIdAsesor]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValNumeroAsesores</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDAsesorOperacionCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDCanalCliente'[ValNumeroCanales]=COUNT(DWDCanalCliente[caIdCanal]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValNumeroCanales</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDCanalCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDAgenciaOperacionCliente'[ValNumeroAgencias]=count(DWDAgenciaOperacionCliente[agIdAgencia]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValNumeroAgencias</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDAgenciaOperacionCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValActivoPromedioSpread]=AVERAGE(DWHActivoOperacion[aoSpread])/100;
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValActivoPromedioSpread</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValInteresGanadoPagado]=[ValConsolidadoInteresAnual]+[ValConsolidadoTasaPool];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValInteresGanadoPagado</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValIngresosFinancieros]=[ValConsolidadoComision]+[ValConsolidadoIngresoServicio]+[ValConsolidadoOperacionFinanciera];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValIngresosFinancieros</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDCuentaContable'[ValConsolidadoPromedioTarifa]=AVERAGE(DWDCuentaContable[ccTarifaTransaccion]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValConsolidadoPromedioTarifa</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDCuentaContable</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHIngresoOperacion'[ValIngresosAcumuladoAnual]=CALCULATE(SUM([ioSaldoAcumuladoAnual]),left(DWDCuentaContableIngresos[ccCodigoNivel6],2)="52" || left(DWDCuentaContableIngresos[ccCodigoNivel6],2)="53" ||
left(DWDCuentaContableIngresos[ccCodigoNivel6],2)="54" || left(DWDCuentaContableIngresos[ccCodigoNivel6],2)="56"
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValIngresosAcumuladoAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHIngresoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHIngresoOperacion'[ValIngresoNumeroTransacciones]=SUM(DWHIngresoOperacion[ioNumeroTransaccionesOperacionAnual]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValIngresoNumeroTransacciones</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHIngresoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHIngresoOperacion'[ValNumeroOperacionesAnual]=SUM(DWHIngresoOperacion[ioConteoNumeroOperacionAnual]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValNumeroOperacionesAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHIngresoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHIngresoOperacion'[ValCostoTransaccionAnual]=SUM(DWHIngresoOperacion[ioSaldoAcumuladoAnualCostoTrx]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCostoTransaccionAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHIngresoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHIngresoOperacion'[ValCostoOperacionAnual]=SUM(DWHIngresoOperacion[ioCostoOperacionAnual]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCostoOperacionAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHIngresoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHIngresoOperacion'[ValMontoAcumuladoAnual]=SUM(DWHIngresoOperacion[ioSaldoAcumuladoAnual]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValMontoAcumuladoAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHIngresoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValConsolidadoPerdidaEsperadaSoloFecha]=CALCULATE([ValConsolidadoPerdidaEsperada],
FILTER(CROSSJOIN(ALL(DWDCanalCliente),ALL(DWDAgenciaOperacionCliente),ALL(DWDAsesorOperacionCliente),ALL(DWDCuentaContable), ALL(DWDCliente)), DWDCuentaContable[ccCalProductoNivel1]="Cartera" || DWDCuentaContable[ccCalProductoNivel1] = "Captaciones" || DWDCuentaContable[ccCalProductoNivel1]="Contingentes"));
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValConsolidadoPerdidaEsperadaSoloFecha</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDCuentaContable'[ValNumeroCuentas]=COUNT(DWDCuentaContable[ccIdCuentaContable]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValNumeroCuentas</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDCuentaContable</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDCuentaContable'[ValTarifaPromedio]=AVERAGE(DWDCuentaContable[ccTarifaTransaccion]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTarifaPromedio</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDCuentaContable</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHIngresoOperacion'[ValRankingTransaccionesOrden]=IF( ISBLANK([ValIngresoNumeroTransacciones]) || [ValIngresoNumeroTransacciones]=0,
     BLANK(),
     RANKX(FILTER(CROSSJOIN(ALLSELECTED(DWDCliente),ALLSELECTED(dwdfecha),ALL(DWDCuentaContableIngresos)),
     DWDCuentaContableIngresos[ccCalCodigoAgrupacionRentabilidaN1]=max(DWDCuentaContableIngresos[ccCalCodigoAgrupacionRentabilidaN1]) &amp;&amp; DWDFecha[feIdFecha]=max(DWDFecha[feIdFecha])     
     ) 
     ,[ValIngresoNumeroTransacciones],,0,Dense)
    );
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValRankingTransaccionesOrden</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHIngresoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValConsolidadoPorcentajePerdidaEsperada]=[ValTarjetaPorcentajePerdidaEsperada]+[ValActivoPorcentajePerdidaEsperada];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValConsolidadoPorcentajePerdidaEsperada</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPerdidaEsperadaPortafolioGlobal'[ValExposicion]=sum(DWHPerdidaEsperadaPortafolioGlobal[peExposicionIncumplimientoEAD]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValExposicion</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPerdidaEsperadaPortafolioGlobal</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPerdidaEsperadaPortafolioGlobal'[ValSeveridad]=AVERAGE(DWHPerdidaEsperadaPortafolioGlobal[peSeveridadLGD]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValSeveridad</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPerdidaEsperadaPortafolioGlobal</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPerdidaEsperadaPortafolioGlobal'[ValProbabilidadIncumplimiento]=AVERAGE(DWHPerdidaEsperadaPortafolioGlobal[peProbabilidadIncumplimientoPD]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValProbabilidadIncumplimiento</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPerdidaEsperadaPortafolioGlobal</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPerdidaEsperadaPortafolioGlobal'[ValPorcentajePerdida]=AVERAGE(DWHPerdidaEsperadaPortafolioGlobal[peValorOperacionPEAnual]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValPorcentajePerdida</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPerdidaEsperadaPortafolioGlobal</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHIngresoOperacion'[ValTotalGrupoTransacciones]=IF(ISBLANK([ValIngresoNumeroTransacciones]),
BLANK(),
 CALCULATE([ValIngresoNumeroTransacciones],  FILTER( CROSSJOIN(ALLSELECTED(DWDCuentaContable),all(DWDCuentaContableIngresos)),DWDCuentaContableIngresos[ccCalCodigoAgrupacionRentabilidaN1]=MAX(DWDCuentaContableIngresos[ccCalCodigoAgrupacionRentabilidaN1]) )
 )
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTotalGrupoTransacciones</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHIngresoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHIngresoOperacion'[ValTotalGrupoIngresosAnual]=IF(ISBLANK([ValIngresoNumeroTransacciones]),
BLANK(),
CALCULATE([ValIngresosAcumuladoAnual],FILTER(CROSSJOIN(ALLSELECTED(DWDCuentaContable),ALL(DWDCuentaContableIngresos)),DWDCuentaContableIngresos[ccCalCodigoAgrupacionRentabilidaN1]=max(DWDCuentaContableIngresos[ccCalCodigoAgrupacionRentabilidaN1])))
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTotalGrupoIngresosAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHIngresoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValGrupoFechaActivoPasivo]=IF(ISBLANK([ValConsolidadoAcumuladoAnual]),
BLANK(),
 CALCULATE([ValConsolidadoAcumuladoAnual],
FILTER(CROSSJOIN(ALLSELECTED(DWDFecha),ALLSELECTED(DWDCanalCliente),ALL(DWDCuentaContable)),DWDFecha[feIdFecha]=max(DWDFecha[feIdFecha])),
DWDCuentaContable[cpCalIndicadorNivel1]=1 || DWDCuentaContable[cpCalIndicadorNivel1]=2 || DWDCuentaContable[cpCalIndicadorNivel1]=3
)
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValGrupoFechaActivoPasivo</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[VaGrupoProductoIngresosFinancieros]=IF(ISBLANK([ValIngresosFinancieros]),
BLANK(),
CALCULATE([ValIngresosFinancieros],
FILTER(CROSSJOIN(ALLSELECTED(DWDCanalCliente),ALL(DWDCuentaContable)),DWDCuentaContable[cpCalIndicadorNivel2]=max(DWDCuentaContable[cpCalIndicadorNivel2])),
DWDCuentaContable[cpCalIndicadorNivel2]=120 || DWDCuentaContable[cpCalIndicadorNivel2]=121 || DWDCuentaContable[cpCalIndicadorNivel2]=122 
|| DWDCuentaContable[cpCalIndicadorNivel2]=124 || DWDCuentaContable[cpCalIndicadorNivel2]=126 || DWDCuentaContable[cpCalIndicadorNivel2]=160
|| DWDCuentaContable[cpCalIndicadorNivel2]=161
|| DWDCuentaContable[cpCalIndicadorNivel2]=140 || DWDCuentaContable[cpCalIndicadorNivel2]=141 || DWDCuentaContable[cpCalIndicadorNivel2]=142
)
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>VaGrupoProductoIngresosFinancieros</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHIngresoOperacion'[ValGrupoRentabilidadN1Ingresos]=if(ISBLANK([ValIngresosAcumuladoAnual]),
BLANK(),
CALCULATE([ValIngresosAcumuladoAnual],
FILTER(CROSSJOIN(ALLSELECTED(DWDCanalCliente),ALLSELECTED(DWDCuentaContable),ALL(DWDCuentaContableIngresos),ALLSELECTED(DWDFecha)),
DWDCuentaContableIngresos[ccCalCodigoAgrupacionRentabilidaN1]=max(DWDCuentaContableIngresos[ccCalCodigoAgrupacionRentabilidaN1])),
DWDCanalCliente[caCodigoAgrupacionCanal]="COR" || DWDCanalCliente[caCodigoAgrupacionCanal]="ESP" || DWDCanalCliente[caCodigoAgrupacionCanal]="RED" || DWDCanalCliente[caCodigoAgrupacionCanal]="TES"
)
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValGrupoRentabilidadN1Ingresos</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHIngresoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHIngresoOperacion'[ValGrupoRentabilidadN2Ingresos]=if(ISBLANK([ValIngresosAcumuladoAnual]),
BLANK(),
CALCULATE([ValIngresosAcumuladoAnual],
FILTER(CROSSJOIN(ALLSELECTED(DWDCanalCliente),ALLSELECTED(DWDCuentaContable),ALLSELECTED(DWDCuentaContableIngresos),
ALLSELECTED(DWDFecha)),DWDCuentaContableIngresos[ccCalCodigoTipoIngresoN2]=max(DWDCuentaContableIngresos[ccCalCodigoTipoIngresoN2])),
DWDCanalCliente[caCodigoAgrupacionCanal]="COR" || DWDCanalCliente[caCodigoAgrupacionCanal]="ESP" || DWDCanalCliente[caCodigoAgrupacionCanal]="RED" || DWDCanalCliente[caCodigoAgrupacionCanal]="TES"
)
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValGrupoRentabilidadN2Ingresos</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHIngresoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValGrupoFechaCarteraInteres]=IF(ISBLANK([ValCarteraInteresAnual]),
BLANK(),
     CALCULATE([ValCarteraInteresAnual],
     FILTER(CROSSJOIN(ALLSELECTED(DWDCanalCliente),ALLSELECTED(DWDFecha),ALL(DWDCuentaContable)),DWDCuentaContable[cpCalIndicadorNivel1]=max(DWDCuentaContable[cpCalIndicadorNivel1]))
)
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValGrupoFechaCarteraInteres</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValCarteraInteresAnual]=[ValActivoInteresAnual]+[ValTarjetaInteresAnual];
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCarteraInteresAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValGrupoCanalCarteraInteres]=IF(ISBLANK([ValCarteraInteresAnual]),
BLANK(),
     CALCULATE([ValCarteraInteresAnual],
     FILTER(CROSSJOIN(ALL(DWDCanalCliente),ALLSELECTED(DWDFecha),ALLSELECTED(DWDCuentaContable)),DWDCanalCliente[caOrdenCanal]=max(DWDCanalCliente[caOrdenCanal]))
)
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValGrupoCanalCarteraInteres</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValCarteraPromedioAnual]=CALCULATE([ValConsolidadoPromedioAnual],DWDCuentaContable[cpCalIndicadorNivel1]=1);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCarteraPromedioAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValGrupoFechaCarteraPromedio]=IF(ISBLANK([ValCarteraPromedioAnual]),
BLANK(),
     CALCULATE([ValCarteraPromedioAnual],
     FILTER(CROSSJOIN(ALLSELECTED(DWDCanalCliente),ALLSELECTED(DWDFecha),ALL(DWDCuentaContable)),DWDCuentaContable[cpCalIndicadorNivel1]=max(DWDCuentaContable[cpCalIndicadorNivel1]))
)
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValGrupoFechaCarteraPromedio</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValGrupoCanalCarteraPromedio]=IF(ISBLANK([ValCarteraPromedioAnual]),
BLANK(),
     CALCULATE([ValCarteraPromedioAnual],
     FILTER(CROSSJOIN(ALL(DWDCanalCliente),ALLSELECTED(DWDFecha),ALLSELECTED(DWDCuentaContable)),DWDCanalCliente[caOrdenCanal]=max(DWDCanalCliente[caOrdenCanal]))
)
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValGrupoCanalCarteraPromedio</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValCaptacionesInteresAnual]=CALCULATE([ValConsolidadoInteresAnual],DWDCuentaContable[cpCalIndicadorNivel1]=2);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCaptacionesInteresAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValGrupoFechaCaptacionesInteres]=IF(ISBLANK([ValCaptacionesInteresAnual]),
BLANK(),
     CALCULATE([ValCaptacionesInteresAnual],
     FILTER(CROSSJOIN(ALLSELECTED(DWDCanalCliente),ALLSELECTED(DWDFecha),ALL(DWDCuentaContable)),DWDCuentaContable[cpCalIndicadorNivel1]=max(DWDCuentaContable[cpCalIndicadorNivel1]))
)
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValGrupoFechaCaptacionesInteres</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValGrupoCanalCaptacionesInteres]=IF(ISBLANK([ValCaptacionesInteresAnual]),
BLANK(),
     CALCULATE([ValCaptacionesInteresAnual],
     FILTER(CROSSJOIN(ALL(DWDCanalCliente),ALLSELECTED(DWDFecha),ALLSELECTED(DWDCuentaContable)),DWDCanalCliente[caOrdenCanal]=max(DWDCanalCliente[caOrdenCanal]))
)
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValGrupoCanalCaptacionesInteres</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValCaptacionesPromedioAnual]=CALCULATE([ValConsolidadoPromedioAnual],DWDCuentaContable[cpCalIndicadorNivel1]=2);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCaptacionesPromedioAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValGrupoFechaCaptacionesPromedio]=IF(ISBLANK([ValCaptacionesPromedioAnual]),
BLANK(),
     CALCULATE([ValCaptacionesPromedioAnual],
     FILTER(CROSSJOIN(ALLSELECTED(DWDCanalCliente),ALLSELECTED(DWDFecha),ALL(DWDCuentaContable)),DWDCuentaContable[ccCalCodigoAgrupacionRentabilidaN1]=max(DWDCuentaContable[ccCalCodigoAgrupacionRentabilidaN1]))
)
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValGrupoFechaCaptacionesPromedio</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValGrupoCanalCaptacionesPromedio]=IF(ISBLANK([ValCaptacionesPromedioAnual]),
BLANK(),
     CALCULATE([ValCaptacionesPromedioAnual],
     FILTER(CROSSJOIN(ALL(DWDCanalCliente),ALLSELECTED(DWDFecha),ALLSELECTED(DWDCuentaContable)),DWDCanalCliente[caOrdenCanal]=max(DWDCanalCliente[caOrdenCanal]))
)
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValGrupoCanalCaptacionesPromedio</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValGrupoFamiliaConsolidadoPromedio]=IF(ISBLANK([ValConsolidadoPromedioAnual]),
   BLANK(),
   CALCULATE([ValConsolidadoPromedioAnual],
   FILTER(CROSSJOIN(ALLSELECTED(DWDCanalCliente),ALLSELECTED(DWDFecha),all(DWDCuentaContable)),DWDCuentaContable[cpCalIndicadorNivel1]=max(DWDCuentaContable[cpCalIndicadorNivel1]))
  )
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValGrupoFamiliaConsolidadoPromedio</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValGrupoFechaCostoOperativo]=if(ISBLANK([ValConsolidadoCostoOperativo]),BLANK(),

CALCULATE([ValConsolidadoCostoOperativo],
FILTER(CROSSJOIN(ALL(DWDFecha),ALLSELECTED(DWDCuentaContable),ALL(DWDCanalCliente)),DWDFecha[feIdFecha]=MAX(DWDFecha[feIdFecha])),
DWDCanalCliente[caCodigoAgrupacionCanal]="COR" || DWDCanalCliente[caCodigoAgrupacionCanal]="ESP" || DWDCanalCliente[caCodigoAgrupacionCanal]="RED" || DWDCanalCliente[caCodigoAgrupacionCanal]="TES"
)
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValGrupoFechaCostoOperativo</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValGrupoCanalCostoOperativo]=if(ISBLANK([ValConsolidadoCostoOperativo]),BLANK(),
CALCULATE([ValConsolidadoCostoOperativo],
FILTER(CROSSJOIN(ALLSELECTED(DWDFecha),ALLSELECTED(DWDCuentaContable),ALL(DWDCanalCliente)),DWDCanalCliente[caOrdenCanal]=max(DWDCanalCliente[caOrdenCanal]) ),
DWDCanalCliente[caCodigoAgrupacionCanal]="COR" || DWDCanalCliente[caCodigoAgrupacionCanal]="ESP" || DWDCanalCliente[caCodigoAgrupacionCanal]="RED" || DWDCanalCliente[caCodigoAgrupacionCanal]="TES"
)
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValGrupoCanalCostoOperativo</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValGrupoFechaPerdidaEsperada]=if(ISBLANK([ValConsolidadoPerdidaEsperada]),BLANK(),

CALCULATE([ValConsolidadoPerdidaEsperada],
FILTER(CROSSJOIN(ALL(DWDFecha),ALLSELECTED(DWDCuentaContable),ALLSELECTED(DWDCanalCliente)),DWDFecha[feIdFecha]=MAX(DWDFecha[feIdFecha]))
)
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValGrupoFechaPerdidaEsperada</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValGrupoCanalPerdidaEsperada]=if(ISBLANK([ValConsolidadoPerdidaEsperada]),BLANK(),
CALCULATE([ValConsolidadoPerdidaEsperada],
FILTER(CROSSJOIN(ALLSELECTED(DWDFecha),ALLSELECTED(DWDCuentaContable),ALL(DWDCanalCliente)),DWDCanalCliente[caOrdenCanal]=max(DWDCanalCliente[caOrdenCanal]) ),
DWDCanalCliente[caCodigoAgrupacionCanal]="COR" || DWDCanalCliente[caCodigoAgrupacionCanal]="ESP" || DWDCanalCliente[caCodigoAgrupacionCanal]="RED" || DWDCanalCliente[caCodigoAgrupacionCanal]="TES"
)
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValGrupoCanalPerdidaEsperada</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValGrupoFechaComision]=if(ISBLANK([ValConsolidadoComision]),BLANK(),
CALCULATE([ValConsolidadoComision],
FILTER(CROSSJOIN(ALL(DWDFecha),ALLSELECTED(DWDCuentaContable),ALLSELECTED(DWDCanalCliente)),DWDFecha[feIdFecha]=MAX(DWDFecha[feIdFecha]))
)
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValGrupoFechaComision</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValGrupoCanalComision]=if(ISBLANK([ValConsolidadoComision]),BLANK(),
CALCULATE([ValConsolidadoComision],
FILTER(CROSSJOIN(ALLSELECTED(DWDFecha),ALLSELECTED(DWDCuentaContable),ALL(DWDCanalCliente)),DWDCanalCliente[caOrdenCanal]=max(DWDCanalCliente[caOrdenCanal]) ),
DWDCanalCliente[caCodigoAgrupacionCanal]="COR" || DWDCanalCliente[caCodigoAgrupacionCanal]="ESP" || DWDCanalCliente[caCodigoAgrupacionCanal]="RED" || DWDCanalCliente[caCodigoAgrupacionCanal]="TES"
)
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValGrupoCanalComision</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValRankingUtilidadTesoreria]=IF( ISBLANK([ValConsolidadoUtilidadOperativa]) || [ValConsolidadoUtilidadOperativa]=0,
     BLANK(),
     RANKX(
                    FILTER(                                   CROSSJOIN(ALLSELECTED(DWDCliente),ALLSELECTED(DWDCanalCliente),ALLSELECTED(DWDFecha))                                   
                                 ,DWDCanalCliente[caDescripcionAgrupacionCanal]="Tesoreria" &amp;&amp; DWDFecha[feIdFecha]=max(DWDFecha[feIdFecha])),
                                 [ValConsolidadoUtilidadOperativa],,0,Dense
               )
     );
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValRankingUtilidadTesoreria</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValUtilidadTesoreria]=IF(
ISBLANK([ValRankingUtilidadTesoreria]),BLANK(),
CALCULATE([ValConsolidadoUtilidadOperativa],DWDCanalCliente[caDescripcionAgrupacionCanal]="Tesoreria",
          FILTER(
          	CROSSJOIN(ALLSELECTED(DWDCliente),ALLSELECTED(DWDCanalCliente),ALLSELECTED(DWDFecha))
                ,DWDFecha[feidFecha]=max(DWDFecha[feidFecha]
                )
	  
         )
));
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValUtilidadTesoreria</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValRankingUtilidadTesoreriaCtr]=if([ValRankingUtilidadTesoreria]&lt;= 10, [ValRankingUtilidadTesoreria], -10);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValRankingUtilidadTesoreriaCtr</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValPonderadoAnualTesoreria]=IF(
ISBLANK([ValRankingUtilidadTesoreria]),BLANK(),
CALCULATE([ValConsolidadoPonderadoAnual],DWDCanalCliente[caDescripcionAgrupacionCanal]="Tesoreria",
          FILTER(
          	CROSSJOIN(ALLSELECTED(DWDCliente),ALLSELECTED(DWDCanalCliente),ALLSELECTED(DWDFecha))
                ,DWDFecha[feidFecha]=max(DWDFecha[feidFecha]
                )
	  
         )
));
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValPonderadoAnualTesoreria</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValGrupoCanalUtilidadCorporativo]=CALCULATE([ValConsolidadoUtilidadOperativa],FILTER(CROSSJOIN(ALLSELECTED(DWDCliente),ALLSELECTED(DWDCanalCliente),ALLSELECTED(DWDFecha)),DWDCanalCliente[caDescripcionAgrupacionCanal]="Corporativo"),
DWDCuentaContable[cpCalIndicadorNivel1]=1 || DWDCuentaContable[cpCalIndicadorNivel1]=2 || DWDCuentaContable[cpCalIndicadorNivel1]=3
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValGrupoCanalUtilidadCorporativo</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValGrupoCanalUtilidadComercial]=CALCULATE([ValConsolidadoUtilidadOperativa],FILTER(CROSSJOIN(ALLSELECTED(DWDCliente),ALLSELECTED(DWDCanalCliente),ALLSELECTED(DWDFecha)),DWDCanalCliente[caDescripcionAgrupacionCanal]="Comercial"),
DWDCuentaContable[cpCalIndicadorNivel1]=1 || DWDCuentaContable[cpCalIndicadorNivel1]=2 || DWDCuentaContable[cpCalIndicadorNivel1]=3
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValGrupoCanalUtilidadComercial</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValGrupoCanalUtilidadEspecializada]=CALCULATE([ValConsolidadoUtilidadOperativa],FILTER(CROSSJOIN(ALLSELECTED(DWDCliente),ALLSELECTED(DWDCanalCliente),ALLSELECTED(DWDFecha)),DWDCanalCliente[caDescripcionAgrupacionCanal]="Especializada"),
DWDCuentaContable[cpCalIndicadorNivel1]=1 || DWDCuentaContable[cpCalIndicadorNivel1]=2 || DWDCuentaContable[cpCalIndicadorNivel1]=3
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValGrupoCanalUtilidadEspecializada</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValGrupoCanalUtilidadTesoreria]=IF(ISBLANK([ValConsolidadoUtilidadOperativa]),
BLANK(),
CALCULATE([ValConsolidadoUtilidadOperativa],FILTER(CROSSJOIN(ALLSELECTED(DWDCliente),ALLSELECTED(DWDCanalCliente),ALLSELECTED(DWDFecha)),DWDCanalCliente[caDescripcionAgrupacionCanal]="Tesoreria"),
DWDCuentaContable[cpCalIndicadorNivel1]=1 || DWDCuentaContable[cpCalIndicadorNivel1]=2 || DWDCuentaContable[cpCalIndicadorNivel1]=3
)
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValGrupoCanalUtilidadTesoreria</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValPromedioProductoFechaAUMS]=IF(ISBLANK([ValConsolidadoPromedioAnual]),
BLANK(),
 CALCULATE([ValConsolidadoPromedioAnual],
FILTER(CROSSJOIN(ALLSELECTED(DWDFecha),ALLSELECTED(DWDCanalCliente),ALL(DWDCuentaContable)),DWDFecha[feIdFecha]=max(DWDFecha[feIdFecha])),
DWDCuentaContable[cpCalIndicadorNivel1]=1 || DWDCuentaContable[cpCalIndicadorNivel1]=2 || DWDCuentaContable[cpCalIndicadorNivel1]=3
)
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValPromedioProductoFechaAUMS</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValCarteraSubProductoFechaInteres]=IF(ISBLANK([ValCarteraInteresAnual]),
BLANK(),
 CALCULATE([ValCarteraInteresAnual],
FILTER(CROSSJOIN(ALL(DWDFecha),ALLSELECTED(DWDCanalCliente),ALLSELECTED(DWDCuentaContable)),DWDFecha[feIdFecha]=max(DWDFecha[feIdFecha])),
DWDCuentaContable[cpCalIndicadorNivel1]=1
)
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCarteraSubProductoFechaInteres</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValCaptacionesSubProductoFechaInteres]=IF(ISBLANK([ValCaptacionesInteresAnual]),
BLANK(),
 CALCULATE([ValCaptacionesInteresAnual],
FILTER(CROSSJOIN(ALL(DWDFecha),ALLSELECTED(DWDCanalCliente),ALLSELECTED(DWDCuentaContable)),DWDFecha[feIdFecha]=max(DWDFecha[feIdFecha])),
DWDCuentaContable[cpCalIndicadorNivel1]=2
)
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCaptacionesSubProductoFechaInteres</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValCarteraSubproductoFechaPromedio]=IF(ISBLANK([ValConsolidadoPromedioAnual]),
BLANK(),
     CALCULATE([ValConsolidadoPromedioAnual],
    FILTER(CROSSJOIN(ALLSELECTED(DWDCanalCliente),ALL(DWDFecha),ALL(DWDCuentaContable)), DWDFecha[feIdFecha]=max(DWDFecha[feIdFecha]) &amp;&amp; DWDCuentaContable[cpCalIndicadorNivel2]=max(DWDCuentaContable[cpCalIndicadorNivel2]) ),     DWDCuentaContable[cpCalIndicadorNivel1]=1
)
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCarteraSubproductoFechaPromedio</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValCaptacionesSubproductoFechaPromedio]=IF(ISBLANK([ValConsolidadoPromedioAnual]),
BLANK(),
     CALCULATE([ValConsolidadoPromedioAnual],
     FILTER(CROSSJOIN(ALLSELECTED(DWDCanalCliente),ALL(DWDFecha),ALL(DWDCuentaContable)),DWDFecha[feIdFecha]=max(DWDFecha[feIdFecha]) &amp;&amp; DWDCuentaContable[cpCalIndicadorNivel2]=max(DWDCuentaContable[cpCalIndicadorNivel2])),
     DWDCuentaContable[cpCalIndicadorNivel1]=2
)
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCaptacionesSubproductoFechaPromedio</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDCliente'[TotalClientes]=COUNT(DWDCliente[clCodigoCliente]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>TotalClientes</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValConsolidadoTasaImplicita]=DIVIDE( [ValConsolidadoInteresAnual], [ValConsolidadoPromedioAnual], 0 );
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValConsolidadoTasaImplicita</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDAsesorOperacionCliente'[ValNombreAsesor]=IFERROR(CALCULATE(VALUES(DWDAsesorOperacionCliente[asNombreAsesor]),ALLEXCEPT(DWDAsesorOperacionCliente,DWDAsesorOperacionCliente[asCodigoAsesor])),"Tiene Mas de un Valor");
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValNombreAsesor</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDAsesorOperacionCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDAgenciaOperacionCliente'[ValNombreAgencia]=IFERROR(CALCULATE( VALUES(DWDAgenciaOperacionCliente[agNombreAgencia]),ALLEXCEPT(DWDAgenciaOperacionCliente,DWDAgenciaOperacionCliente[agCodigoAgencia])),"Tiene Mas de un Valor");
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValNombreAgencia</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDAgenciaOperacionCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDAgenciaOperacionCliente'[ValNombreRegion]=IFERROR(CALCULATE(VALUES(DWDAgenciaOperacionCliente[agNombreRegion]),ALLEXCEPT(DWDAgenciaOperacionCliente,DWDAgenciaOperacionCliente[agCodigoRegion])),"Tiene Mas de un Valor");
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValNombreRegion</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDAgenciaOperacionCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDAgenciaOperacionCliente'[ValNombreZona]=IFERROR(CALCULATE(VALUES(DWDAgenciaOperacionCliente[agNombreZona]),ALL(DWDAgenciaOperacionCliente[agCodigoAgencia])),"Tiene Mas de un Valor");
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValNombreZona</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDAgenciaOperacionCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDCanalCliente'[ValNombreAgrupacionCanal]=IFERROR(CALCULATE( VALUES(DWDCanalCliente[caDescripcionAgrupacionCanal]), ALLEXCEPT(DWDCanalCliente,DWDCanalCliente[caCodigoAgrupacionCanal]),DWDCanalCliente[caEstado]=TRUE() ),"Tiene Mas de un Valor");
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValNombreAgrupacionCanal</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDCanalCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDCliente'[ValNombreCliente]=IFERROR(CALCULATE( VALUES(DWDCliente[clNombreCompleto]),ALLEXCEPT(DWDCliente,DWDCliente[clCodigoCliente]) , ISBLANK(DWDCliente[clFechaFin])  ),"Tiene Mas de un Valor");
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValNombreCliente</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDCuentaContableIngresos'[ValCodigolTipoIngresoN2]=MAX(DWDCuentaContableIngresos[ccCalCodigoTipoIngresoN2]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCodigolTipoIngresoN2</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDCuentaContableIngresos</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDCuentaContableIngresos'[ValTipoIngresoN2]=IFERROR(CALCULATE(VALUES(DWDCuentaContableIngresos[ccCalTipoIngresoN2]),
FILTER(ALL(DWDCuentaContableIngresos),DWDCuentaContableIngresos[ccCalCodigoTipoIngresoN2]=Max(DWDCuentaContableIngresos[ccCalCodigoTipoIngresoN2]))
),"Mas De Un valor");
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTipoIngresoN2</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDCuentaContableIngresos</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDCuentaContableIngresos'[ValTarifaTransaccion]=IFERROR(CALCULATE(VALUES(DWDCuentaContableIngresos[ccTarifaTransaccion]),FILTER(ALL(DWDCuentaContableIngresos),
DWDCuentaContableIngresos[ccIdCuentaContable]=max(DWDCuentaContableIngresos[ccIdCuentaContable]))),"0");
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTarifaTransaccion</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDCuentaContableIngresos</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDAsesorOperacionCliente'[ValNombreRegional]=IFERROR(CALCULATE(VALUES(DWDAsesorOperacionCliente[asNombreRegional]),ALLEXCEPT(DWDAsesorOperacionCliente,DWDAsesorOperacionCliente[asCodigoRegional])),"Tiene Mas de un Valor");
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValNombreRegional</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDAsesorOperacionCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPosicionConsolidadaTarjeta'[ValPosSaldoTotal]=sum([pctSaldoTotal]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValPosSaldoTotal</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPosicionConsolidadaTarjeta</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPosicionConsolidadaTarjeta'[ValPosCupoAsignado]=sum([pctCupoAsignado]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValPosCupoAsignado</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPosicionConsolidadaTarjeta</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPosicionConsolidadaTarjeta'[ValPosSaldoFavor]=sum([pctSaldoFavor]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValPosSaldoFavor</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPosicionConsolidadaTarjeta</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTarjetaQNDI]=CALCULATE(DWHTarjetaCreditoOperacion[ValTarjetaSaldoDia] , DWDCuentaContable[CpEstadoProducto] = "NDE" );
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTarjetaQNDI</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTarjetaVCDA]=CALCULATE(DWHTarjetaCreditoOperacion[ValTarjetaSaldoDia] , DWDCuentaContable[CpEstadoProducto] = "VEN" );
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTarjetaVCDA</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTrjSaldoPromedioAnual]=SUM([tcoSaldoPromedioAnual]) + 0;
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTrjSaldoPromedioAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTrjInteresRealAnual]=SUM([tcoValorInteresRealAnual]) + 0;
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTrjInteresRealAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDAsesorOperacionCliente'[ValNombreSubregion]=IFERROR(CALCULATE(VALUES(DWDAsesorOperacionCliente[asNombreSubregion]),ALLEXCEPT(DWDAsesorOperacionCliente,DWDAsesorOperacionCliente[asCodigoSubregion])),"Tiene Mas de un Valor");
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValNombreSubregion</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDAsesorOperacionCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHIngresoOperacion'[ValIngresoNumeroTrxMesFiscal]=SUM(DWHIngresoOperacion[ioNumeroTransaccionesOperacionMesFiscal]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValIngresoNumeroTrxMesFiscal</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHIngresoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDJerarquia'[ValBanderaJerarquia]=IF
(
  ( HASONEVALUE(ParametrosJerarquia[Canal])  &amp;&amp;  HASONEVALUE(ParametrosJerarquia[Nivel2])) ,
  IF(
  
       (MAX(DWDJerarquia[jeCodigoNivel2])&gt;=VALUES(ParametrosJerarquia[CodigoNivel2])) &amp;&amp;
       (MAX(DWDJerarquia[jeCodigoCanal])=VALUES(ParametrosJerarquia[CodigoCanal]))
       
       ,MAX(DWDJerarquia[jeCodigoNivel2]),BLANK())
       
  , BLANK()
  
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValBanderaJerarquia</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDJerarquia</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDJerarquia'[ValRankingJerarquia]=IF(ISBLANK(DWDJerarquia[ValBanderaJerarquia]),BLANK(),
RANKX
  (
    FILTER(ALLSELECTED(DWDJerarquia),DWDJerarquia[ValBanderaJerarquia]&lt;&gt;BLANK()),
    DWDJerarquia[ValBanderaJerarquia],,1
    )
);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValRankingJerarquia</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDJerarquia</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDJerarquia'[ValTipoFiltro]=IF(ISBLANK([ValRankingJerarquia]),BLANK(),VALUES(DWDJerarquia[jeNivel2]));
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTipoFiltro</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDJerarquia</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValCalTasaPool]=DIVIDE( [ValConsolidadoTasaPool], [ValConsolidadoPromedioAnual], 0.00 );
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCalTasaPool</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDFecha'[ValFechaMesAntRent]=LOOKUPVALUE(DWDFecha[feMesAntCierr],DWDFecha[feMesAnterior],1);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValFechaMesAntRent</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDFecha</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDCliente'[ValClienteCodigoAgencia]=SUM(DWDCliente[clCodigoAgencia]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValClienteCodigoAgencia</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDCliente'[ValClienteCodigoAsesor]=IFERROR(CALCULATE( VALUES(DWDCliente[clCodigoAsesor]),ALLEXCEPT(DWDCliente,DWDCliente[clCodigoCliente]) , ISBLANK(DWDCliente[clFechaFin])  ),"Tiene Mas de un Valor");
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValClienteCodigoAsesor</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDCliente'[ValClienteCodigoZona]=sum(DWDCliente[clCodigoZona]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValClienteCodigoZona</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDCliente'[ValClienteCodigoRegion]=sum(DWDCliente[clCodigoRegion]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValClienteCodigoRegion</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDCliente'[ValClienteCodigoRegional]=sum(DWDCliente[clCodigoRegional]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValClienteCodigoRegional</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDCliente'[ValClienteCodigoSubregion]=sum(DWDCliente[clCodigoSubregion]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValClienteCodigoSubregion</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDCliente'[ValClienteCodigoAgrupacionCanal]=IFERROR(CALCULATE( VALUES(DWDCliente[clCodigoAgrupacionCanal]),ALLEXCEPT(DWDCliente,DWDCliente[clCodigoCliente]) , ISBLANK(DWDCliente[clFechaFin])  ),"Tiene Mas de un Valor");
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValClienteCodigoAgrupacionCanal</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHIngresoOperacion'[ValFacturacionAdquirencia]=CALCULATE(	SUM(DWHIngresoOperacion[ioSaldoAcumuladoAnual]) , DWDCuentaContableIngresos[ccCuentaAdquirenciaTC]=1 );
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValFacturacionAdquirencia</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHIngresoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHActivoOperacion'[ValActivoPorcentajePerdidaEsperada]=AVERAGE(DWHActivoOperacion[aoValorPorcentajePerdidaEsperada]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValActivoPorcentajePerdidaEsperada</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHActivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTarjetaPorcentajePerdidaEsperada]=AVERAGE(DWHTarjetaCreditoOperacion[tcoValorPorcentajePerdidaEsperada]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTarjetaPorcentajePerdidaEsperada</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHIngresoOperacion'[ValNumeroTrxMantenimientoTarjetaCreditoAnual]=CALCULATE(SUM(DWHIngresoOperacion[ioNumeroTransaccionesOperacionMesFiscal]),FILTER(DWDCuentaContableIngresos,DWDCuentaContableIngresos[ccCalCodigoAgrupacionRentabilidaN4]=43));
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValNumeroTrxMantenimientoTarjetaCreditoAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHIngresoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHIngresoOperacion'[ValNumeroTrxAtmRetirosClientesPropiosAnual]=CALCULATE(SUM(DWHIngresoOperacion[ioNumeroTransaccionesOperacionMesFiscal]),FILTER(DWDCuentaContableIngresos,DWDCuentaContableIngresos[ccCalCodigoAgrupacionRentabilidaN4]=42));
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValNumeroTrxAtmRetirosClientesPropiosAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHIngresoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHIngresoOperacion'[ValNumeroTrxTarjetaDebitoEmisionRenovacion]=CALCULATE(SUM(DWHIngresoOperacion[ioNumeroTransaccionesOperacion]),FILTER(DWDCuentaContableIngresos,DWDCuentaContableIngresos[ccCalCodigoAgrupacionRentabilidaN4]=38));
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValNumeroTrxTarjetaDebitoEmisionRenovacion</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHIngresoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHIngresoOperacion'[ValNumeroTrxTarjetaDebitoReposicion]=CALCULATE(SUM(DWHIngresoOperacion[ioNumeroTransaccionesOperacion]),FILTER(DWDCuentaContableIngresos,DWDCuentaContableIngresos[ccCalCodigoAgrupacionRentabilidaN4]=34));
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValNumeroTrxTarjetaDebitoReposicion</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHIngresoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDAsesorOperacionCliente'[ValCodigoAgenciaAsesorOper]=SUM(DWDAsesorOperacionCliente[asCodigoAgencia]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCodigoAgenciaAsesorOper</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDAsesorOperacionCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDAsesorOperacionCliente'[ValCodigoZonaAsesorOper]=SUM(DWDAsesorOperacionCliente[asCodigoZona]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCodigoZonaAsesorOper</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDAsesorOperacionCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDAsesorOperacionCliente'[ValCodigoRegionAsesorOper]=SUM(DWDAsesorOperacionCliente[asCodigoRegion]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCodigoRegionAsesorOper</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDAsesorOperacionCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDAsesorOperacionCliente'[ValCodigoRegionalAsesorOper]=SUM(DWDAsesorOperacionCliente[asCodigoRegional]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCodigoRegionalAsesorOper</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDAsesorOperacionCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDAsesorOperacionCliente'[ValCodigoSubRegionAsesorOper]=SUM(DWDAsesorOperacionCliente[asCodigoSubregion]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCodigoSubRegionAsesorOper</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDAsesorOperacionCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDAsesorOperacionCliente'[ValCodigoAgrupacionCanalAsesorOper]=IFERROR(CALCULATE( VALUES(DWDAsesorOperacionCliente[asCodigoAgrupacionCanal]),
ALLEXCEPT(DWDAsesorOperacionCliente,DWDAsesorOperacionCliente[asCodigoAsesor]) 
),"Tiene Mas de un Valor");
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCodigoAgrupacionCanalAsesorOper</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDAsesorOperacionCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDAsesorOperacionCliente'[ValCodigoAsesor]=CALCULATE(LASTNONBLANK(DWDAsesorOperacionCliente[asCodigoAsesor],1));
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCodigoAsesor</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDAsesorOperacionCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDAsesorOperacionCliente'[ValCodigoAgrupacionCanal]=CALCULATE(LASTNONBLANK(DWDAsesorOperacionCliente[asCodigoAgrupacionCanal],1));
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCodigoAgrupacionCanal</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDAsesorOperacionCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDCliente'[ValCodigoAsesorCliente]=CALCULATE(LASTNONBLANK(DWDCliente[clCodigoAsesor],1));
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCodigoAsesorCliente</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDCliente'[ValAgrupacionCanalCliente]=CALCULATE(LASTNONBLANK(DWDCliente[clCodigoAgrupacionCanal],1));
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValAgrupacionCanalCliente</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDAgenciaOperacionCliente'[ValCodigoAgencia]=SUM(DWDAgenciaOperacionCliente[agCodigoAgencia]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCodigoAgencia</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDAgenciaOperacionCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDAgenciaOperacionCliente'[ValCodigoZonaAgencia]=SUM(DWDAgenciaOperacionCliente[agCodigoZona]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCodigoZonaAgencia</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDAgenciaOperacionCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDAgenciaOperacionCliente'[ValCodigoRegionAgencia]=SUM(DWDAgenciaOperacionCliente[agCodigoRegion]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCodigoRegionAgencia</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDAgenciaOperacionCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDAgenciaOperacionCliente'[ValCodigoRegionalAgencia]=SUM(DWDAgenciaOperacionCliente[agCodigoRegional]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCodigoRegionalAgencia</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDAgenciaOperacionCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDAgenciaOperacionCliente'[ValCodigoSubRegionAgencia]=SUM(DWDAgenciaOperacionCliente[agCodigoSubregion]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCodigoSubRegionAgencia</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDAgenciaOperacionCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDAgenciaOperacionCliente'[ValCodigoJefeAgencia]=CALCULATE(LASTNONBLANK(DWDAgenciaOperacionCliente[agCodigoJefeAgencia],1));
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCodigoJefeAgencia</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDAgenciaOperacionCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHCuotaOperacion'[ValCuotaSaldoDia]=SUM(DWHCuotaOperacion[coCuotaCapital]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCuotaSaldoDia</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHCuotaOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHCuotaOperacion'[ValCuotaVencerActual]=CALCULATE(SUM(DWHCuotaOperacion[coCuotaCapital]),DWDCuentaContable[CpEstadoProducto]="VIG",DWDFecha[feDiaActual]=1,DWDCuentaContable[cpCalIndicadorNivel1]=1,DWDCanalCliente[caEstado]=True);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCuotaVencerActual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHCuotaOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHCuotaOperacion'[ValCuotaQNDIActual]=CALCULATE(SUM(DWHCuotaOperacion[coCuotaCapital]),DWDCuentaContable[CpEstadoProducto]="NDE",DWDFecha[feDiaActual]=1,DWDCuentaContable[cpCalIndicadorNivel1]=1,DWDCanalCliente[caEstado]=True);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCuotaQNDIActual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHCuotaOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHCuotaOperacion'[ValCuotaVencidoActual]=CALCULATE(SUM(DWHCuotaOperacion[coCuotaCapital]),DWDCuentaContable[CpEstadoProducto]="VEN",DWDFecha[feDiaActual]=1,DWDCuentaContable[cpCalIndicadorNivel1]=1,DWDCanalCliente[caEstado]=True);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCuotaVencidoActual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHCuotaOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHCuotaOperacion'[ValCuotaVencidoQNDIActual]=CALCULATE(SUM(DWHCuotaOperacion[coCuotaCapital]),DWDCuentaContable[CpEstadoProducto]="VEN" || DWDCuentaContable[CpEstadoProducto]="NDE" ,DWDFecha[feDiaActual]=1);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCuotaVencidoQNDIActual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHCuotaOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHCuotaOperacion'[ValCuotaVencidoTotalActual]=CALCULATE(SUM(DWHCuotaOperacion[coCuotaCapital]),DWDCuentaContable[CpEstadoProducto]="VEN" || DWDCuentaContable[CpEstadoProducto]="NDE" || DWDCuentaContable[CpEstadoProducto]="VIG",DWDFecha[feDiaActual]=1,DWDCuentaContable[cpCalIndicadorNivel1]=1,DWDCanalCliente[caEstado]=True);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCuotaVencidoTotalActual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHCuotaOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTRXMantenimientoTCMes]=CALCULATE(DISTINCTCOUNT(DWHTarjetaCreditoOperacion[tcoNumeroOperacion]),DWDCuentaContable[ccCodigoIndicadorRentabilidad]=62,DWHTarjetaCreditoOperacion[tcoSaldoAcumuladoMensualFiscal]&lt;&gt;0);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTRXMantenimientoTCMes</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValTRXMantenimientoTCAnual]=CALCULATE(DISTINCTCOUNT(DWHTarjetaCreditoOperacion[tcoNumeroOperacion])*12,DWDCuentaContable[ccCodigoIndicadorRentabilidad]=62,DWHTarjetaCreditoOperacion[tcoSaldoAcumuladoMensualFiscal]&lt;&gt;0);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValTRXMantenimientoTCAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHTarjetaCreditoOperacion'[ValCostoMantenimientoTCAnual]=[ValTRXMantenimientoTCAnual]*CALCULATE(MAX(DWDCuentaContable[ccTarifaTransaccion]),DWDCuentaContable[ccCodigoIndicadorRentabilidad]=62);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCostoMantenimientoTCAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHTarjetaCreditoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHIngresoOperacion'[ValInteresMensual]=SUM(DWHIngresoOperacion[ioSaldoInteresRealFiscal]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValInteresMensual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHIngresoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHIngresoOperacion'[ValInteresCarteraMensual]=CALCULATE( SUM(DWHIngresoOperacion[ioSaldoInteresRealFiscal]), left(DWDCuentaContableIngresos[ccCodigoNivel6],2)="51" );
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValInteresCarteraMensual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHIngresoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHIngresoOperacion'[ValInteresCaptacionesMensual]=CALCULATE( SUM(DWHIngresoOperacion[ioSaldoInteresRealFiscal]), left(DWDCuentaContableIngresos[ccCodigoNivel6],2)="41" );
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValInteresCaptacionesMensual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHIngresoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'ParametrosJerarquia'[ValServer]=CALCULATE(VALUES(ParametrosJerarquia[Nivel1]),ParametrosJerarquia[Canal]="RENTABILIDAD");
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValServer</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>ParametrosJerarquia</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'ParametrosJerarquia'[ValServerParametros]=CALCULATE(VALUES(ParametrosJerarquia[Nivel1]),ParametrosJerarquia[Canal]="PARAMETRORENTABILIDAD");
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValServerParametros</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>ParametrosJerarquia</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHRankingRentabilidadCliente'[ValRankUtilidadOperativa]=SUM(DWHRankingRentabilidadCliente[ValorUtilidadOperativa]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValRankUtilidadOperativa</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHRankingRentabilidadCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHRankingRentabilidadCliente'[ValRankPonderadoAnual]=SUM(DWHRankingRentabilidadCliente[ValorActPondRiesgoPromAnual]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValRankPonderadoAnual</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHRankingRentabilidadCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHRankingRentabilidadCliente'[ValRankRorac]=DIVIDE([ValRankUtilidadOperativa],[ValRankPonderadoAnual],0);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValRankRorac</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHRankingRentabilidadCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHIngresoOperacion'[ValInteresRealAnualFiscal]=SUM(DWHIngresoOperacion[ioSaldoInteresRealAcumuladoAnualFiscal]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValInteresRealAnualFiscal</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHIngresoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPasivoOperacion'[ValPasivoCostoOperativo]=SUM(DWHPasivoOperacion[poValorCostoOperativo]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValPasivoCostoOperativo</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPasivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHIngresoOperacion'[ValIngresoAcumuladoMesFiscal]=sum(DWHIngresoOperacion[ioSaldoAcumuladoMensualFiscal]);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValIngresoAcumuladoMesFiscal</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHIngresoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPasivoOperacion'[ValCalTasaImplicitaPortafolio]=DIVIDE([ValInteresCaptacionesMensual],[ValPasivoSaldoDia],0);
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCalTasaImplicitaPortafolio</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPasivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWDCliente'[ValClienteTotalVinculacion]=AVERAGE(DWDCliente[clVinculacionValor]);
CREATE MEASURE 'DWDCliente'[_ValClienteTotalVinculacion Goal] = 10; 
CREATE MEASURE 'DWDCliente'[_ValClienteTotalVinculacion Status] = if(ISBLANK('DWDCliente'[ValClienteTotalVinculacion]),BLANK(),
                    If('DWDCliente'[ValClienteTotalVinculacion]&lt;4,-1,
	                If('DWDCliente'[ValClienteTotalVinculacion]&lt;8,0,1)
                )
            )
            ; 
CREATE KPI CURRENTCUBE.[ValClienteTotalVinculacion] AS Measures.[ValClienteTotalVinculacion], ASSOCIATED_MEASURE_GROUP = 'DWDCliente', GOAL = Measures.[_ValClienteTotalVinculacion Goal], STATUS = Measures.[_ValClienteTotalVinculacion Status], STATUS_GRAPHIC = 'Traffic Light - Single';
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValClienteTotalVinculacion</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWDCliente</Value>
                    </Annotation>
                  </Annotations>
                </Command>
                <Command>
                  <Text>----------------------------------------------------------
-- PowerPivot measures command (do not modify manually) --
----------------------------------------------------------


CREATE MEASURE 'DWHPasivoOperacion'[ValCalTasaImplicitaAperturada]=CALCULATE(DIVIDE([ValInteresCaptacionesMensual],[ValPasivoSaldoDia],0),DWHPasivoOperacion[poCuentaAperturada]=1)+0;
</Text>
                  <Annotations>
                    <Annotation>
                      <Name>FullName</Name>
                      <Value>ValCalTasaImplicitaAperturada</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Table</Name>
                      <Value>DWHPasivoOperacion</Value>
                    </Annotation>
                  </Annotations>
                </Command>
              </Commands>
              <CalculationProperties>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValFechaActual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValPasivoSaldoDia]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValPasivoAcumuladoAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValPasivoPromedioAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValPasivoPonderadoAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValPasivoComision]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValPasivoIngresoServicio]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValPasivoNumeroTransacciones]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValPasivoOperacionFinanciera]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValPasivoInteresAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValPasivoTasaPool]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValPasivoMargenFinanciero]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValPasivoMargenBancario]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValPasivoMargenOrdinario]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValPasivoMargenExplotacion]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValPasivoUtilidadOperativa]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValActivoSaldoDia]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValActivoPromedioAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValActivoAcumuladoAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValActivoPonderadoAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValActivoComision]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValActivoIngresoServicio]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValActivoOperacionFinanciera]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValActivoInteresAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValActivoTasaPool]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValActivoMargenFinanciero]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValActivoMargenBancario]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValActivoMargenOrdinario]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValActivoMargenExplotacion]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValActivoUtilidadOperativa]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValActivoCostoOperativo]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValActivoPerdidaEsperada]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValActivoNumeroTransacciones]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTarjetaSaldoDia]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTarjetaAcumuladoAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTarjetaPromedioAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTarjetaPonderadoAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTarjetaComision]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTarjetaIngresoServicio]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTarjetaOperacionFinanciera]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTarjetaInteresAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTarjetaTasaPool]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTarjetaMargenFinanciero]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTarjetaMargenBancario]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTarjetaMargenOrdinario]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTarjetaMargenExplotacion]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTarjetaUtilidadOperativa]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTarjetaCostoOperativo]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTarjetaPerdidaEsperada]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTarjetaNumeroTransacciones]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValConsolidadoSaldoDia]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValConsolidadoAcumuladoAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValConsolidadoPromedioAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <Description>Valor del promedio del Pasivo anual mas valor del activo promedio anual mas el valor de tarjeta promedio anual.</Description>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValConsolidadoPonderadoAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValConsolidadoComision]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValConsolidadoIngresoServicio]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValConsolidadoOperacionFinanciera]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValConsolidadoInteresAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValConsolidadoTasaPool]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <Description>Valor del Interes de la tasa pool (Activo+Pasivo+Tarjeta)</Description>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValConsolidadoMargenFinanciero]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValConsolidadoMargenBancario]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValConsolidadoMargenOrdinario]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValConsolidadoMargenExplotacion]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValConsolidadoUtilidadOperativa]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValConsolidadoCostoOperativo]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValConsolidadoPerdidaEsperada]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValConsolidadoNumeroTransacciones]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValClienteCodigo]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValConsolidadoRorac]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValFechaAnioAtras]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValFechaConteo]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValConsolidadoCarteraCaptaciones]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValFechaMinima]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValPromedioCarteraCaptaciones]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValActivoIngresos]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValPasivoIngresos]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTarjetaIngresos]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTarjetaPromedioTasaEfectiva]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValActivoPromedioTasaEfectiva]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValParticipacionCarteraCaptaciones]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValActivoPromedioTasaPool]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValNumeroAsesores]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValNumeroCanales]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValNumeroAgencias]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValActivoPromedioSpread]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValInteresGanadoPagado]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValIngresosFinancieros]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValConsolidadoPromedioTarifa]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <Description>prueba</Description>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValIngresosAcumuladoAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValIngresoNumeroTransacciones]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValNumeroOperacionesAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCostoTransaccionAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCostoOperacionAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValMontoAcumuladoAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValConsolidadoPerdidaEsperadaSoloFecha]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValNumeroCuentas]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTarifaPromedio]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValRankingTransaccionesOrden]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValConsolidadoPorcentajePerdidaEsperada]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValExposicion]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValSeveridad]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValProbabilidadIncumplimiento]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValPorcentajePerdida]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTotalGrupoTransacciones]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTotalGrupoIngresosAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValGrupoFechaActivoPasivo]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[VaGrupoProductoIngresosFinancieros]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValGrupoRentabilidadN1Ingresos]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValGrupoRentabilidadN2Ingresos]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValGrupoFechaCarteraInteres]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCarteraInteresAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValGrupoCanalCarteraInteres]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCarteraPromedioAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValGrupoFechaCarteraPromedio]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValGrupoCanalCarteraPromedio]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCaptacionesInteresAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValGrupoFechaCaptacionesInteres]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValGrupoCanalCaptacionesInteres]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCaptacionesPromedioAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValGrupoFechaCaptacionesPromedio]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValGrupoCanalCaptacionesPromedio]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValGrupoFamiliaConsolidadoPromedio]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValGrupoFechaCostoOperativo]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValGrupoCanalCostoOperativo]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValGrupoFechaPerdidaEsperada]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValGrupoCanalPerdidaEsperada]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValGrupoFechaComision]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValGrupoCanalComision]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValRankingUtilidadTesoreria]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValUtilidadTesoreria]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValRankingUtilidadTesoreriaCtr]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValPonderadoAnualTesoreria]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValGrupoCanalUtilidadCorporativo]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValGrupoCanalUtilidadComercial]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValGrupoCanalUtilidadEspecializada]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValGrupoCanalUtilidadTesoreria]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValPromedioProductoFechaAUMS]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCarteraSubProductoFechaInteres]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCaptacionesSubProductoFechaInteres]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCarteraSubproductoFechaPromedio]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCaptacionesSubproductoFechaPromedio]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[TotalClientes]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValConsolidadoTasaImplicita]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValNombreAsesor]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValNombreAgencia]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValNombreRegion]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValNombreZona]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValNombreAgrupacionCanal]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValNombreCliente]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCodigolTipoIngresoN2]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTipoIngresoN2]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTarifaTransaccion]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValNombreRegional]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValPosSaldoTotal]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <Description>Sumatoria de Saldo total de tarjeta (saldo rotativo + saldodiferido)</Description>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValPosCupoAsignado]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <Description>Sumatorio de cupo asignado (cupo rotativo + cupo diferido)</Description>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValPosSaldoFavor]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <Description>Sumatoria de saldo a favor del cliente, pagos realizados en exceso (saldo ctual en sobregiro)</Description>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTarjetaQNDI]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <Description>Sumatoria de saldo diario para cartera de tarjeta que no devenga interes a traves de la cuenta contable</Description>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTarjetaVCDA]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <Description>Sumatoria de saldo diario para cartera de tarjeta vencida a traves de la cuenta contable</Description>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTrjSaldoPromedioAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <Description>Sumatoria de saldo Promedio anual sin validacion de saldo promedio de activos y pasivos</Description>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTrjInteresRealAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <Description>Sumatoria de Interes real anual sin validacion de interes real anual de activos y pasivos</Description>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValNombreSubregion]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValIngresoNumeroTrxMesFiscal]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValBanderaJerarquia]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValRankingJerarquia]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTipoFiltro]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCalTasaPool]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValFechaMesAntRent]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValClienteCodigoAgencia]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValClienteCodigoAsesor]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValClienteCodigoZona]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValClienteCodigoRegion]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValClienteCodigoRegional]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValClienteCodigoSubregion]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValClienteCodigoAgrupacionCanal]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValFacturacionAdquirencia]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValActivoPorcentajePerdidaEsperada]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTarjetaPorcentajePerdidaEsperada]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValNumeroTrxMantenimientoTarjetaCreditoAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValNumeroTrxAtmRetirosClientesPropiosAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValNumeroTrxTarjetaDebitoEmisionRenovacion]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValNumeroTrxTarjetaDebitoReposicion]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCodigoAgenciaAsesorOper]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCodigoZonaAsesorOper]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCodigoRegionAsesorOper]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCodigoRegionalAsesorOper]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCodigoSubRegionAsesorOper]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCodigoAgrupacionCanalAsesorOper]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCodigoAsesor]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCodigoAgrupacionCanal]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCodigoAsesorCliente]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValAgrupacionCanalCliente]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCodigoAgencia]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCodigoZonaAgencia]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCodigoRegionAgencia]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCodigoRegionalAgencia]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCodigoSubRegionAgencia]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCodigoJefeAgencia]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCuotaSaldoDia]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <Description>Saldo de Cartera </Description>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCuotaVencerActual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <Description>Saldos de estado por vencer solo para la  fecha de corte</Description>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCuotaQNDIActual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <Description>Saldos de estado QNDI solo para la  fecha de corte</Description>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCuotaVencidoActual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <Description>Saldos por estado vencido solo para la  fecha de corte</Description>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCuotaVencidoQNDIActual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <Description>Suma de los estados Vencido y QNDI para la fecha de corte</Description>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCuotaVencidoTotalActual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <Description>Suma de los saldos de cartera por los estados Vencido, QNDI y Por Vencer</Description>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>True</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTRXMantenimientoTCMes]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <Visible>false</Visible>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValTRXMantenimientoTCAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCostoMantenimientoTCAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValInteresMensual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <Description>Saldo acumulado mensual de los interes de cartera y captaciones </Description>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValInteresCarteraMensual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValInteresCaptacionesMensual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValServer]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValServerParametros]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValRankUtilidadOperativa]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValRankPonderadoAnual]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValRankRorac]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValInteresRealAnualFiscal]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValPasivoCostoOperativo]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValIngresoAcumuladoMesFiscal]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCalTasaImplicitaPortafolio]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>Kpi</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                    <Annotation>
                      <Name>GoalType</Name>
                      <Value>StaticValue</Value>
                    </Annotation>
                    <Annotation>
                      <Name>GoalValue</Name>
                      <Value>10</Value>
                    </Annotation>
                    <Annotation>
                      <Name>KpiStatusType</Name>
                      <Value>Linear</Value>
                    </Annotation>
                    <Annotation>
                      <Name>KpiThresholdType</Name>
                      <Value>Absolute</Value>
                    </Annotation>
                    <Annotation>
                      <Name>KpiThresholdOrdering</Name>
                      <Value>Ascending</Value>
                    </Annotation>
                    <Annotation>
                      <Name>KpiThresholdCount</Name>
                      <Value>2</Value>
                    </Annotation>
                    <Annotation>
                      <Name>KpiThreshold_0</Name>
                      <Value>4</Value>
                    </Annotation>
                    <Annotation>
                      <Name>KpiThreshold_1</Name>
                      <Value>8</Value>
                    </Annotation>
                    <Annotation>
                      <Name>ValueDescription</Name>
                    </Annotation>
                    <Annotation>
                      <Name>GoalDescription</Name>
                    </Annotation>
                    <Annotation>
                      <Name>StatusDescription</Name>
                    </Annotation>
                    <Annotation>
                      <Name>TrendDescription</Name>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValClienteTotalVinculacion]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>SupportMdx</Value>
                    </Annotation>
                    <Annotation>
                      <Name>MainObjectType</Name>
                      <Value>Measure</Value>
                    </Annotation>
                    <Annotation>
                      <Name>MainObjectName</Name>
                      <Value>ValClienteTotalVinculacion</Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[_ValClienteTotalVinculacion Goal]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <Visible>false</Visible>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>SupportMdx</Value>
                    </Annotation>
                    <Annotation>
                      <Name>MainObjectType</Name>
                      <Value>Measure</Value>
                    </Annotation>
                    <Annotation>
                      <Name>MainObjectName</Name>
                      <Value>ValClienteTotalVinculacion</Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[_ValClienteTotalVinculacion Status]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <Visible>false</Visible>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>SupportKpi</Value>
                    </Annotation>
                    <Annotation>
                      <Name>MainObjectType</Name>
                      <Value>Measure</Value>
                    </Annotation>
                    <Annotation>
                      <Name>MainObjectName</Name>
                      <Value>ValClienteTotalVinculacion</Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>KPIs.[ValClienteTotalVinculacion]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                </CalculationProperty>
                <CalculationProperty>
                  <Annotations>
                    <Annotation>
                      <Name>Type</Name>
                      <Value>User</Value>
                    </Annotation>
                    <Annotation>
                      <Name>IsPrivate</Name>
                      <Value>False</Value>
                    </Annotation>
                    <Annotation>
                      <Name>Format</Name>
                      <Value>
                        <Format Format="General" xmlns="" />
                      </Value>
                    </Annotation>
                  </Annotations>
                  <CalculationReference>[ValCalTasaImplicitaAperturada]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <FormatString>''</FormatString>
                </CalculationProperty>
                <CalculationProperty>
                  <CalculationReference>Measures.[__No measures defined]</CalculationReference>
                  <CalculationType>Member</CalculationType>
                  <Visible>false</Visible>
                </CalculationProperty>
              </CalculationProperties>
            </MdxScript>
          </MdxScripts>
          <StorageMode valuens="ddl200_200">InMemory</StorageMode>
          <ProactiveCaching>
            <SilenceInterval>-PT1S</SilenceInterval>
            <Latency>-PT1S</Latency>
            <SilenceOverrideInterval>-PT1S</SilenceOverrideInterval>
            <ForceRebuildInterval>-PT1S</ForceRebuildInterval>
            <Source xsi:type="ProactiveCachingInheritedBinding" />
          </ProactiveCaching>
        </Cube>
      </Cubes>
      <DataSources>
        <DataSource xsi:type="RelationalDataSource">
          <ID>fd0cb57e-3079-4c98-91e5-536ca2283c35</ID>
          <Name>DWHCORPORATIVO</Name>
          <Annotations>
            <Annotation>
              <Name>ConnectionEditUISource</Name>
              <Value>SqlServer</Value>
            </Annotation>
          </Annotations>
          <ConnectionString>Data Source=172.16.77.10,2433;Initial Catalog=DWHCORPORATIVO;Persist Security Info=True;User ID=dwh</ConnectionString>
          <ImpersonationInfo>
            <ImpersonationMode>ImpersonateServiceAccount</ImpersonationMode>
          </ImpersonationInfo>
          <ManagedProvider>System.Data.SqlClient</ManagedProvider>
          <Timeout>PT0S</Timeout>
          <MaxActiveConnections>50</MaxActiveConnections>
        </DataSource>
      </DataSources>
      <DataSourceViews>
        <DataSourceView>
          <ID>Sandbox</ID>
          <Name>Sandbox</Name>
          <DataSourceID>fd0cb57e-3079-4c98-91e5-536ca2283c35</DataSourceID>
          <Schema>
            <xs:schema id="NewDataSet" xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata" xmlns:msprop="urn:schemas-microsoft-com:xml-msprop">
              <xs:element name="NewDataSet" msdata:IsDataSet="true" msdata:Locale="es-EC">
                <xs:complexType>
                  <xs:choice minOccurs="0" maxOccurs="unbounded">
                    <xs:element name="DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933" msdata:Locale="" msprop:DataSourceID="fd0cb57e-3079-4c98-91e5-536ca2283c35" msprop:IsLogical="True" msprop:FriendlyName="DWDCuentaContable" msprop:DbSchemaName="dbo" msprop:DbTableName="DWDCuentaContable" msprop:TableType="View" msprop:Description="DWDCuentaContable" msprop:QueryDefinition="set nocount on&#xA;&#xA;OPEN SYMMETRIC KEY ClaveMIS02&#xA;DECRYPTION BY CERTIFICATE Certi01&#xA;&#xA;SELECT DISTINCT &#xA;  cc.ccIdCuentaContable,&#xA;  ccCodigoNivel6=CONVERT(varchar(12), DecryptByKey(cc.ccCodigoNivel6)),&#xA;  cc.ccCodigoMoneda,&#xA;  cc.ccCodigoIndicador,  &#xA;  &#xA;  cpCalIndicadorNivel1=case when cp.indicadorNivel1 is null then cr.CpCodigoIndicadorN2 else cp.indicadorNivel1 end, -- se tiene los codigos de rentabilidad de nivel unon para el filtro en el dataset&#xA;  cpCalIndicadorNivel2=cp.indicadorNivel2, &#xA;  --cpCalIndicadorNivel3=cp.indicadorNivel3, -- Se comento porque la informacion ya tiene la columna cc.ccCodigoIndicador&#xA;&#xA;  ccCalProductoNivel1= case when cp.ProductoNivel1 is null then cc.ccFamiliaProducto else cp.ProductoNivel1  end,&#xA;  ccCalProductoNivel2= case when cp.ProductoNivel2 is null then cc.ccGrupo else cp.ProductoNivel2  end,&#xA;&#xA;  cp.CpEstadoProducto,&#xA;  --cp.CpOrden, Comente porque no se usa&#xA;  cc.ccAgrupacionContableNivel2,&#xA;   &#xA;  ccSubGrupo,&#xA;  ccTarifaTransaccion=ltrim(rtrim(ccCostoOperativo)),&#xA;&#xA;  ccCalCodigoAgrupacionRentabilidaN1=cr.CpCodigoIndicadorN2,&#xA;  ccCalAgrupacionRentabilidaN1=ltrim(rtrim(upper(CpProducto))),&#xA;  ccCalCodigoTipoIngresoN2=cr.CpCodigoIndicadorN3,&#xA;  ccCalTipoIngresoN2=ltrim(rtrim(upper(ccTipoIngreso))),&#xA;  ccCalDescripcionNivel6N3= case when CONVERT(varchar(150), DecryptByKey(cc.ccDescripcionNivel6)) like '%SIN%DESCRIPCION%NIVEL%' then 'SIN DESCRIPCION NIVEL' &#xA;                            else substring(CONVERT(varchar(150), DecryptByKey(cc.ccDescripcionNivel6)),14,100) end,&#xA;  &#xA;  ccAgrupacionTributario,&#xA;  ccAgrupacionRentabilidadTransaccion,&#xA;  ccCovid,&#xA;  ccCodigoNivel2,&#xA;  ccCodigoNivel3,&#xA;&#xA;  ccCalProductoCobranza=case when    ccCodigoNivel2 between '1409' and '1416' or ccCodigoNivel2 between '1421' and '1424' &#xA;          or ccCodigoNivel2 between '1433' and '1437' or ccCodigoNivel2 between '1439' and '1440' &#xA;          or ccCodigoNivel2 between '1457' and '1464' or ccCodigoNivel3='149105' then 'REF'&#xA;&#xA;        when    ccCodigoNivel2 between '1417' and '1420' or ccCodigoNivel2 in ('1441','1443','1444','1465','1467','1468')&#xA;             or ccCodigoNivel3 in ( '14948025','14958025','14968025') then 'REES' else ''&#xA;        end,&#xA; ccCodigoIndicadorRentabilidad&#xA;&#xA;--drop table #DWDCuentaContable&#xA;--into #DWDCuentaContable&#xA;&#xA;FROM DWDCuentaContable cc&#xA;left outer join&#xA;( &#xA;    SELECT DISTINCT &#xA;    p.CpCodigoIndicador indicadorNivel1,p1.CpCodigoIndicador indicadorNivel2,p2.CpCodigoIndicador indicadorNivel3,&#xA;    p.CpProducto ProductoNivel1,&#xA;    ProductoNivel2=case when p1.CpCodigoIndicador=124  then 'Tarjeta de Credito' else p1.CpProducto end,&#xA;    p2.CpEstadoProducto,&#xA;    isnull(p1.CpOrden,1) CpOrden&#xA;    FROM DWDClasificacionProductos p&#xA;    join DWDClasificacionProductos p1 ON p1.CpPadre=p.CpCodigoIndicador&#xA;    join DWDClasificacionProductos p2 ON p2.CpPadre=p1.CpCodigoIndicador&#xA;    WHERE p.CpCodigoIndicador in (1,2,3,72,80,73) -- Comente los indicadores 32,28 ; 72 (ficticias de ingresos); 80 (Portafolio); 73(Cont)&#xA;    and  p.CpNivel=1 and p1.CpNivel=2 and p2.CpNivel=3&#xA;    and p1.CpCodigoIndicador not in (125,143,144) -- Se excluye estas agrupaciones que no pertenecen a captaciones EA&#xA;&#xA;) cp ON ccCodigoIndicador=cp.indicadorNivel3&#xA;left outer join&#xA;(&#xA;   select distinct&#xA;   CpCodigoIndicadorN4=n4.CpCodigoIndicador,&#xA;   CpCodigoIndicadorN2=n2.CpCodigoIndicador,&#xA;   CpCodigoIndicadorN3=n3.CpCodigoIndicador,&#xA;   n2.CpProducto&#xA;   from DWDClasificacionProductos n1&#xA;   inner join DWDClasificacionProductos n2 on n2.CpPadre=n1.CpCodigoIndicador&#xA;   inner join DWDClasificacionProductos n3 on n3.CpPadre=n2.CpCodigoIndicador&#xA;   inner join DWDClasificacionProductos n4 on n4.CpPadre=n3.CpCodigoIndicador&#xA;   where n1.CpCodigoIndicador=71 -- Cuentas de rentabilidad&#xA;   and n1.CpNivel=1 and n2.CpNivel=2 and n3.CpNivel=3 and n4.CpNivel=4&#xA;) as cr on cc.ccCodigoIndicadorRentabilidad=cr.CpCodigoIndicadorN4&#xA;&#xA;&#xA;CLOSE SYMMETRIC KEY ClaveMIS02">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="ccIdCuentaContable" msprop:DbColumnName="ccIdCuentaContable" msprop:FriendlyName="ccIdCuentaContable" type="xs:long" />
                          <xs:element name="ccCodigoMoneda" msprop:DbColumnName="ccCodigoMoneda" msprop:FriendlyName="ccCodigoMoneda" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccCodigoIndicador" msprop:DbColumnName="ccCodigoIndicador" msprop:FriendlyName="ccCodigoIndicador" type="xs:long" minOccurs="0" />
                          <xs:element name="CpEstadoProducto" msprop:DbColumnName="CpEstadoProducto" msprop:FriendlyName="CpEstadoProducto" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccCodigoNivel6" msprop:DbColumnName="ccCodigoNivel6" msprop:FriendlyName="ccCodigoNivel6" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccAgrupacionContableNivel2" msprop:DbColumnName="ccAgrupacionContableNivel2" msprop:FriendlyName="ccAgrupacionContableNivel2" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="cpCalIndicadorNivel1" msprop:DbColumnName="cpCalIndicadorNivel1" msprop:FriendlyName="cpCalIndicadorNivel1" type="xs:int" minOccurs="0" />
                          <xs:element name="cpCalIndicadorNivel2" msprop:DbColumnName="cpCalIndicadorNivel2" msprop:FriendlyName="cpCalIndicadorNivel2" type="xs:int" minOccurs="0" />
                          <xs:element name="ccCalProductoNivel1" msprop:DbColumnName="ccCalProductoNivel1" msprop:FriendlyName="ccCalProductoNivel1" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccCalProductoNivel2" msprop:DbColumnName="ccCalProductoNivel2" msprop:FriendlyName="ccCalProductoNivel2" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccSubGrupo" msprop:DbColumnName="ccSubGrupo" msprop:FriendlyName="ccSubGrupo" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccTarifaTransaccion" msprop:DbColumnName="ccTarifaTransaccion" msprop:FriendlyName="ccTarifaTransaccion" type="xs:double" minOccurs="0" />
                          <xs:element name="ccCalAgrupacionRentabilidaN1" msprop:DbColumnName="ccCalAgrupacionRentabilidaN1" msprop:FriendlyName="ccCalAgrupacionRentabilidaN1" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccCalTipoIngresoN2" msprop:DbColumnName="ccCalTipoIngresoN2" msprop:FriendlyName="ccCalTipoIngresoN2" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccCalDescripcionNivel6N3" msprop:DbColumnName="ccCalDescripcionNivel6N3" msprop:FriendlyName="ccCalDescripcionNivel6N3" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccCalCodigoAgrupacionRentabilidaN1" msprop:DbColumnName="ccCalCodigoAgrupacionRentabilidaN1" msprop:FriendlyName="ccCalCodigoAgrupacionRentabilidaN1" type="xs:int" minOccurs="0" />
                          <xs:element name="ccCalCodigoTipoIngresoN2" msprop:DbColumnName="ccCalCodigoTipoIngresoN2" msprop:FriendlyName="ccCalCodigoTipoIngresoN2" type="xs:int" minOccurs="0" />
                          <xs:element name="ccAgrupacionTributario" msprop:DbColumnName="ccAgrupacionTributario" msprop:FriendlyName="ccAgrupacionTributario" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccAgrupacionRentabilidadTransaccion" msprop:DbColumnName="ccAgrupacionRentabilidadTransaccion" msprop:FriendlyName="ccAgrupacionRentabilidadTransaccion" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccCovid" msprop:DbColumnName="ccCovid" msprop:FriendlyName="ccCovid" type="xs:boolean" minOccurs="0" />
                          <xs:element name="ccCodigoNivel2" msprop:DbColumnName="ccCodigoNivel2" msprop:FriendlyName="ccCodigoNivel2" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32768" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccCodigoNivel3" msprop:DbColumnName="ccCodigoNivel3" msprop:FriendlyName="ccCodigoNivel3" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32768" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccCalProductoCobranza" msprop:DbColumnName="ccCalProductoCobranza" msprop:FriendlyName="ccCalProductoCobranza" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32768" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccCodigoIndicadorRentabilidad" msprop:DbColumnName="ccCodigoIndicadorRentabilidad" msprop:FriendlyName="ccCodigoIndicadorRentabilidad" type="xs:int" minOccurs="0" />
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e" msdata:Locale="" msprop:DataSourceID="fd0cb57e-3079-4c98-91e5-536ca2283c35" msprop:IsLogical="True" msprop:FriendlyName="DWDFecha" msprop:DbSchemaName="dbo" msprop:DbTableName="DWDFecha" msprop:TableType="View" msprop:Description="DWDFecha" msprop:QueryDefinition="declare @FechaMesAntRent  int, @FechaInicio int, @FechaFin int&#xD;&#xA;&#xD;&#xA;select @FechaMesAntRent = feMesAntCierr from dwdfecha where femesanterior = 1 &#xD;&#xA;&#xD;&#xA;select @FechaInicio=feMesAntCierr from DWDFecha -- Se obtiene el mes anterior de la fecha de dos años atras --&#xD;&#xA;where  feIdFecha = ( select feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 ) &#xD;&#xA;&#xD;&#xA;select @FechaFin=feIdFecha from DWDFecha where feDiaActual=1 -- Dia Actual --&#xD;&#xA;&#xD;&#xA;select &#xD;&#xA; feIdFecha&#xD;&#xA;,feFecha&#xD;&#xA;,feDescripcionFecha&#xD;&#xA;,feCalAnio&#xD;&#xA;,feCalMes&#xD;&#xA;,feCalDia&#xD;&#xA;,feTrimNumero&#xD;&#xA;,feTrimMes&#xD;&#xA;,feTrimDia&#xD;&#xA;,feFeriado&#xD;&#xA;,feCierreMes&#xD;&#xA;,feFinMes&#xD;&#xA;,feFinSemana&#xD;&#xA;,EsDiaAnterior&#xD;&#xA;,fecIdAnterior&#xD;&#xA;,EsCierreAño&#xD;&#xA;,feMesAntCierr&#xD;&#xA;,feAnioAntCierr&#xD;&#xA;,feIdFechaAnioAnt&#xD;&#xA;,feIdFechaCierreAnioAnt&#xD;&#xA;,feFechaCierreAnio&#xD;&#xA;,feDiaActual&#xD;&#xA;,feDiaAnterior&#xD;&#xA;,feMesAnterior--&#xD;&#xA;,feAnioAnterior&#xD;&#xA;,feHaceUnAnio&#xD;&#xA;,feFinTrimestreAnt&#xD;&#xA;,feCierreMesAnterior&#xD;&#xA;,feFechaMesAntCierr&#xD;&#xA;,feCierreMesTodosAnios&#xD;&#xA;,feValorCalculoPromedio&#xD;&#xA;,feEsMesActual&#xD;&#xA;,feEsTrimestreActual&#xD;&#xA;,feIdFechaHaceUnMesLab&#xD;&#xA;,feIdFechaHaceUnTrimestreLab&#xD;&#xA;,feIdFechaHaceUnSemestreLab&#xD;&#xA;,feIdFechaHaceUnAnioLab&#xD;&#xA;,feIdFechaHistoricoLab&#xD;&#xA;,feNumDiasMesLab&#xD;&#xA;,feNumDiasTrimLab&#xD;&#xA;,feNumDiasTrimFiscLab&#xD;&#xA;,feNumDiasSemestLab&#xD;&#xA;,feNumDiasAnioLab&#xD;&#xA;,feNumDiasHistLab&#xD;&#xA;,feTrimestresAnteriores&#xD;&#xA;,feCierrFechAnioActFut&#xD;&#xA;,feMesAntAnioAnt&#xD;&#xA;,feCierrMesAnioAtras&#xD;&#xA;,feIdFechaTresMesAtras&#xD;&#xA;,feIdFechaSeisMesAtras&#xD;&#xA;,feIdFechaDoceMesAtras&#xD;&#xA;,FechaMesAntRent=case when feidfecha = @FechaMesAntRent then 1 else 0 end&#xD;&#xA;from DWDFecha&#xD;&#xA;where feidfecha between @FechaInicio and @FechaFin&#xD;&#xA;and feCierreMes=1&#xD;&#xA;order by 1">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="feIdFecha" msprop:DbColumnName="feIdFecha" msprop:FriendlyName="feIdFecha" type="xs:long" />
                          <xs:element name="feFecha" msprop:DbColumnName="feFecha" msprop:FriendlyName="feFecha" type="xs:dateTime" minOccurs="0" />
                          <xs:element name="feDescripcionFecha" msprop:DbColumnName="feDescripcionFecha" msprop:FriendlyName="feDescripcionFecha" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="feCalAnio" msprop:DbColumnName="feCalAnio" msprop:FriendlyName="feCalAnio" type="xs:long" minOccurs="0" />
                          <xs:element name="feCalMes" msprop:DbColumnName="feCalMes" msprop:FriendlyName="feCalMes" type="xs:long" minOccurs="0" />
                          <xs:element name="feCalDia" msprop:DbColumnName="feCalDia" msprop:FriendlyName="feCalDia" type="xs:long" minOccurs="0" />
                          <xs:element name="feTrimNumero" msprop:DbColumnName="feTrimNumero" msprop:FriendlyName="feTrimNumero" type="xs:long" minOccurs="0" />
                          <xs:element name="feTrimMes" msprop:DbColumnName="feTrimMes" msprop:FriendlyName="feTrimMes" type="xs:long" minOccurs="0" />
                          <xs:element name="feTrimDia" msprop:DbColumnName="feTrimDia" msprop:FriendlyName="feTrimDia" type="xs:long" minOccurs="0" />
                          <xs:element name="feFeriado" msprop:DbColumnName="feFeriado" msprop:FriendlyName="feFeriado" type="xs:boolean" minOccurs="0" />
                          <xs:element name="feCierreMes" msprop:DbColumnName="feCierreMes" msprop:FriendlyName="feCierreMes" type="xs:boolean" minOccurs="0" />
                          <xs:element name="feFinMes" msprop:DbColumnName="feFinMes" msprop:FriendlyName="feFinMes" type="xs:boolean" minOccurs="0" />
                          <xs:element name="feFinSemana" msprop:DbColumnName="feFinSemana" msprop:FriendlyName="feFinSemana" type="xs:boolean" minOccurs="0" />
                          <xs:element name="EsDiaAnterior" msprop:DbColumnName="EsDiaAnterior" msprop:FriendlyName="EsDiaAnterior" type="xs:boolean" minOccurs="0" />
                          <xs:element name="fecIdAnterior" msprop:DbColumnName="fecIdAnterior" msprop:FriendlyName="fecIdAnterior" type="xs:long" minOccurs="0" />
                          <xs:element name="EsCierreAño" msprop:DbColumnName="EsCierreAño" msprop:FriendlyName="EsCierreAño" type="xs:boolean" minOccurs="0" />
                          <xs:element name="feMesAntCierr" msprop:DbColumnName="feMesAntCierr" msprop:FriendlyName="feMesAntCierr" type="xs:long" minOccurs="0" />
                          <xs:element name="feAnioAntCierr" msprop:DbColumnName="feAnioAntCierr" msprop:FriendlyName="feAnioAntCierr" type="xs:long" minOccurs="0" />
                          <xs:element name="feIdFechaAnioAnt" msprop:DbColumnName="feIdFechaAnioAnt" msprop:FriendlyName="feIdFechaAnioAnt" type="xs:long" minOccurs="0" />
                          <xs:element name="feIdFechaCierreAnioAnt" msprop:DbColumnName="feIdFechaCierreAnioAnt" msprop:FriendlyName="feIdFechaCierreAnioAnt" type="xs:long" minOccurs="0" />
                          <xs:element name="feFechaCierreAnio" msprop:DbColumnName="feFechaCierreAnio" msprop:FriendlyName="feFechaCierreAnio" type="xs:dateTime" minOccurs="0" />
                          <xs:element name="feDiaActual" msprop:DbColumnName="feDiaActual" msprop:FriendlyName="feDiaActual" type="xs:long" minOccurs="0" />
                          <xs:element name="feDiaAnterior" msprop:DbColumnName="feDiaAnterior" msprop:FriendlyName="feDiaAnterior" type="xs:long" minOccurs="0" />
                          <xs:element name="feMesAnterior" msprop:DbColumnName="feMesAnterior" msprop:FriendlyName="feMesAnterior" type="xs:long" minOccurs="0" />
                          <xs:element name="feAnioAnterior" msprop:DbColumnName="feAnioAnterior" msprop:FriendlyName="feAnioAnterior" type="xs:long" minOccurs="0" />
                          <xs:element name="feHaceUnAnio" msprop:DbColumnName="feHaceUnAnio" msprop:FriendlyName="feHaceUnAnio" type="xs:boolean" minOccurs="0" />
                          <xs:element name="feFinTrimestreAnt" msprop:DbColumnName="feFinTrimestreAnt" msprop:FriendlyName="feFinTrimestreAnt" type="xs:long" minOccurs="0" />
                          <xs:element name="feCierreMesAnterior" msprop:DbColumnName="feCierreMesAnterior" msprop:FriendlyName="feCierreMesAnterior" type="xs:long" minOccurs="0" />
                          <xs:element name="feFechaMesAntCierr" msprop:DbColumnName="feFechaMesAntCierr" msprop:FriendlyName="feFechaMesAntCierr" type="xs:dateTime" minOccurs="0" />
                          <xs:element name="feCierreMesTodosAnios" msprop:DbColumnName="feCierreMesTodosAnios" msprop:FriendlyName="feCierreMesTodosAnios" type="xs:boolean" minOccurs="0" />
                          <xs:element name="feValorCalculoPromedio" msprop:DbColumnName="feValorCalculoPromedio" msprop:FriendlyName="feValorCalculoPromedio" type="xs:long" minOccurs="0" />
                          <xs:element name="feEsMesActual" msprop:DbColumnName="feEsMesActual" msprop:FriendlyName="feEsMesActual" type="xs:boolean" minOccurs="0" />
                          <xs:element name="feEsTrimestreActual" msprop:DbColumnName="feEsTrimestreActual" msprop:FriendlyName="feEsTrimestreActual" type="xs:boolean" minOccurs="0" />
                          <xs:element name="feIdFechaHaceUnMesLab" msprop:DbColumnName="feIdFechaHaceUnMesLab" msprop:FriendlyName="feIdFechaHaceUnMesLab" type="xs:int" minOccurs="0" />
                          <xs:element name="feIdFechaHaceUnTrimestreLab" msprop:DbColumnName="feIdFechaHaceUnTrimestreLab" msprop:FriendlyName="feIdFechaHaceUnTrimestreLab" type="xs:int" minOccurs="0" />
                          <xs:element name="feIdFechaHaceUnSemestreLab" msprop:DbColumnName="feIdFechaHaceUnSemestreLab" msprop:FriendlyName="feIdFechaHaceUnSemestreLab" type="xs:int" minOccurs="0" />
                          <xs:element name="feIdFechaHaceUnAnioLab" msprop:DbColumnName="feIdFechaHaceUnAnioLab" msprop:FriendlyName="feIdFechaHaceUnAnioLab" type="xs:int" minOccurs="0" />
                          <xs:element name="feIdFechaHistoricoLab" msprop:DbColumnName="feIdFechaHistoricoLab" msprop:FriendlyName="feIdFechaHistoricoLab" type="xs:int" minOccurs="0" />
                          <xs:element name="feNumDiasMesLab" msprop:DbColumnName="feNumDiasMesLab" msprop:FriendlyName="feNumDiasMesLab" type="xs:int" minOccurs="0" />
                          <xs:element name="feNumDiasTrimLab" msprop:DbColumnName="feNumDiasTrimLab" msprop:FriendlyName="feNumDiasTrimLab" type="xs:int" minOccurs="0" />
                          <xs:element name="feNumDiasTrimFiscLab" msprop:DbColumnName="feNumDiasTrimFiscLab" msprop:FriendlyName="feNumDiasTrimFiscLab" type="xs:int" minOccurs="0" />
                          <xs:element name="feNumDiasSemestLab" msprop:DbColumnName="feNumDiasSemestLab" msprop:FriendlyName="feNumDiasSemestLab" type="xs:int" minOccurs="0" />
                          <xs:element name="feNumDiasAnioLab" msprop:DbColumnName="feNumDiasAnioLab" msprop:FriendlyName="feNumDiasAnioLab" type="xs:int" minOccurs="0" />
                          <xs:element name="feNumDiasHistLab" msprop:DbColumnName="feNumDiasHistLab" msprop:FriendlyName="feNumDiasHistLab" type="xs:int" minOccurs="0" />
                          <xs:element name="feTrimestresAnteriores" msprop:DbColumnName="feTrimestresAnteriores" msprop:FriendlyName="feTrimestresAnteriores" type="xs:int" minOccurs="0" />
                          <xs:element name="feCierrFechAnioActFut" msprop:DbColumnName="feCierrFechAnioActFut" msprop:FriendlyName="feCierrFechAnioActFut" type="xs:int" minOccurs="0" />
                          <xs:element name="feMesAntAnioAnt" msprop:DbColumnName="feMesAntAnioAnt" msprop:FriendlyName="feMesAntAnioAnt" type="xs:int" minOccurs="0" />
                          <xs:element name="feCierrMesAnioAtras" msprop:DbColumnName="feCierrMesAnioAtras" msprop:FriendlyName="feCierrMesAnioAtras" type="xs:int" minOccurs="0" />
                          <xs:element name="feIdFechaTresMesAtras" msprop:DbColumnName="feIdFechaTresMesAtras" msprop:FriendlyName="feIdFechaTresMesAtras" type="xs:int" minOccurs="0" />
                          <xs:element name="feIdFechaSeisMesAtras" msprop:DbColumnName="feIdFechaSeisMesAtras" msprop:FriendlyName="feIdFechaSeisMesAtras" type="xs:int" minOccurs="0" />
                          <xs:element name="feIdFechaDoceMesAtras" msprop:DbColumnName="feIdFechaDoceMesAtras" msprop:FriendlyName="feIdFechaDoceMesAtras" type="xs:int" minOccurs="0" />
                          <xs:element name="FechaMesAntRent" msprop:DbColumnName="FechaMesAntRent" msprop:FriendlyName="FechaMesAntRent" type="xs:int" minOccurs="0" />
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9" msdata:Locale="" msprop:IsLogical="True" msprop:FriendlyName="DWDCanalCliente" msprop:DbSchemaName="dbo" msprop:DbTableName="DWDCanal" msprop:TableType="View" msprop:Description="DWDCanal" msprop:QueryDefinition=" SELECT [dbo].[DWDCanal].* FROM [dbo].[DWDCanal] ">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="caIdCanal" msprop:DbColumnName="caIdCanal" msprop:FriendlyName="caIdCanal" type="xs:long" />
                          <xs:element name="caCodigoCanal" msprop:DbColumnName="caCodigoCanal" msprop:FriendlyName="caCodigoCanal" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="caDescripcionCanal" msprop:DbColumnName="caDescripcionCanal" msprop:FriendlyName="caDescripcionCanal" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="caCodigoAgrupacionCanal" msprop:DbColumnName="caCodigoAgrupacionCanal" msprop:FriendlyName="caCodigoAgrupacionCanal" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="caDescripcionAgrupacionCanal" msprop:DbColumnName="caDescripcionAgrupacionCanal" msprop:FriendlyName="caDescripcionAgrupacionCanal" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="caOrdenCanal" msprop:DbColumnName="caOrdenCanal" msprop:FriendlyName="caOrdenCanal" type="xs:long" minOccurs="0" />
                          <xs:element name="caAgrupacion" msprop:DbColumnName="caAgrupacion" msprop:FriendlyName="caAgrupacion" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="caEstado" msprop:DbColumnName="caEstado" msprop:FriendlyName="caEstado" type="xs:boolean" minOccurs="0" />
                          <xs:element name="caOrdenDescripcionCanal" msprop:DbColumnName="caOrdenDescripcionCanal" msprop:FriendlyName="caOrdenDescripcionCanal" type="xs:long" minOccurs="0" />
                          <xs:element name="caCodDescripcionAgrupacionCanal" msprop:DbColumnName="caCodDescripcionAgrupacionCanal" msprop:FriendlyName="caCodDescripcionAgrupacionCanal" type="xs:long" minOccurs="0" />
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9" msdata:Locale="" msprop:IsLogical="True" msprop:FriendlyName="DWDAgenciaOperacionCliente" msprop:DbSchemaName="dbo" msprop:DbTableName="DWDAgenciaOperacion" msprop:TableType="View" msprop:Description="DWDAgenciaOperacion" msprop:QueryDefinition="Set nocount ON&#xD;&#xA;&#xD;&#xA;select&#xD;&#xA;a.agIdAgencia&#xD;&#xA;,a.agCodigoAgencia&#xD;&#xA;,a.agNombreAgencia&#xD;&#xA;,a.agDireccionAgencia&#xD;&#xA;,a.agTelefonoAgencia&#xD;&#xA;,a.agResponsableNombre&#xD;&#xA;,a.agFechaApertura&#xD;&#xA;,a.agFechaClausura&#xD;&#xA;,a.agNumeroColaboradores&#xD;&#xA;,a.agMontoInvertido&#xD;&#xA;,a.agCodigoZona&#xD;&#xA;,a.agNombreZona&#xD;&#xA;--,a.agCodigoSubregion&#xD;&#xA;--,a.agNombreSubregion&#xD;&#xA;,a.agCodigoRegion&#xD;&#xA;,a.agNombreRegion&#xD;&#xA;,a.agCodigoCantonCompleto&#xD;&#xA;,a.agNombreCanton&#xD;&#xA;,a.agCodigoProvincia&#xD;&#xA;,a.agNombreProvincia&#xD;&#xA;,a.agCodigoRegionDescn&#xD;&#xA;,a.agNombreRegionDescn&#xD;&#xA;,a.agOrdenRegionAsesor&#xD;&#xA;,a.agEstado&#xD;&#xA;,a.agCodigoJefeAgencia&#xD;&#xA;,agNombreJefeAgencia= b.asNombreAsesor&#xD;&#xA;,'RED' agCodigoAgrupacionCanal&#xD;&#xA;,agCodigoRegional=b.asCodigoRegion&#xD;&#xA;,agCodigoSubregion=b.asCodigoSubregion&#xD;&#xA;from DWDAgenciaOperacion a&#xD;&#xA;left outer join DWDAsesorOperacion b on a.agCodigoJefeAgencia = b.asCodigoAsesor&#xD;&#xA;--where agEstado = 'R'">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="agIdAgencia" msprop:DbColumnName="agIdAgencia" msprop:FriendlyName="agIdAgencia" type="xs:long" />
                          <xs:element name="agCodigoAgencia" msprop:DbColumnName="agCodigoAgencia" msprop:FriendlyName="agCodigoAgencia" type="xs:long" minOccurs="0" />
                          <xs:element name="agNombreAgencia" msprop:DbColumnName="agNombreAgencia" msprop:FriendlyName="agNombreAgencia" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="agDireccionAgencia" msprop:DbColumnName="agDireccionAgencia" msprop:FriendlyName="agDireccionAgencia" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="agTelefonoAgencia" msprop:DbColumnName="agTelefonoAgencia" msprop:FriendlyName="agTelefonoAgencia" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="agResponsableNombre" msprop:DbColumnName="agResponsableNombre" msprop:FriendlyName="agResponsableNombre" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="agFechaApertura" msprop:DbColumnName="agFechaApertura" msprop:FriendlyName="agFechaApertura" type="xs:dateTime" minOccurs="0" />
                          <xs:element name="agFechaClausura" msprop:DbColumnName="agFechaClausura" msprop:FriendlyName="agFechaClausura" type="xs:dateTime" minOccurs="0" />
                          <xs:element name="agNumeroColaboradores" msprop:DbColumnName="agNumeroColaboradores" msprop:FriendlyName="agNumeroColaboradores" type="xs:long" minOccurs="0" />
                          <xs:element name="agMontoInvertido" msprop:DbColumnName="agMontoInvertido" msprop:FriendlyName="agMontoInvertido" type="xs:double" minOccurs="0" />
                          <xs:element name="agCodigoZona" msprop:DbColumnName="agCodigoZona" msprop:FriendlyName="agCodigoZona" type="xs:long" minOccurs="0" />
                          <xs:element name="agNombreZona" msprop:DbColumnName="agNombreZona" msprop:FriendlyName="agNombreZona" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="agCodigoSubregion" msprop:DbColumnName="agCodigoSubregion" msprop:FriendlyName="agCodigoSubregion" type="xs:long" minOccurs="0" />
                          <xs:element name="agCodigoRegion" msprop:DbColumnName="agCodigoRegion" msprop:FriendlyName="agCodigoRegion" type="xs:long" minOccurs="0" />
                          <xs:element name="agNombreRegion" msprop:DbColumnName="agNombreRegion" msprop:FriendlyName="agNombreRegion" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="agCodigoCantonCompleto" msprop:DbColumnName="agCodigoCantonCompleto" msprop:FriendlyName="agCodigoCantonCompleto" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="agNombreCanton" msprop:DbColumnName="agNombreCanton" msprop:FriendlyName="agNombreCanton" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="agCodigoProvincia" msprop:DbColumnName="agCodigoProvincia" msprop:FriendlyName="agCodigoProvincia" type="xs:long" minOccurs="0" />
                          <xs:element name="agNombreProvincia" msprop:DbColumnName="agNombreProvincia" msprop:FriendlyName="agNombreProvincia" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="agCodigoRegionDescn" msprop:DbColumnName="agCodigoRegionDescn" msprop:FriendlyName="agCodigoRegionDescn" type="xs:long" minOccurs="0" />
                          <xs:element name="agNombreRegionDescn" msprop:DbColumnName="agNombreRegionDescn" msprop:FriendlyName="agNombreRegionDescn" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="agOrdenRegionAsesor" msprop:DbColumnName="agOrdenRegionAsesor" msprop:FriendlyName="agOrdenRegionAsesor" type="xs:long" minOccurs="0" />
                          <xs:element name="agEstado" msprop:DbColumnName="agEstado" msprop:FriendlyName="agEstado" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="agCodigoJefeAgencia" msprop:DbColumnName="agCodigoJefeAgencia" msprop:FriendlyName="agCodigoJefeAgencia" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="agNombreJefeAgencia" msprop:DbColumnName="agNombreJefeAgencia" msprop:FriendlyName="agNombreJefeAgencia" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="agCodigoAgrupacionCanal" msprop:DbColumnName="agCodigoAgrupacionCanal" msprop:FriendlyName="agCodigoAgrupacionCanal" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="agCodigoRegional" msprop:DbColumnName="agCodigoRegional" msprop:FriendlyName="agCodigoRegional" type="xs:int" minOccurs="0" />
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489" msdata:Locale="" msprop:IsLogical="True" msprop:FriendlyName="DWDAsesorOperacionCliente" msprop:DbSchemaName="dbo" msprop:DbTableName="DWDAsesorOperacion" msprop:TableType="View" msprop:Description="DWDAsesorOperacion" msprop:QueryDefinition="Set nocount ON&#xD;&#xA;&#xD;&#xA;select &#xD;&#xA;a.asIdAsesor&#xD;&#xA;,a.asCodigoAsesor&#xD;&#xA;,a.asNombreAsesor&#xD;&#xA;,a.asUsuario&#xD;&#xA;,asCodigoAgrupacionCanal=c.caCodigoAgrupacionCanal&#xD;&#xA;,a.asNombreCanal&#xD;&#xA;,a.asAsesorPrincipal&#xD;&#xA;,a.asCodigoAgencia&#xD;&#xA;,a.asNombreAgencia&#xD;&#xA;,a.asEstado&#xD;&#xA;,a.asOrdenAsesor&#xD;&#xA;,asCodigoRegion=b.agCodigoRegion&#xD;&#xA;,asNombreRegion=b.agNombreRegion&#xD;&#xA;,asCodigoZona=b.agCodigoZona&#xD;&#xA;,asNombreZona=b.agNombreZona&#xD;&#xA;,asCodigoRegional=a.asCodigoRegion&#xD;&#xA;,asNombreRegional=a.asNombreRegion&#xD;&#xA;,a.asCodigoSubregion&#xD;&#xA;,a.asNombreSubregion&#xD;&#xA;from DWDAsesorOperacion a&#xD;&#xA;left join DWDAgenciaOperacion b on a.asCodigoAgencia = b.agCodigoAgencia&#xD;&#xA;inner join DWDCanal c on a.asCodigoCanal = c.caCodigoCanal &#xD;&#xA;&#xD;&#xA;/*Set nocount ON&#xD;&#xA;&#xD;&#xA;select &#xD;&#xA;a.asIdAsesor&#xD;&#xA;,a.asCodigoAsesor&#xD;&#xA;,a.asNombreAsesor&#xD;&#xA;,a.asUsuario&#xD;&#xA;--,a.asCodigoCanal&#xD;&#xA;,c.caCodigoAgrupacionCanal&#xD;&#xA;,a.asNombreCanal&#xD;&#xA;,a.asAsesorPrincipal&#xD;&#xA;,a.asCodigoAgencia&#xD;&#xA;,a.asNombreAgencia&#xD;&#xA;,a.asEstado&#xD;&#xA;,a.asOrdenAsesor&#xD;&#xA;,b.agCodigoRegion&#xD;&#xA;,b.agNombreRegion&#xD;&#xA;,b.agCodigoZona&#xD;&#xA;,b.agNombreZona&#xD;&#xA;,a.asCodigoRegion&#xD;&#xA;,a.asNombreRegion&#xD;&#xA;from DWDAsesorOperacion a&#xD;&#xA;left join DWDAgenciaOperacion b on a.asCodigoAgencia = b.agCodigoAgencia&#xD;&#xA;inner join DWDCanal c on a.asCodigoCanal = c.caCodigoCanal &#xD;&#xA;--where a.asEstado=1 &#xD;&#xA;--and c.caCodigoAgrupacionCanal in ('COR','ESP','TES')*/">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="asIdAsesor" msprop:DbColumnName="asIdAsesor" msprop:FriendlyName="asIdAsesor" type="xs:long" />
                          <xs:element name="asCodigoAsesor" msprop:DbColumnName="asCodigoAsesor" msprop:FriendlyName="asCodigoAsesor" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="asNombreAsesor" msprop:DbColumnName="asNombreAsesor" msprop:FriendlyName="asNombreAsesor" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="asUsuario" msprop:DbColumnName="asUsuario" msprop:FriendlyName="asUsuario" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="asNombreCanal" msprop:DbColumnName="asNombreCanal" msprop:FriendlyName="asNombreCanal" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="asAsesorPrincipal" msprop:DbColumnName="asAsesorPrincipal" msprop:FriendlyName="asAsesorPrincipal" type="xs:boolean" minOccurs="0" />
                          <xs:element name="asCodigoAgencia" msprop:DbColumnName="asCodigoAgencia" msprop:FriendlyName="asCodigoAgencia" type="xs:long" minOccurs="0" />
                          <xs:element name="asNombreAgencia" msprop:DbColumnName="asNombreAgencia" msprop:FriendlyName="asNombreAgencia" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="asEstado" msprop:DbColumnName="asEstado" msprop:FriendlyName="asEstado" type="xs:boolean" minOccurs="0" />
                          <xs:element name="asOrdenAsesor" msprop:DbColumnName="asOrdenAsesor" msprop:FriendlyName="asOrdenAsesor" type="xs:long" minOccurs="0" />
                          <xs:element name="asCodigoRegion" msprop:DbColumnName="asCodigoRegion" msprop:FriendlyName="asCodigoRegion" type="xs:int" minOccurs="0" />
                          <xs:element name="asNombreRegion" msprop:DbColumnName="asNombreRegion" msprop:FriendlyName="asNombreRegion" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="asCodigoAgrupacionCanal" msprop:DbColumnName="asCodigoAgrupacionCanal" msprop:FriendlyName="asCodigoAgrupacionCanal" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="asCodigoZona" msprop:DbColumnName="asCodigoZona" msprop:FriendlyName="asCodigoZona" type="xs:int" minOccurs="0" />
                          <xs:element name="asNombreZona" msprop:DbColumnName="asNombreZona" msprop:FriendlyName="asNombreZona" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="asCodigoRegional" msprop:DbColumnName="asCodigoRegional" msprop:FriendlyName="asCodigoRegional" type="xs:int" minOccurs="0" />
                          <xs:element name="asNombreRegional" msprop:DbColumnName="asNombreRegional" msprop:FriendlyName="asNombreRegional" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="asCodigoSubRegion" msprop:DbColumnName="asCodigoSubRegion" msprop:FriendlyName="asCodigoSubRegion" type="xs:int" minOccurs="0" />
                          <xs:element name="asNombreSubRegion" msprop:DbColumnName="asNombreSubRegion" msprop:FriendlyName="asNombreSubRegion" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="DWDCliente_a87cb9d1-8c22-410f-8f2f-42ff218cc1b3" msdata:Locale="" msprop:IsLogical="True" msprop:FriendlyName="DWDCliente" msprop:DbTableName="DWDCliente" msprop:TableType="View" msprop:Description="DWDCliente" msprop:QueryDefinition="select&#xD;&#xA;clIdCliente&#xD;&#xA;,clCodigoCliente&#xD;&#xA;,clNombreCompleto&#xD;&#xA;,clIdCanal&#xD;&#xA;,clIdAsesorPrincipal&#xD;&#xA;,clIdAgencia&#xD;&#xA;,clVinculacionValor&#xD;&#xA;,clCodigoGrupo&#xD;&#xA;,clGrupo&#xD;&#xA;,clEstado&#xD;&#xA;,clIdBanca&#xD;&#xA;,clIdSegmentacionCliente&#xD;&#xA;,concat(year(getdate())-left(clFechaIngreso,4),' año(s) ') clCalClienteDesde&#xD;&#xA;,clFechaFin&#xD;&#xA;,clSegmentacionTipoCliente&#xD;&#xA;,clFechaIngreso&#xD;&#xA;from DWDCliente">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="clIdCliente" msprop:DbColumnName="clIdCliente" msprop:FriendlyName="clIdCliente" type="xs:int" minOccurs="0" />
                          <xs:element name="clCodigoCliente" msprop:DbColumnName="clCodigoCliente" msprop:FriendlyName="clCodigoCliente" type="xs:int" minOccurs="0" />
                          <xs:element name="clNombreCompleto" msprop:DbColumnName="clNombreCompleto" msprop:FriendlyName="clNombreCompleto" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="clIdCanal" msprop:DbColumnName="clIdCanal" msprop:FriendlyName="clIdCanal" type="xs:int" minOccurs="0" />
                          <xs:element name="clIdAsesorPrincipal" msprop:DbColumnName="clIdAsesorPrincipal" msprop:FriendlyName="clIdAsesorPrincipal" type="xs:int" minOccurs="0" />
                          <xs:element name="clIdAgencia" msprop:DbColumnName="clIdAgencia" msprop:FriendlyName="clIdAgencia" type="xs:int" minOccurs="0" />
                          <xs:element name="clVinculacionValor" msprop:DbColumnName="clVinculacionValor" msprop:FriendlyName="clVinculacionValor" type="xs:double" minOccurs="0" />
                          <xs:element name="clCodigoGrupo" msprop:DbColumnName="clCodigoGrupo" msprop:FriendlyName="clCodigoGrupo" type="xs:int" minOccurs="0" />
                          <xs:element name="clGrupo" msprop:DbColumnName="clGrupo" msprop:FriendlyName="clGrupo" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="clEstado" msprop:DbColumnName="clEstado" msprop:FriendlyName="clEstado" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="clFechaFin" msprop:DbColumnName="clFechaFin" msprop:FriendlyName="clFechaFin" type="xs:dateTime" minOccurs="0" />
                          <xs:element name="clIdBanca" msprop:DbColumnName="clIdBanca" msprop:FriendlyName="clIdBanca" type="xs:int" minOccurs="0" />
                          <xs:element name="clIdSegmentacionCliente" msprop:DbColumnName="clIdSegmentacionCliente" msprop:FriendlyName="clIdSegmentacionCliente" type="xs:int" minOccurs="0" />
                          <xs:element name="clCalClienteDesde" msprop:DbColumnName="clCalClienteDesde" msprop:FriendlyName="clCalClienteDesde" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="clSegmentacionTipoCliente" msprop:DbColumnName="clSegmentacionTipoCliente" msprop:FriendlyName="clSegmentacionTipoCliente" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="clFechaIngreso" msprop:DbColumnName="clFechaIngreso" msprop:FriendlyName="clFechaIngreso" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="DWHPasivoOperacion_abbaa295-b462-49cf-8c65-034c7dc36f40" msdata:Locale="" msprop:IsLogical="True" msprop:FriendlyName="DWHPasivoOperacion" msprop:DbTableName="DWHPasivoOperacion" msprop:TableType="View" msprop:Description="DWHPasivoOperacion" msprop:QueryDefinition="set nocount on&#xD;&#xA;&#xD;&#xA;declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int&#xD;&#xA;&#xD;&#xA;set @Mes=2&#xD;&#xA;&#xD;&#xA;-- Fecha hace dos años corrido --&#xD;&#xA;select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 &#xD;&#xA;&#xD;&#xA;-- Fecha Mes Anterior --&#xD;&#xA;select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1&#xD;&#xA;&#xD;&#xA;/*---- Fecha ----*/&#xD;&#xA;&#xD;&#xA;if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end &#xD;&#xA;&#xD;&#xA;select feIdFecha&#xD;&#xA;into #DWDFecha&#xD;&#xA;from DWDFecha&#xD;&#xA;where feIdFecha=19000101 --between @FechaHaceDosAnios and @FechaMesAnt&#xD;&#xA;and fecierremes=1&#xD;&#xA;and feCalMes=@Mes&#xD;&#xA;&#xD;&#xA;/*----- Cuenta Contable Ctas Ahorro y Credito -----*/&#xD;&#xA;&#xD;&#xA;if object_id('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end&#xD;&#xA;&#xD;&#xA;select distinct&#xD;&#xA;ccIdCuentaContable,ccCostoOperativo=isnull(ccCostoOperativo,0),CtasAhoCorr=case when ccCodigoIndicadorRentabilidad in (60,61) then 1 else 0 end --60 (MantenimientoCuentaAhorro) ; 61 (MantenimientoCuentaCorriente)&#xD;&#xA;into #DWDCuentaContable&#xD;&#xA;from DWDCuentaContable cc&#xD;&#xA;inner join vuClasificacionProductos cp on cc.ccCodigoIndicador=cp.indicadorNivel3&#xD;&#xA;where indicadorNivel1=2 -- Captaciones&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;/*----- Pasivo Operacion -----*/&#xD;&#xA;&#xD;&#xA;if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end &#xD;&#xA;&#xD;&#xA;select&#xD;&#xA; poIdFecha&#xD;&#xA;,poIdCliente&#xD;&#xA;,poIdCuentaContable&#xD;&#xA;,poSaldoOperacionUSD&#xD;&#xA;,poSaldoAcumuladoAnual&#xD;&#xA;,poSaldoPromedioAnual&#xD;&#xA;,poValorActPondRiesgoPromAnual&#xD;&#xA;,poValorComision&#xD;&#xA;,poValorIngresoServicio&#xD;&#xA;,poNumeroTransaccionesAnual&#xD;&#xA;,poValorCostoOperativo&#xD;&#xA;,poValorOperacionFinanciera&#xD;&#xA;,poValorInteresRealAnual&#xD;&#xA;,poValorInteresTasaPool&#xD;&#xA;,poValorMargenFinanciero&#xD;&#xA;,poValorMargenBancarioBasico&#xD;&#xA;,poValorMargenOrdinario&#xD;&#xA;,poValorMargenExplotacion&#xD;&#xA;,poValorUtilidadOperativa&#xD;&#xA;,poSaldoAcumuladoMensualFiscal&#xD;&#xA;,poCuentaAperturada = case when left(poIdFechaApertura,6) = left(poidfecha,6)  then 1 else 0 end &#xD;&#xA;into #PasivoOperacion&#xD;&#xA;from DWHPasivoOperacion po&#xD;&#xA;inner join #DWDFecha fe on po.poIdFecha=fe.feIdFecha&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;select&#xD;&#xA; poIdFecha&#xD;&#xA;,poIdCliente&#xD;&#xA;,poIdCuentaContable&#xD;&#xA;&#xD;&#xA;,poSaldoOperacionUSD=sum(isnull(poSaldoOperacionUSD,0))&#xD;&#xA;,poSaldoAcumuladoAnual=sum(isnull(poSaldoAcumuladoAnual,0))&#xD;&#xA;,poSaldoPromedioAnual=sum(isnull(poSaldoPromedioAnual,0))&#xD;&#xA;,poValorActPondRiesgoPromAnual=sum(isnull(poValorActPondRiesgoPromAnual,0))&#xD;&#xA;&#xD;&#xA;,poValorComision=sum(isnull(poValorComision,0))&#xD;&#xA;,poValorIngresoServicio=sum(isnull(poValorIngresoServicio,0))&#xD;&#xA;,poNumeroTransaccionesAnual=sum(isnull(poNumeroTransaccionesAnual,0))&#xD;&#xA;,poValorCostoOperativo=sum(isnull(poValorCostoOperativo,0) +  (12*cta.ccCostoOperativo) ) &#xD;&#xA;,poValorOperacionFinanciera=sum(isnull(poValorOperacionFinanciera,0))&#xD;&#xA;,poValorInteresRealAnual=sum(isnull(poValorInteresRealAnual,0))&#xD;&#xA;,poValorInteresTasaPool=sum(isnull(poValorInteresTasaPool,0))&#xD;&#xA;,poValorMargenFinanciero=sum(isnull(poValorMargenFinanciero,0))&#xD;&#xA;,poValorMargenBancarioBasico=sum(isnull(poValorMargenBancarioBasico,0))&#xD;&#xA;,poValorMargenOrdinario=sum(isnull(poValorMargenOrdinario,0))&#xD;&#xA;,poValorMargenExplotacion=sum( (isnull(poValorMargenExplotacion,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenOrdinario - CostoOperativo&#xD;&#xA;,poValorUtilidadOperativa=sum( (isnull(poValorUtilidadOperativa,0)) - (case when cta.CtasAhoCorr=1 and isnull(poSaldoAcumuladoMensualFiscal,0)!=0 then 12*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada&#xD;&#xA;,poSaldoAcumuladoMensualFiscal=sum(isnull(poSaldoAcumuladoMensualFiscal,0))&#xD;&#xA;,poCuentaAperturada&#xD;&#xA;from #PasivoOperacion po&#xD;&#xA;inner join #DWDCuentaContable cta on po.poIdCuentaContable=cta.ccIdCuentaContable&#xD;&#xA;group by poIdFecha&#xD;&#xA;,poIdCliente&#xD;&#xA;,poIdCuentaContable&#xD;&#xA;,poCuentaAperturada&#xD;&#xA;&#xD;&#xA;if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end &#xD;&#xA;if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end&#xD;&#xA;if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="poIdFecha" msprop:DbColumnName="poIdFecha" msprop:FriendlyName="poIdFecha" type="xs:int" minOccurs="0" />
                          <xs:element name="poIdCliente" msprop:DbColumnName="poIdCliente" msprop:FriendlyName="poIdCliente" type="xs:int" minOccurs="0" />
                          <xs:element name="poIdCuentaContable" msprop:DbColumnName="poIdCuentaContable" msprop:FriendlyName="poIdCuentaContable" type="xs:int" minOccurs="0" />
                          <xs:element name="poSaldoOperacionUSD" msprop:DbColumnName="poSaldoOperacionUSD" msprop:FriendlyName="poSaldoOperacionUSD" type="xs:double" minOccurs="0" />
                          <xs:element name="poSaldoAcumuladoAnual" msprop:DbColumnName="poSaldoAcumuladoAnual" msprop:FriendlyName="poSaldoAcumuladoAnual" type="xs:double" minOccurs="0" />
                          <xs:element name="poSaldoPromedioAnual" msprop:DbColumnName="poSaldoPromedioAnual" msprop:FriendlyName="poSaldoPromedioAnual" type="xs:double" minOccurs="0" />
                          <xs:element name="poValorActPondRiesgoPromAnual" msprop:DbColumnName="poValorActPondRiesgoPromAnual" msprop:FriendlyName="poValorActPondRiesgoPromAnual" type="xs:double" minOccurs="0" />
                          <xs:element name="poValorComision" msprop:DbColumnName="poValorComision" msprop:FriendlyName="poValorComision" type="xs:double" minOccurs="0" />
                          <xs:element name="poValorIngresoServicio" msprop:DbColumnName="poValorIngresoServicio" msprop:FriendlyName="poValorIngresoServicio" type="xs:double" minOccurs="0" />
                          <xs:element name="poNumeroTransaccionesAnual" msprop:DbColumnName="poNumeroTransaccionesAnual" msprop:FriendlyName="poNumeroTransaccionesAnual" type="xs:int" minOccurs="0" />
                          <xs:element name="poValorCostoOperativo" msprop:DbColumnName="poValorCostoOperativo" msprop:FriendlyName="poValorCostoOperativo" type="xs:double" minOccurs="0" />
                          <xs:element name="poValorOperacionFinanciera" msprop:DbColumnName="poValorOperacionFinanciera" msprop:FriendlyName="poValorOperacionFinanciera" type="xs:double" minOccurs="0" />
                          <xs:element name="poValorInteresRealAnual" msprop:DbColumnName="poValorInteresRealAnual" msprop:FriendlyName="poValorInteresRealAnual" type="xs:double" minOccurs="0" />
                          <xs:element name="poValorInteresTasaPool" msprop:DbColumnName="poValorInteresTasaPool" msprop:FriendlyName="poValorInteresTasaPool" type="xs:double" minOccurs="0" />
                          <xs:element name="poValorMargenFinanciero" msprop:DbColumnName="poValorMargenFinanciero" msprop:FriendlyName="poValorMargenFinanciero" type="xs:double" minOccurs="0" />
                          <xs:element name="poValorMargenBancarioBasico" msprop:DbColumnName="poValorMargenBancarioBasico" msprop:FriendlyName="poValorMargenBancarioBasico" type="xs:double" minOccurs="0" />
                          <xs:element name="poValorMargenOrdinario" msprop:DbColumnName="poValorMargenOrdinario" msprop:FriendlyName="poValorMargenOrdinario" type="xs:double" minOccurs="0" />
                          <xs:element name="poValorMargenExplotacion" msprop:DbColumnName="poValorMargenExplotacion" msprop:FriendlyName="poValorMargenExplotacion" type="xs:double" minOccurs="0" />
                          <xs:element name="poValorUtilidadOperativa" msprop:DbColumnName="poValorUtilidadOperativa" msprop:FriendlyName="poValorUtilidadOperativa" type="xs:double" minOccurs="0" />
                          <xs:element name="poSaldoAcumuladoMensualFiscal" msprop:DbColumnName="poSaldoAcumuladoMensualFiscal" msprop:FriendlyName="poSaldoAcumuladoMensualFiscal" type="xs:double" minOccurs="0" />
                          <xs:element name="poCuentaAperturada" msprop:DbColumnName="poCuentaAperturada" msprop:FriendlyName="poCuentaAperturada" type="xs:int" minOccurs="0" />
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="DWHTarjetaCreditoOperacion_df5c7a69-83f6-4645-8161-7b288fed7bac" msdata:Locale="" msprop:IsLogical="True" msprop:FriendlyName="DWHTarjetaCreditoOperacion" msprop:DbTableName="DWHTarjetaCreditoOperacion" msprop:TableType="View" msprop:Description="DWHTarjetaCreditoOperacion" msprop:QueryDefinition="set nocount on&#xD;&#xA;&#xD;&#xA;declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @tasaEfectiva float&#xD;&#xA;&#xD;&#xA;set @Mes=1&#xD;&#xA;&#xD;&#xA;-- Fecha hace dos años corrido --&#xD;&#xA;select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 &#xD;&#xA;&#xD;&#xA;-- Fecha Mes Anterior --&#xD;&#xA;select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1&#xD;&#xA;&#xD;&#xA;/*---- Fecha ----*/&#xD;&#xA;&#xD;&#xA;if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end &#xD;&#xA;&#xD;&#xA;select feIdFecha&#xD;&#xA;into #DWDFecha&#xD;&#xA;from DWDFecha&#xD;&#xA;where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt&#xD;&#xA;and fecierremes=1&#xD;&#xA;and feCalMes=@Mes&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;/* Tasa Efectiva */&#xD;&#xA;&#xD;&#xA;select @tasaEfectiva = convert(float,copPorcentajeConstante) from DWDConstanteOperacion where copCodigoConstante = 15&#xD;&#xA;&#xD;&#xA;OPEN SYMMETRIC KEY ClaveMIS02&#xD;&#xA;DECRYPTION BY CERTIFICATE Certi01&#xD;&#xA;&#xD;&#xA;SELECT&#xD;&#xA; tcoIdFecha&#xD;&#xA;,tcoIdCuentaContable&#xD;&#xA;,tcoIdProducto&#xD;&#xA;,tcoIdCliente&#xD;&#xA;,tcoIdCalificacionOperacionCliente&#xD;&#xA;&#xD;&#xA;,tcoNumeroOperacion=CONVERT(varchar(25), DecryptByKey(tcoNumeroOperacion))&#xD;&#xA;&#xD;&#xA;,tcoSaldo=isnull(tcoSaldo,0)&#xD;&#xA;,tcoSaldoAcumuladoAnual=isnull(tcoSaldoAcumuladoAnual,0)&#xD;&#xA;,tcoSaldoAcumuladoMensualFiscal=isnull(tcoSaldoAcumuladoMensualFiscal,0)&#xD;&#xA;&#xD;&#xA;,tcoSaldoPromedioAnual=isnull(tcoSaldoPromedioAnual,0)&#xD;&#xA;&#xD;&#xA;,tcoValorActPondRiesgoPromAnual=isnull(tcoValorActPondRiesgoPromAnual,0)&#xD;&#xA;&#xD;&#xA;,tcoValorComision=isnull(tcoValorComision,0)&#xD;&#xA;,tcoValorIngresoServicio=isnull(tcoValorIngresoServicio,0)&#xD;&#xA;,tcoValorOperacionFinanciera=isnull(tcoValorOperacionFinanciera,0)&#xD;&#xA;,tcoValorInteresRealAnual=isnull(tcoValorInteresRealAnual,0)&#xD;&#xA;,tcoValorInteresTasaPool=isnull(tcoValorInteresTasaPool,0)&#xD;&#xA;,tcoValorMargenFinanciero=isnull(tcoValorMargenFinanciero,0)&#xD;&#xA;,tcoValorMargenBancarioBasico=isnull(tcoValorMargenBancarioBasico,0)&#xD;&#xA;,tcoValorMargenOrdinario=isnull(tcoValorMargenOrdinario,0)&#xD;&#xA;,tcoValorMargenExplotacion=isnull(tcoValorMargenExplotacion,0)&#xD;&#xA;,tcoValorUtilidadOperativa=isnull(tcoValorUtilidadOperativa,0)&#xD;&#xA;,tcoValorCostoOperativo=isnull(tcoValorCostoOperativo,0)&#xD;&#xA;,tcoValorPerdidaEsperada=isnull(tcoValorPerdidaEsperada,0)&#xD;&#xA;&#xD;&#xA;,tcoNumeroTransaccionesAnual=isnull(tcoNumeroTransaccionesAnual,0)&#xD;&#xA;&#xD;&#xA;,tcoTasaEfectiva = @tasaEfectiva&#xD;&#xA;,tcoIdTarjeta = isnull(tcoIdTarjeta, -1)&#xD;&#xA;,tcoValorPorcentajePerdidaEsperada=isnull(tcoValorPorcentajePerdidaEsperada,0.00)&#xD;&#xA;FROM DWHTarjetaCreditoOperacion tco&#xD;&#xA;inner join #DWDFecha fe on tco.tcoIdFecha=fe.feIdFecha&#xD;&#xA;&#xD;&#xA;CLOSE SYMMETRIC KEY ClaveMIS02&#xD;&#xA;&#xD;&#xA;if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="tcoIdFecha" msprop:DbColumnName="tcoIdFecha" msprop:FriendlyName="tcoIdFecha" type="xs:int" minOccurs="0" />
                          <xs:element name="tcoIdCuentaContable" msprop:DbColumnName="tcoIdCuentaContable" msprop:FriendlyName="tcoIdCuentaContable" type="xs:int" minOccurs="0" />
                          <xs:element name="tcoIdProducto" msprop:DbColumnName="tcoIdProducto" msprop:FriendlyName="tcoIdProducto" type="xs:int" minOccurs="0" />
                          <xs:element name="tcoIdCliente" msprop:DbColumnName="tcoIdCliente" msprop:FriendlyName="tcoIdCliente" type="xs:int" minOccurs="0" />
                          <xs:element name="tcoNumeroOperacion" msprop:DbColumnName="tcoNumeroOperacion" msprop:FriendlyName="tcoNumeroOperacion" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="tcoSaldo" msprop:DbColumnName="tcoSaldo" msprop:FriendlyName="tcoSaldo" type="xs:double" minOccurs="0" />
                          <xs:element name="tcoSaldoAcumuladoAnual" msprop:DbColumnName="tcoSaldoAcumuladoAnual" msprop:FriendlyName="tcoSaldoAcumuladoAnual" type="xs:double" minOccurs="0" />
                          <xs:element name="tcoSaldoPromedioAnual" msprop:DbColumnName="tcoSaldoPromedioAnual" msprop:FriendlyName="tcoSaldoPromedioAnual" type="xs:double" minOccurs="0" />
                          <xs:element name="tcoValorActPondRiesgoPromAnual" msprop:DbColumnName="tcoValorActPondRiesgoPromAnual" msprop:FriendlyName="tcoValorActPondRiesgoPromAnual" type="xs:double" minOccurs="0" />
                          <xs:element name="tcoValorComision" msprop:DbColumnName="tcoValorComision" msprop:FriendlyName="tcoValorComision" type="xs:double" minOccurs="0" />
                          <xs:element name="tcoValorIngresoServicio" msprop:DbColumnName="tcoValorIngresoServicio" msprop:FriendlyName="tcoValorIngresoServicio" type="xs:double" minOccurs="0" />
                          <xs:element name="tcoValorOperacionFinanciera" msprop:DbColumnName="tcoValorOperacionFinanciera" msprop:FriendlyName="tcoValorOperacionFinanciera" type="xs:double" minOccurs="0" />
                          <xs:element name="tcoValorInteresRealAnual" msprop:DbColumnName="tcoValorInteresRealAnual" msprop:FriendlyName="tcoValorInteresRealAnual" type="xs:double" minOccurs="0" />
                          <xs:element name="tcoValorInteresTasaPool" msprop:DbColumnName="tcoValorInteresTasaPool" msprop:FriendlyName="tcoValorInteresTasaPool" type="xs:double" minOccurs="0" />
                          <xs:element name="tcoValorMargenFinanciero" msprop:DbColumnName="tcoValorMargenFinanciero" msprop:FriendlyName="tcoValorMargenFinanciero" type="xs:double" minOccurs="0" />
                          <xs:element name="tcoValorMargenBancarioBasico" msprop:DbColumnName="tcoValorMargenBancarioBasico" msprop:FriendlyName="tcoValorMargenBancarioBasico" type="xs:double" minOccurs="0" />
                          <xs:element name="tcoValorMargenOrdinario" msprop:DbColumnName="tcoValorMargenOrdinario" msprop:FriendlyName="tcoValorMargenOrdinario" type="xs:double" minOccurs="0" />
                          <xs:element name="tcoValorMargenExplotacion" msprop:DbColumnName="tcoValorMargenExplotacion" msprop:FriendlyName="tcoValorMargenExplotacion" type="xs:double" minOccurs="0" />
                          <xs:element name="tcoValorUtilidadOperativa" msprop:DbColumnName="tcoValorUtilidadOperativa" msprop:FriendlyName="tcoValorUtilidadOperativa" type="xs:double" minOccurs="0" />
                          <xs:element name="tcoValorCostoOperativo" msprop:DbColumnName="tcoValorCostoOperativo" msprop:FriendlyName="tcoValorCostoOperativo" type="xs:double" minOccurs="0" />
                          <xs:element name="tcoValorPerdidaEsperada" msprop:DbColumnName="tcoValorPerdidaEsperada" msprop:FriendlyName="tcoValorPerdidaEsperada" type="xs:double" minOccurs="0" />
                          <xs:element name="tcoNumeroTransaccionesAnual" msprop:DbColumnName="tcoNumeroTransaccionesAnual" msprop:FriendlyName="tcoNumeroTransaccionesAnual" type="xs:int" minOccurs="0" />
                          <xs:element name="tcoTasaEfectiva" msprop:DbColumnName="tcoTasaEfectiva" msprop:FriendlyName="tcoTasaEfectiva" type="xs:double" minOccurs="0" />
                          <xs:element name="tcoIdCalificacionOperacionCliente" msprop:DbColumnName="tcoIdCalificacionOperacionCliente" msprop:FriendlyName="tcoIdCalificacionOperacionCliente" type="xs:int" minOccurs="0" />
                          <xs:element name="tcoIdTarjeta" msprop:DbColumnName="tcoIdTarjeta" msprop:FriendlyName="tcoIdTarjeta" type="xs:int" minOccurs="0" />
                          <xs:element name="tcoValorPorcentajePerdidaEsperada" msprop:DbColumnName="tcoValorPorcentajePerdidaEsperada" msprop:FriendlyName="tcoValorPorcentajePerdidaEsperada" type="xs:double" minOccurs="0" />
                          <xs:element name="tcoSaldoAcumuladoMensualFiscal" msprop:DbColumnName="tcoSaldoAcumuladoMensualFiscal" msprop:FriendlyName="tcoSaldoAcumuladoMensualFiscal" type="xs:double" minOccurs="0" />
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="DWHActivoOperacion_5d8c3eaa-b4db-4917-baf4-5b00fe6b4e3e" msdata:Locale="" msprop:IsLogical="True" msprop:FriendlyName="DWHActivoOperacion" msprop:DbTableName="DWHActivoOperacion" msprop:TableType="View" msprop:Description="DWHActivoOperacion" msprop:QueryDefinition="declare @FechaActual int&#xD;&#xA;&#xD;&#xA;select @FechaActual=feIdFecha from DWDFecha where feDiaActual=1&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;OPEN SYMMETRIC KEY ClaveMIS02&#xD;&#xA;DECRYPTION BY CERTIFICATE Certi01&#xD;&#xA;&#xD;&#xA;select&#xD;&#xA; aoIdFecha&#xD;&#xA;,aoIdCliente&#xD;&#xA;,aoIdCuentaContable&#xD;&#xA;,aoIdProducto&#xD;&#xA;&#xD;&#xA;,aoIdCalificacionOperacionCliente&#xD;&#xA; &#xD;&#xA;,aoNumeroOperacion=CONVERT(varchar(20), DecryptByKey(aoNumeroOperacion))&#xD;&#xA;,aoMontoSaldoDolar=isnull(aoMontoSaldoDolar,0) &#xD;&#xA;&#xD;&#xA;,aoSaldoAcumuladoAnual=isnull(aoSaldoAcumuladoAnual,0)&#xD;&#xA;,aoSaldoPromedioAnual=isnull(aoSaldoPromedioAnual,0)&#xD;&#xA;,aoValorActPondRiesgoPromAnual=isnull(aoValorActPondRiesgoPromAnual,0)&#xD;&#xA;,aoValorComision=isnull(aoValorComision,0)&#xD;&#xA;,aoValorIngresoServicio=isnull(aoValorIngresoServicio,0)&#xD;&#xA;,aoValorOperacionFinanciera=isnull(aoValorOperacionFinanciera,0)&#xD;&#xA;,aoValorInteresRealAnual=isnull(aoValorInteresRealAnual,0)&#xD;&#xA;,aoValorInteresTasaPool=isnull(aoValorInteresTasaPool,0)&#xD;&#xA;,aoValorMargenFinanciero=isnull(aoValorMargenFinanciero,0)&#xD;&#xA;,aoValorMargenBancarioBasico=isnull(aoValorMargenBancarioBasico,0)&#xD;&#xA;,aoValorMargenOrdinario=isnull(aoValorMargenOrdinario,0)&#xD;&#xA;,aoValorMargenExplotacion=isnull(aoValorMargenExplotacion,0)&#xD;&#xA;,aoValorUtilidadOperativa=isnull(aoValorUtilidadOperativa,0)&#xD;&#xA;,aoValorCostoOperativo=isnull(aoValorCostoOperativo,0)&#xD;&#xA;,aoValorPerdidaEsperada=isnull(aoValorPerdidaEsperada,0)&#xD;&#xA;,aoTasaPool=isnull(aoTasaPool,0)&#xD;&#xA;,aoSpread=isnull(aoSpread,0)&#xD;&#xA;,aoTasaImplicita=isnull(aoTasaImplicita,0)&#xD;&#xA;,aoNumeroTransaccionesAnual=isnull(aoNumeroTransaccionesAnual,0)&#xD;&#xA;--,aoInteresTasaEfectiva=isnull(aoInteresTasaEfectiva,0)&#xD;&#xA;,aoTasaEfectiva=isnull(aoTasaEfectiva,0)&#xD;&#xA;,aoValorPorcentajePerdidaEsperada=isnull(aoValorPorcentajePerdidaEsperada,0.00)&#xD;&#xA;from DWHActivoOperacion&#xD;&#xA;where aoIdFecha=@FechaActual&#xD;&#xA;&#xD;&#xA;CLOSE SYMMETRIC KEY ClaveMIS02">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="aoIdFecha" msprop:DbColumnName="aoIdFecha" msprop:FriendlyName="aoIdFecha" type="xs:int" minOccurs="0" />
                          <xs:element name="aoIdCliente" msprop:DbColumnName="aoIdCliente" msprop:FriendlyName="aoIdCliente" type="xs:int" minOccurs="0" />
                          <xs:element name="aoIdCuentaContable" msprop:DbColumnName="aoIdCuentaContable" msprop:FriendlyName="aoIdCuentaContable" type="xs:int" minOccurs="0" />
                          <xs:element name="aoIdProducto" msprop:DbColumnName="aoIdProducto" msprop:FriendlyName="aoIdProducto" type="xs:int" minOccurs="0" />
                          <xs:element name="aoNumeroOperacion" msprop:DbColumnName="aoNumeroOperacion" msprop:FriendlyName="aoNumeroOperacion" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="aoMontoSaldoDolar" msprop:DbColumnName="aoMontoSaldoDolar" msprop:FriendlyName="aoMontoSaldoDolar" type="xs:double" minOccurs="0" />
                          <xs:element name="aoSaldoAcumuladoAnual" msprop:DbColumnName="aoSaldoAcumuladoAnual" msprop:FriendlyName="aoSaldoAcumuladoAnual" type="xs:double" minOccurs="0" />
                          <xs:element name="aoSaldoPromedioAnual" msprop:DbColumnName="aoSaldoPromedioAnual" msprop:FriendlyName="aoSaldoPromedioAnual" type="xs:double" minOccurs="0" />
                          <xs:element name="aoValorActPondRiesgoPromAnual" msprop:DbColumnName="aoValorActPondRiesgoPromAnual" msprop:FriendlyName="aoValorActPondRiesgoPromAnual" type="xs:double" minOccurs="0" />
                          <xs:element name="aoValorComision" msprop:DbColumnName="aoValorComision" msprop:FriendlyName="aoValorComision" type="xs:double" minOccurs="0" />
                          <xs:element name="aoValorIngresoServicio" msprop:DbColumnName="aoValorIngresoServicio" msprop:FriendlyName="aoValorIngresoServicio" type="xs:double" minOccurs="0" />
                          <xs:element name="aoValorOperacionFinanciera" msprop:DbColumnName="aoValorOperacionFinanciera" msprop:FriendlyName="aoValorOperacionFinanciera" type="xs:double" minOccurs="0" />
                          <xs:element name="aoValorInteresRealAnual" msprop:DbColumnName="aoValorInteresRealAnual" msprop:FriendlyName="aoValorInteresRealAnual" type="xs:double" minOccurs="0" />
                          <xs:element name="aoValorInteresTasaPool" msprop:DbColumnName="aoValorInteresTasaPool" msprop:FriendlyName="aoValorInteresTasaPool" type="xs:double" minOccurs="0" />
                          <xs:element name="aoValorMargenFinanciero" msprop:DbColumnName="aoValorMargenFinanciero" msprop:FriendlyName="aoValorMargenFinanciero" type="xs:double" minOccurs="0" />
                          <xs:element name="aoValorMargenBancarioBasico" msprop:DbColumnName="aoValorMargenBancarioBasico" msprop:FriendlyName="aoValorMargenBancarioBasico" type="xs:double" minOccurs="0" />
                          <xs:element name="aoValorMargenOrdinario" msprop:DbColumnName="aoValorMargenOrdinario" msprop:FriendlyName="aoValorMargenOrdinario" type="xs:double" minOccurs="0" />
                          <xs:element name="aoValorMargenExplotacion" msprop:DbColumnName="aoValorMargenExplotacion" msprop:FriendlyName="aoValorMargenExplotacion" type="xs:double" minOccurs="0" />
                          <xs:element name="aoValorUtilidadOperativa" msprop:DbColumnName="aoValorUtilidadOperativa" msprop:FriendlyName="aoValorUtilidadOperativa" type="xs:double" minOccurs="0" />
                          <xs:element name="aoValorCostoOperativo" msprop:DbColumnName="aoValorCostoOperativo" msprop:FriendlyName="aoValorCostoOperativo" type="xs:double" minOccurs="0" />
                          <xs:element name="aoValorPerdidaEsperada" msprop:DbColumnName="aoValorPerdidaEsperada" msprop:FriendlyName="aoValorPerdidaEsperada" type="xs:double" minOccurs="0" />
                          <xs:element name="aoTasaPool" msprop:DbColumnName="aoTasaPool" msprop:FriendlyName="aoTasaPool" type="xs:double" minOccurs="0" />
                          <xs:element name="aoSpread" msprop:DbColumnName="aoSpread" msprop:FriendlyName="aoSpread" type="xs:double" minOccurs="0" />
                          <xs:element name="aoTasaImplicita" msprop:DbColumnName="aoTasaImplicita" msprop:FriendlyName="aoTasaImplicita" type="xs:double" minOccurs="0" />
                          <xs:element name="aoNumeroTransaccionesAnual" msprop:DbColumnName="aoNumeroTransaccionesAnual" msprop:FriendlyName="aoNumeroTransaccionesAnual" type="xs:double" minOccurs="0" />
                          <xs:element name="aoTasaEfectiva" msprop:DbColumnName="aoTasaEfectiva" msprop:FriendlyName="aoTasaEfectiva" type="xs:double" minOccurs="0" />
                          <xs:element name="aoIdCalificacionOperacionCliente" msprop:DbColumnName="aoIdCalificacionOperacionCliente" msprop:FriendlyName="aoIdCalificacionOperacionCliente" type="xs:int" minOccurs="0" />
                          <xs:element name="aoValorPorcentajePerdidaEsperada" msprop:DbColumnName="aoValorPorcentajePerdidaEsperada" msprop:FriendlyName="aoValorPorcentajePerdidaEsperada" type="xs:double" minOccurs="0" />
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461" msdata:Locale="" msprop:IsLogical="True" msprop:FriendlyName="DWDSegmentacionCliente" msprop:DbSchemaName="dbo" msprop:DbTableName="DWDSegmentacionCliente" msprop:TableType="View" msprop:Description="DWDSegmentacionCliente" msprop:QueryDefinition=" SELECT [dbo].[DWDSegmentacionCliente].* FROM [dbo].[DWDSegmentacionCliente] ">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="scIdSegmentacionCliente" msprop:DbColumnName="scIdSegmentacionCliente" msprop:FriendlyName="scIdSegmentacionCliente" type="xs:long" />
                          <xs:element name="scIdCodigo" msprop:DbColumnName="scIdCodigo" msprop:FriendlyName="scIdCodigo" type="xs:long" minOccurs="0" />
                          <xs:element name="scDetalleCodigo" msprop:DbColumnName="scDetalleCodigo" msprop:FriendlyName="scDetalleCodigo" type="xs:long" minOccurs="0" />
                          <xs:element name="scDetalleNombre" msprop:DbColumnName="scDetalleNombre" msprop:FriendlyName="scDetalleNombre" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="scSegmentacionCodigo" msprop:DbColumnName="scSegmentacionCodigo" msprop:FriendlyName="scSegmentacionCodigo" type="xs:long" minOccurs="0" />
                          <xs:element name="scSegmentacion" msprop:DbColumnName="scSegmentacion" msprop:FriendlyName="scSegmentacion" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="scSegmentacionTipoCodigo" msprop:DbColumnName="scSegmentacionTipoCodigo" msprop:FriendlyName="scSegmentacionTipoCodigo" type="xs:long" minOccurs="0" />
                          <xs:element name="scSegmentacionTipo" msprop:DbColumnName="scSegmentacionTipo" msprop:FriendlyName="scSegmentacionTipo" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="scSegmentacionOrden" msprop:DbColumnName="scSegmentacionOrden" msprop:FriendlyName="scSegmentacionOrden" type="xs:long" minOccurs="0" />
                          <xs:element name="scSegmentacionOrdenN2" msprop:DbColumnName="scSegmentacionOrdenN2" msprop:FriendlyName="scSegmentacionOrdenN2" type="xs:long" minOccurs="0" />
                          <xs:element name="scSegmentacionOrdenN3" msprop:DbColumnName="scSegmentacionOrdenN3" msprop:FriendlyName="scSegmentacionOrdenN3" type="xs:long" minOccurs="0" />
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997" msdata:Locale="" msprop:IsLogical="True" msprop:FriendlyName="DWDBanca" msprop:DbSchemaName="dbo" msprop:DbTableName="DWDBanca" msprop:TableType="View" msprop:Description="DWDBanca" msprop:QueryDefinition="SELECT &#xD;&#xA;baidbanca,&#xD;&#xA;baCodigoBanca,&#xD;&#xA;baDescripcionBanca &#xD;&#xA;FROM [dbo].[DWDBanca]">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="baIdBanca" msprop:DbColumnName="baIdBanca" msprop:FriendlyName="baIdBanca" type="xs:long" />
                          <xs:element name="baCodigoBanca" msprop:DbColumnName="baCodigoBanca" msprop:FriendlyName="baCodigoBanca" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="baDescripcionBanca" msprop:DbColumnName="baDescripcionBanca" msprop:FriendlyName="baDescripcionBanca" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10" msdata:Locale="" msprop:IsLogical="True" msprop:FriendlyName="DWDCalificacionOperacionCliente" msprop:DbSchemaName="dbo" msprop:DbTableName="DWDCalificacionOperacionCliente" msprop:TableType="View" msprop:Description="DWDCalificacionOperacionCliente" msprop:QueryDefinition=" SELECT [dbo].[DWDCalificacionOperacionCliente].* FROM [dbo].[DWDCalificacionOperacionCliente] ">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="cocIdCalificacionOperacionCliente" msprop:DbColumnName="cocIdCalificacionOperacionCliente" msprop:FriendlyName="cocIdCalificacionOperacionCliente" type="xs:long" />
                          <xs:element name="cocCodigoCalificacionOperacionCliente" msprop:DbColumnName="cocCodigoCalificacionOperacionCliente" msprop:FriendlyName="cocCodigoCalificacionOperacionCliente" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="cocCalificacionOperacionCiente" msprop:DbColumnName="cocCalificacionOperacionCiente" msprop:FriendlyName="cocCalificacionOperacionCiente" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="DWHIngresoOperacion_5c35dbe1-2015-485c-a6fa-47e0c4157510" msdata:Locale="" msprop:IsLogical="True" msprop:FriendlyName="DWHIngresoOperacion" msprop:DbTableName="DWHIngresoOperacion" msprop:TableType="View" msprop:Description="DWHIngresoOperacion" msprop:QueryDefinition="set nocount on&#xD;&#xA;&#xD;&#xA;declare @Mes int, @FechaMesAnt int, @FechaHaceDosAnios int, @IdMoneda int, @IdCtaSeviciosFinancieros int&#xD;&#xA;&#xD;&#xA;set @Mes=100&#xD;&#xA;&#xD;&#xA;/* -------  Parametros ------------ */&#xD;&#xA;&#xD;&#xA;select @IdMoneda=moIdMoneda from DWDMoneda where ltrim(rtrim(moCodigoMoneda))='USD'&#xD;&#xA;&#xD;&#xA;-- Fecha hace dos años corrido --&#xD;&#xA;select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 &#xD;&#xA;&#xD;&#xA;-- Fecha Mes Anterior --&#xD;&#xA;select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;/*---- Fecha ----*/&#xD;&#xA;&#xD;&#xA;if OBJECT_ID ('tempdb..#Fecha') is not null begin drop table #Fecha end&#xD;&#xA;&#xD;&#xA;select feIdFecha&#xD;&#xA;into #Fecha&#xD;&#xA;from DWDFecha&#xD;&#xA;where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt&#xD;&#xA;and fecierremes=1&#xD;&#xA;and feCalMes=@Mes &#xD;&#xA;and feIdFecha&gt;=20211029 -- Se filtra porque a partir de esta fecha se tiene datos de rentabilidad calculados correctamente&#xD;&#xA;&#xD;&#xA;-- Tarjeta / Pasivo --&#xD;&#xA;&#xD;&#xA;if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end&#xD;&#xA;&#xD;&#xA;select ccIdCuentaContable&#xD;&#xA;,ccCostoOperativo&#xD;&#xA;into #CuentasPasivoTarjeta&#xD;&#xA;from DWDCuentaContable&#xD;&#xA;where ccCodigoIndicadorRentabilidad in (&#xD;&#xA; 60 --Mantenimiento, administracion, mantencion o manejo de cuentas ahorros&#xD;&#xA;,61 --Mantenimiento, administracion, mantencion o manejo de cuentas corriente&#xD;&#xA;,62 --Mantenimiento tarjeta credito&#xD;&#xA;)&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;OPEN SYMMETRIC KEY ClaveMIS02&#xD;&#xA;DECRYPTION BY CERTIFICATE Certi01&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end&#xD;&#xA;&#xD;&#xA;select poidfecha, poidcliente, CONVERT(varchar(30), DecryptByKey(poNoOperacion)) as poNoOperacion, poidcuentacontable, poSaldoAcumuladoMensualFiscal &#xD;&#xA;into #Pasivo&#xD;&#xA;from DWHPasivoOperacion po&#xD;&#xA;inner join #Fecha fe on po.poIdFecha=fe.feIdFecha&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end&#xD;&#xA;&#xD;&#xA;select tcoIdFecha, tcoIdCliente, CONVERT(varchar(30), DecryptByKey(tco.tcoNumeroOperacion)) as tcoNumeroOperacion, tcoIdCuentaContable, tcoSaldoAcumuladoMensualFiscal&#xD;&#xA;into #Tarjeta&#xD;&#xA;from DWHTarjetaCreditoOperacion tco&#xD;&#xA;inner join #Fecha fe on tco.tcoIdFecha=fe.feIdFecha&#xD;&#xA;&#xD;&#xA;CLOSE SYMMETRIC KEY ClaveMIS02&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;-- Cuenta Contable --&#xD;&#xA;&#xD;&#xA;/* &#xD;&#xA; 50 Pago de Cheque por Ventanilla &#xD;&#xA; 51 Pago de cheques por cámara &#xD;&#xA; 52 Pago de Cheque Certificado &#xD;&#xA; 53 Retiro en cajas cuentas de ahorros &#xD;&#xA; 54 Deposito Mixto - Ahorros. Cuenta Corriente &#xD;&#xA; 55 Atm Retiros Clientes Propios &#xD;&#xA; 56 Depósitos Efectivo - Ahorros, cuentas corrientes &#xD;&#xA; 57 Deposito en cheque ahorros y cuentas corriente &#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;if OBJECT_ID ('tempdb..#CuentaContable') is not null begin drop table #CuentaContable end&#xD;&#xA;&#xD;&#xA;select &#xD;&#xA; ccIdCuentaContable=max(ccIdCuentaContable)&#xD;&#xA;,ccCodigoIndicadorRentabilidad&#xD;&#xA;into #CuentaContable&#xD;&#xA;from DWDCuentaContable cc&#xD;&#xA;where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)&#xD;&#xA;group by ccCodigoIndicadorRentabilidad&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;-- Tipo Transaccion --&#xD;&#xA;&#xD;&#xA;if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end&#xD;&#xA;&#xD;&#xA;select &#xD;&#xA; ttIdTipoTransaccion&#xD;&#xA;,ttCodigoTransaccion&#xD;&#xA;,ttCodigoServicioMovimiento&#xD;&#xA;,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 &#xD;&#xA;         when ttCodigoTransaccion in ('150','3110','3111')  then 56&#xD;&#xA;         when ttCodigoTransaccion='6211' then  53&#xD;&#xA;         when ttCodigoTransaccion in ('6210','6301') then 52&#xD;&#xA;         when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51&#xD;&#xA;         when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50&#xD;&#xA;        end&#xD;&#xA;into #TipoTransaccion&#xD;&#xA;from DWDTipoTransaccion&#xD;&#xA;where  ttCodigoTransaccion in (&#xD;&#xA; 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)&#xD;&#xA;,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente&#xD;&#xA;,'6210','6301' -- Pago de Cheque Certificado&#xD;&#xA;,'6212' -- 6212 CQ Pago de Cheque por Camara ; 6212 CV Pago de Cheque por Ventanilla&#xD;&#xA;,'6211' -- Retiro en cajas cuentas de ahorros&#xD;&#xA;)&#xD;&#xA;union all&#xD;&#xA;select &#xD;&#xA; ttIdTipoTransaccion&#xD;&#xA;,ttCodigoTransaccion&#xD;&#xA;,ttCodigoServicioMovimiento&#xD;&#xA;,IndicadorCtaContable=54&#xD;&#xA;from DWDTipoTransaccion&#xD;&#xA;where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end&#xD;&#xA;&#xD;&#xA;select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional&#xD;&#xA;into #TipoTransaccionTmp&#xD;&#xA;from #TipoTransaccion&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;-- Canal Transaccional --&#xD;&#xA;&#xD;&#xA;if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end&#xD;&#xA;&#xD;&#xA;select &#xD;&#xA;ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdTipoTransaccion, &#xD;&#xA;ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,&#xD;&#xA;ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido&#xD;&#xA;into #CanalTransaccional&#xD;&#xA;from DWHCanalTransaccional ct&#xD;&#xA;inner join #Fecha fe on ct.ctIdFechaTransaccion=fe.feIdFecha&#xD;&#xA;inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion&#xD;&#xA;&#xD;&#xA;-- Cliente --&#xD;&#xA;&#xD;&#xA;if OBJECT_ID('tempdb..#NoDuplicadoCliente') is not null begin drop table #NoDuplicadoCliente end&#xD;&#xA;&#xD;&#xA;select &#xD;&#xA; clIdClienteND=max(clIdCliente) -- Id No Duplicado&#xD;&#xA;,clCodigoCliente &#xD;&#xA;into #NoDuplicadoCliente&#xD;&#xA;from DWDCliente&#xD;&#xA;group by clCodigoCliente&#xD;&#xA;&#xD;&#xA;if OBJECT_ID('tempdb..#Cliente') is not null begin drop table #Cliente end&#xD;&#xA;&#xD;&#xA;select cl1.clIdCliente,cl1.clCodigoCliente,cl2.clIdClienteND&#xD;&#xA;into #Cliente&#xD;&#xA;from DWDCliente cl1&#xD;&#xA;inner join #NoDuplicadoCliente cl2 on cl1.clCodigoCliente=cl2.clCodigoCliente&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;-- Resultado Final --&#xD;&#xA;&#xD;&#xA;if OBJECT_ID ('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end&#xD;&#xA;&#xD;&#xA;select&#xD;&#xA; ctIdFechaTransaccion&#xD;&#xA;,ctIdClientePropietarioOperacion&#xD;&#xA;,IdCuentaContable=ccIdCuentaContable&#xD;&#xA;,NumeroOperacion=cast('0' as varchar(30))&#xD;&#xA;,NumeroTransaccionesMes=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeMesFiscal -- Deposito Mixto&#xD;&#xA;              when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeMesFiscal  -- Desposito Efectivo&#xD;&#xA;                                else ctNumeroTransaccionesMesFiscal  end )&#xD;&#xA;,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto&#xD;&#xA;              when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo&#xD;&#xA;                                else ctNumeroTransaccionesAnioCorrido  end )&#xD;&#xA;into #IndicadoresSaldos&#xD;&#xA;from #CanalTransaccional ct&#xD;&#xA;inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion -- Se cruza con esta tabla para obtener los productos de Depositos&#xD;&#xA;inner join #CuentaContable cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad&#xD;&#xA;group by ctIdFechaTransaccion,ctIdClientePropietarioOperacion,ctIdClientePropietarioOperacion,ccIdCuentaContable&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;insert into #IndicadoresSaldos&#xD;&#xA;select &#xD;&#xA; poidfecha&#xD;&#xA;,poidcliente --max(poidcliente)&#xD;&#xA;,poidcuentacontable --=max(poidcuentacontable)&#xD;&#xA;,poNoOperacion&#xD;&#xA;,NumTRXMesFiscal=cast(1 as int)&#xD;&#xA;,NumTRXAnualFiscal=cast(1 as int)*12&#xD;&#xA;from #Pasivo po&#xD;&#xA;inner join #CuentasPasivoTarjeta cp on po.poIdCuentaContable=cp.ccIdCuentaContable&#xD;&#xA;where poSaldoAcumuladoMensualFiscal!=0&#xD;&#xA;--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion&#xD;&#xA;&#xD;&#xA;insert into #IndicadoresSaldos&#xD;&#xA;select &#xD;&#xA; tcoidfecha&#xD;&#xA;,clIdClienteND -- se eliminan los registros con mismo ibs y id diferente &#xD;&#xA;,tcoidcuentacontable=max(tcoIdCuentaContable)&#xD;&#xA;,tcoNumeroOperacion&#xD;&#xA;,NumTRXMesFiscal=cast(1 as int)&#xD;&#xA;,NumTRXAnualFiscal=cast(1 as int)*12&#xD;&#xA;from #Tarjeta tco&#xD;&#xA;inner join #CuentasPasivoTarjeta cp on tco.tcoIdCuentaContable=cp.ccIdCuentaContable&#xD;&#xA;inner join #Cliente cl on tco.tcoidcliente=cl.clIdCliente&#xD;&#xA;where tcoSaldoAcumuladoMensualFiscal!=0&#xD;&#xA;group by tcoidfecha,tcoNumeroOperacion,clIdClienteND&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;select&#xD;&#xA; ioIdFecha&#xD;&#xA;,ioIdCliente&#xD;&#xA;,ioIdCuentaContablePrincipal&#xD;&#xA;&#xD;&#xA;--,ioIdCuentaContableSecundaria -- NO VA&#xD;&#xA;&#xD;&#xA;--,ioIdMoneda -- NO VA&#xD;&#xA;--,ioIdProducto -- NO VA&#xD;&#xA;&#xD;&#xA;--,ioIdAgenciaOperacion -- NO VA&#xD;&#xA;--,ioIdTipoTrasaccion -- NO VA&#xD;&#xA;--,ioIdConstanteOperacion -- NO VA&#xD;&#xA;--,ioNumeroOperacion=CONVERT(varchar(20), DecryptByKey(ioNumeroOperacion)) -- NO VA&#xD;&#xA;&#xD;&#xA;,ioMontoIngreso=sum(ioMontoIngreso)&#xD;&#xA;,ioSaldoAcumuladoMensualFiscal=sum(ioSaldoAcumuladoMensualFiscal)&#xD;&#xA;,ioSaldoAcumuladoAnual=sum(ioSaldoAcumuladoAnual)&#xD;&#xA;,ioMontoCostoTrx=sum(ioMontoCostoTrx)&#xD;&#xA;,ioSaldoAcumuladoAnualCostoTrx=sum(ioSaldoAcumuladoAnualCostoTrx)&#xD;&#xA;,ioSaldoAcumuladoMesCostoTrxFiscal=sum(ioSaldoAcumuladoMesCostoTrxFiscal)&#xD;&#xA;,ioSaldoInteresRealFiscal=sum(ioSaldoInteresRealFiscal)&#xD;&#xA;,ioSaldoInteresRealAcumuladoAnualFiscal=sum(ioSaldoInteresRealAcumuladoAnualFiscal)&#xD;&#xA;,ioNumeroTransaccionesOperacionMesFiscal=sum(ioNumeroTransaccionesOperacionMesFiscal)&#xD;&#xA;,ioNumeroTransaccionesOperacionAnual=sum(ioNumeroTransaccionesOperacionAnual)&#xD;&#xA;,ioNumeroTransaccionesOperacion=sum(ioNumeroTransaccionesOperacion)&#xD;&#xA;,ioConteoNumeroOperacionAnual=sum(ioConteoNumeroOperacionAnual)&#xD;&#xA;,ioCostoOperacionAnual=sum(ioCostoOperacionAnual)&#xD;&#xA;,ioIdCuentaContableVolumen&#xD;&#xA;--,ioFacturacionAnual=isnull(ioFacturacionAnual,0.00) -- NO VA&#xD;&#xA;from DWHIngresoOperacion iop&#xD;&#xA;inner join #Fecha fe on iop.ioIdFecha=fe.feIdFecha&#xD;&#xA;group by ioIdFecha,ioIdCliente&#xD;&#xA;,ioIdCuentaContablePrincipal,ioIdCuentaContableVolumen&#xD;&#xA;&#xD;&#xA;union all&#xD;&#xA;&#xD;&#xA;select&#xD;&#xA; ioIdFecha=ct.ctIdFechaTransaccion&#xD;&#xA;,ioIdCliente=ct.ctIdClientePropietarioOperacion&#xD;&#xA;,ioIdCuentaContablePrincipal=ct.IdCuentaContable&#xD;&#xA;&#xD;&#xA;--,ioIdCuentaContableSecundaria=-1&#xD;&#xA;&#xD;&#xA;--,ioIdMoneda=@IdMoneda&#xD;&#xA;--,ioIdProducto=-1&#xD;&#xA;&#xD;&#xA;--,ioIdAgenciaOperacion=-1&#xD;&#xA;--,ioIdTipoTrasaccion=-1&#xD;&#xA;--,ioIdConstanteOperacion=-1&#xD;&#xA;--,ioNumeroOperacion=NumeroOperacion&#xD;&#xA;&#xD;&#xA;,ioMontoIngreso=0&#xD;&#xA;,ioSaldoAcumuladoMensualFiscal=0&#xD;&#xA;,ioSaldoAcumuladoAnual=0&#xD;&#xA;,ioMontoCostoTrx=0&#xD;&#xA;,ioSaldoAcumuladoAnualCostoTrx=sum( ct.NumeroTransaccionesAnual*isnull(ccCostoOperativo,0) )&#xD;&#xA;,ioSaldoAcumuladoMesCostoTrxFiscal=sum( ct.NumeroTransaccionesMes*isnull(ccCostoOperativo,0) )&#xD;&#xA;,ioSaldoInteresRealFiscal=0&#xD;&#xA;,ioSaldoInteresRealAcumuladoAnualFiscal=0&#xD;&#xA;,ioNumeroTransaccionesOperacionMesFiscal=sum( ct.NumeroTransaccionesMes )&#xD;&#xA;,ioNumeroTransaccionesOperacionAnual=sum( ct.NumeroTransaccionesAnual )&#xD;&#xA;,ioNumeroTransaccionesOperacion=0&#xD;&#xA;,ioConteoNumeroOperacionAnual=0&#xD;&#xA;,ioCostoOperacionAnual=0&#xD;&#xA;,ioIdCuentaContableVolumen=-1&#xD;&#xA;--,ioFacturacionAnual=0&#xD;&#xA;from #IndicadoresSaldos ct&#xD;&#xA;inner join DWDCuentaContable cc on ct.IdCuentaContable=cc.ccIdCuentaContable&#xD;&#xA;where (abs(NumeroTransaccionesMes)+abs(NumeroTransaccionesAnual))!=0&#xD;&#xA;group by ct.ctIdFechaTransaccion&#xD;&#xA;,ct.ctIdClientePropietarioOperacion,ct.IdCuentaContable&#xD;&#xA;&#xD;&#xA;if OBJECT_ID('tempdb..#Pasivo') is not null begin drop table #Pasivo end&#xD;&#xA;if OBJECT_ID('tempdb..#Tarjeta') is not null begin drop table #Tarjeta end&#xD;&#xA;if OBJECT_ID('tempdb..#IndicadoresSaldos') is not null begin drop table #IndicadoresSaldos end&#xD;&#xA;if OBJECT_ID('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="ioIdFecha" msprop:DbColumnName="ioIdFecha" msprop:FriendlyName="ioIdFecha" type="xs:int" minOccurs="0" />
                          <xs:element name="ioIdCliente" msprop:DbColumnName="ioIdCliente" msprop:FriendlyName="ioIdCliente" type="xs:int" minOccurs="0" />
                          <xs:element name="ioIdCuentaContablePrincipal" msprop:DbColumnName="ioIdCuentaContablePrincipal" msprop:FriendlyName="ioIdCuentaContablePrincipal" type="xs:int" minOccurs="0" />
                          <xs:element name="ioMontoIngreso" msprop:DbColumnName="ioMontoIngreso" msprop:FriendlyName="ioMontoIngreso" type="xs:double" minOccurs="0" />
                          <xs:element name="ioSaldoAcumuladoMensualFiscal" msprop:DbColumnName="ioSaldoAcumuladoMensualFiscal" msprop:FriendlyName="ioSaldoAcumuladoMensualFiscal" type="xs:double" minOccurs="0" />
                          <xs:element name="ioSaldoAcumuladoAnual" msprop:DbColumnName="ioSaldoAcumuladoAnual" msprop:FriendlyName="ioSaldoAcumuladoAnual" type="xs:double" minOccurs="0" />
                          <xs:element name="ioMontoCostoTrx" msprop:DbColumnName="ioMontoCostoTrx" msprop:FriendlyName="ioMontoCostoTrx" type="xs:double" minOccurs="0" />
                          <xs:element name="ioSaldoAcumuladoAnualCostoTrx" msprop:DbColumnName="ioSaldoAcumuladoAnualCostoTrx" msprop:FriendlyName="ioSaldoAcumuladoAnualCostoTrx" type="xs:double" minOccurs="0" />
                          <xs:element name="ioSaldoAcumuladoMesCostoTrxFiscal" msprop:DbColumnName="ioSaldoAcumuladoMesCostoTrxFiscal" msprop:FriendlyName="ioSaldoAcumuladoMesCostoTrxFiscal" type="xs:double" minOccurs="0" />
                          <xs:element name="ioSaldoInteresRealFiscal" msprop:DbColumnName="ioSaldoInteresRealFiscal" msprop:FriendlyName="ioSaldoInteresRealFiscal" type="xs:double" minOccurs="0" />
                          <xs:element name="ioSaldoInteresRealAcumuladoAnualFiscal" msprop:DbColumnName="ioSaldoInteresRealAcumuladoAnualFiscal" msprop:FriendlyName="ioSaldoInteresRealAcumuladoAnualFiscal" type="xs:double" minOccurs="0" />
                          <xs:element name="ioNumeroTransaccionesOperacionMesFiscal" msprop:DbColumnName="ioNumeroTransaccionesOperacionMesFiscal" msprop:FriendlyName="ioNumeroTransaccionesOperacionMesFiscal" type="xs:int" minOccurs="0" />
                          <xs:element name="ioNumeroTransaccionesOperacionAnual" msprop:DbColumnName="ioNumeroTransaccionesOperacionAnual" msprop:FriendlyName="ioNumeroTransaccionesOperacionAnual" type="xs:int" minOccurs="0" />
                          <xs:element name="ioNumeroTransaccionesOperacion" msprop:DbColumnName="ioNumeroTransaccionesOperacion" msprop:FriendlyName="ioNumeroTransaccionesOperacion" type="xs:int" minOccurs="0" />
                          <xs:element name="ioConteoNumeroOperacionAnual" msprop:DbColumnName="ioConteoNumeroOperacionAnual" msprop:FriendlyName="ioConteoNumeroOperacionAnual" type="xs:int" minOccurs="0" />
                          <xs:element name="ioCostoOperacionAnual" msprop:DbColumnName="ioCostoOperacionAnual" msprop:FriendlyName="ioCostoOperacionAnual" type="xs:double" minOccurs="0" />
                          <xs:element name="ioIdCuentaContableVolumen" msprop:DbColumnName="ioIdCuentaContableVolumen" msprop:FriendlyName="ioIdCuentaContableVolumen" type="xs:int" minOccurs="0" />
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b" msdata:Locale="" msprop:IsLogical="True" msprop:FriendlyName="DWDMoneda" msprop:DbSchemaName="dbo" msprop:DbTableName="DWDMoneda" msprop:TableType="View" msprop:Description="DWDMoneda" msprop:QueryDefinition=" SELECT [dbo].[DWDMoneda].* FROM [dbo].[DWDMoneda] ">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="moIdMoneda" msprop:DbColumnName="moIdMoneda" msprop:FriendlyName="moIdMoneda" type="xs:long" />
                          <xs:element name="moCodigoMoneda" msprop:DbColumnName="moCodigoMoneda" msprop:FriendlyName="moCodigoMoneda" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="moMoneda" msprop:DbColumnName="moMoneda" msprop:FriendlyName="moMoneda" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791" msdata:Locale="" msprop:IsLogical="True" msprop:FriendlyName="DWDProducto" msprop:DbSchemaName="dbo" msprop:DbTableName="DWDProducto" msprop:TableType="View" msprop:Description="DWDProducto" msprop:QueryDefinition=" SELECT [dbo].[DWDProducto].[prIdProducto],[dbo].[DWDProducto].[prCodigoProducto],[dbo].[DWDProducto].[prProducto],[dbo].[DWDProducto].[prSubGrupo],[dbo].[DWDProducto].[prGrupo],[dbo].[DWDProducto].[prFamiliaProducto],[dbo].[DWDProducto].[prVehiculo],[dbo].[DWDProducto].[prCodigoIndicador],[dbo].[DWDProducto].[prOrdenN1],[dbo].[DWDProducto].[prOrdenN2],[dbo].[DWDProducto].[prOrdenN3],[dbo].[DWDProducto].[prDescripcionProducto],[dbo].[DWDProducto].[prTipoProductoAUMS] FROM [dbo].[DWDProducto] ">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="prIdProducto" msprop:DbColumnName="prIdProducto" msprop:FriendlyName="prIdProducto" type="xs:long" />
                          <xs:element name="prCodigoProducto" msprop:DbColumnName="prCodigoProducto" msprop:FriendlyName="prCodigoProducto" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="prProducto" msprop:DbColumnName="prProducto" msprop:FriendlyName="prProducto" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="prSubGrupo" msprop:DbColumnName="prSubGrupo" msprop:FriendlyName="prSubGrupo" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="prGrupo" msprop:DbColumnName="prGrupo" msprop:FriendlyName="prGrupo" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="prFamiliaProducto" msprop:DbColumnName="prFamiliaProducto" msprop:FriendlyName="prFamiliaProducto" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="prVehiculo" msprop:DbColumnName="prVehiculo" msprop:FriendlyName="prVehiculo" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="prCodigoIndicador" msprop:DbColumnName="prCodigoIndicador" msprop:FriendlyName="prCodigoIndicador" type="xs:long" minOccurs="0" />
                          <xs:element name="prOrdenN1" msprop:DbColumnName="prOrdenN1" msprop:FriendlyName="prOrdenN1" type="xs:long" minOccurs="0" />
                          <xs:element name="prOrdenN2" msprop:DbColumnName="prOrdenN2" msprop:FriendlyName="prOrdenN2" type="xs:long" minOccurs="0" />
                          <xs:element name="prOrdenN3" msprop:DbColumnName="prOrdenN3" msprop:FriendlyName="prOrdenN3" type="xs:long" minOccurs="0" />
                          <xs:element name="prDescripcionProducto" msprop:DbColumnName="prDescripcionProducto" msprop:FriendlyName="prDescripcionProducto" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="prTipoProductoAUMS" msprop:DbColumnName="prTipoProductoAUMS" msprop:FriendlyName="prTipoProductoAUMS" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="DWHPerdidaEsperadaPortafolioGlobal_1f156d0f-8f98-4d03-96bb-d254ce7134fa" msdata:Locale="" msprop:IsLogical="True" msprop:FriendlyName="DWHPerdidaEsperadaPortafolioGlobal" msprop:DbSchemaName="dbo" msprop:DbTableName="DWHPerdidaEsperadaPortafolioGlobal" msprop:TableType="View" msprop:Description="DWHPerdidaEsperadaPortafolioGlobal" msprop:QueryDefinition="set nocount on&#xD;&#xA;&#xD;&#xA;declare @FechaMesAnt int, @FechaHaceDosAnios int&#xD;&#xA;&#xD;&#xA;-- Fecha hace dos años corrido --&#xD;&#xA;select @FechaHaceDosAnios=feIdFechaCierreAnioAnt from DWDFecha where feHaceUnAnio=1 &#xD;&#xA;&#xD;&#xA;-- Fecha Mes Anterior --&#xD;&#xA;select @FechaMesAnt=feIdFecha from DWDFecha where feMesAnterior=1&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;/*---- Fecha ----*/&#xD;&#xA;&#xD;&#xA;if object_id('tempdb..#DWDFecha') is not null begin drop table #DWDFecha end &#xD;&#xA;&#xD;&#xA;select feIdFecha&#xD;&#xA;into #DWDFecha&#xD;&#xA;from DWDFecha&#xD;&#xA;where feIdFecha between @FechaHaceDosAnios and @FechaMesAnt&#xD;&#xA;and fecierremes=1&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;OPEN SYMMETRIC KEY ClaveMIS02&#xD;&#xA;DECRYPTION BY CERTIFICATE Certi01&#xD;&#xA;&#xD;&#xA;select&#xD;&#xA; peIdFecha&#xD;&#xA;,peIdCliente&#xD;&#xA;,peNumeroOperacion=CONVERT(varchar(25), DecryptByKey(peNumeroOperacion))&#xD;&#xA;,peProbabilidadIncumplimientoPD&#xD;&#xA;,peSeveridadLGD&#xD;&#xA;,peExposicionIncumplimientoEAD&#xD;&#xA;,pePerdidaEsperadaPE&#xD;&#xA;,peCalculoOperacionPEMes&#xD;&#xA;,peValorOperacionPETrimestral&#xD;&#xA;,peValorOperacionPESemestral&#xD;&#xA;,peValorOperacionPEAnual&#xD;&#xA;&#xD;&#xA;--,pePerdidaEsperadaPEAnual&#xD;&#xA;--,peExposicionIncumplimientoEADAnual&#xD;&#xA;--,peValorPorcentajePE&#xD;&#xA;&#xD;&#xA;from DWHPerdidaEsperadaPortafolioGlobal pe&#xD;&#xA;inner join #DWDFecha fe on pe.peIdFecha=fe.feIdFecha&#xD;&#xA;&#xD;&#xA;CLOSE SYMMETRIC KEY ClaveMIS02">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="peIdFecha" msprop:DbColumnName="peIdFecha" msprop:FriendlyName="peIdFecha" type="xs:long" minOccurs="0" />
                          <xs:element name="peIdCliente" msprop:DbColumnName="peIdCliente" msprop:FriendlyName="peIdCliente" type="xs:long" minOccurs="0" />
                          <xs:element name="peProbabilidadIncumplimientoPD" msprop:DbColumnName="peProbabilidadIncumplimientoPD" msprop:FriendlyName="peProbabilidadIncumplimientoPD" type="xs:double" minOccurs="0" />
                          <xs:element name="peSeveridadLGD" msprop:DbColumnName="peSeveridadLGD" msprop:FriendlyName="peSeveridadLGD" type="xs:double" minOccurs="0" />
                          <xs:element name="peExposicionIncumplimientoEAD" msprop:DbColumnName="peExposicionIncumplimientoEAD" msprop:FriendlyName="peExposicionIncumplimientoEAD" type="xs:double" minOccurs="0" />
                          <xs:element name="pePerdidaEsperadaPE" msprop:DbColumnName="pePerdidaEsperadaPE" msprop:FriendlyName="pePerdidaEsperadaPE" type="xs:double" minOccurs="0" />
                          <xs:element name="peNumeroOperacion" msprop:DbColumnName="peNumeroOperacion" msprop:FriendlyName="peNumeroOperacion" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="peCalculoOperacionPEMes" msprop:DbColumnName="peCalculoOperacionPEMes" msprop:FriendlyName="peCalculoOperacionPEMes" type="xs:double" minOccurs="0" />
                          <xs:element name="peValorOperacionPETrimestral" msprop:DbColumnName="peValorOperacionPETrimestral" msprop:FriendlyName="peValorOperacionPETrimestral" type="xs:double" minOccurs="0" />
                          <xs:element name="peValorOperacionPESemestral" msprop:DbColumnName="peValorOperacionPESemestral" msprop:FriendlyName="peValorOperacionPESemestral" type="xs:double" minOccurs="0" />
                          <xs:element name="peValorOperacionPEAnual" msprop:DbColumnName="peValorOperacionPEAnual" msprop:FriendlyName="peValorOperacionPEAnual" type="xs:double" minOccurs="0" />
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="DWDPerfilesAccesoMonitores_fc0341c0-7ee0-4df5-b1e4-229c86a91e11" msdata:Locale="" msprop:IsLogical="True" msprop:FriendlyName="DWDPerfilesAccesoMonitores" msprop:DbTableName="DWDPerfilesAccesoMonitores" msprop:TableType="View" msprop:Description="DWDPerfilesAccesoMonitores" msprop:QueryDefinition="select * from DWDPerfilesAccesoMonitores">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="pamIdPerfilAcceso" msprop:DbColumnName="pamIdPerfilAcceso" msprop:FriendlyName="pamIdPerfilAcceso" type="xs:int" minOccurs="0" />
                          <xs:element name="pamBinUsuario" msprop:DbColumnName="pamBinUsuario" msprop:FriendlyName="pamBinUsuario" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="pamBinPerfil" msprop:DbColumnName="pamBinPerfil" msprop:FriendlyName="pamBinPerfil" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="pamIdAsesor" msprop:DbColumnName="pamIdAsesor" msprop:FriendlyName="pamIdAsesor" type="xs:int" minOccurs="0" />
                          <xs:element name="pamBinUsuarioPadre" msprop:DbColumnName="pamBinUsuarioPadre" msprop:FriendlyName="pamBinUsuarioPadre" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="pamRegion" msprop:DbColumnName="pamRegion" msprop:FriendlyName="pamRegion" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="pamSubregion" msprop:DbColumnName="pamSubregion" msprop:FriendlyName="pamSubregion" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="pamDescripcionPerfil" msprop:DbColumnName="pamDescripcionPerfil" msprop:FriendlyName="pamDescripcionPerfil" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="DWDCuentaContableIngresos_37d664e0-0005-449b-b05c-64f27051b92a" msdata:Locale="" msprop:IsLogical="True" msprop:FriendlyName="DWDCuentaContableIngresos" msprop:DbTableName="DWDCuentaContableIngresos" msprop:TableType="View" msprop:Description="DWDCuentaContableIngresos" msprop:QueryDefinition="set nocount on&#xD;&#xA;&#xD;&#xA;OPEN SYMMETRIC KEY ClaveMIS02&#xD;&#xA;DECRYPTION BY CERTIFICATE Certi01&#xD;&#xA;&#xD;&#xA;SELECT DISTINCT &#xD;&#xA;  cc.ccIdCuentaContable,&#xD;&#xA;  ccCodigoNivel6=CONVERT(varchar(12), DecryptByKey(cc.ccCodigoNivel6)),&#xD;&#xA;  cc.ccCodigoMoneda,&#xD;&#xA;  cc.ccCodigoIndicador,  &#xD;&#xA;  &#xD;&#xA;  cpCalIndicadorNivel1=case when cp.indicadorNivel1 is null then cr.CpCodigoIndicadorN2 else cp.indicadorNivel1 end, -- se tiene los codigos de rentabilidad de nivel unon para el filtro en el dataset&#xD;&#xA;  cpCalIndicadorNivel2=cp.indicadorNivel2, &#xD;&#xA;  --cpCalIndicadorNivel3=cp.indicadorNivel3, -- Se comento porque la informacion ya tiene la columna cc.ccCodigoIndicador&#xD;&#xA;&#xD;&#xA;  ccCalProductoNivel1= case when cp.ProductoNivel1 is null then cc.ccFamiliaProducto else cp.ProductoNivel1  end,&#xD;&#xA;  ccCalProductoNivel2= case when cp.ProductoNivel2 is null then cc.ccGrupo else cp.ProductoNivel2  end,&#xD;&#xA;&#xD;&#xA;  cp.CpEstadoProducto,&#xD;&#xA;  --cp.CpOrden, Comente porque no se usa&#xD;&#xA;  cc.ccAgrupacionContableNivel2,&#xD;&#xA;   &#xD;&#xA;  ccSubGrupo,&#xD;&#xA;  ccTarifaTransaccion=ccCostoOperativo,&#xD;&#xA;&#xD;&#xA;  ccCalCodigoAgrupacionRentabilidaN1=cr.CpCodigoIndicadorN2,&#xD;&#xA;  ccCalAgrupacionRentabilidaN1=ltrim(rtrim(upper(CpProducto))),&#xD;&#xA;  ccCalCodigoTipoIngresoN2=cr.CpCodigoIndicadorN3,&#xD;&#xA;  ccCalTipoIngresoN2=ltrim(rtrim(upper(ccTipoIngreso))),&#xD;&#xA;  ccCalDescripcionNivel6N3= case when CONVERT(varchar(150), DecryptByKey(cc.ccDescripcionNivel6)) like '%SIN%DESCRIPCION%NIVEL%' then 'SIN DESCRIPCION NIVEL' &#xD;&#xA;                            else substring(CONVERT(varchar(150), DecryptByKey(cc.ccDescripcionNivel6)),14,100) end,&#xD;&#xA;&#xD;&#xA;  ccCodigoIndicadorRentabilidad,&#xD;&#xA;  ccCalAgrupacionTarifaBasica=isnull(cr.CpProductoN4,'SIN AGRUPACION'),&#xD;&#xA;&#xD;&#xA;  ccAgrupacionTributario,&#xD;&#xA;  ccCuentaAdquirenciaTC=case when ccCodigoIndicadorRentabilidad=40 then 1 else 0 end,ccCalCodigoAgrupacionRentabilidaN4=cr.CpCodigoIndicadorN4&#xD;&#xA;  &#xD;&#xA;  --drop table #DWDCuentaContable&#xD;&#xA;  --into #DWDCuentaContable&#xD;&#xA;&#xD;&#xA;FROM DWDCuentaContable cc&#xD;&#xA;left outer join&#xD;&#xA;( &#xD;&#xA;    SELECT DISTINCT &#xD;&#xA;    p.CpCodigoIndicador indicadorNivel1,p1.CpCodigoIndicador indicadorNivel2,p2.CpCodigoIndicador indicadorNivel3,&#xD;&#xA;    p.CpProducto ProductoNivel1,&#xD;&#xA;    ProductoNivel2=case when p1.CpCodigoIndicador=124  then 'Tarjeta de Credito' else p1.CpProducto end,&#xD;&#xA;    p2.CpEstadoProducto,&#xD;&#xA;    isnull(p1.CpOrden,1) CpOrden&#xD;&#xA;    FROM DWDClasificacionProductos p&#xD;&#xA;    join DWDClasificacionProductos p1 ON p1.CpPadre=p.CpCodigoIndicador&#xD;&#xA;    join DWDClasificacionProductos p2 ON p2.CpPadre=p1.CpCodigoIndicador&#xD;&#xA;    WHERE p.CpCodigoIndicador in (1,2,3,72,80) -- Comente los indicadores 32,28 ; 72 (ficticias de ingresos); 80 (Portafolio)&#xD;&#xA;    and  p.CpNivel=1 and p1.CpNivel=2 and p2.CpNivel=3&#xD;&#xA;    and p1.CpCodigoIndicador not in (143,144) -- Se excluye estas agrupaciones que no pertenecen a captaciones EA&#xD;&#xA;&#xD;&#xA;) cp ON ccCodigoIndicador=cp.indicadorNivel3&#xD;&#xA;left outer join&#xD;&#xA;(&#xD;&#xA;   select distinct&#xD;&#xA;   CpCodigoIndicadorN4=n4.CpCodigoIndicador,&#xD;&#xA;   CpProductoN4=case when n3.CpCodigoIndicador between 460 and 465 then n4.CpProducto else 'SIN AGRUPACION' end, -- Solo se obtiene las agrupaciones de tarifa básica / Conteo Tributario&#xD;&#xA;   CpCodigoIndicadorN2=n2.CpCodigoIndicador,&#xD;&#xA;   CpCodigoIndicadorN3=n3.CpCodigoIndicador,&#xD;&#xA;   n2.CpProducto&#xD;&#xA;   from DWDClasificacionProductos n1&#xD;&#xA;   inner join DWDClasificacionProductos n2 on n2.CpPadre=n1.CpCodigoIndicador&#xD;&#xA;   inner join DWDClasificacionProductos n3 on n3.CpPadre=n2.CpCodigoIndicador&#xD;&#xA;   inner join DWDClasificacionProductos n4 on n4.CpPadre=n3.CpCodigoIndicador&#xD;&#xA;   where n1.CpCodigoIndicador=71 -- Cuentas de rentabilidad&#xD;&#xA;   and n1.CpNivel=1 and n2.CpNivel=2 and n3.CpNivel=3 and n4.CpNivel=4&#xD;&#xA;) as cr on cc.ccCodigoIndicadorRentabilidad=cr.CpCodigoIndicadorN4&#xD;&#xA;&#xD;&#xA;CLOSE SYMMETRIC KEY ClaveMIS02">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="ccIdCuentaContable" msprop:DbColumnName="ccIdCuentaContable" msprop:FriendlyName="ccIdCuentaContable" type="xs:int" minOccurs="0" />
                          <xs:element name="ccCodigoNivel6" msprop:DbColumnName="ccCodigoNivel6" msprop:FriendlyName="ccCodigoNivel6" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccCodigoMoneda" msprop:DbColumnName="ccCodigoMoneda" msprop:FriendlyName="ccCodigoMoneda" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccCodigoIndicador" msprop:DbColumnName="ccCodigoIndicador" msprop:FriendlyName="ccCodigoIndicador" type="xs:int" minOccurs="0" />
                          <xs:element name="cpCalIndicadorNivel1" msprop:DbColumnName="cpCalIndicadorNivel1" msprop:FriendlyName="cpCalIndicadorNivel1" type="xs:int" minOccurs="0" />
                          <xs:element name="cpCalIndicadorNivel2" msprop:DbColumnName="cpCalIndicadorNivel2" msprop:FriendlyName="cpCalIndicadorNivel2" type="xs:int" minOccurs="0" />
                          <xs:element name="ccCalProductoNivel1" msprop:DbColumnName="ccCalProductoNivel1" msprop:FriendlyName="ccCalProductoNivel1" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccCalProductoNivel2" msprop:DbColumnName="ccCalProductoNivel2" msprop:FriendlyName="ccCalProductoNivel2" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="CpEstadoProducto" msprop:DbColumnName="CpEstadoProducto" msprop:FriendlyName="CpEstadoProducto" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccAgrupacionContableNivel2" msprop:DbColumnName="ccAgrupacionContableNivel2" msprop:FriendlyName="ccAgrupacionContableNivel2" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccSubGrupo" msprop:DbColumnName="ccSubGrupo" msprop:FriendlyName="ccSubGrupo" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccTarifaTransaccion" msprop:DbColumnName="ccTarifaTransaccion" msprop:FriendlyName="ccTarifaTransaccion" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccCalCodigoAgrupacionRentabilidaN1" msprop:DbColumnName="ccCalCodigoAgrupacionRentabilidaN1" msprop:FriendlyName="ccCalCodigoAgrupacionRentabilidaN1" type="xs:int" minOccurs="0" />
                          <xs:element name="ccCalAgrupacionRentabilidaN1" msprop:DbColumnName="ccCalAgrupacionRentabilidaN1" msprop:FriendlyName="ccCalAgrupacionRentabilidaN1" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccCalCodigoTipoIngresoN2" msprop:DbColumnName="ccCalCodigoTipoIngresoN2" msprop:FriendlyName="ccCalCodigoTipoIngresoN2" type="xs:int" minOccurs="0" />
                          <xs:element name="ccCalTipoIngresoN2" msprop:DbColumnName="ccCalTipoIngresoN2" msprop:FriendlyName="ccCalTipoIngresoN2" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccCalDescripcionNivel6N3" msprop:DbColumnName="ccCalDescripcionNivel6N3" msprop:FriendlyName="ccCalDescripcionNivel6N3" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccAgrupacionTributario" msprop:DbColumnName="ccAgrupacionTributario" msprop:FriendlyName="ccAgrupacionTributario" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="ccCuentaAdquirenciaTC" msprop:DbColumnName="ccCuentaAdquirenciaTC" msprop:FriendlyName="ccCuentaAdquirenciaTC" type="xs:int" minOccurs="0" />
                          <xs:element name="ccCalCodigoAgrupacionRentabilidaN4" msprop:DbColumnName="ccCalCodigoAgrupacionRentabilidaN4" msprop:FriendlyName="ccCalCodigoAgrupacionRentabilidaN4" type="xs:int" minOccurs="0" />
                          <xs:element name="ccCodigoIndicadorRentabilidad" msprop:DbColumnName="ccCodigoIndicadorRentabilidad" msprop:FriendlyName="ccCodigoIndicadorRentabilidad" type="xs:int" minOccurs="0" />
                          <xs:element name="ccCalAgrupacionTarifaBasica" msprop:DbColumnName="ccCalAgrupacionTarifaBasica" msprop:FriendlyName="ccCalAgrupacionTarifaBasica" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="ParametrosJeraquia_dfb498cf-22c2-47ec-9736-be8fc0519105" msdata:Locale="" msprop:IsLogical="True" msprop:FriendlyName="ParametrosJerarquia" msprop:DbTableName="ParametrosJeraquia" msprop:TableType="View" msprop:Description="ParametrosJeraquia" msprop:QueryDefinition="set nocount on &#xD;&#xA;&#xD;&#xA;declare @RutaPortal varchar(50)&#xD;&#xA;&#xD;&#xA;select @RutaPortal=&#xD;&#xA;case when copTipoConstante like '%mis.bcointernacional%' then 'ReportServer_MIS/Pages/ReportViewer.aspx?' -- Produccion&#xD;&#xA;     else 'ReportServer/Pages/ReportViewer.aspx?' end&#xD;&#xA;from DWDConstanteOperacion&#xD;&#xA;where copCodigoConstante = -2&#xD;&#xA;&#xD;&#xA;if object_id('tempdb..#ConstanteOperacion') is not null begin drop table #ConstanteOperacion end&#xD;&#xA;&#xD;&#xA;select&#xD;&#xA;copIdConstante=copIdConstante*100,&#xD;&#xA;concat(copTipoConstante,@RutaPortal, '/Monitores/MonitorRentabilidad/') as copServer,&#xD;&#xA;cast('RENTABILIDAD' as varchar(20)) as Monitor&#xD;&#xA;into #ConstanteOperacion&#xD;&#xA;from DWDConstanteOperacion&#xD;&#xA;where copCodigoConstante = -2&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;select&#xD;&#xA; CodigoCanal=jeCodigoN1&#xD;&#xA;,Canal=jeNivel1&#xD;&#xA;,CodigoNivel1=jeCodigoN2&#xD;&#xA;,Nivel1=jeNivel2&#xD;&#xA;,CodigoNivel2=jeCodigoN3&#xD;&#xA;,Nivel2=lower( ltrim(rtrim(replace(replace(replace(replace(replace(jeNivel3,'á','a'),'é','e'),'í','i'),'ó','o'),'ú','u'))) )&#xD;&#xA;from DWDJerarquia&#xD;&#xA;where jeMonitor='Rentabilidad'&#xD;&#xA;union &#xD;&#xA;select &#xD;&#xA; CodigoCanal=copIdConstante&#xD;&#xA;,Canal=Monitor&#xD;&#xA;,CodigoNivel1=copIdConstante&#xD;&#xA;,Nivel1=copServer&#xD;&#xA;,CodigoNivel2=copIdConstante &#xD;&#xA;,Nivel2=Monitor&#xD;&#xA;from #ConstanteOperacion&#xD;&#xA;union &#xD;&#xA;select &#xD;&#xA; CodigoCanal=copIdConstante&#xD;&#xA;,Canal='PARAMETRORENTABILIDAD'&#xD;&#xA;,CodigoNivel1=copIdConstante&#xD;&#xA;,Nivel1=copTipoConstante&#xD;&#xA;,CodigoNivel2=copIdConstante &#xD;&#xA;,Nivel2='PARAMETRORENTABILIDAD'&#xD;&#xA;from DWDConstanteOperacion&#xD;&#xA;where copIdConstante=-3">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="CodigoCanal" msprop:DbColumnName="CodigoCanal" msprop:FriendlyName="CodigoCanal" type="xs:int" minOccurs="0" />
                          <xs:element name="Canal" msprop:DbColumnName="Canal" msprop:FriendlyName="Canal" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="CodigoNivel1" msprop:DbColumnName="CodigoNivel1" msprop:FriendlyName="CodigoNivel1" type="xs:int" minOccurs="0" />
                          <xs:element name="Nivel1" msprop:DbColumnName="Nivel1" msprop:FriendlyName="Nivel1" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="CodigoNivel2" msprop:DbColumnName="CodigoNivel2" msprop:FriendlyName="CodigoNivel2" type="xs:int" minOccurs="0" />
                          <xs:element name="Nivel2" msprop:DbColumnName="Nivel2" msprop:FriendlyName="Nivel2" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="DWDGrupoCliente_e2b5b028-636b-4fd2-9569-2e48f1dc81da" msdata:Locale="" msprop:IsLogical="True" msprop:FriendlyName="DWDGrupoCliente" msprop:DbTableName="DWDGrupoCliente" msprop:TableType="View" msprop:Description="DWDGrupoCliente" msprop:QueryDefinition="set nocount on&#xD;&#xA;&#xD;&#xA;if object_id('tempdb..#GrupoCliente') is not null begin drop table #GrupoCliente end&#xD;&#xA;&#xD;&#xA;select &#xD;&#xA; Bandera=ROW_NUMBER() over (partition by grCodigoGrupo order by grIdentificacionGrupo, grNombreGrupo )&#xD;&#xA;,*&#xD;&#xA;into #GrupoCliente&#xD;&#xA;from&#xD;&#xA;(&#xD;&#xA; SELECT distinct&#xD;&#xA;  grCodigoGrupo = clCodigoGrupo&#xD;&#xA; ,grIdentificacionGrupo= clGrupoSBS&#xD;&#xA; ,grNombreGrupo= clGrupo&#xD;&#xA; from DWDCliente&#xD;&#xA; where clMaestroGrupo = 1 and clCodigoGrupo is not null&#xD;&#xA;) as t&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;select&#xD;&#xA; grCodigoGrupo&#xD;&#xA;,grIdentificacionGrupo&#xD;&#xA;,grNombreGrupo&#xD;&#xA;,grCodigoAsesor = '-1' &#xD;&#xA;,grCodigoAgencia= '-1'&#xD;&#xA;,grCodigoAgrCanal = 'COR'--'-1'&#xD;&#xA;,grDescripcionCanal= 'Corporativo'--'-1'&#xD;&#xA;,grNombreAsesor= '-1'&#xD;&#xA;,grCodigoRegion= '-1'&#xD;&#xA;,grCodigoSubRegion= '-1'&#xD;&#xA;,grCodigoZona= '-1'&#xD;&#xA;,grCodigoRegional= '-1'&#xD;&#xA;from #GrupoCliente&#xD;&#xA;where Bandera=1  -- Se eliminan los registros duplicados&#xD;&#xA;union&#xD;&#xA;select -1,'0000000000000','GRUPO','NDI',0,'RED','Comercial','SIN NOMBRE',1,11,111,-1">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="grCodigoGrupo" msprop:DbColumnName="grCodigoGrupo" msprop:FriendlyName="grCodigoGrupo" type="xs:int" minOccurs="0" />
                          <xs:element name="grIdentificacionGrupo" msprop:DbColumnName="grIdentificacionGrupo" msprop:FriendlyName="grIdentificacionGrupo" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="grNombreGrupo" msprop:DbColumnName="grNombreGrupo" msprop:FriendlyName="grNombreGrupo" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="grCodigoAsesor" msprop:DbColumnName="grCodigoAsesor" msprop:FriendlyName="grCodigoAsesor" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="grCodigoAgencia" msprop:DbColumnName="grCodigoAgencia" msprop:FriendlyName="grCodigoAgencia" type="xs:int" minOccurs="0" />
                          <xs:element name="grCodigoAgrCanal" msprop:DbColumnName="grCodigoAgrCanal" msprop:FriendlyName="grCodigoAgrCanal" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="grDescripcionCanal" msprop:DbColumnName="grDescripcionCanal" msprop:FriendlyName="grDescripcionCanal" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="grNombreAsesor" msprop:DbColumnName="grNombreAsesor" msprop:FriendlyName="grNombreAsesor" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="grCodigoRegion" msprop:DbColumnName="grCodigoRegion" msprop:FriendlyName="grCodigoRegion" type="xs:int" minOccurs="0" />
                          <xs:element name="grCodigoSubRegion" msprop:DbColumnName="grCodigoSubRegion" msprop:FriendlyName="grCodigoSubRegion" type="xs:int" minOccurs="0" />
                          <xs:element name="grCodigoZona" msprop:DbColumnName="grCodigoZona" msprop:FriendlyName="grCodigoZona" type="xs:int" minOccurs="0" />
                          <xs:element name="grCodigoRegional" msprop:DbColumnName="grCodigoRegional" msprop:FriendlyName="grCodigoRegional" type="xs:int" minOccurs="0" />
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="DWDTarjeta_7799debf-5919-4928-ac41-1b9287f75718" msdata:Locale="" msprop:IsLogical="True" msprop:FriendlyName="DWDTarjeta" msprop:DbTableName="DWDTarjeta" msprop:TableType="View" msprop:Description="DWDTarjeta" msprop:QueryDefinition="OPEN SYMMETRIC KEY ClaveMIS02&#xD;&#xA;DECRYPTION BY CERTIFICATE Certi01&#xD;&#xA;&#xD;&#xA;select taIdTarjeta, taCuenta, taIdCliente, taIdEstadoTarjeta,&#xD;&#xA;convert(char(16), DecryptByKey(taNumeroTarjeta)) taNumeroTarjeta, &#xD;&#xA;taIndicadorEsPrincipal, taEstadoActivo, taBandera, taGama&#xD;&#xA;from DWDTarjeta&#xD;&#xA;order by taNumeroTarjeta&#xD;&#xA;&#xD;&#xA;CLOSE SYMMETRIC KEY ClaveMIS02">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="taIdTarjeta" msprop:DbColumnName="taIdTarjeta" msprop:FriendlyName="taIdTarjeta" type="xs:int" minOccurs="0" />
                          <xs:element name="taCuenta" msprop:DbColumnName="taCuenta" msprop:FriendlyName="taCuenta" type="xs:int" minOccurs="0" />
                          <xs:element name="taIdCliente" msprop:DbColumnName="taIdCliente" msprop:FriendlyName="taIdCliente" type="xs:int" minOccurs="0" />
                          <xs:element name="taIdEstadoTarjeta" msprop:DbColumnName="taIdEstadoTarjeta" msprop:FriendlyName="taIdEstadoTarjeta" type="xs:int" minOccurs="0" />
                          <xs:element name="taNumeroTarjeta" msprop:DbColumnName="taNumeroTarjeta" msprop:FriendlyName="taNumeroTarjeta" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="taIndicadorEsPrincipal" msprop:DbColumnName="taIndicadorEsPrincipal" msprop:FriendlyName="taIndicadorEsPrincipal" type="xs:boolean" minOccurs="0" />
                          <xs:element name="taEstadoActivo" msprop:DbColumnName="taEstadoActivo" msprop:FriendlyName="taEstadoActivo" type="xs:boolean" minOccurs="0" />
                          <xs:element name="taBandera" msprop:DbColumnName="taBandera" msprop:FriendlyName="taBandera" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="taGama" msprop:DbColumnName="taGama" msprop:FriendlyName="taGama" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="DWHPosicionConsolidadaTarjeta_11b8068f-d89d-4794-b8c1-456d8eb00b12" msdata:Locale="" msprop:IsLogical="True" msprop:FriendlyName="DWHPosicionConsolidadaTarjeta" msprop:DbTableName="DWHPosicionConsolidadaTarjeta" msprop:TableType="View" msprop:Description="DWHPosicionConsolidadaTarjeta" msprop:QueryDefinition="select pctIdFecha, &#xD;&#xA;pctIdTarjeta, &#xD;&#xA;(pctSaldoActual + pctSaldoDiferido) pctSaldoTotal, &#xD;&#xA;(pctCupoRotativo + pctCupoDiferido) pctCupoAsignado, &#xD;&#xA;case when pctSaldoActual &lt; 0 then abs(pctSaldoActual) else 0 end pctSaldoFavor&#xD;&#xA;from DWHPosicionConsolidadaTarjeta pos&#xD;&#xA;inner join DWDFecha fec on (pos.pctIdFecha = fec.feIdFecha and feMesAnterior = 1)">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="pctIdFecha" msprop:DbColumnName="pctIdFecha" msprop:FriendlyName="pctIdFecha" type="xs:int" minOccurs="0" />
                          <xs:element name="pctIdTarjeta" msprop:DbColumnName="pctIdTarjeta" msprop:FriendlyName="pctIdTarjeta" type="xs:int" minOccurs="0" />
                          <xs:element name="pctSaldoTotal" msprop:DbColumnName="pctSaldoTotal" msprop:FriendlyName="pctSaldoTotal" type="xs:double" minOccurs="0" />
                          <xs:element name="pctCupoAsignado" msprop:DbColumnName="pctCupoAsignado" msprop:FriendlyName="pctCupoAsignado" type="xs:double" minOccurs="0" />
                          <xs:element name="pctSaldoFavor" msprop:DbColumnName="pctSaldoFavor" msprop:FriendlyName="pctSaldoFavor" type="xs:double" minOccurs="0" />
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="DWDJerarquia2_7a3c35e2-3ac5-4f76-a160-13130032d261" msdata:Locale="" msprop:IsLogical="True" msprop:FriendlyName="DWDJerarquia" msprop:DbTableName="DWDJerarquia2" msprop:TableType="View" msprop:Description="DWDJerarquia2" msprop:QueryDefinition="/* Tabla Jerarquia */&#xD;&#xA;&#xD;&#xA;set nocount on&#xD;&#xA;&#xD;&#xA;if OBJECT_ID('[tempdb]..#DWDJerarquia') is not null&#xD;&#xA;begin &#xD;&#xA; drop table #DWDJerarquia&#xD;&#xA;end&#xD;&#xA;&#xD;&#xA;--*******************DWDJerarquia2&#xD;&#xA;select&#xD;&#xA; jeCodigoCanal=a.jeCodigoN1&#xD;&#xA;,jeCanal=upper(a.jeNivel1)&#xD;&#xA;,jeCodigoNivel1=a.jeCodigoN2&#xD;&#xA;,jeNivel1=a.jeNivel2&#xD;&#xA;,jeCodigoNivel2=a.jeCodigoN3&#xD;&#xA;,jeNivel2=lower( ltrim(rtrim(replace(replace(replace(replace(replace(a.jeNivel3,'á','a'),'é','e'),'í','i'),'ó','o'),'ú','u'))) )&#xD;&#xA;into #DWDJerarquia&#xD;&#xA;from DWDJerarquia a&#xD;&#xA;where a.jeMonitor='Rentabilidad'&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;/* Tabla Jerarquia */&#xD;&#xA;&#xD;&#xA;select &#xD;&#xA; jeCodigoCanal &#xD;&#xA;,jeCanal &#xD;&#xA;,jeCodigoNivel1 &#xD;&#xA;,jeNivel1 &#xD;&#xA;,jeCodigoNivel2 &#xD;&#xA;,jeNivel2&#xD;&#xA;,Filtro=&#xD;&#xA;case when ltrim(rtrim(jeNivel2))='Asesor' then '{([DWDAsesorOperacionCliente].[asCodigoAsesor].['&#xD;&#xA;     when ltrim(rtrim(jeNivel2))='Banco' then '[DWDCanalCliente].[caCodigoAgrupacionCanal].[' -- &gt;Se va a realizar un filtro de All&#xD;&#xA;     when ltrim(rtrim(jeNivel2))='Canal' then '[DWDCanalCliente].[caCodigoAgrupacionCanal].['&#xD;&#xA;     when ltrim(rtrim(jeNivel2))='Cliente' then '{([DWDCliente].[clCodigoCliente].['&#xD;&#xA;     when ltrim(rtrim(jeNivel2))='Oficina' then '{([DWDAgenciaOperacionCliente].[agCodigoAgencia].['&#xD;&#xA;     when ltrim(rtrim(jeNivel2)) in ('Región','Region') then '{([DWDAgenciaOperacionCliente].[agCodigoRegion].['&#xD;&#xA;     when ltrim(rtrim(jeNivel2))='Regional'then '{([DWDAsesorOperacionCliente].[asCodigoRegional].['&#xD;&#xA;  when ltrim(rtrim(jeNivel2))='Subregion'then '{([DWDAsesorOperacionCliente].[asCodigoSubregion].['&#xD;&#xA;     when ltrim(rtrim(jeNivel2))='Zona' then '{([DWDAgenciaOperacionCliente].[agCodigoZona].['&#xD;&#xA;  when ltrim(rtrim(jeNivel2))='Grupo' then '[DWDGrupoCliente].[grCodigoGrupo].['&#xD;&#xA;  else ''&#xD;&#xA;end&#xD;&#xA;,FiltroCanal=&#xD;&#xA;case &#xD;&#xA;     when ltrim(rtrim(jeNivel2))='Banco' then '' &#xD;&#xA;     when ltrim(rtrim(jeNivel2))='Canal' then ''&#xD;&#xA;  when ltrim(rtrim(jeNivel2))='Grupo' then ''&#xD;&#xA;     else '],[DWDCanalCliente].[caCodigoAgrupacionCanal].['  &#xD;&#xA;end&#xD;&#xA;&#xD;&#xA;from #DWDJerarquia">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="jeCodigoCanal" msprop:DbColumnName="jeCodigoCanal" msprop:FriendlyName="jeCodigoCanal" type="xs:int" minOccurs="0" />
                          <xs:element name="jeCanal" msprop:DbColumnName="jeCanal" msprop:FriendlyName="jeCanal" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="jeCodigoNivel1" msprop:DbColumnName="jeCodigoNivel1" msprop:FriendlyName="jeCodigoNivel1" type="xs:int" minOccurs="0" />
                          <xs:element name="jeNivel1" msprop:DbColumnName="jeNivel1" msprop:FriendlyName="jeNivel1" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="jeCodigoNivel2" msprop:DbColumnName="jeCodigoNivel2" msprop:FriendlyName="jeCodigoNivel2" type="xs:int" minOccurs="0" />
                          <xs:element name="jeNivel2" msprop:DbColumnName="jeNivel2" msprop:FriendlyName="jeNivel2" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="Filtro" msprop:DbColumnName="Filtro" msprop:FriendlyName="Filtro" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="FiltroCanal" msprop:DbColumnName="FiltroCanal" msprop:FriendlyName="FiltroCanal" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="DWHCuotaOperacion_d1d32615-f539-4073-8c55-42cb36bdbed5" msdata:Locale="" msprop:IsLogical="True" msprop:FriendlyName="DWHCuotaOperacion" msprop:DbTableName="DWHCuotaOperacion" msprop:TableType="View" msprop:Description="DWHCuotaOperacion" msprop:QueryDefinition="OPEN SYMMETRIC KEY ClaveMIS02&#xD;&#xA;DECRYPTION BY CERTIFICATE Certi01&#xD;&#xA;&#xD;&#xA;select &#xD;&#xA; coIdFecha &#xD;&#xA;,coIdAgencia &#xD;&#xA;,coIdAsesorPrincipal&#xD;&#xA;,coIdCliente &#xD;&#xA;,coIdCuentaContable&#xD;&#xA;,coIdProducto&#xD;&#xA;,coIdMoneda&#xD;&#xA;,coNumeroOperacion=CONVERT(varchar(12), DecryptByKey(coNumeroOperacion))&#xD;&#xA;,coCuotaCapital&#xD;&#xA;from DWHCuotaOperacion co&#xD;&#xA;inner join &#xD;&#xA;(&#xD;&#xA; select feIdFecha&#xD;&#xA; from DWDFecha&#xD;&#xA; where feCierrMesAnioAtras = 1--bandera para obtener los cierres de mes de un año en base a la fecha de corte actual&#xD;&#xA; and fecierremes=1&#xD;&#xA; and feCalMes between 1 and 6 -- Se filtra los meses que comprenden el primer semestre de un año&#xD;&#xA;&#xD;&#xA;) as fe on co.coIdFecha=fe.feIdFecha&#xD;&#xA;&#xD;&#xA;CLOSE SYMMETRIC KEY ClaveMIS02">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="coIdFecha" msprop:DbColumnName="coIdFecha" msprop:FriendlyName="coIdFecha" type="xs:int" minOccurs="0" />
                          <xs:element name="coIdAgencia" msprop:DbColumnName="coIdAgencia" msprop:FriendlyName="coIdAgencia" type="xs:int" minOccurs="0" />
                          <xs:element name="coIdAsesorPrincipal" msprop:DbColumnName="coIdAsesorPrincipal" msprop:FriendlyName="coIdAsesorPrincipal" type="xs:int" minOccurs="0" />
                          <xs:element name="coIdCliente" msprop:DbColumnName="coIdCliente" msprop:FriendlyName="coIdCliente" type="xs:int" minOccurs="0" />
                          <xs:element name="coIdCuentaContable" msprop:DbColumnName="coIdCuentaContable" msprop:FriendlyName="coIdCuentaContable" type="xs:int" minOccurs="0" />
                          <xs:element name="coIdProducto" msprop:DbColumnName="coIdProducto" msprop:FriendlyName="coIdProducto" type="xs:int" minOccurs="0" />
                          <xs:element name="coIdMoneda" msprop:DbColumnName="coIdMoneda" msprop:FriendlyName="coIdMoneda" type="xs:int" minOccurs="0" />
                          <xs:element name="coNumeroOperacion" msprop:DbColumnName="coNumeroOperacion" msprop:FriendlyName="coNumeroOperacion" minOccurs="0">
                            <xs:simpleType>
                              <xs:restriction base="xs:string">
                                <xs:maxLength value="32766" />
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element name="coCuotaCapital" msprop:DbColumnName="coCuotaCapital" msprop:FriendlyName="coCuotaCapital" type="xs:double" minOccurs="0" />
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="DWHRankingRentabilidadCliente_83435357-aee3-49a8-9547-b388a32c3944" msdata:Locale="" msprop:IsLogical="True" msprop:FriendlyName="DWHRankingRentabilidadCliente" msprop:DbTableName="DWHRankingRentabilidadCliente" msprop:TableType="View" msprop:Description="DWHRankingRentabilidadCliente" msprop:QueryDefinition="set nocount on&#xD;&#xA;&#xD;&#xA;declare @FechaCarga int&#xD;&#xA;&#xD;&#xA;--select @FechaCarga=20220630&#xD;&#xA;&#xD;&#xA;select @FechaCarga=feIdFecha from DWDFecha where feMesAnterior=1&#xD;&#xA;--select feIdFechaTresMesAtras from DWDFecha where feMesAnterior=1&#xD;&#xA;--select feIdFechaSeisMesAtras from DWDFecha where feMesAnterior=1&#xD;&#xA;--select feIdFechaDoceMesAtras from DWDFecha where feMesAnterior=1&#xD;&#xA;&#xD;&#xA;--select @FechaCarga&#xD;&#xA;&#xD;&#xA;/* -------------------------------------------------------- */&#xD;&#xA;/*          PARTICION TABLA DWHACTIVOOPERACION    */&#xD;&#xA;/* -------------------------------------------------------- */&#xD;&#xA;&#xD;&#xA;-- Cuenta Contable --&#xD;&#xA;&#xD;&#xA;if OBJECT_ID ('tempdb..#DWDCuentaContable') is not null begin drop table #DWDCuentaContable end&#xD;&#xA;&#xD;&#xA;SELECT distinct&#xD;&#xA; cc.ccIdCuentaContable  &#xD;&#xA;,cpCalIndicadorNivel1= cp.indicadorNivel1 &#xD;&#xA;into #DWDCuentaContable&#xD;&#xA;FROM DWDCuentaContable cc&#xD;&#xA;inner join&#xD;&#xA;( &#xD;&#xA;    SELECT DISTINCT &#xD;&#xA;    p.CpCodigoIndicador indicadorNivel1,p1.CpCodigoIndicador indicadorNivel2,p2.CpCodigoIndicador indicadorNivel3,&#xD;&#xA;    p.CpProducto ProductoNivel1,p2.CpEstadoProducto&#xD;&#xA;    FROM DWDClasificacionProductos p&#xD;&#xA;    join DWDClasificacionProductos p1 ON p1.CpPadre=p.CpCodigoIndicador&#xD;&#xA;    join DWDClasificacionProductos p2 ON p2.CpPadre=p1.CpCodigoIndicador&#xD;&#xA;    WHERE p.CpCodigoIndicador in (1,2,3,72,80) -- Comente los indicadores 32,28 ; 72 (ficticias de ingresos); 80 (Portafolio)&#xD;&#xA;    and  p.CpNivel=1 and p1.CpNivel=2 and p2.CpNivel=3&#xD;&#xA;    and p1.CpCodigoIndicador not in (125,143,144) -- Se excluye las agrupaciones de Titularizada, Otros Depositos, Obligaciones Financieras&#xD;&#xA;) cp ON ccCodigoIndicador=cp.indicadorNivel3&#xD;&#xA;&#xD;&#xA;-- Cuenta Contable Indicadores de Tárifa Basica --&#xD;&#xA;&#xD;&#xA;/*&#xD;&#xA; 50 Pago de Cheque por Ventanilla -- ok&#xD;&#xA; 51 Pago de cheques por cámara -- ok&#xD;&#xA; 52 Pago de Cheque Certificado -- ok&#xD;&#xA; 53 Retiro en cajas cuentas de ahorros -- ok&#xD;&#xA; 54 Deposito Mixto - Ahorros. Cuenta Corriente &#xD;&#xA; 55 Atm Retiros Clientes Propios -- Pendiente Revisar ------&#xD;&#xA; 56 Depósitos Efectivo - Ahorros, cuentas corrientes -- ok&#xD;&#xA; 57 Deposito en cheque ahorros y cuentas corriente -- ok&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;if OBJECT_ID ('tempdb..#CuentaContableTB') is not null begin drop table #CuentaContableTB end&#xD;&#xA;&#xD;&#xA;select &#xD;&#xA; ccIdCuentaContable=max(ccIdCuentaContable)&#xD;&#xA;,ccCodigoIndicadorRentabilidad&#xD;&#xA;into #CuentaContableTB&#xD;&#xA;from DWDCuentaContable cc&#xD;&#xA;where ccCodigoIndicadorRentabilidad in (50,51,52,53,54,55,56,57)&#xD;&#xA;group by ccCodigoIndicadorRentabilidad&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;-- Tipo Transaccion --&#xD;&#xA;&#xD;&#xA;if OBJECT_ID ('tempdb..#TipoTransaccion') is not null begin drop table #TipoTransaccion end&#xD;&#xA;&#xD;&#xA;select &#xD;&#xA; ttIdTipoTransaccion&#xD;&#xA;,ttCodigoTransaccion&#xD;&#xA;,ttCodigoServicioMovimiento&#xD;&#xA;,IndicadorCtaContable=case when ttCodigoTransaccion in ('CHDG','DCCT','DCST') then 57 &#xD;&#xA;         when ttCodigoTransaccion in ('150','3110','3111')  then 56&#xD;&#xA;         when ttCodigoTransaccion='6211' then  53&#xD;&#xA;         when ttCodigoTransaccion in ('6210','6301') then 52&#xD;&#xA;         when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CQ' then 51&#xD;&#xA;         when ttCodigoTransaccion='6212' and ttCodigoServicioMovimiento='CV' then 50&#xD;&#xA;        end&#xD;&#xA;into #TipoTransaccion&#xD;&#xA;from DWDTipoTransaccion&#xD;&#xA;where  ttCodigoTransaccion in (&#xD;&#xA; 'CHDG','DCCT','DCST' -- Deposito en cheque ahorros y cuentas corriente (57)&#xD;&#xA;,'150','3110','3111'  -- Depositos Efectivo - Ahorros, cuentas corriente&#xD;&#xA;,'6210','6301' -- Pago de Cheque Certificado&#xD;&#xA;,'6212' -- 6212 CQ Pago de Cheque por Camara ; 6212 CV Pago de Cheque por Ventanilla&#xD;&#xA;,'6211' -- Retiro en cajas cuentas de ahorros&#xD;&#xA;)&#xD;&#xA;union all&#xD;&#xA;select &#xD;&#xA; ttIdTipoTransaccion&#xD;&#xA;,ttCodigoTransaccion&#xD;&#xA;,ttCodigoServicioMovimiento&#xD;&#xA;,IndicadorCtaContable=54&#xD;&#xA;from DWDTipoTransaccion&#xD;&#xA;where  ttCodigoTransaccion in ('150','3110','3111') -- Deposito Mixto - Ahorros. Cuenta Corriente -- Se repite para al realizar cruce con la tabla DWHCanalTransacional&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;if OBJECT_ID ('tempdb..#TipoTransaccionTmp') is not null begin drop table #TipoTransaccionTmp end&#xD;&#xA;&#xD;&#xA;select distinct ttIdTipoTransaccion -- Se quita los duplicados temporalmente para realizar el cruce  con la tabla DWHCanalTransaccional&#xD;&#xA;into #TipoTransaccionTmp&#xD;&#xA;from #TipoTransaccion&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;-- Canal Transaccional --&#xD;&#xA;&#xD;&#xA;if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end&#xD;&#xA;&#xD;&#xA;select&#xD;&#xA;ctIdClientePropietarioOperacion,ctIdTipoTransaccion, &#xD;&#xA;ctNumeroTransaccionesChequeMesFiscal,ctNumeroTransaccionesSinChequeMesFiscal,ctNumeroTransaccionesMesFiscal,&#xD;&#xA;ctNumeroTransaccionesChequeAnioCorrido,ctNumeroTransaccionesSinChequeAnioCorrido,ctNumeroTransaccionesAnioCorrido&#xD;&#xA;into #CanalTransaccionalTmp&#xD;&#xA;from DWHCanalTransaccional ct&#xD;&#xA;inner join #TipoTransaccionTmp tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion&#xD;&#xA;where ct.ctIdFechaTransaccion=@FechaCarga&#xD;&#xA;&#xD;&#xA;-- Canal Transaccional --&#xD;&#xA;&#xD;&#xA;if OBJECT_ID ('tempdb..#CanalTransaccional') is not null begin drop table #CanalTransaccional end&#xD;&#xA;&#xD;&#xA;select&#xD;&#xA; ctIdClientePropietarioOperacion&#xD;&#xA;,IdCuentaContable=ccIdCuentaContable&#xD;&#xA;,NumeroTransaccionesAnual=sum( case when ccCodigoIndicadorRentabilidad=54 then ctNumeroTransaccionesChequeAnioCorrido -- Deposito Mixto&#xD;&#xA;              when ccCodigoIndicadorRentabilidad=56 then ctNumeroTransaccionesSinChequeAnioCorrido  -- Desposito Efectivo&#xD;&#xA;                                else ctNumeroTransaccionesAnioCorrido  end )&#xD;&#xA;into #CanalTransaccional&#xD;&#xA;&#xD;&#xA;from #CanalTransaccionalTmp ct&#xD;&#xA;inner join #TipoTransaccion tt on ct.ctIdTipoTransaccion=tt.ttIdTipoTransaccion&#xD;&#xA;inner join #CuentaContableTB cc on tt.IndicadorCtaContable=cc.ccCodigoIndicadorRentabilidad&#xD;&#xA;group by ctIdClientePropietarioOperacion,ccIdCuentaContable&#xD;&#xA;&#xD;&#xA;---  Activo Operacion --&#xD;&#xA;&#xD;&#xA;if OBJECT_ID ('tempdb..#DatosFuentes') is not null begin drop table #DatosFuentes end&#xD;&#xA;&#xD;&#xA;select &#xD;&#xA; IdCliente=ao.aoIdCliente&#xD;&#xA;,ValorActPondRiesgoPromAnual=sum(isnull(ao.aoValorActPondRiesgoPromAnual,0))&#xD;&#xA;,ValorUtilidadOperativa=sum(isnull(ao.aoValorUtilidadOperativa,0))&#xD;&#xA;into #DatosFuentes&#xD;&#xA;from DWHActivoOperacion ao&#xD;&#xA;inner join #DWDCuentaContable cc on ao.aoIdCuentaContable=cc.ccIdCuentaContable&#xD;&#xA;where ao.aoIdFecha=@FechaCarga&#xD;&#xA;group by ao.aoIdCliente&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;insert into #DatosFuentes&#xD;&#xA;select&#xD;&#xA; ca.ctIdClientePropietarioOperacion&#xD;&#xA;,aoValorActPondRiesgoPromAnual=0&#xD;&#xA;,aoValorUtilidadOperativa=sum( 0-(isnull(cc.ccCostoOperativo,0)*ca.NumeroTransaccionesAnual) ) -- ValorMargenExplotacion - PerdidaEsperada&#xD;&#xA;from #CanalTransaccional ca&#xD;&#xA;inner join DWDCuentaContable cc on ca.IdCuentaContable=cc.ccIdCuentaContable&#xD;&#xA;where NumeroTransaccionesAnual!=0&#xD;&#xA;group by ca.ctIdClientePropietarioOperacion&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;/* -------------------------------------------------------- */&#xD;&#xA;/*         PARTICION TABLA DWHPASIVOSOPERACION    */&#xD;&#xA;/* -------------------------------------------------------- */&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;--- Cuenta Contable Ctas Ahorro y Credito ---&#xD;&#xA;&#xD;&#xA;if object_id('tempdb..#CtasAhoCorr') is not null begin drop table #CtasAhoCorr end &#xD;&#xA;&#xD;&#xA;select ccIdCuentaContable,ccCostoOperativo,ccCodigoIndicadorRentabilidad&#xD;&#xA;into #CtasAhoCorr&#xD;&#xA;from DWDCuentaContable&#xD;&#xA;where ccCodigoIndicadorRentabilidad in&#xD;&#xA;(60, -- Mantenimiento Cuenta Ahorro&#xD;&#xA; 61  -- Mantenimiento Cuenta Corriente&#xD;&#xA;)&#xD;&#xA;&#xD;&#xA;--- Pasivo Operacion ---&#xD;&#xA;&#xD;&#xA;if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end&#xD;&#xA;&#xD;&#xA;select&#xD;&#xA; poIdCliente&#xD;&#xA;,poValorActPondRiesgoPromAnual&#xD;&#xA;,poValorUtilidadOperativa&#xD;&#xA;,poIdCuentaContable&#xD;&#xA;,poSaldoAcumuladoMensualFiscal&#xD;&#xA;--,NumTRXMesFiscal=cast(1 as int)&#xD;&#xA;,NumTRXAnualFiscal=cast(1 as int)*12&#xD;&#xA;into #PasivoOperacion&#xD;&#xA;from DWHPasivoOperacion&#xD;&#xA;where poIdFecha=@FechaCarga&#xD;&#xA;--group by poidfecha,poNoOperacion,poidcliente -- no se deben agrupar por la validacion en la tabla DWHPasivoOperacion&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;insert into #DatosFuentes&#xD;&#xA;select&#xD;&#xA; poIdCliente&#xD;&#xA;,poValorActPondRiesgoPromAnual=sum( isnull(poValorActPondRiesgoPromAnual,0) )&#xD;&#xA;,poValorUtilidadOperativa=sum( isnull(poValorUtilidadOperativa,0) - (case when cta.ccIdCuentaContable is not null and po.poSaldoAcumuladoMensualFiscal!=0 then po.NumTRXAnualFiscal*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada&#xD;&#xA;from #PasivoOperacion po&#xD;&#xA;inner join #DWDCuentaContable cc on po.poIdCuentaContable=cc.ccIdCuentaContable&#xD;&#xA;left outer join #CtasAhoCorr cta on po.poIdCuentaContable=cta.ccIdCuentaContable&#xD;&#xA;group by poIdCliente&#xD;&#xA;&#xD;&#xA;if object_id('tempdb..#PasivoOperacion') is not null begin drop table #PasivoOperacion end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;/* --------------------------------------------------------------- */&#xD;&#xA;/*         PARTICION TABLA DWHTARJETACREDITOOPERACION      */&#xD;&#xA;/* --------------------------------------------------------------- */&#xD;&#xA;&#xD;&#xA;-- Tarjeta --&#xD;&#xA;&#xD;&#xA;if OBJECT_ID ('tempdb..#CuentasPasivoTarjeta') is not null begin drop table #CuentasPasivoTarjeta end&#xD;&#xA;&#xD;&#xA;select ccIdCuentaContable&#xD;&#xA;,ccCostoOperativo&#xD;&#xA;into #CuentasPasivoTarjeta&#xD;&#xA;from DWDCuentaContable&#xD;&#xA;where ccCodigoIndicadorRentabilidad in ( &#xD;&#xA; 62 --Mantenimiento tarjeta credito&#xD;&#xA;)&#xD;&#xA;&#xD;&#xA;if OBJECT_ID ('tempdb..#TarjetaCreditoOperacion') is not null begin drop table #TarjetaCreditoOperacion end&#xD;&#xA;&#xD;&#xA;OPEN SYMMETRIC KEY ClaveMIS02&#xD;&#xA;DECRYPTION BY CERTIFICATE Certi01&#xD;&#xA;&#xD;&#xA;select &#xD;&#xA; tcoIdCliente&#xD;&#xA;--,poNoOperacion=CONVERT(varchar(30), DecryptByKey(poNoOperacion))&#xD;&#xA;,tcoValorActPondRiesgoPromAnual=sum(tcoValorActPondRiesgoPromAnual)&#xD;&#xA;,tcoSaldoAcumuladoMensualFiscal=sum(tcoSaldoAcumuladoMensualFiscal)&#xD;&#xA;,tcoValorUtilidadOperativa=sum(tcoValorUtilidadOperativa)&#xD;&#xA;,tcoIdCuentaContable=max(tcoIdCuentaContable)&#xD;&#xA;--,NumTRXMesFiscal=cast(1 as int)&#xD;&#xA;,NumTRXAnualFiscal=cast(1 as int)*12&#xD;&#xA;into #TarjetaCreditoOperacion&#xD;&#xA;from DWHTarjetaCreditoOperacion&#xD;&#xA;where tcoIdFecha=@FechaCarga&#xD;&#xA;group by tcoIdCliente,CONVERT(varchar(30), DecryptByKey(tcoNumeroOperacion)) -- debe tener la agrupacion por cleinte y operacion &#xD;&#xA;&#xD;&#xA;CLOSE SYMMETRIC KEY ClaveMIS02&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;insert into #DatosFuentes&#xD;&#xA;select&#xD;&#xA; tcoIdCliente&#xD;&#xA;,tcoValorActPondRiesgoPromAnual=sum(tcoValorActPondRiesgoPromAnual)&#xD;&#xA;,tcoValorUtilidadOperativa=sum( isnull(tcoValorUtilidadOperativa,0) - (case when cta.ccIdCuentaContable is not null and tco.tcoSaldoAcumuladoMensualFiscal!=0 then tco.NumTRXAnualFiscal*cta.ccCostoOperativo else 0 end) )  --------- ValorMargenExplotacion - PerdidaEsperada&#xD;&#xA;FROM #TarjetaCreditoOperacion tco&#xD;&#xA;inner join #DWDCuentaContable cc on tco.tcoIdCuentaContable=cc.ccIdCuentaContable&#xD;&#xA;left outer join #CuentasPasivoTarjeta cta on tco.tcoIdCuentaContable=cta.ccIdCuentaContable&#xD;&#xA;group by tcoIdCliente&#xD;&#xA;&#xD;&#xA;if OBJECT_ID ('tempdb..#TarjetaCreditoOperacion') is not null begin drop table #TarjetaCreditoOperacion end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;/* ------------------------------------------ */&#xD;&#xA;/*        CALCULO RANKING POR CANAL     */&#xD;&#xA;/* ------------------------------------------ */&#xD;&#xA;&#xD;&#xA;if OBJECT_ID ('tempdb..#Cliente') is not null begin drop table #Cliente end&#xD;&#xA;&#xD;&#xA;select&#xD;&#xA; cl.clIdCliente&#xD;&#xA;,cl.clCodigoCliente&#xD;&#xA;,ca.caCodigoAgrupacionCanal&#xD;&#xA;into #Cliente&#xD;&#xA;from DWDCliente cl&#xD;&#xA;inner join DWDCanal ca on cl.clIdCanal=ca.caIdCanal&#xD;&#xA;where cl.clCodigoCliente not in (-1,0) --- Son los clientes de ajuste que no deben mostrar en los ranking pero si en los totales&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;if OBJECT_ID ('tempdb..#Ranking') is not null begin drop table #Ranking end&#xD;&#xA;&#xD;&#xA;select top 50&#xD;&#xA; cl.clCodigoCliente&#xD;&#xA;,cl.caCodigoAgrupacionCanal&#xD;&#xA;,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)&#xD;&#xA;,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)&#xD;&#xA;into #Ranking&#xD;&#xA;from #DatosFuentes df&#xD;&#xA;inner join #Cliente cl on df.IdCliente=cl.clIdCliente&#xD;&#xA;where cl.caCodigoAgrupacionCanal='RED'&#xD;&#xA;group by cl.clCodigoCliente&#xD;&#xA;,cl.caCodigoAgrupacionCanal&#xD;&#xA;order by ValorUtilidadOperativa desc&#xD;&#xA;&#xD;&#xA;insert into #Ranking&#xD;&#xA;select top 50&#xD;&#xA; cl.clCodigoCliente&#xD;&#xA;,cl.caCodigoAgrupacionCanal&#xD;&#xA;,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)&#xD;&#xA;,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)&#xD;&#xA;from #DatosFuentes df&#xD;&#xA;inner join #Cliente cl on df.IdCliente=cl.clIdCliente&#xD;&#xA;where cl.caCodigoAgrupacionCanal='COR'&#xD;&#xA;group by cl.clCodigoCliente&#xD;&#xA;,cl.caCodigoAgrupacionCanal&#xD;&#xA;order by ValorUtilidadOperativa desc&#xD;&#xA;&#xD;&#xA;insert into #Ranking&#xD;&#xA;select top 50&#xD;&#xA; cl.clCodigoCliente&#xD;&#xA;,cl.caCodigoAgrupacionCanal&#xD;&#xA;,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)&#xD;&#xA;,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)&#xD;&#xA;from #DatosFuentes df&#xD;&#xA;inner join #Cliente cl on df.IdCliente=cl.clIdCliente&#xD;&#xA;where cl.caCodigoAgrupacionCanal='ESP'&#xD;&#xA;group by cl.clCodigoCliente&#xD;&#xA;,cl.caCodigoAgrupacionCanal&#xD;&#xA;order by ValorUtilidadOperativa desc&#xD;&#xA;&#xD;&#xA;insert into #Ranking&#xD;&#xA;select top 50&#xD;&#xA; cl.clCodigoCliente&#xD;&#xA;,cl.caCodigoAgrupacionCanal&#xD;&#xA;,ValorActPondRiesgoPromAnual=sum(df.ValorActPondRiesgoPromAnual)&#xD;&#xA;,ValorUtilidadOperativa=sum(df.ValorUtilidadOperativa)&#xD;&#xA;from #DatosFuentes df&#xD;&#xA;inner join #Cliente cl on df.IdCliente=cl.clIdCliente&#xD;&#xA;where cl.caCodigoAgrupacionCanal='TES'&#xD;&#xA;group by cl.clCodigoCliente&#xD;&#xA;,cl.caCodigoAgrupacionCanal&#xD;&#xA;order by ValorUtilidadOperativa desc&#xD;&#xA;&#xD;&#xA;if OBJECT_ID ('tempdb..#Cliente') is not null begin drop table #Cliente end -- elimino esta tabla temporal porque ya no se utiliza apartir de esta linea&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;/* ------------------------------ */&#xD;&#xA;/*        TABLA FINAL     */&#xD;&#xA;/* ------------------------------ */&#xD;&#xA;&#xD;&#xA;if OBJECT_ID ('tempdb..#DWDCliente') is not null begin drop table #DWDCliente end&#xD;&#xA;&#xD;&#xA;select clIdCliente=max(clIdCliente),clCodigoCliente &#xD;&#xA;into #DWDCliente&#xD;&#xA;from DWDCliente&#xD;&#xA;group by clCodigoCliente&#xD;&#xA;&#xD;&#xA;select&#xD;&#xA; Orden=Row_Number() over (partition by tf.caCodigoAgrupacionCanal order by tf.ValorUtilidadOperativa desc )&#xD;&#xA;,Fecha=@FechaCarga&#xD;&#xA;,cl.clIdCliente&#xD;&#xA;,tf.ValorActPondRiesgoPromAnual &#xD;&#xA;,tf.ValorUtilidadOperativa&#xD;&#xA;from #Ranking tf&#xD;&#xA;inner join #DWDCliente cl on tf.clCodigoCliente=cl.clCodigoCliente -- se toma el id del cliente maximo&#xD;&#xA;order by tf.caCodigoAgrupacionCanal&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;if OBJECT_ID ('tempdb..#DWDCliente') is not null begin drop table #DWDCliente end&#xD;&#xA;if OBJECT_ID ('tempdb..#DatosFuentes') is not null begin drop table #DatosFuentes end&#xD;&#xA;if OBJECT_ID ('tempdb..#CanalTransaccionalTmp') is not null begin drop table #CanalTransaccionalTmp end&#xD;&#xA;if OBJECT_ID ('tempdb..#Ranking') is not null begin drop table #Ranking end">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="Orden" msprop:DbColumnName="Orden" msprop:FriendlyName="Orden" type="xs:long" minOccurs="0" />
                          <xs:element name="Fecha" msprop:DbColumnName="Fecha" msprop:FriendlyName="Fecha" type="xs:int" minOccurs="0" />
                          <xs:element name="clIdCliente" msprop:DbColumnName="clIdCliente" msprop:FriendlyName="clIdCliente" type="xs:int" minOccurs="0" />
                          <xs:element name="ValorActPondRiesgoPromAnual" msprop:DbColumnName="ValorActPondRiesgoPromAnual" msprop:FriendlyName="ValorActPondRiesgoPromAnual" type="xs:double" minOccurs="0" />
                          <xs:element name="ValorUtilidadOperativa" msprop:DbColumnName="ValorUtilidadOperativa" msprop:FriendlyName="ValorUtilidadOperativa" type="xs:double" minOccurs="0" />
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                  </xs:choice>
                </xs:complexType>
                <xs:unique name="Constraint1" msdata:PrimaryKey="true">
                  <xs:selector xpath=".//DWDCuentaContable_09d4cd84-df5b-4931-8e85-b3bd1e2dc933" />
                  <xs:field xpath="ccIdCuentaContable" />
                </xs:unique>
                <xs:unique name="DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e_Constraint1" msdata:ConstraintName="Constraint1" msdata:PrimaryKey="true">
                  <xs:selector xpath=".//DWDFecha_3ee73abf-d2b6-4e5e-82d9-20a581444b0e" />
                  <xs:field xpath="feIdFecha" />
                </xs:unique>
                <xs:unique name="DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9_Constraint1" msdata:ConstraintName="Constraint1" msdata:PrimaryKey="true">
                  <xs:selector xpath=".//DWDCanal_8ac3df34-6c3f-42b5-ad80-55ae5c042db9" />
                  <xs:field xpath="caIdCanal" />
                </xs:unique>
                <xs:unique name="DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9_Constraint1" msdata:ConstraintName="Constraint1" msdata:PrimaryKey="true">
                  <xs:selector xpath=".//DWDAgenciaOperacion_603e7ea3-ea1c-4233-b4cd-3f19b166b5f9" />
                  <xs:field xpath="agIdAgencia" />
                </xs:unique>
                <xs:unique name="DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489_Constraint1" msdata:ConstraintName="Constraint1" msdata:PrimaryKey="true">
                  <xs:selector xpath=".//DWDAsesorOperacion_9170c0b2-65ba-4629-aae8-418ab8929489" />
                  <xs:field xpath="asIdAsesor" />
                </xs:unique>
                <xs:unique name="DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461_Constraint1" msdata:ConstraintName="Constraint1" msdata:PrimaryKey="true">
                  <xs:selector xpath=".//DWDSegmentacionCliente_c362a353-76ac-4f2c-95a5-cf929acf9461" />
                  <xs:field xpath="scIdSegmentacionCliente" />
                </xs:unique>
                <xs:unique name="DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997_Constraint1" msdata:ConstraintName="Constraint1" msdata:PrimaryKey="true">
                  <xs:selector xpath=".//DWDBanca_71f0e35f-4eec-47b9-b81e-582b969d4997" />
                  <xs:field xpath="baIdBanca" />
                </xs:unique>
                <xs:unique name="DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10_Constraint1" msdata:ConstraintName="Constraint1" msdata:PrimaryKey="true">
                  <xs:selector xpath=".//DWDCalificacionOperacionCliente_d79ca593-d16b-45b5-a3a0-41dcf5d09c10" />
                  <xs:field xpath="cocIdCalificacionOperacionCliente" />
                </xs:unique>
                <xs:unique name="DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b_Constraint1" msdata:ConstraintName="Constraint1" msdata:PrimaryKey="true">
                  <xs:selector xpath=".//DWDMoneda_78ca64f8-1fe0-470c-866f-0de6e1864f6b" />
                  <xs:field xpath="moIdMoneda" />
                </xs:unique>
                <xs:unique name="DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791_Constraint1" msdata:ConstraintName="Constraint1" msdata:PrimaryKey="true">
                  <xs:selector xpath=".//DWDProducto_49cf50b4-0a3e-404b-931b-c15b697bb791" />
                  <xs:field xpath="prIdProducto" />
                </xs:unique>
              </xs:element>
            </xs:schema>
            <NewDataSet xmlns="" />
          </Schema>
        </DataSourceView>
      </DataSourceViews>
      <Roles>
        <Role>
          <ID>Role</ID>
          <Name>Lectura</Name>
          <Members>
            <Member>
              <Name>BANINTERN\bingomes</Name>
              <Sid>S-1-5-21-3084530191-2796110714-333732663-34653</Sid>
            </Member>
            <Member>
              <Name>BANINTERN\binvilld</Name>
              <Sid>S-1-5-21-3084530191-2796110714-333732663-4624</Sid>
            </Member>
            <Member>
              <Name>BANINTERN\binanche</Name>
              <Sid>S-1-5-21-3084530191-2796110714-333732663-4933</Sid>
            </Member>
            <Member>
              <Name>BANINTERN\ggs_MIS_MonitorHojaPosicion</Name>
              <Sid>S-1-5-21-3084530191-2796110714-333732663-35939</Sid>
            </Member>
            <Member>
              <Name>BANINTERN\bincarro</Name>
              <Sid>S-1-5-21-3084530191-2796110714-333732663-34750</Sid>
            </Member>
            <Member>
              <Name>BANINTERN\BINXASTE</Name>
              <Sid>S-1-5-21-3084530191-2796110714-333732663-34271</Sid>
            </Member>
          </Members>
        </Role>
        <Role>
          <ID>Role2</ID>
          <Name>Administrador</Name>
          <Members>
            <Member>
              <Name>BANINTERN\bincarro</Name>
              <Sid>S-1-5-21-3084530191-2796110714-333732663-34750</Sid>
            </Member>
            <Member>
              <Name>BANINTERN\BINXASTE</Name>
              <Sid>S-1-5-21-3084530191-2796110714-333732663-34271</Sid>
            </Member>
            <Member>
              <Name>BANINTERN\bingod34</Name>
              <Sid>S-1-5-21-3084530191-2796110714-333732663-58887</Sid>
            </Member>
          </Members>
        </Role>
      </Roles>
      <DatabasePermissions>
        <DatabasePermission>
          <ID>DatabasePermission</ID>
          <Name>DatabasePermission</Name>
          <RoleID>Role</RoleID>
          <Read>Allowed</Read>
        </DatabasePermission>
        <DatabasePermission>
          <ID>DatabasePermission 1</ID>
          <Name>DatabasePermission 1</Name>
          <RoleID>Role2</RoleID>
          <ReadDefinition>Allowed</ReadDefinition>
          <Administer>true</Administer>
        </DatabasePermission>
      </DatabasePermissions>
    </Database>
  </ObjectDefinition>
</Alter>